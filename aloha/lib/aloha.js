(function(){function pa(a,b){var d,p;p=a||{};this.jQuery=b||{};this.config={};this.config.elements=p.elements?p.elements:[];this.config.attributes=p.attributes?p.attributes:{};this.config.attributes[pa.ALL]=this.config.attributes[pa.ALL]?this.config.attributes[pa.ALL]:[];this.config.allow_comments=p.allow_comments?p.allow_comments:!1;this.allowed_elements={};this.config.protocols=p.protocols?p.protocols:{};this.config.add_attributes=p.add_attributes?p.add_attributes:{};this.dom=p.dom?p.dom:document;
for(d=0;d<this.config.elements.length;d++)this.allowed_elements[this.config.elements[d]]=!0;this.config.remove_element_contents={};this.config.remove_all_contents=!1;if(p.remove_contents)if(p.remove_contents instanceof Array)for(d=0;d<p.remove_contents.length;d++)this.config.remove_element_contents[p.remove_contents[d]]=!0;else this.config.remove_all_contents=!0;this.transformers=p.transformers?p.transformers:[];this.filters=p.filters?p.filters:[]}var da;da||(da={});(function(){function a(a){return 10>
a?"0"+a:a}function b(a){r.lastIndex=0;return r.test(a)?'"'+a.replace(r,function(a){var b=g[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(a,j){var e,g,p,c,u=s,k,y=j[a];y&&("object"===typeof y&&"function"===typeof y.toJSON)&&(y=y.toJSON(a));"function"===typeof f&&(y=f.call(j,a,y));switch(typeof y){case "string":return b(y);case "number":return isFinite(y)?String(y):"null";case "boolean":case "null":return String(y);case "object":if(!y)return"null";
s+=t;k=[];if("[object Array]"===Object.prototype.toString.apply(y)){c=y.length;for(e=0;e<c;e+=1)k[e]=d(e,y)||"null";p=0===k.length?"[]":s?"[\n"+s+k.join(",\n"+s)+"\n"+u+"]":"["+k.join(",")+"]";s=u;return p}if(f&&"object"===typeof f){c=f.length;for(e=0;e<c;e+=1)"string"===typeof f[e]&&(g=f[e],(p=d(g,y))&&k.push(b(g)+(s?": ":":")+p))}else for(g in y)Object.prototype.hasOwnProperty.call(y,g)&&(p=d(g,y))&&k.push(b(g)+(s?": ":":")+p);p=0===k.length?"{}":s?"{\n"+s+k.join(",\n"+s)+"\n"+u+"}":"{"+k.join(",")+
"}";s=u;return p}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var p=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
r=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s,t,g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},f;"function"!==typeof da.stringify&&(da.stringify=function(a,b,e){var g;t=s="";if("number"===typeof e)for(g=0;g<e;g+=1)t+=" ";else"string"===typeof e&&(t=e);if((f=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return d("",{"":a})});
"function"!==typeof da.parse&&(da.parse=function(a,b){function f(a,c){var s,k,g=a[c];if(g&&"object"===typeof g)for(s in g)Object.prototype.hasOwnProperty.call(g,s)&&(k=f(g,s),void 0!==k?g[s]=k:delete g[s]);return b.call(a,c,g)}var s;a=String(a);p.lastIndex=0;p.test(a)&&(a=a.replace(p,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return s=eval("("+a+")"),"function"===typeof b?f({"":s},""):s;throw new SyntaxError("JSON.parse");})})();define("util/json2",[],function(){return da});var ba;a:{var Fa=function(a,b){var d=typeof a[b];return d==Kb||!!(d==Ab&&a[b])||"unknown"==d},Ya=function(a,b){return!!(typeof a[b]==Ab&&a[b])};ba=function(a,b){return typeof a[b]!=Za};var ua=function(a){return function(b,d){for(var p=d.length;p--;)if(!a(b,d[p]))return!1;return!0}},Bb=function(a){return a&&bb(a,
Lb)&&lb(a,Mb)},Ka=function(a){window.alert("Rangy not supported in your browser. Reason: "+a);U.initialized=!0;U.supported=!1},cb=function(){if(!U.initialized){var a,b=!1,d=!1;Fa(document,"createRange")&&(a=document.createRange(),bb(a,Nb)&&lb(a,Ob)&&(b=!0),a.detach());if((a=Ya(document,"body")?document.body:document.getElementsByTagName("body")[0])&&Fa(a,"createTextRange"))a=a.createTextRange(),Bb(a)&&(d=!0);!b&&!d&&Ka("Neither Range nor TextRange are implemented");U.initialized=!0;U.features={implementsDomRange:b,
implementsTextRange:d};b=Cb.concat(Db);d=0;for(a=b.length;d<a;++d)try{b[d](U)}catch(p){Ya(window,"console")&&Fa(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",p)}}},$a=function(a){this.name=a;this.supported=this.initialized=!1},Ab="object",Kb="function",Za="undefined",Ob="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),Nb="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),
Mb="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),Lb="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),bb=ua(Fa),Pa=ua(Ya),lb=ua(ba),U={version:"1.2.1",initialized:!1,supported:!0,util:{isHostMethod:Fa,isHostObject:Ya,isHostProperty:ba,areHostMethods:bb,areHostObjects:Pa,areHostProperties:lb,isTextRange:Bb},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!0}};
U.fail=Ka;U.warn=function(a){a="Rangy warning: "+a;U.config.alertOnWarn?window.alert(a):typeof window.console!=Za&&typeof window.console.log!=Za&&window.console.log(a)};({}).hasOwnProperty?U.util.extend=function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}:Ka("hasOwnProperty not supported");var Db=[],Cb=[];U.init=cb;U.addInitListener=function(a){U.initialized?a(U):Db.push(a)};var ab=[];U.addCreateMissingNativeApiListener=function(a){ab.push(a)};U.createMissingNativeApi=function(a){a=a||window;
cb();for(var b=0,d=ab.length;b<d;++b)ab[b](a)};$a.prototype.fail=function(a){this.initialized=!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+a);};$a.prototype.warn=function(a){U.warn("Module "+this.name+": "+a)};$a.prototype.createError=function(a){return Error("Error in Rangy "+this.name+" module: "+a)};U.createModule=function(a,b){var d=new $a(a);U.modules[a]=d;Cb.push(function(a){b(a,d);d.initialized=!0;d.supported=!0})};U.requireModules=function(a){for(var b=0,d=a.length,
p,r;b<d;++b){r=a[b];p=U.modules[r];if(!p||!(p instanceof $a))throw Error("Module '"+r+"' not found");if(!p.supported)throw Error("Module '"+r+"' not supported");}};var Eb=!1;ba=function(){Eb||(Eb=!0,U.initialized||cb())};if(typeof window==Za)Ka("No window found");else if(typeof document==Za)Ka("No document found");else{Fa(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",ba,!1);Fa(window,"addEventListener")?window.addEventListener("load",ba,!1):Fa(window,"attachEvent")?window.attachEvent("onload",
ba):Ka("Window does not have required addEventListener or attachEvent method");ba=U;break a}ba=void 0}ba.createModule("DomUtil",function(a,b){function d(a){for(var b=0;a=a.previousSibling;)b++;return b}function p(a,b){var c=[],f;for(f=a;f;f=f.parentNode)c.push(f);for(f=b;f;f=f.parentNode)if(k(c,f))return f;return null}function r(a,b,c){for(c=c?a:a.parentNode;c;){a=c.parentNode;if(a===b)return c;c=a}return null}function s(a){a=a.nodeType;return 3==a||4==a||8==a}function t(a,b){var c=b.nextSibling,
f=b.parentNode;c?f.insertBefore(a,c):f.appendChild(a);return a}function g(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=x)return a.ownerDocument;if(typeof a.document!=x)return a.document;if(a.parentNode)return g(a.parentNode);throw Error("getDocument: no document found for node");}function f(a){if(a)return a.previousSibling?a.previousSibling.nextSibling:a.nextSibling?a.nextSibling.previousSibling:a.parentNode?a.parentNode.firstChild:a}function n(a){return!a?"[No node]":s(a)?'"'+a.data+'"':
1==a.nodeType?"<"+a.nodeName+(a.id?' id="'+a.id+'"':"")+">["+a.childNodes.length+"]":a.nodeName}function j(a){this._next=this.root=a}function e(a,b){this.node=a;this.offset=b}function v(a){this.code=this[a];this.codeName=a;this.message="DOMException: "+this.codeName}var x="undefined",c=a.util;c.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method");c.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");
var u=document.createElement("div");c.areHostMethods(u,["insertBefore","appendChild","cloneNode"])||b.fail("Incomplete Element implementation");c.isHostProperty(u,"innerHTML")||b.fail("Element is missing innerHTML property");u=document.createTextNode("test");c.areHostMethods(u,["splitText","deleteData","insertData","appendData","cloneNode"])||b.fail("Incomplete Text Node implementation");var k=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1};j.prototype={_current:null,hasNext:function(){return!!this._next},
next:function(){var a=this._current=this._next,b;if(this._current){b=a.firstChild;if(!b)for(b=null;a!==this.root&&!(b=a.nextSibling);)a=a.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}};e.prototype={equals:function(a){return this.node===a.node&this.offset==a.offset},inspect:function(){return"[DomPosition("+n(this.node)+":"+this.offset+")]"}};v.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,
NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};v.prototype.toString=function(){return this.message};a.dom={arrayContains:k,isHtmlNamespace:function(a){var b;return typeof a.namespaceURI==x||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b},parentElement:function(a){a=a.parentNode;return 1==a.nodeType?a:null},getNodeIndex:d,getNodeLength:function(a){var b;return s(a)?a.length:(b=a.childNodes)?b.length:0},getCommonAncestor:p,isAncestorOf:function(a,b,c){for(b=c?b:b.parentNode;b;){if(b===
a)return!0;b=b.parentNode}return!1},getClosestAncestorIn:r,isCharacterDataNode:s,insertAfter:t,splitDataNode:function(a,b){var c=a.cloneNode(!1);c.deleteData(0,b);a.deleteData(b,a.length-b);t(c,a);return c},getDocument:g,getWindow:function(a){a=g(a);if(typeof a.defaultView!=x)return a.defaultView;if(typeof a.parentWindow!=x)return a.parentWindow;throw Error("Cannot get a window object for node");},getIframeWindow:function(a){if(typeof a.contentWindow!=x)return a.contentWindow;if(typeof a.contentDocument!=
x)return a.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element");},getIframeDocument:function(a){if(typeof a.contentDocument!=x)return a.contentDocument;if(typeof a.contentWindow!=x)return a.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element");},getBody:function(a){return c.isHostObject(a,"body")?a.body:a.getElementsByTagName("body")[0]},getRootContainer:function(a){for(var b;b=a.parentNode;)a=b;return a},
comparePoints:function(a,b,c,k){a=f(a);c=f(c);var e;if(a==c)return b===k?0:b<k?-1:1;if(e=r(c,a,!0))return b<=d(e)?-1:1;if(e=r(a,c,!0))return d(e)<k?-1:1;b=p(a,c);a=a===b?b:r(a,b,!0);c=c===b?b:r(c,b,!0);if(a===c)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(b=b.firstChild;b;){if(b===a)return-1;if(b===c)return 1;b=b.nextSibling}throw Error("Should not be here!");},inspectNode:n,fragmentFromNodeChildren:function(a){for(var b=g(a).createDocumentFragment(),c;c=a.firstChild;)b.appendChild(c);
return b},createIterator:function(a){return new j(a)},DomPosition:e};a.DOMException=v});ba.createModule("DomRange",function(a){function b(a,b){return 3!=a.nodeType&&(H.isAncestorOf(a,b.startContainer,!0)||H.isAncestorOf(a,b.endContainer,!0))}function d(a){return H.getDocument(a.startContainer)}function p(a,b,c){if(b=a._listeners[b])for(var k=0,f=b.length;k<f;++k)b[k].call(a,{target:a,args:c})}function r(a){return new ya(a.parentNode,H.getNodeIndex(a))}function s(a){return new ya(a.parentNode,H.getNodeIndex(a)+
1)}function t(a,b,c){var k=11==a.nodeType?a.firstChild:a;H.isCharacterDataNode(b)?c==b.length?H.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:H.splitDataNode(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]);return k}function g(a){for(var b,c,k=d(a.range).createDocumentFragment();c=a.next();){b=a.isPartiallySelectedSubtree();c=c.cloneNode(!b);b&&(b=a.getSubtreeIterator(),c.appendChild(g(b)),b.detach(!0));if(10==c.nodeType)throw new ha("HIERARCHY_REQUEST_ERR");k.appendChild(c)}return k}
function f(a,b,c){var k,e;for(c=c||{stop:!1};k=a.next();)if(a.isPartiallySelectedSubtree())if(!1===b(k)){c.stop=!0;break}else{if(k=a.getSubtreeIterator(),f(k,b,c),k.detach(!0),c.stop)break}else for(k=H.createIterator(k);e=k.next();)if(!1===b(e)){c.stop=!0;return}}function n(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),n(b),b.detach(!0)):a.remove()}function j(a){for(var b,c=d(a.range).createDocumentFragment(),k;b=a.next();){a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),
k=a.getSubtreeIterator(),b.appendChild(j(k)),k.detach(!0)):a.remove();if(10==b.nodeType)throw new ha("HIERARCHY_REQUEST_ERR");c.appendChild(b)}return c}function e(a,b,c){var k=!(!b||!b.length),e,s=!!c;k&&(e=RegExp("^("+b.join("|")+")$"));var j=[];f(new x(a,!1),function(a){(!k||e.test(a.nodeType))&&(!s||c(a))&&j.push(a)});return j}function v(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+H.inspectNode(a.startContainer)+":"+a.startOffset+", "+H.inspectNode(a.endContainer)+":"+
a.endOffset+")]"}function x(a,b){this.range=a;this.clonePartiallySelectedTextNodes=b;if(!a.collapsed){this.sc=a.startContainer;this.so=a.startOffset;this.ec=a.endContainer;this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&H.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===c&&!H.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:H.getClosestAncestorIn(this.sc,c,!0),this._last=this.ec===
c&&!H.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:H.getClosestAncestorIn(this.ec,c,!0))}}function c(a){this.code=this[a];this.codeName=a;this.message="RangeException: "+this.codeName}function u(a,b,c){this.nodes=e(a,b,c);this._next=this.nodes[0];this._position=0}function k(a){return function(b,c){for(var k,f=c?b:b.parentNode;f;){k=f.nodeType;if(H.arrayContains(a,k))return f;f=f.parentNode}return null}}function y(a,b){if(da(a,b))throw new c("INVALID_NODE_TYPE_ERR");}function z(a){if(!a.startContainer)throw new ha("INVALID_STATE_ERR");
}function D(a,b){if(!H.arrayContains(b,a.nodeType))throw new c("INVALID_NODE_TYPE_ERR");}function K(a,b){if(0>b||b>(H.isCharacterDataNode(a)?a.length:a.childNodes.length))throw new ha("INDEX_SIZE_ERR");}function E(a,b){if(aa(a,!0)!==aa(b,!0))throw new ha("WRONG_DOCUMENT_ERR");}function B(a){if(A(a,!0))throw new ha("NO_MODIFICATION_ALLOWED_ERR");}function J(a,b){if(!a)throw new ha(b);}function N(a){z(a);if(!H.arrayContains(U,a.startContainer.nodeType)&&!aa(a.startContainer,!0)||!H.arrayContains(U,
a.endContainer.nodeType)&&!aa(a.endContainer,!0)||!(a.startOffset<=(H.isCharacterDataNode(a.startContainer)?a.startContainer.length:a.startContainer.childNodes.length))||!(a.endOffset<=(H.isCharacterDataNode(a.endContainer)?a.endContainer.length:a.endContainer.childNodes.length)))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")");}function W(){}function oa(a){a.START_TO_START=Ga;a.START_TO_END=sb;a.END_TO_END=ea;a.END_TO_START=L;a.NODE_BEFORE=P;a.NODE_AFTER=
C;a.NODE_BEFORE_AND_AFTER=R;a.NODE_INSIDE=ba}function G(a){oa(a);oa(a.prototype)}function T(a,b){return function(){N(this);var c=this.startContainer,k=this.startOffset,e=this.commonAncestorContainer,j=new x(this,!0);c!==e&&(c=H.getClosestAncestorIn(c,e,!0),k=s(c),c=k.node,k=k.offset);f(j,B);j.reset();e=a(j);j.detach();b(this,c,k,c,k);return e}}function ca(c,k,f){function e(a,b){return function(c){z(this);D(c,ia);D(O(c),U);c=(a?r:s)(c);(b?g:u)(this,c.node,c.offset)}}function g(a,b,c){var f=a.endContainer,
e=a.endOffset;if(b!==a.startContainer||c!==this.startOffset){if(O(b)!=O(f)||1==H.comparePoints(b,c,f,e))f=b,e=c;k(a,b,c,f,e)}}function u(a,b,c){var f=a.startContainer,e=a.startOffset;if(b!==a.endContainer||c!==this.endOffset){if(O(b)!=O(f)||-1==H.comparePoints(b,c,f,e))f=b,e=c;k(a,f,e,b,c)}}function t(a,b,c){(b!==a.startContainer||c!==this.startOffset||b!==a.endContainer||c!==this.endOffset)&&k(a,b,c,b,c)}c.prototype=new W;a.util.extend(c.prototype,{setStart:function(a,b){z(this);y(a,!0);K(a,b);g(this,
a,b)},setEnd:function(a,b){z(this);y(a,!0);K(a,b);u(this,a,b)},setStartBefore:e(!0,!0),setStartAfter:e(!1,!0),setEndBefore:e(!0,!1),setEndAfter:e(!1,!1),collapse:function(a){N(this);a?k(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):k(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){z(this);y(a,!0);k(this,a,0,a,H.getNodeLength(a))},selectNode:function(a){z(this);y(a,!1);D(a,ia);var b=r(a);a=s(a);k(this,b.node,
b.offset,a.node,a.offset)},extractContents:T(j,k),deleteContents:T(n,k),canSurroundContents:function(){N(this);B(this.startContainer);B(this.endContainer);var a=new x(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);a.detach();return!c},detach:function(){f(this)},splitBoundaries:function(){N(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,f=this.endOffset,e=a===c;H.isCharacterDataNode(c)&&(0<f&&f<c.length)&&H.splitDataNode(c,f);H.isCharacterDataNode(a)&&(0<b&&
b<a.length)&&(a=H.splitDataNode(a,b),e?(f-=b,c=a):c==a.parentNode&&f>=H.getNodeIndex(a)&&f++,b=0);k(this,a,b,c,f)},normalizeBoundaries:function(){N(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,f=this.endOffset,e=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,f=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},s=function(k){var e=k.previousSibling;if(e&&e.nodeType==k.nodeType){a=k;var s=k.length;b=e.length;k.insertData(0,e.data);e.parentNode.removeChild(e);
a==c?(f+=b,c=a):c==k.parentNode&&(e=H.getNodeIndex(k),f==e?(c=k,f=s):f>e&&f--)}},j=!0;H.isCharacterDataNode(c)?c.length==f&&e(c):(0<f&&(j=c.childNodes[f-1])&&H.isCharacterDataNode(j)&&e(j),j=!this.collapsed);j?H.isCharacterDataNode(a)?0==b&&s(a):b<a.childNodes.length&&(e=a.childNodes[b])&&H.isCharacterDataNode(e)&&s(e):(a=c,b=f);k(this,a,b,c,f)},collapseToPoint:function(a,b){z(this);y(a,!0);K(a,b);t(this,a,b)}});G(c)}function Fb(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;
a.commonAncestorContainer=a.collapsed?a.startContainer:H.getCommonAncestor(a.startContainer,a.endContainer)}function Ba(a,b,c,k,f){var e=a.startContainer!==b||a.startOffset!==c,s=a.endContainer!==k||a.endOffset!==f;a.startContainer=b;a.startOffset=c;a.endContainer=k;a.endOffset=f;Fb(a);p(a,"boundarychange",{startMoved:e,endMoved:s})}function V(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};Fb(this)}a.requireModules(["DomUtil"]);
var H=a.dom,ya=H.DomPosition,ha=a.DOMException;x.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=a!==this._last?a.nextSibling:null,H.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,
this.so)));return a},remove:function(){var a=this._current,b,c;H.isCharacterDataNode(a)&&(a===this.sc||a===this.ec)?(b=a===this.sc?this.so:0,c=a===this.ec?this.eo:a.length,b!=c&&a.deleteData(b,c-b)):a.parentNode&&a.parentNode.removeChild(a)},isPartiallySelectedSubtree:function(){return b(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new V(d(this.range));var b=this._current,c=b,k=0,f=b,e=H.getNodeLength(b);
H.isAncestorOf(b,this.sc,!0)&&(c=this.sc,k=this.so);H.isAncestorOf(b,this.ec,!0)&&(f=this.ec,e=this.eo);Ba(a,c,k,f,e)}return new x(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};c.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};c.prototype.toString=function(){return this.message};u.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=
this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var ia=[1,3,4,5,7,8,10],U=[2,9,11],ma=[1,3,4,5,7,8,10,11],X=[1,3,4,5,7,8],O=H.getRootContainer,aa=k([9,11]),A=k([5,6,10,12]),da=k([6,10,12]),Ia=document.createElement("style"),ja=!1;try{Ia.innerHTML="<b>x</b>",ja=3==Ia.firstChild.nodeType}catch(fa){}a.features.htmlParsingConforms=ja;var La="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),
Ga=0,sb=1,ea=2,L=3,P=0,C=1,R=2,ba=3;W.prototype={attachListener:function(a,b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){N(this);E(this.startContainer,b.startContainer);var c=a==L||a==Ga?"start":"end",k=a==sb||a==Ga?"start":"end";return H.comparePoints(this[c+"Container"],this[c+"Offset"],b[k+"Container"],b[k+"Offset"])},insertNode:function(a){N(this);D(a,ma);B(this.startContainer);if(H.isAncestorOf(a,this.startContainer,!0))throw new ha("HIERARCHY_REQUEST_ERR");a=t(a,this.startContainer,
this.startOffset);this.setStartBefore(a)},cloneContents:function(){N(this);var a,b;if(this.collapsed)return d(this).createDocumentFragment();if(this.startContainer===this.endContainer&&H.isCharacterDataNode(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=d(this).createDocumentFragment(),b.appendChild(a),b;b=new x(this,!0);a=g(b);b.detach();return a},canSurroundContents:function(){N(this);B(this.startContainer);B(this.endContainer);
var a=new x(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);a.detach();return!c},surroundContents:function(a){D(a,X);if(!this.canSurroundContents())throw new c("BAD_BOUNDARYPOINTS_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);t(a,this.startContainer,this.startOffset);a.appendChild(b);this.selectNode(a)},cloneRange:function(){N(this);for(var a=new V(d(this)),b=La.length,c;b--;)c=La[b],a[c]=this[c];return a},toString:function(){N(this);
var a=this.startContainer;if(a===this.endContainer&&H.isCharacterDataNode(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],a=new x(this,!0);f(a,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)});a.detach();return b.join("")},compareNode:function(a){N(this);var b=a.parentNode,c=H.getNodeIndex(a);if(!b)throw new ha("NOT_FOUND_ERR");a=this.comparePoint(b,c);b=this.comparePoint(b,c+1);return 0>a?0<b?R:P:0<b?C:ba},comparePoint:function(a,b){N(this);
J(a,"HIERARCHY_REQUEST_ERR");E(a,this.startContainer);return 0>H.comparePoints(a,b,this.startContainer,this.startOffset)?-1:0<H.comparePoints(a,b,this.endContainer,this.endOffset)?1:0},createContextualFragment:ja?function(a){var b=this.startContainer,c=H.getDocument(b);if(!b)throw new ha("INVALID_STATE_ERR");var k=null;1==b.nodeType?k=b:H.isCharacterDataNode(b)&&(k=H.parentElement(b));k=null===k||"HTML"==k.nodeName&&H.isHtmlNamespace(H.getDocument(k).documentElement)&&H.isHtmlNamespace(k)?c.createElement("body"):
k.cloneNode(!1);k.innerHTML=a;return H.fragmentFromNodeChildren(k)}:function(a){z(this);var b=d(this).createElement("body");b.innerHTML=a;return H.fragmentFromNodeChildren(b)},toHtml:function(){N(this);var a=d(this).createElement("div");a.appendChild(this.cloneContents());return a.innerHTML},intersectsNode:function(a,b){N(this);J(a,"NOT_FOUND_ERR");if(H.getDocument(a)!==d(this))return!1;var c=a.parentNode,k=H.getNodeIndex(a);J(c,"NOT_FOUND_ERR");var f=H.comparePoints(c,k,this.endContainer,this.endOffset),
c=H.comparePoints(c,k+1,this.startContainer,this.startOffset);return b?0>=f&&0<=c:0>f&&0<c},isPointInRange:function(a,b){N(this);J(a,"HIERARCHY_REQUEST_ERR");E(a,this.startContainer);return 0<=H.comparePoints(a,b,this.startContainer,this.startOffset)&&0>=H.comparePoints(a,b,this.endContainer,this.endOffset)},intersectsRange:function(a,b){N(this);if(d(a)!=d(this))throw new ha("WRONG_DOCUMENT_ERR");var c=H.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),k=H.comparePoints(this.endContainer,
this.endOffset,a.startContainer,a.startOffset);return b?0>=c&&0<=k:0>c&&0<k},intersection:function(a){if(this.intersectsRange(a)){var b=H.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=H.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),k=this.cloneRange();-1==b&&k.setStart(a.startContainer,a.startOffset);1==c&&k.setEnd(a.endContainer,a.endOffset);return k}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();
-1==H.comparePoints(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset);1==H.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset);return b}throw new c("Ranges do not intersect");},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==ba},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,H.getNodeLength(a))},containsRange:function(a){return this.intersection(a).equals(a)},
containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);return 0<c.length?(b.setStart(c[0],0),a=c.pop(),b.setEnd(a,a.length),a=this.containsRange(b),b.detach(),a):this.containsNodeContents(a)},createNodeIterator:function(a,b){N(this);return new u(this,a,b)},getNodes:function(a,b){N(this);return e(this,a,b)},getDocument:function(){return d(this)},collapseBefore:function(a){z(this);this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){z(this);this.setStartAfter(a);
this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return V.rangesEqual(this,a)},inspect:function(){return v(this)}};ca(V,Ba,function(a){z(a);a.startContainer=a.startOffset=a.endContainer=a.endOffset=null;a.collapsed=a.commonAncestorContainer=null;p(a,"detach",null);a._listeners=null});a.rangePrototype=W.prototype;V.rangeProperties=La;V.RangeIterator=x;V.copyComparisonConstants=G;V.createPrototypeRange=ca;V.inspect=v;V.getRangeDocument=d;V.rangesEqual=function(a,b){return a.startContainer===
b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset};a.DomRange=V;a.RangeException=c});ba.createModule("WrappedRange",function(a){function b(a,b,k,f){var e=a.duplicate();e.collapse(k);var j=e.parentElement();r.isAncestorOf(b,j,!0)||(j=b);if(!j.canHaveHTML)return new s(j.parentNode,r.getNodeIndex(j));b=r.getDocument(j).createElement("span");b.parentNode&&b.parentNode.removeChild(b);var g,n=k?"StartToStart":"StartToEnd";do j.insertBefore(b,b.previousSibling),
e.moveToElementText(b);while(0<(g=e.compareEndPoints(n,a))&&b.previousSibling);n=b.nextSibling;if(-1==g&&n&&r.isCharacterDataNode(n)){e.setEndPoint(k?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(n.data)){e=e.duplicate();j=e.text.replace(/\r\n/g,"\r").length;for(j=e.moveStart("character",j);-1==e.compareEndPoints("StartToEnd",e);)j++,e.moveStart("character",1)}else if(j=e.text.replace(/\u00a0/g," "),k=n.data.replace(/\u00a0/g," "),0!==k.indexOf(j)){for(;0<j.length&&0!==k.indexOf(j);)j=j.substr(1);j=
j.length}else j=e.text.length;n=new s(n,j)}else n=(f||!k)&&b.previousSibling,n=(e=(f||k)&&b.nextSibling)&&r.isCharacterDataNode(e)?new s(e,0):n&&r.isCharacterDataNode(n)?new s(n,n.length):new s(j,r.getNodeIndex(b));b.parentNode.removeChild(b);return n}function d(a,b){var k,f,e=a.offset,s=r.getDocument(a.node),j=s.body.createTextRange(),g=r.isCharacterDataNode(a.node);g?(k=a.node,f=k.parentNode):(k=a.node.childNodes,k=e<k.length?k[e]:null,f=a.node);s=s.createElement("span");s.innerHTML="&#feff;";k?
f.insertBefore(s,k):f.appendChild(s);try{j.moveToElementText(s),j.collapse(!b)}catch(n){}f.removeChild(s);if(g)j[b?"moveStart":"moveEnd"]("character",e);return j}a.requireModules(["DomUtil","DomRange"]);var p,r=a.dom,s=r.DomPosition,t=a.DomRange;if(a.features.implementsDomRange&&(!a.features.implementsTextRange||!a.config.preferTextRange)){var g=function(a){for(var b=n.length,k;b--;)k=n[b],a[k]=a.nativeRange[k]},f,n=t.rangeProperties,j;p=function(a){if(!a)throw Error("Range must be specified");this.nativeRange=
a;g(this)};t.createPrototypeRange(p,function(a,b,k,f,e){var s=a.endContainer!==f||a.endOffset!=e;if(a.startContainer!==b||a.startOffset!=k||s)a.setEnd(f,e),a.setStart(b,k)},function(a){a.nativeRange.detach();a.detached=!0;for(var b=n.length,k;b--;)k=n[b],a[k]=null});f=p.prototype;f.selectNode=function(a){this.nativeRange.selectNode(a);g(this)};f.deleteContents=function(){this.nativeRange.deleteContents();g(this)};f.extractContents=function(){var a=this.nativeRange.extractContents();g(this);return a};
f.cloneContents=function(){return this.nativeRange.cloneContents()};f.surroundContents=function(a){this.nativeRange.surroundContents(a);g(this)};f.collapse=function(a){this.nativeRange.collapse(a);g(this)};f.cloneRange=function(){return new p(this.nativeRange.cloneRange())};f.refresh=function(){g(this)};f.toString=function(){return this.nativeRange.toString()};var e=document.createTextNode("test");r.getBody(document).appendChild(e);var v=document.createRange();v.setStart(e,0);v.setEnd(e,0);try{v.setStart(e,
1),f.setStart=function(a,b){this.nativeRange.setStart(a,b);g(this)},f.setEnd=function(a,b){this.nativeRange.setEnd(a,b);g(this)},j=function(a){return function(b){this.nativeRange[a](b);g(this)}}}catch(x){f.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(k){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}g(this)},f.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(k){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}g(this)},j=function(a,b){return function(k){try{this.nativeRange[a](k)}catch(f){this.nativeRange[b](k),
this.nativeRange[a](k)}g(this)}}}f.setStartBefore=j("setStartBefore","setEndBefore");f.setStartAfter=j("setStartAfter","setEndAfter");f.setEndBefore=j("setEndBefore","setStartBefore");f.setEndAfter=j("setEndAfter","setStartAfter");v.selectNodeContents(e);f.selectNodeContents=v.startContainer==e&&v.endContainer==e&&0==v.startOffset&&v.endOffset==e.length?function(a){this.nativeRange.selectNodeContents(a);g(this)}:function(a){this.setStart(a,0);this.setEnd(a,t.getEndOffset(a))};v.selectNodeContents(e);
v.setEnd(e,3);j=document.createRange();j.selectNodeContents(e);j.setEnd(e,4);j.setStart(e,2);f.compareBoundaryPoints=-1==v.compareBoundaryPoints(v.START_TO_END,j)&1==v.compareBoundaryPoints(v.END_TO_START,j)?function(a,b){b=b.nativeRange||b;a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END);return this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};a.util.isHostMethod(v,"createContextualFragment")&&(f.createContextualFragment=
function(a){return this.nativeRange.createContextualFragment(a)});r.getBody(document).removeChild(e);v.detach();j.detach();a.createNativeRange=function(a){a=a||document;return a.createRange()}}else a.features.implementsTextRange&&(p=function(a){this.textRange=a;this.refresh()},p.prototype=new t(document),p.prototype.refresh=function(){var a,f,k=this.textRange;a=k.parentElement();var e=k.duplicate();e.collapse(!0);f=e.parentElement();e=k.duplicate();e.collapse(!1);k=e.parentElement();f=f==k?f:r.getCommonAncestor(f,
k);f=f==a?f:r.getCommonAncestor(a,f);0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?f=a=b(this.textRange,f,!0,!0):(a=b(this.textRange,f,!0,!1),f=b(this.textRange,f,!1,!1));this.setStart(a.node,a.offset);this.setEnd(f.node,f.offset)},t.copyComparisonConstants(p),f=function(){return this}(),"undefined"==typeof f.Range&&(f.Range=p),a.createNativeRange=function(a){a=a||document;return a.body.createTextRange()});a.features.implementsTextRange&&(p.rangeToTextRange=function(a){if(a.collapsed)return d(new s(a.startContainer,
a.startOffset),!0);var b=d(new s(a.startContainer,a.startOffset),!0),k=d(new s(a.endContainer,a.endOffset),!1);a=r.getDocument(a.startContainer).body.createTextRange();a.setEndPoint("StartToStart",b);a.setEndPoint("EndToEnd",k);return a});p.prototype.getName=function(){return"WrappedRange"};a.WrappedRange=p;a.createRange=function(b){b=b||document;return new p(a.createNativeRange(b))};a.createRangyRange=function(a){a=a||document;return new t(a)};a.createIframeRange=function(b){return a.createRange(r.getIframeDocument(b))};
a.createIframeRangyRange=function(b){return a.createRangyRange(r.getIframeDocument(b))};a.addCreateMissingNativeApiListener(function(b){b=b.document;"undefined"==typeof b.createRange&&(b.createRange=function(){return a.createRange(this)});b=b=null})});ba.createModule("WrappedSelection",function(a,b){function d(a){return(a||window).getSelection()}function p(a){return(a||window).document.selection}function r(a,b,c){var k=c?"end":"start";c=c?"start":"end";a.anchorNode=b[k+"Container"];a.anchorOffset=
b[k+"Offset"];a.focusNode=b[c+"Container"];a.focusOffset=b[c+"Offset"]}function s(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function t(b){var c;b instanceof y?(c=b._selectionNativeRange,c||(c=a.createNativeRange(u.getDocument(b.startContainer)),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset),b._selectionNativeRange=c,b.attachListener("detach",function(){this._selectionNativeRange=null}))):b instanceof
z?c=b.nativeRange:a.features.implementsDomRange&&b instanceof u.getWindow(b.startContainer).Range&&(c=b);return c}function g(a){var b=a.getNodes(),c;a:if(!b.length||1!=b[0].nodeType)c=!1;else{c=1;for(var k=b.length;c<k;++c)if(!u.isAncestorOf(b[0],b[c])){c=!1;break a}c=!0}if(!c)throw Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return b[0]}function f(a,b){var c=new z(b);a._ranges=[c];r(a,c,!1);a.rangeCount=1;a.isCollapsed=c.collapsed}function n(b){b._ranges.length=
0;if("None"==b.docSelection.type)s(b);else{var c=b.docSelection.createRange();if(c&&"undefined"!=typeof c.text)f(b,c);else{b.rangeCount=c.length;for(var k,e=u.getDocument(c.item(0)),j=0;j<b.rangeCount;++j)k=a.createRange(e),k.selectNode(c.item(j)),b._ranges.push(k);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed;r(b,b._ranges[b.rangeCount-1],!1)}}}function j(a,b){for(var c=a.docSelection.createRange(),k=g(b),f=u.getDocument(c.item(0)),f=u.getBody(f).createControlRange(),e=0,s=c.length;e<s;++e)f.add(c.item(e));
try{f.add(k)}catch(j){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}f.select();n(a)}function e(a,b,c){this.nativeSelection=a;this.docSelection=b;this._ranges=[];this.win=c;this.refresh()}function v(a,b){for(var c=u.getDocument(b[0].startContainer),c=u.getBody(c).createControlRange(),k=0,f;k<rangeCount;++k){f=g(b[k]);try{c.add(f)}catch(e){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)");
}}c.select();n(a)}function x(a,b){if(a.anchorNode&&u.getDocument(a.anchorNode)!==u.getDocument(b))throw new D("WRONG_DOCUMENT_ERR");}function c(a){var b=[],c=new K(a.anchorNode,a.anchorOffset),k=new K(a.focusNode,a.focusOffset),f="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var e=0,s=a.rangeCount;e<s;++e)b[e]=y.inspect(a.getRangeAt(e));return"["+f+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+k.inspect()+"]"}a.requireModules(["DomUtil",
"DomRange","WrappedRange"]);a.config.checkSelectionRanges=!0;var u=a.dom,k=a.util,y=a.DomRange,z=a.WrappedRange,D=a.DOMException,K=u.DomPosition,E,B,J=a.util.isHostMethod(window,"getSelection"),N=a.util.isHostObject(document,"selection"),W=N&&(!J||a.config.preferTextRange);W?(E=p,a.isSelectionValid=function(a){a=(a||window).document;var b=a.selection;return"None"!=b.type||u.getDocument(b.createRange().parentElement())==a}):J?(E=d,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected.");
a.getNativeSelection=E;var J=E(),oa=a.createNativeRange(document),G=u.getBody(document),T=k.areHostObjects(J,k.areHostProperties(J,["anchorOffset","focusOffset"]));a.features.selectionHasAnchorAndFocus=T;var ca=k.isHostMethod(J,"extend");a.features.selectionHasExtend=ca;var U="number"==typeof J.rangeCount;a.features.selectionHasRangeCount=U;var Ba=!1,V=!0;if(k.areHostMethods(J,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof J.rangeCount&&a.features.implementsDomRange){var H=document.createElement("iframe");
G.appendChild(H);V=u.getIframeDocument(H);V.open();V.write("<html><head></head><body>12</body></html>");V.close();var ya=u.getIframeWindow(H).getSelection(),ha=V.documentElement.lastChild.firstChild,ia=V.createRange();ia.setStart(ha,1);ia.collapse(!0);ya.addRange(ia);V=1==ya.rangeCount;ya.removeAllRanges();var ba=ia.cloneRange();ia.setStart(ha,0);ba.setEnd(ha,2);ya.addRange(ia);ya.addRange(ba);Ba=2==ya.rangeCount;ia.detach();ba.detach();G.removeChild(H)}a.features.selectionSupportsMultipleRanges=
Ba;a.features.collapsedNonEditableSelectionsSupported=V;var ma=!1;G&&k.isHostMethod(G,"createControlRange")&&(G=G.createControlRange(),k.areHostProperties(G,["item","add"])&&(ma=!0));a.features.implementsControlRange=ma;B=T?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var X;k.isHostMethod(J,"getRangeAt")?X=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:T&&(X=function(b){var c=
u.getDocument(b.anchorNode),c=a.createRange(c);c.setStart(b.anchorNode,b.anchorOffset);c.setEnd(b.focusNode,b.focusOffset);c.collapsed!==this.isCollapsed&&(c.setStart(b.focusNode,b.focusOffset),c.setEnd(b.anchorNode,b.anchorOffset));return c});a.getSelection=function(a){a=a||window;var b=a._rangySelection,c=E(a),k=N?p(a):null;b?(b.nativeSelection=c,b.docSelection=k,b.refresh(a)):(b=new e(c,k,a),a._rangySelection=b);return b};a.getIframeSelection=function(b){return a.getSelection(u.getIframeWindow(b))};
G=e.prototype;if(!W&&T&&k.areHostMethods(J,["removeAllRanges","addRange"])){G.removeAllRanges=function(){this.nativeSelection.removeAllRanges();s(this)};var O=function(b,c){var k=y.getRangeDocument(c),k=a.createRange(k);k.collapseToPoint(c.endContainer,c.endOffset);b.nativeSelection.addRange(t(k));b.nativeSelection.extend(c.startContainer,c.startOffset);b.refresh()};G.addRange=U?function(b,c){if(ma&&N&&"Control"==this.docSelection.type)j(this,b);else if(c&&ca)O(this,b);else{var k;Ba?k=this.rangeCount:
(this.removeAllRanges(),k=0);this.nativeSelection.addRange(t(b));this.rangeCount=this.nativeSelection.rangeCount;this.rangeCount==k+1?(a.config.checkSelectionRanges&&(k=X(this.nativeSelection,this.rangeCount-1))&&!y.rangesEqual(k,b)&&(b=new z(k)),this._ranges[this.rangeCount-1]=b,r(this,b,da(this.nativeSelection)),this.isCollapsed=B(this)):this.refresh()}}:function(a,b){b&&ca?O(this,a):(this.nativeSelection.addRange(t(a)),this.refresh())};G.setRanges=function(a){if(ma&&1<a.length)v(this,a);else{this.removeAllRanges();
for(var b=0,c=a.length;b<c;++b)this.addRange(a[b])}}}else if(k.isHostMethod(J,"empty")&&k.isHostMethod(oa,"select")&&ma&&W)G.removeAllRanges=function(){try{var a=jQuery.browser.msie&&8>jQuery.browser.version&&"undefined"===typeof document.documentMode;a||this.docSelection.empty();"None"!=this.docSelection.type&&a&&this.docSelection.empty()}catch(b){}s(this)},G.addRange=function(a){if("Control"==this.docSelection.type)j(this,a);else try{z.rangeToTextRange(a).select(),this._ranges[0]=a,this.rangeCount=
1,this.isCollapsed=this._ranges[0].collapsed,r(this,a,!1)}catch(b){}},G.setRanges=function(a){this.removeAllRanges();var b=a.length;1<b?v(this,a):b&&this.addRange(a[0])};else return b.fail("No means of selecting a Range or TextRange was found"),!1;G.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new D("INDEX_SIZE_ERR");return this._ranges[a]};var aa;if(W)aa=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=u.getBody(b.win.document).createTextRange(),c.collapse(!0));
"Control"==b.docSelection.type?n(b):c&&"undefined"!=typeof c.text?f(b,c):s(b)};else if(k.isHostMethod(J,"getRangeAt")&&"number"==typeof J.rangeCount)aa=function(b){if(ma&&N&&"Control"==b.docSelection.type)n(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,k=b.rangeCount;c<k;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));r(b,b._ranges[b.rangeCount-1],da(b.nativeSelection));b.isCollapsed=B(b)}else s(b)};else if(T&&"boolean"==typeof J.isCollapsed&&
"boolean"==typeof oa.collapsed&&a.features.implementsDomRange)aa=function(a){var b;b=a.nativeSelection;b.anchorNode?(b=X(b,0),a._ranges=[b],a.rangeCount=1,b=a.nativeSelection,a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset,a.isCollapsed=B(a)):s(a)};else return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;G.refresh=function(a){var b=a?this._ranges.slice(0):null;aa(this);if(a){a=b.length;if(a!=
this._ranges.length)return!1;for(;a--;)if(!y.rangesEqual(b[a],this._ranges[a]))return!1;return!0}};var A=function(a,b){var c=a.getAllRanges(),k=!1;a.removeAllRanges();for(var f=0,e=c.length;f<e;++f)k||b!==c[f]?a.addRange(c[f]):k=!0;a.rangeCount||s(a)};G.removeRange=ma?function(a){if("Control"==this.docSelection.type){var b=this.docSelection.createRange();a=g(a);for(var c=u.getDocument(b.item(0)),c=u.getBody(c).createControlRange(),k,f=!1,e=0,s=b.length;e<s;++e)k=b.item(e),k!==a||f?c.add(b.item(e)):
f=!0;c.select();n(this)}else A(this,a)}:function(a){A(this,a)};var da;!W&&T&&a.features.implementsDomRange?(da=function(a){var b=!1;a.anchorNode&&(b=1==u.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset));return b},G.isBackwards=function(){return da(this)}):da=G.isBackwards=function(){return!1};G.toString=function(){for(var a=[],b=0,c=this.rangeCount;b<c;++b)a[b]=""+this._ranges[b];return a.join("")};G.collapse=function(b,c){x(this,b);var k=a.createRange(u.getDocument(b));k.collapseToPoint(b,
c);this.removeAllRanges();this.addRange(k);this.isCollapsed=!0};G.collapseToStart=function(){if(this.rangeCount){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new D("INVALID_STATE_ERR");};G.collapseToEnd=function(){if(this.rangeCount){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new D("INVALID_STATE_ERR");};G.selectAllChildren=function(b){x(this,b);var c=a.createRange(u.getDocument(b));c.selectNodeContents(b);this.removeAllRanges();
this.addRange(c)};G.deleteFromDocument=function(){if(ma&&N&&"Control"==this.docSelection.type){for(var a=this.docSelection.createRange(),b;a.length;)b=a.item(0),a.remove(b),b.parentNode.removeChild(b);this.refresh()}else if(this.rangeCount){a=this.getAllRanges();this.removeAllRanges();b=0;for(var c=a.length;b<c;++b)a[b].deleteContents();this.addRange(a[c-1])}};G.getAllRanges=function(){return this._ranges.slice(0)};G.setSingleRange=function(a){this.setRanges([a])};G.containsNode=function(a,b){for(var c=
0,k=this._ranges.length;c<k;++c)if(this._ranges[c].containsNode(a,b))return!0;return!1};G.toHtml=function(){var a="";if(this.rangeCount){for(var a=y.getRangeDocument(this._ranges[0]).createElement("div"),b=0,c=this._ranges.length;b<c;++b)a.appendChild(this._ranges[b].cloneContents());a=a.innerHTML}return a};G.getName=function(){return"WrappedSelection"};G.inspect=function(){return c(this)};G.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};e.inspect=c;a.Selection=
e;a.selectionPrototype=G;a.addCreateMissingNativeApiListener(function(b){"undefined"==typeof b.getSelection&&(b.getSelection=function(){return a.getSelection(this)});b=null})});window.rangy=ba;define("vendor/rangy-core",function(){});define("aloha/rangy-core",["jquery","vendor/rangy-core"],function(){return window.rangy});define("util/class",[],function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){function d(){!a&&this._constructor&&this._constructor.apply(this,
arguments)}var p=this.prototype;a=!0;var r=new this;a=!1;for(var s=0;s<arguments.length;s++){var t=arguments[s],g;for(g in t)r[g]="function"==typeof t[g]&&"function"==typeof p[g]&&b.test(t[g])?function(a,b){return function(){var s=this._super;this._super=p[a];var e=b.apply(this,arguments);this._super=s;return e}}(g,t[g]):t[g]}d.prototype=r;d.constructor=d;d.extend=arguments.callee;return d};return this.Class});window.GENTICS=window.GENTICS||{};window.GENTICS.Utils=window.GENTICS.Utils||{};define("util/lang",
[],function(){});var db=window.GENTICS;db.Utils.applyProperties=function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])};db.Utils.uniqeString4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};db.Utils.guid=function(){var a=db.Utils.uniqeString4;return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};define("aloha/ecma5shims",[],function(){function a(a){var b=null;if(a){do b=a;while(null!=(a=a.parentNode))}return b}function b(a,b){return(a.contains(b)&&16)+(b.contains(a)&&
8)+(0<=a.sourceIndex&&0<=b.sourceIndex?(a.sourceIndex<b.sourceIndex&&4)+(a.sourceIndex>b.sourceIndex&&2):1)}var d,p={bind:function(a){var b=this.obj||this,g=Function.prototype.bind,f=Array.prototype.slice.call(arguments,1);return g?g.apply(b,arguments):function(){return b.apply(a,0===arguments.length?f:f.concat(Array.prototype.slice.call(arguments)))}},trim:function(){var a=this.obj||this,b=String.prototype.trim;return b?b.call(a):a.replace(/^\s+/,"").replace(/\s+$/,"")},indexOf:function(a,b){var g=
this.obj||this,f=Array.prototype.indexOf;if(f)return f.call(g,a,b);void 0===b&&(b=0);0>b&&(b+=g.length);0>b&&(b=0);for(f=g.length;b<f;b++)if(void 0!==g[b]&&g[b]===a)return b;return-1},forEach:function(a,b){var g=this.obj||this,f=Array.prototype.forEach;if(f)return f.call(g,a,b);var n,f=0;for(n=g.length;f<n;f++)void 0!==g[f]&&a.call(b,g[f],f,g)},map:function(a,b,g){var f=this.obj||this,n=Array.prototype.map,j="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,e=
[];if(n)e=n.call(f,a,b);else{var n=[],p,e=0;for(p=f.length;e<p;e++)void 0!==f[e]&&(n[e]=a.call(b,f[e],e,f));e=n}return j?d(e):e},filter:function(a,b,g){var f=this.obj||this,n=Array.prototype.filter,j="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,e=[];if(n)e=n.call(f,a,b);else{var n=[],p,r,e=0;for(r=f.length;e<r;e++)void 0!==f[e]&&a.call(b,p=f[e],e,f)&&n.push(p);e=n}return j?d(e):e},every:function(a,b){var g=this.obj||this,f=Array.prototype.every;if(f)return f.call(g,
a,b);var n,f=0;for(n=g.length;f<n;f++)if(void 0!==g[f]&&!a.call(b,g[f],f,g))return!1;return!0},some:function(a,b){var g=this.obj||this,f=Array.prototype.some;if(f)return f.call(g,a,b);var n,f=0;for(n=g.length;f<n;f++)if(void 0!==g[f]&&a.call(b,g[f],f,g))return!0;return!1},hasAttribute:function(a){var b=this.obj||this;return b.hasAttribute?b.hasAttribute(a):!!b.getAttribute(a)}};d=function(a){var b=function(){};b.prototype=p;b=new b;b.obj=a;return b};for(var r in p)p.hasOwnProperty(r)&&(d[r]=p[r]);
d.Node="undefined"!=typeof window.Node?window.Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32};d.compareDocumentPosition=
function(s,d){if(document.documentElement.compareDocumentPosition)return s.compareDocumentPosition(d);if(!document.documentElement.contains)throw"neither compareDocumentPosition nor contains is supported by this browser.";if(s==d)return 0;if(a(s)!=a(d))return 1;if(null!=s.sourceIndex&&null!=d.sourceIndex)return b(s,d);if(s==document)return 20;if(d==document)return 10;var g=null!=s.sourceIndex?s:s.parentNode.insertBefore(document.createComment(""),s),f=null!=d.sourceIndex?d:d.parentNode.insertBefore(document.createComment(""),
d),n=b(g,f);s!=g&&g.parentNode.removeChild(g);d!=f&&f.parentNode.removeChild(f);return n};d.getComputedStyle=function(a,b){return window.getComputedStyle?window.getComputedStyle(a,b):a.currentStyle?a.currentStyle:null};return d});window.GENTICS=window.GENTICS||{};window.GENTICS.Utils=window.GENTICS.Utils||{};define("util/dom",["jquery","util/class","aloha/ecma5shims"],function(a,b,d){var p=window.GENTICS,r={P:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,LI:!0};b=b.extend({wordRegex:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,
nonWordRegex:/[^\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,
mergeableTags:"b code del em i ins strong sub sup #text".split(" "),nonWordBoundaryTags:"a b code del em i ins span strong sub sup #text".split(" "),nonEmptyTags:["br"],tags:{flow:"a abbr address area article aside audio b bdi bdo blockquote br button canvas cite code command datalist del details dfn div dl em embed fieldset figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr i iframe img input ins kbd keygen label map mark math menu meter nav noscript object ol output p pre progress q ruby s samp script section select small span strong style sub sup svg table textarea time u ul var video wbr #text".split(" "),
phrasing:"a abbr area audio b bdi bdo br button canvas cite code command datalist del dfn em embed i iframe img input ins kbd keygen label map mark math meter noscript object output progress q ruby samp script select small span strong sub sup svg textarea time u var video wbr #text".split(" ")},children:{a:"phrasing",abbr:"phrasing",address:"flow",area:"empty",article:"flow",aside:"flow",audio:"source",b:"phrasing",base:"empty",bdo:"phrasing",blockquote:"phrasing",body:"flow",br:"empty",button:"phrasing",
canvas:"phrasing",caption:"flow",cite:"phrasing",code:"phrasing",col:"empty",colgroup:"col",command:"empty",datalist:["phrasing","option"],dd:"flow",del:"phrasing",div:"flow",details:["summary","flow"],dfn:"flow",dl:["dt","dd"],dt:"phrasing",em:"phrasing",embed:"empty",fieldset:["legend","flow"],figcaption:"flow",figure:["figcaption","flow"],footer:"flow",form:"flow",h1:"phrasing",h2:"phrasing",h3:"phrasing",h4:"phrasing",h5:"phrasing",h6:"phrasing",header:"flow",hgroup:"h1 h2 h3 h4 h5 h6".split(" "),
hr:"empty",i:"phrasing",iframe:"#text",img:"empty",input:"empty",ins:"phrasing",kbd:"phrasing",keygen:"empty",label:"phrasing",legend:"phrasing",li:"flow",link:"empty",map:"area",mark:"phrasing",menu:["li","flow"],meta:"empty",meter:"phrasing",nav:"flow",noscript:"phrasing",object:"param",ol:"li",optgroup:"option",option:"#text",output:"phrasing",p:"phrasing",param:"empty",pre:"phrasing",progress:"phrasing",q:"phrasing",rp:"phrasing",rt:"phrasing",ruby:["phrasing","rt","rp"],s:"phrasing",samp:"pharsing",
script:"#script",section:"flow",select:["option","optgroup"],small:"phrasing",source:"empty",span:"phrasing",strong:"phrasing",style:"phrasing",sub:"phrasing",summary:"phrasing",sup:"phrasing",table:"caption colgroup thead tbody tfoot tr".split(" "),tbody:"tr",td:"flow",textarea:"#text",tfoot:"tr",th:"phrasing",thead:"tr",time:"phrasing",title:"#text",tr:["th","td"],track:"empty",u:"phrasing",ul:"li","var":"phrasing",video:"source",wbr:"empty"},blockLevelElements:"p h1 h2 h3 h4 h5 h6 blockquote div pre".split(" "),
listElements:["li","ol","ul"],split:function(b,d,g){var f=a(b.startContainer),n=b.startOffset,j,e,p,r,c,u,k,y,z;g&&(f=a(b.endContainer),n=b.endOffset);1>d.length&&(d=a(document.body));g=!b.isCollapsed()&&!g;e=f.parents().get();e.unshift(f.get(0));a.each(e,function(a,b){if(d.filter(function(){return this==b}).length)return 0<a&&(j=e.slice(0,a)),!1});if(!j)return!0;j=j.reverse();f=0;for(u=j.length;f<u;++f)if(k=j[f],f===u-1)3===k.nodeType?(c=document.createTextNode(k.data.substring(n,k.data.length)),
k.data=k.data.substring(0,n)):(y=a(k),c=y.contents(),y=y.clone(!1).empty(),c=y.append(c.slice(n,c.length)).get(0)),g&&b.endContainer===k&&(b.endContainer=c,b.endOffset-=n,b.clearCaches()),r?r.prepend(c):a(k).after(c);else{y=a(k).clone(!1).empty();p?r.prepend(y):p=y;for(r=y;;){z=j[f+1].nextSibling;if(!z)break;r.append(z)}if(g&&b.endContainer===k){b.endContainer=y.get(0);k=j[f+1];for(y=0;;){k=k.previousSibling;if(!k)break;y++}b.endOffset-=y;b.clearCaches()}}a(j[0]).after(p);return a([j[0],p?p.get(0):
c])},allowsNesting:function(b,d){if(!b||!b.nodeName||!d||!d.nodeName)return!1;var g=b.nodeName.toLowerCase(),f=d.nodeName.toLowerCase();return!this.children[g]?!1:this.children[g]==f||a.isArray(this.children[g])&&0<=a.inArray(f,this.children[g])||a.isArray(this.tags[this.children[g]])&&0<=a.inArray(f,this.tags[this.children[g]])?!0:!1},addMarkup:function(b,d,g){3===b.startContainer.nodeType&&(0<b.startOffset&&b.startOffset<b.startContainer.data.length)&&this.split(b,a(b.startContainer).parent(),!1);
3===b.endContainer.nodeType&&(0<b.endOffset&&b.endOffset<b.endContainer.data.length)&&this.split(b,a(b.endContainer).parent(),!0);var f=b.getRangeTree();this.recursiveAddMarkup(f,d,b,g);this.doCleanup({merge:!0,removeempty:!0},b)},recursiveAddMarkup:function(b,d,g,f){var n,j;g=0;for(j=b.length;g<j;++g)if("full"==b[g].type&&this.allowsNesting(d.get(0),b[g].domobj)){if((f||b[g].domobj.nodeName!=d.get(0).nodeName)&&(3!==b[g].domobj.nodeType||0!==a.trim(b[g].domobj.data).length))a(b[g].domobj).wrap(d),
!f&&3!==b[g].domobj.nodeType&&(n=new p.Utils.RangeObject,n.startContainer=n.endContainer=b[g].domobj.parentNode,n.startOffset=0,n.endOffset=n.endContainer.childNodes.length,this.removeMarkup(n,d,a(b[g].domobj.parentNode)))}else(f||b[g].domobj&&b[g].domobj.nodeName!==d.get(0).nodeName)&&(b[g].children&&0<b[g].children.length)&&this.recursiveAddMarkup(b[g].children,d)},findHighestElement:function(a,b,g){b=b.toLowerCase();var f,n=a;for(a=g?function(){return g.filter(function(){return n==this}).length}:
function(){return!1};!a()&&n;)n.nodeName.toLowerCase()===b&&(f=n),n=n.parentNode;return f},removeMarkup:function(b,d,g){var f=d.get(0).nodeName,n=this.findHighestElement(b.startContainer,f,g),j=this.findHighestElement(b.endContainer,f,g),e=!1;n&&0<b.startOffset&&(this.split(b,a(n).parent(),!1),e=!0);j&&(3===b.endContainer.nodeType&&b.endOffset<b.endContainer.data.length&&(this.split(b,a(j).parent(),!0),e=!0),1===b.endContainer.nodeType&&b.endOffset<b.endContainer.childNodes.length&&(this.split(b,
a(j).parent(),!0),e=!0));e&&b.correctRange();if(g=(g=this.findHighestElement(b.getCommonAncestorContainer(),f,g))?g.parentNode:b.getCommonAncestorContainer())f=b.getRangeTree(g),this.recursiveRemoveMarkup(f,d),this.doCleanup({merge:!0,removeempty:!0},b,g)},recursiveRemoveMarkup:function(b,d){var g,f,n;g=0;for(f=b.length;g<f;++g)"full"==b[g].type&&b[g].domobj.nodeName==d.get(0).nodeName&&(n=a(b[g].domobj).contents(),0<n.length?n.first().unwrap():a(b[g].domobj).remove()),b[g].children&&this.recursiveRemoveMarkup(b[g].children,
d)},doCleanup:function(b,d,g){var f=this,n,j,e,r,x;"undefined"===typeof b&&(b={});"undefined"===typeof b.merge&&(b.merge=!1);"undefined"===typeof b.removeempty&&(b.removeempty=!1);"undefined"===typeof g&&d&&(g=d.getCommonAncestorContainer());j=n=!1;e=a(g);r=d.startOffset;x=d.endOffset;e.contents().each(function(){var c,g;try{g=this.nodeType,c=f.getIndexInParent(this)}catch(k){return}switch(g){case 1:n&&n.nodeName==this.nodeName?(d.startContainer===e&&r>c&&(d.startOffset-=1,j=!0),d.endContainer===
e&&x>c&&(d.endOffset-=1,j=!0),a(n).append(a(this).contents()),j|=f.doCleanup(b,d,n),a(this).remove()):(j|=f.doCleanup(b,d,this),g=!1,b.removeempty&&(p.Utils.Dom.isBlockLevelElement(this)&&0===this.childNodes.length&&(g=!0),0<=a.inArray(this.nodeName.toLowerCase(),f.mergeableTags)&&(0===a(this).text().length&&0===this.childNodes.length)&&(g=!0)),g?(d.startContainer===this.parentNode&&r>c&&(d.startOffset-=1,j=!0),d.endContainer===this.parentNode&&x>c&&(d.endOffset-=1,j=!0),a(this).remove()):n=0<=a.inArray(this.nodeName.toLowerCase(),
f.mergeableTags)?this:!1);break;case 3:if(n&&3===n.nodeType&&b.merge)d.startContainer===this?(d.startContainer=n,d.startOffset+=n.nodeValue.length,j=!0):d.startContainer===n.parentNode&&d.startOffset===f.getIndexInParent(n)+1&&(d.startContainer=n,d.startOffset=n.nodeValue.length,j=!0),d.endContainer===this?(d.endContainer=n,d.endOffset+=n.nodeValue.length,j=!0):d.endContainer===n.parentNode&&d.endOffset===f.getIndexInParent(n)+1&&(d.endContainer=n,d.endOffset=n.nodeValue.length,j=!0),n.data+=this.data;
else if(!(""===this.nodeValue&&b.removeempty)){n=this;break}d.startContainer===this.parentNode&&d.startOffset>c&&(d.startOffset-=1,j=!0);d.endContainer===this.parentNode&&d.endOffset>c&&(d.endOffset-=1,j=!0);a(this).remove();if(n&&(!n.nextSibling||3!==n.nextSibling.nodeType))for(c=n.data.length-1;0<=c&&1<n.data.length;c--)"\u200b"===n.data.charAt(c)&&(n.deleteData(c,1),d.startContainer===n&&d.startOffset>c&&(d.startOffset--,j=!0),d.endContainer===n&&d.endOffset>c&&(d.endOffset--,j=!0))}});j&&d.clearCaches();
return j},getIndexInParent:function(a){if(!a)return!1;var b=0;for(a=a.previousSibling;a;)b++,a=a.previousSibling;return b},isBlockLevelElement:function(b){return!b?!1:1===b.nodeType&&0<=a.inArray(b.nodeName.toLowerCase(),this.blockLevelElements)?!0:!1},isLineBreakElement:function(a){return!a?!1:1===a.nodeType&&"br"==a.nodeName.toLowerCase()},isListElement:function(b){return!b?!1:1===b.nodeType&&0<=a.inArray(b.nodeName.toLowerCase(),this.listElements)},isSplitObject:function(a){return 1===a.nodeType&&
r.hasOwnProperty(a.nodeName)},searchAdjacentTextNode:function(b,d,g,f){if(!b||1!==b.nodeType||0>d||d>b.childNodes.length)return!1;"undefined"===typeof f&&(f={blocklevel:!0,list:!0,linebreak:!0});"undefined"===typeof f.blocklevel&&(f.blocklevel=!0);"undefined"===typeof f.list&&(f.list=!0);"undefined"===typeof f.linebreak&&(f.linebreak=!0);"undefined"===typeof g&&(g=!0);var n,j=b;g&&0<d&&(n=b.childNodes[d-1]);for(!g&&d<b.childNodes.length&&(n=b.childNodes[d]);j;)if(n){if(3===n.nodeType&&0<a.trim(n.data).length)return n;
if(f.blocklevel&&this.isBlockLevelElement(n)||f.linebreak&&this.isLineBreakElement(n)||f.list&&this.isListElement(n))return!1;3===n.nodeType?n=g?n.previousSibling:n.nextSibling:(j=n,n=g?n.lastChild:n.firstChild)}else{if(f.blocklevel&&this.isBlockLevelElement(j)||f.list&&this.isListElement(j))return!1;n=g?j.previousSibling:j.nextSibling;j=j.parentNode}},insertIntoDOM:function(b,d,g,f,n){var j=d.getContainerParents(g,f),e=this,p;g||(g=a(document.body));0===j.length?p=g.get(0):a.each(j,function(a,c){if(e.allowsNesting(c,
b.get(0)))return p=c,!1});"undefined"===typeof p&&0<g.length&&(p=g.get(0));if(!this.allowsNesting(p,b.get(0))&&!n)return!1;if("undefined"!==typeof p){g=this.split(d,a(p),f);if(!0===g){g=d.startContainer;n=d.startOffset;f&&(g=d.endContainer,n=d.endOffset);if(0===n)return d=a(g).contents(),0<d.length?d.eq(0).before(b):a(g).append(b),!0;a(g).contents().eq(n-1).after(b);return!0}if(g)return g.eq(0).after(b),!0}return!1},removeFromDOM:function(b,d,g){if(g){g=this.getIndexInParent(b);var f=a(b).contents().length,
n=b.parentNode;d.startContainer==n&&d.startOffset>g?d.startOffset+=f-1:d.startContainer==b&&(d.startContainer=n,d.startOffset=g+d.startOffset);d.endContainer==n&&d.endOffset>g?d.endOffset+=f-1:d.endContainer==b&&(d.endContainer=n,d.endOffset=g+d.endOffset);a(b).contents().unwrap();this.doCleanup({merge:!0},d,n)}},removeRange:function(b){if(!b||b.isCollapsed())return!1;3==b.startContainer.nodeType&&(0<b.startOffset&&b.startOffset<b.startContainer.data.length)&&this.split(b,a(b.startContainer).parent(),
!1);3==b.endContainer.nodeType&&(0<b.endOffset&&b.endOffset<b.endContainer.data.length)&&this.split(b,a(b.endContainer).parent(),!0);var d=b.getRangeTree();b.endContainer=b.startContainer;b.endOffset=b.startOffset;this.recursiveRemoveRange(d,b);this.doCleanup({merge:!0},b);b.clearCaches()},recursiveRemoveRange:function(b,d){var g;for(g=0;g<b.length;++g)"full"==b[g].type?(0<a(d.startContainer).parents().andSelf().filter(b[g].domobj).length&&(d.startContainer=d.endContainer=b[g].domobj.parentNode,d.startOffset=
d.endOffset=this.getIndexInParent(b[g].domobj)),a(b[g].domobj).remove()):"partial"==b[g].type&&b[g].children&&this.recursiveRemoveRange(b[g].children,d)},extendToWord:function(a,b){var d=this.searchWordBoundary(a.startContainer,a.startOffset,!0),f=this.searchWordBoundary(a.endContainer,a.endOffset,!1);if(b||!(a.startContainer==d.container&&a.startOffset==d.offset||a.endContainer==f.container&&a.endOffset==f.offset))a.startContainer=d.container,a.startOffset=d.offset,a.endContainer=f.container,a.endOffset=
f.offset,a.correctRange(),a.clearCaches()},isWordBoundaryElement:function(b){return!b||!b.nodeName?!1:-1==a.inArray(b.nodeName.toLowerCase(),this.nonWordBoundaryTags)},searchWordBoundary:function(a,b,d){"undefined"===typeof d&&(d=!0);for(var f=!1,n,j;!f;)if(3===a.nodeType)if(d){for(j=n=a.data.substring(0,b).search(this.nonWordRegex);-1!=j;)n=j,j=a.data.substring(n+1,b).search(this.nonWordRegex),-1!=j&&(j=j+n+1);-1!=n?(b=n+1,f=!0):(b=this.getIndexInParent(a),a=a.parentNode)}else n=a.data.substring(b).search(this.nonWordRegex),
-1!=n?(b+=n,f=!0):(b=this.getIndexInParent(a)+1,a=a.parentNode);else 1===a.nodeType&&(d?0<b?this.isWordBoundaryElement(a.childNodes[b-1])?f=!0:(a=a.childNodes[b-1],b=3===a.nodeType?a.data.length:a.childNodes.length):this.isWordBoundaryElement(a)?f=!0:(b=this.getIndexInParent(a),a=a.parentNode):b<a.childNodes.length?this.isWordBoundaryElement(a.childNodes[b])?f=!0:(a=a.childNodes[b],b=0):this.isWordBoundaryElement(a)?f=!0:(b=this.getIndexInParent(a)+1,a=a.parentNode));if(3!==a.nodeType&&(f=this.searchAdjacentTextNode(a,
b,!d)))a=f,b=d?0:a.data.length;return{container:a,offset:b}},isEmpty:function(b){if(!b)return!0;if(-1!=a.inArray(b.nodeName.toLowerCase(),this.nonEmptyTags))return!1;if(3===b.nodeType)return-1==b.data.search(/\S/);var d,g;d=0;for(g=b.childNodes.length;d<g;++d)if(!this.isEmpty(b.childNodes[d]))return!1;return!0},setCursorAfter:function(a){var b=new p.Utils.RangeObject;this.getIndexInParent(a);var d;3==a.nodeType?(d=a,a=d.nodeValue.length):a.nextSibling&&3==a.nextSibling.nodeType?(d=a.nextSibling,a=
0):(d=a.parentNode,a=this.getIndexInParent(a)+1);b.startContainer=b.endContainer=d;b.startOffset=b.endOffset=a;b.select();return b},selectDomNode:function(a){var b=new p.Utils.RangeObject;b.startContainer=b.endContainer=a.parentNode;b.startOffset=this.getIndexInParent(a);b.endOffset=b.startOffset+1;b.select()},setCursorInto:function(a){var b=new p.Utils.RangeObject;b.startContainer=b.endContainer=a;b.startOffset=b.endOffset=0;b.select()},isEditingHost:function(a){return a&&1==a.nodeType&&("true"==
a.contentEditable||a.parentNode&&9==a.parentNode.nodeType&&"on"==a.parentNode.designMode)},isEditable:function(a){return a&&!this.isEditingHost(a)&&(1!=a.nodeType||"false"!=a.contentEditable)&&(this.isEditingHost(a.parentNode)||this.isEditable(a.parentNode))},getEditingHostOf:function(a){if(this.isEditingHost(a))return a;if(this.isEditable(a)){for(a=a.parentNode;!this.isEditingHost(a);)a=a.parentNode;return a}return null},inSameEditingHost:function(a,b){return this.getEditingHostOf(a)&&this.getEditingHostOf(a)==
this.getEditingHostOf(b)},isBlockNode:function(a){return a&&(a.nodeType==d.Node.ELEMENT_NODE&&-1==d(["inline","inline-block","inline-table","none"]).indexOf(d.getComputedStyle(a).display)||a.nodeType==d.Node.DOCUMENT_NODE||a.nodeType==d.Node.DOCUMENT_FRAGMENT_NODE)},getFirstVisibleChild:function(b,p){if(!b||b.nodeType==d.Node.TEXT_NODE&&this.isEmpty(b)||b.nodeType==d.Node.ELEMENT_NODE&&0==b.offsetHeight&&-1===a.inArray(b.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(b.nodeType==d.Node.TEXT_NODE||
b.nodeType==d.Node.ELEMENT_NODE&&0==b.childNodes.length||!a(b).contentEditable())return p?b:null;var g;for(g=0;g<b.childNodes.length;++g){var f=this.getFirstVisibleChild(b.childNodes[g],!0);if(null!=f)return f}return null},getLastVisibleChild:function(b,p){if(!b||b.nodeType==d.Node.TEXT_NODE&&this.isEmpty(b)||b.nodeType==d.Node.ELEMENT_NODE&&0==b.offsetHeight&&-1===a.inArray(b.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(b.nodeType==d.Node.TEXT_NODE||b.nodeType==d.Node.ELEMENT_NODE&&0==
b.childNodes.length||!a(b).contentEditable())return p?b:null;var g;for(g=b.childNodes.length-1;0<=g;--g){var f=this.getLastVisibleChild(b.childNodes[g],!0);if(null!=f)return f}return null}});p.Utils.Dom=new b;return p.Utils.Dom});define("aloha/pluginmanager",["jquery","util/class"],function(a,b){var d=window.Aloha;return new (b.extend({plugins:{},init:function(a,b){var s=d&&d.settings?d.settings.plugins||{}:{},t,g;for(g in s)if(s.hasOwnProperty(g)&&(t=this.plugins[g]||!1))t.settings=s[g]||{};if(!b.length)for(g in this.plugins)this.plugins.hasOwnProperty(g)&&
b.push(g);for(s=0;s<b.length;++s)if(g=b[s],t=this.plugins[g]||!1)t.settings=t.settings||{},"undefined"===typeof t.settings.enabled&&(t.settings.enabled=!0),t.settings.enabled&&t.checkDependencies()&&t.init();a()},register:function(a){if(!a.name)throw Error("Plugin does not have an name.");if(this.plugins[a.name])throw Error('Already registered the plugin "'+a.name+'"!');this.plugins[a.name]=a},makeClean:function(a){for(var b in this.plugins)this.plugins.hasOwnProperty(b)&&(d.Log.isDebugEnabled()&&
d.Log.debug(this,"Passing contents of HTML Element with id { "+a.attr("id")+" } for cleaning to plugin { "+b+" }"),this.plugins[b].makeClean(a))},toString:function(){return"pluginmanager"}}))});define("aloha/core",["jquery","aloha/pluginmanager"],function(a,b){var d=window.Aloha;a.extend(!0,d,{version:"${version}",editables:[],activeEditable:null,settings:{},defaults:{},ui:{},OSName:"Unknown",stage:"loadingAloha",loadedPlugins:[],_pluginBaseUrlByName:{},init:function(){d.stage="initAloha";d.initAloha(function(){d.stage=
"initPlugins";d.initPlugins(function(){d.stage="initGui";d.initGui(function(){d.stage="alohaReady";d.trigger("aloha-ready")})})})},getLoadedPlugins:function(){return this.loadedPlugins},isPluginLoaded:function(b){var d=!1;a.each(this.loadedPlugins,function(){b.toString()===this.toString()&&(d=!0)});return d},initAloha:function(b){var r=a("html");(a.browser.webkit&&20>parseInt(a.browser.version,10)||a.browser.mozilla&&1.9>parseFloat(a.browser.version)||a.browser.msie&&7>a.browser.version||a.browser.opera&&
11>a.browser.version)&&window.console&&window.console.log&&window.console.log("Your browser is not supported.");a("html").mousedown(function(){d.activeEditable&&(!a(".aloha-dialog").is(":visible")&&!d.eventHandled)&&(d.activeEditable.blur(),d.activeEditable=null)}).mouseup(function(){d.eventHandled=!1});a.browser.webkit?r.addClass("aloha-webkit"):a.browser.opera?r.addClass("aloha-opera"):a.browser.msie?r.addClass("aloha-ie"+parseInt(a.browser.version,10)):a.browser.mozilla&&r.addClass("aloha-mozilla");
d.settings.base=d.getAlohaUrl();d.Log.init();d.settings.errorhandling&&(window.onerror=function(a,b,g){d.Log.error(d,"Error message: "+a+"\nURL: "+b+"\nLine Number: "+g);return!0});-1!=navigator.appVersion.indexOf("Win")&&(d.OSName="Win");-1!=navigator.appVersion.indexOf("Mac")&&(d.OSName="Mac");-1!=navigator.appVersion.indexOf("X11")&&(d.OSName="Unix");-1!=navigator.appVersion.indexOf("Linux")&&(d.OSName="Linux");b()},initPlugins:function(a){b.init(a,this.getLoadedPlugins())},initGui:function(a){var b,
s;d.RepositoryManager.init();b=0;for(s=d.editables.length;b<s;b++)d.editables[b].ready||d.editables[b].init();a()},activateEditable:function(a){var b;for(b=0;b<d.editables.length;b++)d.editables[b]!=a&&d.editables[b].isActive&&d.editables[b].blur();d.activeEditable=a},getActiveEditable:function(){return d.activeEditable},deactivateEditable:function(){"undefined"===typeof d.activeEditable||null===d.activeEditable||(d.activeEditable.blur(),d.activeEditable=null)},getEditableById:function(b){var r,s;
"textarea"===a("#"+b).get(0).nodeName.toLowerCase()&&(b+="-aloha");r=0;for(s=d.editables.length;r<s;r++)if(d.editables[r].getId()==b)return d.editables[r];return null},isEditable:function(a){var b,s;b=0;for(s=d.editables.length;b<s;b++)if(d.editables[b].originalObj.get(0)===a)return!0;return!1},getEditableHost:function(a){var b,s,t=d.editables.length;if(a)return a.parents().andSelf().each(function(){for(b=0;b<t;b++)if(d.editables[b].originalObj.get(0)===this)return s=d.editables[b],!1}),s},log:function(a,
b,s){"undefined"!==typeof d.Log&&d.Log.log(a,b,s)},registerEditable:function(a){d.editables.push(a)},unregisterEditable:function(b){b=a.inArray(b,d.editables);-1!=b&&d.editables.splice(b,1)},toString:function(){return"Aloha"},isModified:function(){var a;for(a=0;a<d.editables.length;a++)if(d.editables[a].isModified&&d.editables[a].isModified())return!0;return!1},getAlohaUrl:function(){return d.settings.baseUrl},getPluginUrl:function(a){var b;a&&(b=d.settings._pluginBaseUrlByName[a])&&(b.match("^(/|http[s]?:).*")||
(b=d.getAlohaUrl()+"/"+b));return b},disableObjectResizing:function(){try{var a;try{a=document.queryCommandSupported("enableObjectResizing")}catch(b){a=!1,d.Log.log("enableObjectResizing is not supported.")}a&&(document.execCommand("enableObjectResizing",!1,!1),d.Log.log("enableObjectResizing disabled."))}catch(s){d.Log.error(s,"Could not disable enableObjectResizing")}}});return d});define("aloha/console",["aloha/core","util/class","jquery"],function(a,b){var d=b.extend({init:function(){if("undefined"===
typeof a.settings.logLevels||!a.settings.logLevels)a.settings.logLevels={error:!0,warn:!0};if("undefined"===typeof a.settings.logHistory||!a.settings.logHistory)a.settings.logHistory={};a.settings.logHistory.maxEntries||(a.settings.logHistory.maxEntries=100);a.settings.logHistory.highWaterMark||(a.settings.logHistory.highWaterMark=90);a.settings.logHistory.levels||(a.settings.logHistory.levels={error:!0,warn:!0});this.flushLogHistory();a.trigger("aloha-logger-ready")},logHistory:[],highWaterMarkReached:!1,
log:function(b,d,s){"undefined"===typeof d&&(s=b);"string"!==typeof d&&(d&&d.toString)&&(d=d.toString());"undefined"===typeof s&&(s=d,d=void 0);if("undefined"===typeof b||!b)b="log";b=b.toLowerCase();if("undefined"!==typeof a.settings.logLevels&&a.settings.logLevels[b]){d=d||"Unkown Aloha Component";this.addToLogHistory({level:b,component:d,message:s,date:new Date});var t=window.console;switch(b){case "error":window.console&&t.error&&(!d&&!s?t.error("Error occured without message and component"):
t.error(d+": "+s));break;case "warn":window.console&&t.warn&&t.warn(d+": "+s);break;case "info":window.console&&t.info&&t.info(d+": "+s);break;case "debug":window.console&&t.log&&t.log(d+" ["+b+"]: "+s);break;default:window.console&&t.log&&t.log(d+" ["+b+"]: "+s)}}},error:function(a,b){this.log("error",a,b)},warn:function(a,b){this.log("warn",a,b)},info:function(a,b){this.log("info",a,b)},debug:function(a,b){this.log("debug",a,b)},deprecated:function(b,d){this.log("warn",b,d);if(a.settings.logLevels.deprecated)throw Error(d);
},isLogLevelEnabled:function(b){return a.settings&&a.settings.logLevels&&a.settings.logLevels[b]},isErrorEnabled:function(){return this.isLogLevelEnabled("error")},isWarnEnabled:function(){return this.isLogLevelEnabled("warn")},isInfoEnabled:function(){return this.isLogLevelEnabled("info")},isDebugEnabled:function(){return this.isLogLevelEnabled("debug")},addToLogHistory:function(b){a.settings.logHistory||this.init();if(!(0>=a.settings.logHistory.maxEntries)&&a.settings.logHistory.levels[b.level]){this.logHistory.push(b);
!this.highWaterMarkReached&&this.logHistory.length>=a.settings.logHistory.maxEntries*a.settings.logHistory.highWaterMark/100&&(a.trigger("aloha-log-full"),this.highWaterMarkReached=!0);for(;this.logHistory.length>a.settings.logHistory.maxEntries;)this.logHistory.shift()}},getLogHistory:function(){return this.logHistory},flushLogHistory:function(){this.logHistory=[];this.highWaterMarkReached=!1}}),d=new d;return a.Log=a.Console=d});window.GENTICS=window.GENTICS||{};window.GENTICS.Utils=window.GENTICS.Utils||
{};define("util/range",["jquery","util/dom","util/class","aloha/console","aloha/rangy-core"],function(a,b,d,p,r){function s(a,b){var d=[],e;for(e=1===a.nodeType?a:a.parentNode;e&&!(e===b||9===e.nodeType);)1===e.nodeType&&d.push(e),e=e.parentNode;return d}var t=window.GENTICS,g=window.Aloha;t.Utils.RangeObject=d.extend({_constructor:function(a){"object"===typeof a?("undefined"!==typeof a.startContainer&&(this.startContainer=a.startContainer),"undefined"!==typeof a.startOffset&&(this.startOffset=a.startOffset),
"undefined"!==typeof a.endContainer&&(this.endContainer=a.endContainer),"undefined"!==typeof a.endOffset&&(this.endOffset=a.endOffset)):!0===a&&this.initializeFromUserSelection()},startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0,deleteContents:function(){b.removeRange(this)},log:function(a){p.deprecated("Utils.RangeObject",'log() is deprecated. use console.log() from module "aloha/console" instead: '+a)},isCollapsed:function(){return!this.endContainer||this.startContainer===
this.endContainer&&this.startOffset===this.endOffset},getCommonAncestorContainer:function(){if(this.commonAncestorContainer)return this.commonAncestorContainer;this.updateCommonAncestorContainer();return this.commonAncestorContainer},getContainerParents:function(b,d){var j=d?this.endContainer:this.startContainer;return!j?!1:a(s(j,b?b[0]:null))},getStartContainerParents:function(a){return this.getContainerParents(a,!1)},getEndContainerParents:function(a){return this.getContainerParents(a,!0)},updateCommonAncestorContainer:function(a){if(a)this.commonAncestorContainer=
a;else{var b=this.getStartContainerParents(),d=this.getEndContainerParents(),e;if(!(0<b.length&&0<d.length))return p.warn("aloha/range","could not find commonAncestorContainer"),!1;for(e=0;e<b.length;e++)if(-1!=d.index(b[e])){this.commonAncestorContainer=b[e];break}}p.debug(a?"commonAncestorContainer was set successfully":"commonAncestorContainer was calculated successfully");return!0},getCollapsedIERange:function(a,b){var d=document.body.createTextRange(),e,g,p;p=this.searchElementToLeft(a,b);p.element?
(e=document.body.createTextRange(),e.moveToElementText(p.element),d.setEndPoint("StartToEnd",e),0!==p.characters?d.moveStart("character",p.characters):(d.moveStart("character",1),d.moveStart("character",-1))):(this.searchElementToRight(a,b),g=3==a.nodeType?a.parentNode:a,e=document.body.createTextRange(),e.moveToElementText(g),d.setEndPoint("StartToStart",e),0!==p.characters&&d.moveStart("character",p.characters));d.collapse();return d},select:function(){var a;if("undefined"===typeof this.startContainer||
"undefined"===typeof this.endContainer)return p.warn("can not select an empty range"),!1;a=r.createRange();a.setStart(this.startContainer,this.startOffset);a.setEnd(this.endContainer,this.endOffset);r.getSelection().setSingleRange(a)},searchElementToLeft:function(a,b){var d,e=0;3===a.nodeType?(e=b,d=a.previousSibling):0<b&&(d=a.childNodes[b-1]);for(;d&&3===d.nodeType;)e+=d.data.length,d=d.previousSibling;return{element:d,characters:e}},searchElementToRight:function(a,b){var d,e=0;3===a.nodeType?(e=
a.data.length-b,d=a.nextSibling):b<a.childNodes.length&&(d=a.childNodes[b]);for(;d&&3===d.nodeType;)e+=d.data.length,d=d.nextSibling;return{element:d,characters:e}},update:function(a){p.debug("now updating rangeObject");this.initializeFromUserSelection(a);this.updateCommonAncestorContainer()},initializeFromUserSelection:function(){var a=r.getSelection();if(!a||!a.rangeCount)return!1;a=a.getRangeAt(0);if(!a)return!1;this.startContainer=a.startContainer;this.endContainer=a.endContainer;this.startOffset=
a.startOffset;this.endOffset=a.endOffset;this.correctRange()},correctRange:function(){var b,d;this.clearCaches();if(this.isCollapsed()){if(1===this.startContainer.nodeType){if(0<this.startOffset&&3===this.startContainer.childNodes[this.startOffset-1].nodeType){this.startContainer=this.startContainer.childNodes[this.startOffset-1];this.startOffset=this.startContainer.data.length;this.endContainer=this.startContainer;this.endOffset=this.startOffset;return}if(0<this.startOffset&&1===this.startContainer.childNodes[this.startOffset-
1].nodeType){if(b=t.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!0)){this.startContainer=this.endContainer=b;this.startOffset=this.endOffset=b.data.length;return}if(b=t.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!1)){this.startContainer=this.endContainer=b;this.startOffset=this.endOffset=0;return}}if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType){this.startContainer=this.startContainer.childNodes[this.startOffset];
this.startOffset=0;this.endContainer=this.startContainer;this.endOffset=0;return}}if(3===this.startContainer.nodeType&&0===this.startOffset&&(b=t.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,t.Utils.Dom.getIndexInParent(this.startContainer),!0))&&0<a(b).closest(g.activeEditable.obj).length)this.startContainer=this.endContainer=b,this.startOffset=this.endOffset=b.data.length}else{if(1===this.startContainer.nodeType)if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType)this.startContainer=
this.startContainer.childNodes[this.startOffset],this.startOffset=0;else if(this.startOffset<this.startContainer.childNodes.length&&1===this.startContainer.childNodes[this.startOffset].nodeType){b=!1;for(d=this.startContainer.childNodes[this.startOffset];!1===b&&d.childNodes&&0<d.childNodes.length;)d=d.childNodes[0],3===d.nodeType&&(b=d);!1!==b&&(this.startContainer=b,this.startOffset=0)}if(3===this.startContainer.nodeType&&this.startOffset===this.startContainer.data.length&&(b=t.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,
t.Utils.Dom.getIndexInParent(this.startContainer)+1,!1)))this.startContainer=b,this.startOffset=0;if(3===this.endContainer.nodeType&&0===this.endOffset)if(this.endContainer.previousSibling&&3===this.endContainer.previousSibling.nodeType)this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length;else if(this.endContainer.previousSibling&&1===this.endContainer.previousSibling.nodeType&&this.endContainer.parentNode){b=this.endContainer.parentNode;for(d=0;d<b.childNodes.length;++d)if(b.childNodes[d]==
this.endContainer){this.endOffset=d;break}this.endContainer=b}1==this.endContainer.nodeType&&0===this.endOffset&&this.endContainer.previousSibling&&(3===this.endContainer.previousSibling.nodeType?(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length):1===this.endContainer.previousSibling.nodeType&&(this.endContainer.previousSibling.childNodes&&0<this.endContainer.previousSibling.childNodes.length)&&(this.endContainer=this.endContainer.previousSibling,this.endOffset=
this.endContainer.childNodes.length));if(1==this.endContainer.nodeType)if(0<this.endOffset&&3===this.endContainer.childNodes[this.endOffset-1].nodeType)this.endContainer=this.endContainer.childNodes[this.endOffset-1],this.endOffset=this.endContainer.data.length;else if(0<this.endOffset&&1===this.endContainer.childNodes[this.endOffset-1].nodeType){b=!1;for(d=this.endContainer.childNodes[this.endOffset-1];!1===b&&d.childNodes&&0<d.childNodes.length;)d=d.childNodes[d.childNodes.length-1],3===d.nodeType&&
(b=d);!1!==b&&(this.endContainer=b,this.endOffset=this.endContainer.data.length)}}},clearCaches:function(){this.commonAncestorContainer=void 0},getRangeTree:function(a){"undefined"===typeof a&&(a=this.getCommonAncestorContainer());this.inselection=!1;return this.recursiveGetRangeTree(a)},recursiveGetRangeTree:function(b){var d=0,j=this,e=[];a(b).contents().each(function(a){var g="none",c=!1,u=!1,k=!1,p=!1,r=!1,s=!1;j.isCollapsed()&&(b===j.startContainer&&j.startOffset===a)&&(e[d]=new t.Utils.RangeTree,
e[d].type="collapsed",e[d].domobj=void 0,j.inselection=!1,k=!0,d++);if(!j.inselection&&!k)switch(this.nodeType){case 3:this===j.startContainer&&(j.inselection=!0,g=0<j.startOffset?"partial":"full",c=j.startOffset,u=this.length);break;case 1:this===j.startContainer&&0===j.startOffset&&(j.inselection=!0,g="full"),b===j.startContainer&&j.startOffset===a&&(j.inselection=!0,g="full")}if(j.inselection&&!k){"none"==g&&(g="full");switch(this.nodeType){case 3:this===j.endContainer&&(j.inselection=!1,j.endOffset<
this.length&&(g="partial"),!1===c&&(c=0),u=j.endOffset);break;case 1:this===j.endContainer&&0===j.endOffset&&(j.inselection=!1)}b===j.endContainer&&j.endOffset<=a&&(j.inselection=!1,g="none")}e[d]=new t.Utils.RangeTree;e[d].domobj=this;e[d].type=g;"partial"==g&&(e[d].startOffset=c,e[d].endOffset=u);e[d].children=j.recursiveGetRangeTree(this);if(0<e[d].children.length){for(a=0;a<e[d].children.length;++a)switch(e[d].children[a].type){case "none":p=!0;break;case "full":s=!0;break;case "partial":r=!0}r||
s&&p?e[d].type="partial":s&&(!r&&!p)&&(e[d].type="full")}d++});this.isCollapsed()&&(b===this.startContainer&&this.startOffset==b.childNodes.length)&&(e[d]=new t.Utils.RangeTree,e[d].type="collapsed",e[d].domobj=void 0);return e},findMarkup:function(a,b,d){d=d?this.endContainer:this.startContainer;var e;b=b?b[0]:null;if(d){b=s(d,b);d=0;for(e=b.length;d<e;d++)if(a.apply(b[d]))return b[d];return!1}},getText:function(){return this.isCollapsed()?"":this.recursiveGetText(this.getRangeTree())},recursiveGetText:function(b){if(!b)return"";
var d=this,j="";a.each(b,function(){"full"==this.type?j+=a(this.domobj).text():"partial"==this.type&&3===this.domobj.nodeType?j+=a(this.domobj).text().substring(this.startOffset,this.endOffset):"partial"==this.type&&(1===this.domobj.nodeType&&this.children)&&(j+=d.recursiveGetText(this.children))});return j}});t.Utils.RangeTree=d.extend({domobj:{},type:null,children:[]});return t.Utils.RangeObject});define("util/arrays",[],function(){function a(a,b){var r,s,t=[];r=0;for(s=a.length;r<s;r++)t.push(b(a[r]));
return t}function b(a,b){return a.map(b)}return{filter:function(a,b){var r,s,t,g=[];r=0;for(s=a.length;r<s;r++)t=a[r],b(t)&&g.push(t);return g},indexOf:function(a,b){var r,s;r=0;for(s=a.length;r<s;r++)if(b===a[r])return r;return-1},reduce:function(a,b,r){var s,t;s=0;for(t=a.length;s<t;s++)b=r(b,a[s]);return b},applyNotNull:function(a,b){return null==a?null:b(a)},sortUnique:function(a,b){var r;if(b){a.sort(b);for(r=1;r<a.length;r++)0===b(a[r],a[r-1])&&a.splice(r--,1)}else{a.sort();for(r=1;r<a.length;r++)a[r]==
a[r-1]&&a.splice(r--,1)}return a},equal:function(a,b,r){var s,t=a.length;if(t!==b.length)return!1;if(r)for(s=0;s<t;s++){if(!r(a[s],b[s]))return!1}else for(s=0;s<t;s++)if(a[s]!==b[s])return!1;return!0},map:Array.prototype.map?b:a}});define("util/strings",["jquery"],function(){var a=/\s+/;return{words:function(b){b=b.split(a);b.length&&""===b[0]&&b.shift();b.length&&""===b[b.length-1]&&b.pop();return b},dashesToCamelCase:function(a){return a.replace(/[\-]([a-z])/gi,function(a,b){return b.toUpperCase()})},
camelCaseToDashes:function(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}}});define("PubSub",[],function(){var a={},b={},d=0;return{sub:function(p,r){if("function"!==typeof r)return-1;var s=a[p];s||(s=a[p]=[]);s.push(++d);b[d]={channel:p,callback:r};return d},unsub:function(d){if(-1===d||!b[d])return!1;var r=b[d]&&a[b[d].channel];delete b[d];for(var s=r.length;s;)if(r[--s]===d)return r.splice(s,1),!0;return!1},pub:function(d,r){var s=d.split("."),t,g=s.length,f="",n=0;for(t=
0;t<g;++t){var f=f+((0===t?"":".")+s[t]),j;var e=f;j=r;if(a[e]){j?"object"!==typeof j&&(j={data:j}):j={};j.channel=e;for(var e=a[e].slice(),v=void 0,v=0;v<e.length;++v)b[e[v]].callback(j);j=v}else j=0;n+=j}return n}}});define("aloha/engine",["aloha/core","aloha/ecma5shims","jquery"],function(a,b,d){function p(a,l){return a.hasAttribute?a.hasAttribute(l):"undefined"!=typeof a.attributes[l]}function r(a){return null===a||!a||a===Pb}function s(a,l){"string"==typeof l&&(l=[l]);"object"==typeof l&&(l=
b(l).map(function(a){return a.toUpperCase()}));return a&&1==a.nodeType&&r(a.namespaceURI)&&("undefined"==typeof l||-1!=b(l).indexOf(a.tagName))}function t(a){return a&&1==a.nodeType&&r(a.namespaceURI)}function g(a,l){return a&&1==a.nodeType&&r(a.namespaceURI)&&l.toUpperCase()===a.nodeName}function f(a,l){var b;if(b=a)if(b=1==a.nodeType)if(b=r(a.namespaceURI))a:{b=a.nodeName;var m,q;b=b.toUpperCase();m=0;for(q=l.length;m<q;m++)if(l[m].toUpperCase()===b){b=!0;break a}b=!1}return b}function n(a){var l,
b=0;if(!a||!a.style)return 0;if("undefined"!==typeof a.style.length)return a.style.length;for(l in a.style)a.style[l]&&(0!==a.style[l]&&"false"!==a.style[l])&&b++;return b}function j(a){if(!a)return null;var l=[],b;for(b=a.length>>>0;b--;)l[b]=a[b];return l}function e(a){for(;a&&!a.nextSibling;)a=a.parentNode;return!a?null:a.nextSibling}function v(a){return a.hasChildNodes()?a.firstChild:e(a)}function x(a){if(a.previousSibling){for(a=a.previousSibling;a.hasChildNodes();)a=a.lastChild;return a}return a.parentNode&&
a.parentNode.nodeType==b.Node.ELEMENT_NODE?a.parentNode:null}function c(a,l){return a&&l&&Boolean(b.compareDocumentPosition(a,l)&b.Node.DOCUMENT_POSITION_CONTAINED_BY)}function u(a,l){return l&&a&&Boolean(b.compareDocumentPosition(l,a)&b.Node.DOCUMENT_POSITION_CONTAINED_BY)}function k(a,l){return Boolean(b.compareDocumentPosition(a,l)&b.Node.DOCUMENT_POSITION_FOLLOWING)}function y(a){for(var l=[];a.parentNode;)l.unshift(a.parentNode),a=a.parentNode;return l}function z(a){for(var l=[],b=e(a);null!=
(a=v(a))&&a!=b;)l.push(a);return l}function D(a){return{"xx-small":1,small:2,medium:3,large:4,"x-large":5,"xx-large":6,"xxx-large":7}[a]}function K(a){return"ltr"==a.dir?"ltr":"rtl"==a.dir?"rtl":!t(a.parentNode)?"ltr":K(a.parentNode)}function E(a){for(var l=0;a.previousSibling;)l++,a=a.previousSibling;return l}function B(a){switch(a.nodeType){case b.Node.PROCESSING_INSTRUCTION_NODE:case b.Node.DOCUMENT_TYPE_NODE:return 0;case b.Node.TEXT_NODE:case b.Node.COMMENT_NODE:return a.length;default:return a.childNodes.length}}
function J(a,l,m,q){if(a==m){if(l==q)return"equal";if(l<q)return"before";if(l>q)return"after"}var c=b.compareDocumentPosition(m,a);if(c&b.Node.DOCUMENT_POSITION_FOLLOWING){q=J(m,q,a,l);if("before"==q)return"after";if("after"==q)return"before"}if(c&b.Node.DOCUMENT_POSITION_CONTAINS){for(;m.parentNode!=a;)m=m.parentNode;if(E(m)<l)return"after"}return"before"}function N(a){for(;null!=a.parentNode;)a=a.parentNode;return a}function W(a,l){return"after"!==J(a,0,l.startContainer,l.startOffset)||"before"!==
J(a,B(a),l.endContainer,l.endOffset)?!1:N(a)==N(l.startContainer)}function oa(a,l){"undefined"==typeof l&&(l=function(){return!0});for(var b=a.startContainer,b=b.hasChildNodes()&&a.startOffset<b.childNodes.length?b.childNodes[a.startOffset]:a.startOffset==B(b)?e(b):v(b),m=a.endContainer,m=m.hasChildNodes()&&a.endOffset<m.childNodes.length?m.childNodes[a.endOffset]:e(m),q=[];k(b,m);)W(b,a)&&l(b)?(q.push(b),b=e(b)):b=v(b);return q}function G(a,l){"undefined"==typeof l&&(l=function(){return!0});for(var b=
a.startContainer,b=b.hasChildNodes()&&a.startOffset<b.childNodes.length?b.childNodes[a.startOffset]:a.startOffset==B(b)?e(b):v(b),m=a.endContainer,m=m.hasChildNodes()&&a.endOffset<m.childNodes.length?m.childNodes[a.endOffset]:e(m),q=[];k(b,m);)W(b,a)&&l(b)&&q.push(b),b=v(b);return q}function T(a){if("currentcolor"==a.toLowerCase())return null;var l=document.createElement("span");document.body.appendChild(l);l.style.color="black";var m=document.createElement("span");l.appendChild(m);m.style.color=
a;a=b.getComputedStyle(m).color;if("rgb(0, 0, 0)"==a&&(l.color="white",a=b.getComputedStyle(m).color,"rgb(0, 0, 0)"!=a))return null;document.body.removeChild(l);return/^rgba\([0-9]+, [0-9]+, [0-9]+, 1\)$/.test(a)?a.replace("rgba","rgb").replace(", 1)",")"):"transparent"==a?"rgba(0, 0, 0, 0)":a}function ca(a){a=a.toLowerCase();if(-1!=b("aliceblue antiquewhite aqua aquamarine azure beige bisque black blanchedalmond blue blueviolet brown burlywood cadetblue chartreuse chocolate coral cornflowerblue cornsilk crimson cyan darkblue darkcyan darkgoldenrod darkgray darkgreen darkgrey darkkhaki darkmagenta darkolivegreen darkorange darkorchid darkred darksalmon darkseagreen darkslateblue darkslategray darkslategrey darkturquoise darkviolet deeppink deepskyblue dimgray dimgrey dodgerblue firebrick floralwhite forestgreen fuchsia gainsboro ghostwhite gold goldenrod gray green greenyellow grey honeydew hotpink indianred indigo ivory khaki lavender lavenderblush lawngreen lemonchiffon lightblue lightcoral lightcyan lightgoldenrodyellow lightgray lightgreen lightgrey lightpink lightsalmon lightseagreen lightskyblue lightslategray lightslategrey lightsteelblue lightyellow lime limegreen linen magenta maroon mediumaquamarine mediumblue mediumorchid mediumpurple mediumseagreen mediumslateblue mediumspringgreen mediumturquoise mediumvioletred midnightblue mintcream mistyrose moccasin navajowhite navy oldlace olive olivedrab orange orangered orchid palegoldenrod palegreen paleturquoise palevioletred papayawhip peachpuff peru pink plum powderblue purple red rosybrown royalblue saddlebrown salmon sandybrown seagreen seashell sienna silver skyblue slateblue slategray slategrey snow springgreen steelblue tan teal thistle tomato turquoise violet wheat white whitesmoke yellow yellowgreen".split(" ")).indexOf(a))return a;
a=T(a);return(a=/^rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)$/.exec(a))?"#"+parseInt(a[1],10).toString(16).replace(/^.$/,"0$&")+parseInt(a[2],10).toString(16).replace(/^.$/,"0$&")+parseInt(a[3],10).toString(16).replace(/^.$/,"0$&"):null}function U(a){a=b(a).trim();if(/^[\-+]?[0-9]+(\.[0-9]+)?([eE][\-+]?[0-9]+)?$/.test(a)){var l;"+"==a[0]?(a=a.slice(1),l="relative-plus"):"-"==a[0]?(a=a.slice(1),l="relative-minus"):l="absolute";a=parseInt(a,10);"relative-plus"==l&&(a+=3);"relative-minus"==l&&(a=3-a);1>a&&
(a=1);7<a&&(a=7);a={1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[a]}return a}function Ba(a){a=U(a);if(-1==d.inArray(a,"xx-small x-small small medium large x-large xx-large xxx-large".split(" "))&&!/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc|px)$/.test(a))return null;var l=document.createElement("font");document.body.appendChild(l);"xxx-large"==a?l.size=7:l.style.fontSize=a;a=parseInt(b.getComputedStyle(l).fontSize,10);document.body.removeChild(l);for(var m=1;7>m;){l=
document.createElement("font");l.size=m;document.body.appendChild(l);var q=parseInt(b.getComputedStyle(l).fontSize,10);l.size=1+m;var c=parseInt(b.getComputedStyle(l).fontSize,10);document.body.removeChild(l);if(a<(c+q)/2)return String(m);m++}return"7"}function V(a,l,b,m){var q;0==mb&&"undefined"!=typeof b?Na=b:0==mb&&(Na=null,Na=b);if(!M.hasOwnProperty(a))throw"NOT_SUPPORTED_ERR";if("enabled"!=l&&!M[a].hasOwnProperty(l))throw"INVALID_ACCESS_ERR";mb++;try{q=m()}catch(c){throw mb--,c;}mb--;return q}
function H(a,l){var b=a=a.toLowerCase();return V(a,"action",l,function(){return-1!=d.inArray(b,"copy cut paste selectall stylewithcss usecss".split(" "))||null!==l})}function ya(a){var l=new window.GENTICS.Utils.RangeObject;l.startContainer=a.startContainer;l.startOffset=a.startOffset;l.endContainer=a.endContainer;l.endOffset=a.endOffset;l.select()}function ha(a,l,b,m){var q=a.toLowerCase(),c=b;if(2>=arguments.length||4<=arguments.length&&"undefined"==typeof c)c="";var k=c;return V(q,"action",m,function(){if(!H(q))return!1;
M[q].action(k,m);ya(m);return!0})}function ia(a,l){var b=a=a.toLowerCase();return V(a,"state",l,function(){return!H(b,l)?!1:"undefined"!=typeof nb(b,l)?nb(b,l):M[b].state(l)})}function da(a,l){a=a.toLowerCase();return V(a,"value",l,function(){return!H(a,l)?"":"fontsize"==a&&void 0!==Ra("fontsize",l)?Ba(Ra("fontsize",l)):"undefined"!=typeof Ra(a,l)?Ra(a,l):M[a].value(l)})}function ma(a){return a&&1==a.nodeType&&r(a.namespaceURI)&&Y[a.nodeName]}function X(a){return a&&(a.nodeType==b.Node.ELEMENT_NODE&&
!Qb[b.getComputedStyle(a).display]||a.nodeType==b.Node.DOCUMENT_NODE||a.nodeType==b.Node.DOCUMENT_FRAGMENT_NODE)}function O(a){return a&&!X(a)}function aa(a){return a&&a.nodeType==b.Node.ELEMENT_NODE&&("true"==a.contentEditable||a.parentNode&&a.parentNode.nodeType==b.Node.DOCUMENT_NODE&&"on"==a.parentNode.designMode)}function A(a){return a&&!aa(a)&&(a.nodeType!=b.Node.ELEMENT_NODE||"false"!=a.contentEditable||d(a).hasClass("aloha-table-wrapper"))&&(aa(a.parentNode)||A(a.parentNode))}function ba(a){var l;
for(l=0;l<a.childNodes.length;l++)if(A(a.childNodes[l])||ba(a.childNodes[l]))return!0;return!1}function Ia(a){if(aa(a))return a;if(A(a)){for(a=a.parentNode;!aa(a);)a=a.parentNode;return a}return null}function ja(a,l){return Ia(a)&&Ia(a)==Ia(l)}function fa(a){if(!g(a,"br"))return!1;for(var l=a.parentNode;"inline"==b.getComputedStyle(l).display;)l=l.parentNode;var m=l.style.height,q=l.style.maxHeight,c=l.style.minHeight;l.style.height="auto";l.style.maxHeight="none";d.browser.msie&&8>d.browser.version||
(l.style.minHeight="0");var k=document.createTextNode("\u200b"),e=l.offsetHeight;if(0==e)throw"isCollapsedLineBreak: original height is zero, bug?";a.parentNode.insertBefore(k,a.nextSibling);a=l.offsetHeight;k.parentNode.removeChild(k);l.style.height=m;l.style.maxHeight=q;d.browser.msie&&8>d.browser.version||(l.style.minHeight=c);return e<a-5}function La(a){if(!g(a,"br")||g(a.parentNode,"li")&&1==a.parentNode.childNodes.length)return!1;for(var l=a.parentNode;"inline"==b.getComputedStyle(l).display;)l=
l.parentNode;var m=l.style.height,q=l.style.maxHeight,c=l.style.minHeight,k=l.contentEditable;l.style.height="auto";l.style.maxHeight="none";l.style.minHeight="0";d.browser.msie&&7>=d.browser.version&&(l.contentEditable="false");var e=l.offsetHeight;if(0==e)throw"isExtraneousLineBreak: original height is zero, bug?";var f=a.style.display;a.style.display="none";var j=l.offsetHeight;l.style.height=m;l.style.maxHeight=q;l.style.minHeight=c;d.browser.msie&&7>=d.browser.version&&(l.contentEditable=k);
a.style.display=f;return e==j}function Ga(a){return a&&a.nodeType==b.Node.TEXT_NODE&&(""==a.data||/^[\t\n\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==b.Node.ELEMENT_NODE&&-1!=d.inArray(b.getComputedStyle(a.parentNode).whiteSpace,["normal","nowrap"])||/^[\t\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==b.Node.ELEMENT_NODE&&"pre-line"==b.getComputedStyle(a.parentNode).whiteSpace||/^[\t\n\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==b.Node.DOCUMENT_FRAGMENT_NODE)}
function sb(a){if(!Ga(a))return!1;if(""==a.data)return!0;var l=a.parentNode;if(!l||b(y(a)).some(function(a){return a.nodeType==b.Node.ELEMENT_NODE&&"none"==b.getComputedStyle(a).display}))return!0;for(;!X(l)&&l.parentNode;)l=l.parentNode;for(var m=a;m!=l;){m=x(m);if(X(m)||g(m,"br"))return!0;if(m.nodeType==b.Node.TEXT_NODE&&!Ga(m)||g(m,"img"))break}m=a;for(a=e(l);m!=a;){m=v(m);if(X(m)||g(m,"br"))return!0;if(m&&m.nodeType==b.Node.TEXT_NODE&&!Ga(m)||g(m,"img"))break}return!1}function ea(a){var l;if(!a||
b(y(a).concat(a)).filter(function(a){return a.nodeType==b.Node.ELEMENT_NODE},!0).some(function(a){return"none"==b.getComputedStyle(a).display}))return!1;if(X(a)||a.nodeType==b.Node.TEXT_NODE&&!sb(a)||g(a,"img")||g(a,"br")&&!La(a))return!0;for(l=0;l<a.childNodes.length;l++)if(ea(a.childNodes[l]))return!0;return!1}function L(a){return a&&!ea(a)}function P(a){var l;if(fa(a)&&!La(a))return!0;if(!O(a)||a.nodeType!=b.Node.ELEMENT_NODE)return!1;var m=!1;for(l=0;l<a.childNodes.length;l++){if(!L(a.childNodes[l])&&
!P(a.childNodes[l]))return!1;P(a.childNodes[l])&&(m=!0)}return m}function C(){var l;if(Na)l=Na;else if(a.getSelection().rangeCount)l=a.getSelection().getRangeAt(0);else return null;if(-1==d.inArray(l.startContainer.nodeType,[b.Node.TEXT_NODE,b.Node.ELEMENT_NODE])||-1==d.inArray(l.endContainer.nodeType,[b.Node.TEXT_NODE,b.Node.ELEMENT_NODE])||!l.startContainer.ownerDocument||!l.endContainer.ownerDocument||!u(l.startContainer,l.startContainer.ownerDocument)||!u(l.endContainer,l.endContainer.ownerDocument))throw"Invalid active range; test bug?";
return l}function R(l,m,q,c){-1==q&&(q=m.childNodes.length);var k=l.parentNode,e=E(l),d,f=[c];for(d=0;d<a.getSelection().rangeCount;d++)f.push(a.getSelection().getRangeAt(d));var j=[];b(f).forEach(function(a){j.push([a.startContainer,a.startOffset]);j.push([a.endContainer,a.endOffset])});b(j).forEach(function(a){a[0]==m&&a[1]>q&&a[1]++;if(a[0]==k&&(a[1]==e||a[1]==e+1))a[0]=m,a[1]+=q-e;a[0]==k&&a[1]>e+1&&a[1]--});m.childNodes.length==q?m.appendChild(l):m.insertBefore(l,m.childNodes[q]);var g=null;
if(j[0][1]>j[0][0].childNodes.length&&j[1][1]>j[1][0].childNodes.length)c.setStart(l,0),c.setEnd(l,0);else{c.setStart(j[0][0],j[0][1]);c.setEnd(j[1][0],j[1][1]);a.getSelection().removeAllRanges();for(d=1;d<f.length;d++)g=a.createRange(),g.setStart(j[2*d][0],j[2*d][1]),g.setEnd(j[2*d+1][0],j[2*d+1][1]),a.getSelection().addRange(g);g&&(c=g)}}function ua(a,l){d.browser.msie&&(7<=d.browser.version&&"undefined"!==typeof a.attributes[d.expando])&&d(a).removeAttr(d.expando);var b=a.attributes,m;for(m=0;m<
b.length;m++){var q=b[m];if("undefined"===typeof q.specified||q.specified)"function"===typeof l.setAttributeNS?l.setAttributeNS(q.namespaceURI,q.name,q.value):l.setAttribute(q.name,q.value)}}function I(a,l,b){if(g(a,l)||!a.parentNode)return a;l=a.ownerDocument.createElement(l);a.parentNode.insertBefore(l,a);for(ua(a,l);a.childNodes.length;)R(a.firstChild,l,l.childNodes.length,b);a.parentNode.removeChild(a);b.startContainer===a&&(b.startContainer=l);b.endContainer===a&&(b.endContainer=l);return l}
function ga(a){var l=a.previousSibling;if(l){for(;l.hasChildNodes();)l=l.lastChild;for(;L(l)&&!La(l)&&l!=a.parentNode;)l=x(l);A(l)&&La(l)&&l.parentNode.removeChild(l)}}function Ua(a){for(var l=a;l.hasChildNodes();)l=l.lastChild;for(;L(l)&&!La(l)&&l!=a;)l=x(l);A(l)&&La(l)&&l.parentNode.removeChild(l)}function xa(a,l,b,m){var q;"undefined"==typeof l&&(l=function(){return!1});"undefined"==typeof b&&(b=function(){return null});if(!a.length||!A(a[0]))return null;O(a[a.length-1])&&(!g(a[a.length-1],"br")&&
g(a[a.length-1].nextSibling,"br"))&&a.push(a[a.length-1].nextSibling);b=A(a[0].previousSibling)&&l(a[0].previousSibling)?a[0].previousSibling:A(a[a.length-1].nextSibling)&&l(a[a.length-1].nextSibling)?a[a.length-1].nextSibling:b();if(!b)return null;if(!b.parentNode){a[0].parentNode.insertBefore(b,a[0]);q=m.startContainer;var c=m.startOffset,e=m.endContainer,d=m.endOffset;q==b.parentNode&&c>=E(b)&&m.setStart(q,c+1);e==b.parentNode&&d>=E(b)&&m.setEnd(e,d+1);Na&&Na!==m&&(q=Na.startContainer,c=Na.startOffset,
e=Na.endContainer,d=Na.endOffset,q==b.parentNode&&c>=E(b)&&Na.setStart(q,c+1),e==b.parentNode&&d>=E(b)&&Na.setEnd(e,d+1))}c=a[0].parentNode;if(k(b,a[0])){!O(b)&&(O(b.lastChild)&&O(a[0])&&!g(b.lastChild,"BR"))&&b.appendChild(b.ownerDocument.createElement("br"));for(q=0;q<a.length;q++)R(a[q],b,-1,m)}else{!O(b)&&(O(b.firstChild)&&O(a[a.length-1])&&!g(a[a.length-1],"BR"))&&b.insertBefore(b.ownerDocument.createElement("br"),b.firstChild);for(q=a.length-1;0<=q;q--)R(a[q],b,0,m)}A(c)&&!c.hasChildNodes()&&
c.parentNode.removeChild(c);if(A(b.nextSibling)&&l(b.nextSibling)){for(!O(b)&&(O(b.lastChild)&&O(b.nextSibling.firstChild)&&!g(b.lastChild,"BR"))&&b.appendChild(b.ownerDocument.createElement("br"));b.nextSibling.hasChildNodes();)R(b.nextSibling.firstChild,b,-1,m);b.parentNode.removeChild(b.nextSibling)}ga(b);Ua(b);return b}function ka(a,l){if((Za[l]||f(l,"colgroup table tbody tfoot thead tr".split(" ")))&&"object"==typeof a&&a.nodeType==b.Node.TEXT_NODE&&!/^[ \t\n\f\r]*$/.test(a.data)||($a[l]||f(l,
["script","style","plaintext","xmp"]))&&("object"!=typeof a||a.nodeType!=b.Node.TEXT_NODE)||"object"==typeof a&&(a.nodeType==b.Node.DOCUMENT_NODE||a.nodeType==b.Node.DOCUMENT_FRAGMENT_NODE||a.nodeType==b.Node.DOCUMENT_TYPE_NODE))return!1;t(a)&&(a=a.tagName.toLowerCase());if("string"!=typeof a)return!0;if(t(l)){for(var m=l;m;){if("a"==a&&g(m,"a")||Y[a.toUpperCase()]&&m&&1==m.nodeType&&r(m.namespaceURI)&&Ta[m.nodeName]||/^h[1-6]$/.test(a)&&t(m)&&/^H[1-6]$/.test(m.tagName))return!1;m=m.parentNode}l=
l.tagName.toLowerCase()}if("object"==typeof l&&(l.nodeType==b.Node.ELEMENT_NODE||l.nodeType==b.Node.DOCUMENT_FRAGMENT_NODE))return!0;if("string"!=typeof l)return!1;switch(l){case "colgroup":return"col"==a;case "table":return-1!=d.inArray(a,"caption col colgroup tbody td tfoot th thead tr".split(" "));case "tbody":case "thead":case "tfoot":return-1!=d.inArray(a,["td","th","tr"]);case "tr":return-1!=d.inArray(a,["td","th"]);case "dl":return-1!=d.inArray(a,["dt","dd"]);case "dir":case "ol":case "ul":return-1!=
d.inArray(a,["dir","li","ol","ul"]);case "hgroup":return/^h[1-6]$/.test(a)}return-1!=d.inArray(a,"body caption col colgroup frame frameset head html tbody td tfoot th thead tr".split(" "))||-1!=d.inArray(a,["dd","dt"])&&"dl"!=l||"li"==a&&"ol"!=l&&"ul"!=l?!1:(m=db[l.toUpperCase()])&&m[a.toUpperCase()]?!1:!0}function pa(a,l){return l.collapsed?!1:W(a,l)||a==l.startContainer&&a.nodeType==b.Node.TEXT_NODE&&B(a)!=l.startOffset||a==l.endContainer&&a.nodeType==b.Node.TEXT_NODE&&0!=l.endOffset||a.hasChildNodes()&&
b(a.childNodes).every(function(a){return pa(a,l)})&&(!u(l.startContainer,a)||l.startContainer.nodeType!=b.Node.TEXT_NODE||0==l.startOffset)&&(!u(l.endContainer,a)||l.endContainer.nodeType!=b.Node.TEXT_NODE||l.endOffset==B(l.endContainer))?!0:!1}function qa(a,l){"undefined"==typeof l&&(l=function(){return!0});for(var b=a.startContainer;pa(b.parentNode,a);)b=b.parentNode;for(var m=e(a.endContainer),q=[];k(b,m);)pa(b,a)&&l(b)&&q.push(b),b=v(b);return q}function la(a){if(!t(a))return!1;if(-1!=d.inArray(a.tagName,
"B EM I S SPAN STRIKE STRONG SUB SUP U".split(" "))&&(0==a.attributes.length||1==a.attributes.length&&p(a,"style")))return!0;if("FONT"==a.tagName||"A"==a.tagName){var l=a.attributes.length;p(a,"style")&&l--;"FONT"==a.tagName&&(p(a,"color")&&l--,p(a,"face")&&l--,p(a,"size")&&l--);"A"==a.tagName&&p(a,"href")&&l--;if(0==l)return!0}return!1}function ta(a){return!t(a)||-1==d.inArray(a.tagName,"A B EM FONT I S SPAN STRIKE STRONG SUB SUP U".split(" "))?!1:0==a.attributes.length?!0:1<a.attributes.length?
!1:p(a,"style")&&0==n(a)||"A"==a.tagName&&p(a,"href")||"FONT"==a.tagName&&(p(a,"color")||p(a,"face")||p(a,"size"))||("B"==a.tagName||"STRONG"==a.tagName)&&p(a,"style")&&1==n(a)&&""!=a.style.fontWeight||("I"==a.tagName||"EM"==a.tagName)&&p(a,"style")&&1==n(a)&&""!=a.style.fontStyle||("A"==a.tagName||"FONT"==a.tagName||"SPAN"==a.tagName)&&p(a,"style")&&1==n(a)&&""==a.style.textDecoration||-1!=d.inArray(a.tagName,"A FONT S SPAN STRIKE U".split(" "))&&p(a,"style")&&1==n(a)&&("line-through"==a.style.textDecoration||
"underline"==a.style.textDecoration||"overline"==a.style.textDecoration||"none"==a.style.textDecoration)?!0:!1}function Ha(a,l,b){return null===l&&null===b||"string"==typeof l&&"string"==typeof b&&l==b&&!M[a].hasOwnProperty("equivalentValues")||"string"==typeof l&&"string"==typeof b&&M[a].hasOwnProperty("equivalentValues")&&M[a].equivalentValues(l,b)?!0:!1}function za(a,l,m){if(Ha(a,l,m))return!0;if("fontsize"!=a||"string"!=typeof l||"string"!=typeof m)return!1;var q=za;if(void 0===q.sizeMap){q.sizeMap=
{};var c=document.createElement("font");document.body.appendChild(c);b("xx-small small medium large x-large xx-large xxx-large".split(" ")).forEach(function(a){c.size=D(a);q.sizeMap[a]=b.getComputedStyle(c).fontSize});document.body.removeChild(c)}return l===q.sizeMap[m]||m===q.sizeMap[l]}function Z(a,l){if(a.nodeType!=b.Node.ELEMENT_NODE&&(!a.parentNode||a.parentNode.nodeType!=b.Node.ELEMENT_NODE))return null;if(a.nodeType!=b.Node.ELEMENT_NODE)return Z(a.parentNode,l);if("createlink"==l||"unlink"==
l){for(;a&&(!t(a)||"A"!=a.tagName||!p(a,"href"));)a=a.parentNode;return!a?null:a.getAttribute("href")}if("backcolor"==l||"hilitecolor"==l){for(;("rgba(0, 0, 0, 0)"==b.getComputedStyle(a).backgroundColor||""===b.getComputedStyle(a).backgroundColor||"transparent"==b.getComputedStyle(a).backgroundColor)&&a.parentNode&&a.parentNode.nodeType==b.Node.ELEMENT_NODE;)a=a.parentNode;return"rgba(0, 0, 0, 0)"==b.getComputedStyle(a).backgroundColor||""===b.getComputedStyle(a).backgroundColor||"transparent"==b.getComputedStyle(a).backgroundColor?
"rgb(255, 255, 255)":b.getComputedStyle(a).backgroundColor}if("subscript"==l||"superscript"==l){for(var m=!1,q=!1;O(a);)b.getComputedStyle(a),g(a,"sub")?m=!0:g(a,"sup")&&(q=!0),a=a.parentNode;return m&&q?"mixed":m?"subscript":q?"superscript":null}if("strikethrough"==l){do{if(-1!=b.getComputedStyle(a).textDecoration.indexOf("line-through"))return"line-through";a=a.parentNode}while(a&&a.nodeType==b.Node.ELEMENT_NODE);return null}if("underline"==l){do{if(-1!=b.getComputedStyle(a).textDecoration.indexOf("underline"))return"underline";
a=a.parentNode}while(a&&a.nodeType==b.Node.ELEMENT_NODE);return null}if(!M[l].hasOwnProperty("relevantCssProperty"))throw"Bug: no relevantCssProperty for "+l+" in getEffectiveCommandValue";return b.getComputedStyle(a)[M[l].relevantCssProperty].toString()}function $(a,l){if(("backcolor"==l||"hilitecolor"==l)&&"inline"!=b.getComputedStyle(a).display)return null;if("createlink"==l||"unlink"==l)return t(a)&&"A"==a.tagName&&p(a,"href")?a.getAttribute("href"):null;if("subscript"==l||"superscript"==l)return g(a,
"sup")?"superscript":g(a,"sub")?"subscript":null;if("strikethrough"==l&&""!=a.style.textDecoration)return-1!=a.style.textDecoration.indexOf("line-through")?"line-through":null;if("strikethrough"==l&&f(a,["S","STRIKE"]))return"line-through";if("underline"==l&&""!=a.style.textDecoration)return-1!=a.style.textDecoration.indexOf("underline")?"underline":null;if("underline"==l&&g(a,"U"))return"underline";var m=M[l].relevantCssProperty;if(null===m)return null;if(""!=a.style[m])return a.style[m];if(r(a.namespaceURI)&&
"FONT"==a.tagName){if("color"==m&&p(a,"color"))return a.color;if("fontFamily"==m&&p(a,"face"))return a.face;if("fontSize"==m&&p(a,"size"))return m=parseInt(a.size,10),1>m&&(m=1),7<m&&(m=7),{1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[m]}return"fontWeight"==m&&("B"==a.tagName||"STRONG"==a.tagName)?"bold":"fontStyle"==m&&("I"==a.tagName||"EM"==a.tagName)?"italic":null}function ra(a,l,b,m){for(var q=a;la(q)&&1==q.childNodes.length&&la(q.firstChild)&&(!ta(q)||!Ha(l,
$(q,l),b));)q=q.firstChild;if(!(q==a||!ta(q)||!Ha(l,$(q,l),b)||!za(l,Z(q,l),b))){for(;q.hasChildNodes();)R(q.firstChild,q.parentNode,E(q),m);a.parentNode.insertBefore(q,a.nextSibling);R(a,q,-1,m)}}function va(a){var l=[];a=d.makeArray(a);var b,m,q,c,k,e;for(b=0;b<a.length;b++){q=a[b];for(m=0;m<bb.length;m++){c=bb[m];k=q;1!=k.nodeType&&(k=k.parentNode);for(e=null;k&&1==k.nodeType&&null===(e=$(k,c));)k=k.parentNode;l.push([q,c,e])}}return l}function Ma(a,l,b){if(!A(a)||null===$(a,l))return[];if(ta(a)){l=
Array.prototype.slice.call(j(a.childNodes));var m;for(m=0;m<l.length;m++)R(l[m],a.parentNode,E(a),b);a.parentNode.removeChild(a);return l}"strikethrough"==l&&-1!=a.style.textDecoration.indexOf("line-through")&&(a.style.textDecoration="line-through"==a.style.textDecoration?"":a.style.textDecoration.replace("line-through",""),""==a.getAttribute("style")&&a.removeAttribute("style"));"underline"==l&&-1!=a.style.textDecoration.indexOf("underline")&&(a.style.textDecoration="underline"==a.style.textDecoration?
"":a.style.textDecoration.replace("underline",""),""==a.getAttribute("style")&&a.removeAttribute("style"));null!==M[l].relevantCssProperty&&(a.style[M[l].relevantCssProperty]="",""==a.getAttribute("style")&&a.removeAttribute("style"));r(a.namespaceURI)&&"FONT"==a.tagName&&("forecolor"==l&&a.removeAttribute("color"),"fontname"==l&&a.removeAttribute("face"),"fontsize"==l&&a.removeAttribute("size"));g(a,"A")&&("createlink"==l||"unlink"==l)&&a.removeAttribute("href");return null===$(a,l)?[]:[I(a,"span",
b)]}function Qa(a,l,m,q){var c=[],k,e;if(a.parentNode&&null!==m&&(ka(a,"span")&&(ra(a.previousSibling,l,m,q),ra(a.nextSibling,l,m,q),xa([a],function(a){return ta(a)&&Ha(l,$(a,l),m)&&za(l,Z(a,l),m)},function(){return null},q)),!za(l,Z(a,l),m)))if(ka(a,"span")){if(!za(l,Z(a,l),m)){c=null;if(!ob){if("bold"==l&&("bold"==m||"700"==m))c=a.ownerDocument.createElement("b");"italic"==l&&"italic"==m&&(c=a.ownerDocument.createElement("i"));"strikethrough"==l&&"line-through"==m&&(c=a.ownerDocument.createElement("s"));
"underline"==l&&"underline"==m&&(c=a.ownerDocument.createElement("u"));"forecolor"==l&&ca(m)&&(c=a.ownerDocument.createElement("span"),d(c).css("color",ca(m)));"fontname"==l&&(c=a.ownerDocument.createElement("font"),c.face=m)}if("createlink"==l||"unlink"==l){c=a.ownerDocument.createElement("a");c.setAttribute("href",m);for(k=a.parentNode;k;)g(k,"A")&&(k=I(k,"span",q)),k=k.parentNode}if("fontsize"==l&&-1!=d.inArray(m,"xx-small small medium large x-large xx-large xxx-large".split(" "))&&(!ob||"xxx-large"==
m))c=a.ownerDocument.createElement("font"),c.size=D(m);if(("subscript"==l||"superscript"==l)&&"subscript"==m)c=a.ownerDocument.createElement("sub");if(("subscript"==l||"superscript"==l)&&"superscript"==m)c=a.ownerDocument.createElement("sup");c||(c=a.ownerDocument.createElement("span"));a.parentNode.insertBefore(c,a);k=M[l].relevantCssProperty;null!==k&&!za(l,Z(c,l),m)&&(c.style[k]=m);"strikethrough"==l&&("line-through"==m&&"line-through"!=Z(c,"strikethrough"))&&(c.style.textDecoration="line-through");
"underline"==l&&("underline"==m&&"underline"!=Z(c,"underline"))&&(c.style.textDecoration="underline");R(a,c,c.childNodes.length,q);if(a.nodeType==b.Node.ELEMENT_NODE&&!Ha(l,Z(a,l),m)){R(a,c.parentNode,E(c),q);c.parentNode.removeChild(c);c=[];for(k=0;k<a.childNodes.length;k++){if(a.childNodes[k].nodeType==b.Node.ELEMENT_NODE&&(e=$(a.childNodes[k],l),null!==e&&!Ha(l,m,e)))continue;c.push(a.childNodes[k])}for(k=0;k<c.length;k++)Qa(c[k],l,m,q)}}}else{for(k=0;k<a.childNodes.length;k++){if(a.childNodes[k].nodeType==
b.Node.ELEMENT_NODE&&(e=$(a.childNodes[k],l),null!==e&&!Ha(l,m,e)))continue;c.push(a.childNodes[k])}for(k=0;k<c.length;k++)Qa(c[k],l,m,q)}}function Ca(a,l,m,q){if(a.parentNode&&a.parentNode.nodeType==b.Node.ELEMENT_NODE&&!za(l,Z(a,l),m)){for(var c=a.parentNode,k=[];A(c)&&c.nodeType==b.Node.ELEMENT_NODE&&!za(l,Z(c,l),m);)k.push(c),c=c.parentNode;if(k.length){var e=$(k[k.length-1],l);if(!(null===e&&e!=m)&&(null===m||za(l,Z(k[k.length-1].parentNode,l),m)))for(;k.length;){c=k.pop();null!==$(c,l)&&(e=
$(c,l));m=Array.prototype.slice.call(j(c.childNodes));null!==$(c,l)&&Ma(c,l,q);for(c=0;c<m.length;c++){var d=m[c];d!=a&&(d.nodeType==b.Node.ELEMENT_NODE&&null!==$(d,l)&&!Ha(l,e,$(d,l))||d!=k[k.length-1]&&Qa(d,l,e,q))}}}}}function Aa(a,l){b(a).forEach(function(a){var m=a[0],q=a[1];a=a[2];var c=m;if(!c||c.nodeType!=b.Node.ELEMENT_NODE)c=c.parentNode;for(;c&&c.nodeType==b.Node.ELEMENT_NODE&&null===$(c,q);)c=c.parentNode;null===a&&c&&c.nodeType==b.Node.ELEMENT_NODE?Ca(m,q,null,l):(c&&c.nodeType==b.Node.ELEMENT_NODE&&
!Ha(q,$(c,q),a)||(!c||c.nodeType!=b.Node.ELEMENT_NODE)&&null!==a)&&Qa(m,q,a,l)})}function na(l,m,q){q=q||C();if(b(qa(q)).filter(function(a){return a.nodeType==b.Node.TEXT_NODE},!0).some(A)){if(A(q.startContainer)&&q.startContainer.nodeType==b.Node.TEXT_NODE&&0!=q.startOffset&&q.startOffset!=B(q.startContainer)){var c=q.startContainer.splitText(q.startOffset),k=a.createRange();if(q.startContainer==q.endContainer){var e=q.endOffset-q.startOffset;k.setEnd(c,e);q.setEnd(c,e)}k.setStart(c,0);a.getSelection().removeAllRanges();
a.getSelection().addRange(k);q.setStart(c,0)}A(q.endContainer)&&(q.endContainer.nodeType==b.Node.TEXT_NODE&&0!=q.endOffset&&q.endOffset!=B(q.endContainer))&&(c=q,k=[c.startContainer,c.startOffset],e=[c.endContainer,c.endOffset],c.endContainer.splitText(c.endOffset),c.setStart(k[0],k[1]),c.setEnd(e[0],e[1]),a.getSelection().removeAllRanges(),a.getSelection().addRange(c));b(qa(C(),function(a){return A(a)&&a.nodeType==b.Node.ELEMENT_NODE})).forEach(function(a){Ma(a,l,q)});b(qa(q,A)).forEach(function(a){Ca(a,
l,m,q);Qa(a,l,m,q)})}else M[l].hasOwnProperty("inlineCommandActivatedValues")&&wb(l,-1!=b(M[l].inlineCommandActivatedValues).indexOf(m),q),"subscript"==l&&xb("superscript",q),"superscript"==l&&xb("subscript",q),null===m?Gb(l,q):M[l].hasOwnProperty("value")&&Ka(l,m,q)}function Fa(a,l){var m;if(a.nodeType===b.Node.TEXT_NODE&&l<a.length)for(m=l;m<a.length;m++)if("\t"!==a.data.charAt(m)&&"\r"!==a.data.charAt(m)&&"\n"!==a.data.charAt(m)||160===a.data.charCodeAt(m))return!1;if(a.nextSibling&&a.nextSibling.className&&
0<=a.nextSibling.className.indexOf("aloha-table-wrapper"))return a.nextSibling;if(a.parentNode&&a.parentNode.nextSibling&&a.parentNode.nextSibling.className&&0<=a.parentNode.nextSibling.className.indexOf("aloha-table-wrapper"))return a.parentNode.nextSibling;if(a.parentNode&&a.parentNode.nextSibling&&Ga(a.parentNode.nextSibling)&&a.parentNode.nextSibling.nextSibling&&a.parentNode.nextSibling.nextSibling.className&&0<=a.parentNode.nextSibling.nextSibling.className.indexOf("aloha-table-wrapper"))return a.parentNode.nextSibling.nextSibling}
function Oa(a,l){return!a.parentNode&&0==l||0<=l-1&&l-1<a.childNodes.length&&ea(a.childNodes[l-1])&&(X(a.childNodes[l-1])||g(a.childNodes[l-1],"br"))}function l(a,l){return!a.parentNode&&l==B(a)||l<a.childNodes.length&&ea(a.childNodes[l])&&X(a.childNodes[l])}function m(a){for(var b=0;!Oa(a,b)&&!l(a,b);){if(0<=b-1&&b-1<a.childNodes.length&&ea(a.childNodes[b-1]))return!1;0==b||!a.hasChildNodes()?(b=E(a),a=a.parentNode):(a=a.childNodes[b-1],b=B(a))}return!0}function q(a){for(var b=B(a);!Oa(a,b)&&!l(a,
b);){if(b<a.childNodes.length&&ea(a.childNodes[b]))return!1;b==B(a)||!a.hasChildNodes()?(b=1+E(a),a=a.parentNode):(a=a.childNodes[b],b=0)}return!0}function wa(a,l){var b,c=a[0].parentNode;if(A(c)&&c.parentNode){-1!=d.inArray(c.firstChild,a)&&ga(c);b=-1!=d.inArray(c.firstChild,a);var k=-1!=d.inArray(c.lastChild,a),e=b&&m(c),f=k&&q(c);if(!b&&k){for(b=a.length-1;0<=b;b--)R(a[b],c.parentNode,1+E(c),l);f&&!q(a[a.length-1])&&a[a.length-1].parentNode.insertBefore(document.createElement("br"),a[a.length-
1].nextSibling);Ua(c)}else{if(!b){b=c.cloneNode(!1);c.removeAttribute("id");for(c.parentNode.insertBefore(b,c);a[0].previousSibling;)R(c.firstChild,b,b.childNodes.length,l)}for(b=0;b<a.length;b++)R(a[b],c.parentNode,E(c),l);e&&!m(a[0])&&a[0].parentNode.insertBefore(document.createElement("br"),a[0]);O(a[a.length-1])&&(!g(a[a.length-1],"br")&&g(c.firstChild,"br")&&!O(c))&&c.removeChild(c.firstChild);c.hasChildNodes()?ga(c):(c.parentNode===l.startContainer&&(c.parentNode===l.endContainer&&l.startContainer===
l.endContainer&&l.startOffset===l.endOffset&&c.parentNode.childNodes.length===l.startOffset)&&(l.startOffset=c.parentNode.childNodes.length-1,l.endOffset=l.startOffset),c.parentNode.removeChild(c),f&&!q(a[a.length-1])&&a[a.length-1].parentNode.insertBefore(document.createElement("br"),a[a.length-1].nextSibling));!a[a.length-1].nextSibling&&a[a.length-1].parentNode&&Ua(a[a.length-1].parentNode)}}}function Q(a){if(!t(a))return!1;if("BLOCKQUOTE"==a.tagName)return!0;if("DIV"!=a.tagName)return!1;if("undefined"!==
typeof a.style.length){var l;for(l=0;l<a.style.length;l++)if(/^(-[a-z]+-)?margin/.test(a.style[l]))return!0}else for(l in a.style)if(/^(-[a-z]+-)?margin/.test(l)&&a.style[l]&&0!==a.style[l])return!0;return!1}function Va(a){if(!Q(a)||"BLOCKQUOTE"!=a.tagName&&"DIV"!=a.tagName)return!1;var l;for(l=0;l<a.attributes.length;l++)if(!r(a.attributes[l].namespaceURI)||-1==d.inArray(a.attributes[l].name,["style","class","dir"]))return!1;if("undefined"!==typeof a.style.length)for(l=0;l<a.style.length;l++){if(!/^(-[a-z]+-)?(margin|border|padding)/.test(a.style[l]))return!1}else for(var b in a.style)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(b)&&
a.style[b]&&0!==a.style[b]&&"false"!==a.style[b])return!1;return!0}function eb(a){return f(a,"address div h1 h2 h3 h4 h5 h6 listing p pre xmp".split(" "))}function F(a){return eb(a)||f(a,["li","dt","dd"])}function S(){return document.createElement("br")}function Ja(a){a&&(g(a.lastChild,"br")||b(a.childNodes).some(ea)||(d.browser.msie?d.browser.msie&&(7>=d.browser.version&&f(a,"p h1 h2 h3 h4 h5 h6 pre blockquote".split(" ")))&&(a.firstChild||a.appendChild(document.createTextNode("\u200b"))):a.appendChild(S())))}
function Sa(a,l){var m;if(A(a))if(b(y(a)).every(function(l){return!ja(a,l)||!ka(a,l)})&&!s(a,fb))if(f(a,["dd","dt"]))xa([a],function(a){return g(a,"dl")&&!a.attributes.length},function(){return document.createElement("dl")},l);else{if(ma(a)){a=I(a,fb,l);Ja(a);Sa(a,l);var q=z(a);for(m=0;m<q.length;m++)Sa(q[m],l)}}else{for(var q=va([a]),c;!ka(a,a.parentNode);){for(m=a.parentNode.childNodes.length-1;0<=m;--m)3==a.parentNode.childNodes[m].nodeType&&0==a.parentNode.childNodes[m].data.length&&(a.parentNode.removeChild(a.parentNode.childNodes[m]),
l.startContainer==a.parentNode&&l.startOffset>m&&l.startOffset--,l.endContainer==a.parentNode&&l.endOffset>m&&l.endOffset--);if(1==a.parentNode.childNodes.length){m=l.startOffset;c=l.endOffset;l.startContainer===a.parentNode&&l.startOffset>E(a)&&(m=l.startOffset+(d(a).contents().length-1));l.endContainer===a.parentNode&&l.endOffset>E(a)&&(c=l.endOffset+(d(a).contents().length-1));d(a).contents().unwrap();l.startOffset=m;l.endOffset=c;break}else if(m=a.parentNode,wa([a],l),m===a.parentNode){m=l.startOffset;
c=l.endOffset;l.startContainer===a.parentNode&&l.startOffset>E(a)&&(m=l.startOffset+(d(a).contents().length-1));l.endContainer===a.parentNode&&l.endOffset>E(a)&&(c=l.endOffset+(d(a).contents().length-1));d(a).contents().unwrap();l.startOffset=m;l.endOffset=c;break}}Aa(q,l)}}function gb(a,l){function m(a){return f(a,["OL","UL"])}if(g(a,"LI")&&A(a)&&A(a.parentNode))for(var q=null;b(a.childNodes).some(m);){var c=a.lastChild;f(c,["OL","UL"])||!q&&c.nodeType==b.Node.TEXT_NODE&&/^[ \t\n\f\r]*$/.test(c.data)?
(q=null,R(c,a.parentNode,1+E(a),l)):(q||(q=a.ownerDocument.createElement("li"),a.parentNode.insertBefore(q,a.nextSibling)),R(c,q,0,l))}}function Rb(a,l){f(a,["OL","UL"])&&A(a)&&d(a).children("ol,ul").each(function(a,b){g(b.previousSibling,"LI")&&R(b,b.previousSibling,b.previousSibling.childNodes.length,l)})}function sa(m){var q=m.startContainer,c=m.startOffset,k=m.endContainer;m=m.endOffset;var e=b(y(q).concat(q)).filter(function(a){return g(a,"li")}).slice(-1);e.length&&(c=E(e[0]),q=e[0].parentNode);
if(!Oa(q,c)){do 0==c?(c=E(q),q=q.parentNode):c--;while(!Oa(q,c)&&!l(q,c))}for(;0==c&&q.parentNode;)c=E(q),q=q.parentNode;e=b(y(k).concat(k)).filter(function(a){return g(a,"li")}).slice(-1);e.length&&(m=1+E(e[0]),k=e[0].parentNode);if(!l(k,m)){do m==B(k)?(m=1+E(k),k=k.parentNode):m++;while(!Oa(k,m)&&!l(k,m))}for(;m==B(k)&&k.parentNode;)m=1+E(k),k=k.parentNode;e=a.createRange();e.setStart(q,c);e.setEnd(k,m);return e}function pb(){var a=sa(C()),l=oa(a,function(a){return A(a)&&!Q(a)&&(f(a,["ol","ul"])||
f(a.parentNode,["ol","ul"])||ka(a,"li"))});if(!l.length)return"none";if(b(l).every(function(a){return g(a,"ol")||g(a.parentNode,"ol")||g(a.parentNode,"li")&&g(a.parentNode.parentNode,"ol")})&&!b(l).some(function(a){return g(a,"ul")||a.querySelector&&a.querySelector("ul")}))return"ol";if(b(l).every(function(a){return g(a,"ul")||g(a.parentNode,"ul")||g(a.parentNode,"li")&&g(a.parentNode.parentNode,"ul")})&&!b(l).some(function(a){return g(a,"ol")||a.querySelector&&a.querySelector("ol")}))return"ul";
a=b(l).some(function(a){return g(a,"ol")||g(a.parentNode,"ol")||a.querySelector&&a.querySelector("ol")||g(a.parentNode,"li")&&g(a.parentNode.parentNode,"ol")});l=b(l).some(function(a){return g(a,"ul")||g(a.parentNode,"ul")||a.querySelector&&a.querySelector("ul")||g(a.parentNode,"li")&&g(a.parentNode.parentNode,"ul")});return a&&l?"mixed":a?"mixed ol":l?"mixed ul":"none"}function Da(a){for(;a&&a.nodeType!=b.Node.ELEMENT_NODE||a.nodeType==b.Node.ELEMENT_NODE&&-1!=d.inArray(b.getComputedStyle(a).display,
["inline","none"]);)a=a.parentNode;if(!a||a.nodeType!=b.Node.ELEMENT_NODE)return"left";var l=b.getComputedStyle(a).textAlign.replace(/^-(moz|webkit)-/,"").replace(/^auto$/,"start");return"start"==l?"ltr"==K(a)?"left":"right":"end"==l?"ltr"==K(a)?"right":"left":-1!=d.inArray(l,["center","justify","left","right"])?l:"left"}function qb(a,l){function m(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE}var q,c,k,e=b(qa(l)).filter(function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE})[0];if(e)for(q=0;q<a.length;q++){c=
a[q][0];k=a[q][1];if("boolean"==typeof k&&ia(c,l)!=k)ha(c);else if("string"==typeof k&&"fontsize"!=c&&!Ha(c,da(c,l),k))ha(c,!1,k,l);else if("string"==typeof k&&"fontsize"==c&&(void 0!==Ra("fontsize",l)&&Ra("fontsize",l)!==k||void 0===Ra("fontsize",l)&&!za(c,Z(e,"fontsize"),k)))ha("fontsize",!1,k,l);else continue;e=b(qa(l)).filter(m)[0]||e}else for(q=0;q<a.length;q++)c=a[q][0],k=a[q][1],"boolean"==typeof k&&wb(c,k,l),"string"==typeof k&&Ka(c,k,l)}function Sb(a,l,b){if(0==a)return"";if(1==a&&!l&&!b)return" ";
if(1==a)return"\u00a0";var m="",q;for(q=l?"\u00a0 ":" \u00a0";3<a;)m+=q,a-=2;return 3==a?m+(!l&&!b?" \u00a0 ":l&&!b?"\u00a0\u00a0 ":!l&&b?" \u00a0\u00a0":l&&b?"\u00a0 \u00a0":"impossible"):m+(!l&&!b?"\u00a0 ":l&&!b?"\u00a0 ":!l&&b?" \u00a0":l&&b?"\u00a0\u00a0":"impossible")}function Wa(a,l){if(A(a)||aa(a)){for(var c=a,k=l;;)if(0<=k-1&&ja(c,c.childNodes[k-1]))c=c.childNodes[k-1],k=B(c);else if(0==k&&!m(c)&&ja(c,c.parentNode))k=E(c),c=c.parentNode;else if(c.nodeType==b.Node.TEXT_NODE&&-1==d.inArray(b.getComputedStyle(c.parentNode).whiteSpace,
["pre","pre-wrap"])&&0!=k&&/[ \xa0]/.test(c.data[k-1]))k--;else break;for(var e=c,f=k,j=0,g=!1;;)if(f<e.childNodes.length&&ja(e,e.childNodes[f]))e=e.childNodes[f],f=0;else if(f==B(e)&&!q(e)&&ja(e,e.parentNode))f=1+E(e),e=e.parentNode;else if(e.nodeType==b.Node.TEXT_NODE&&-1==d.inArray(b.getComputedStyle(e.parentNode).whiteSpace,["pre","pre-wrap"])&&f!=B(e)&&/[ \xa0]/.test(e.data[f]))g&&" "==e.data[f]?e.deleteData(f,1):(g=" "==e.data[f],f++,j++);else break;for(j=Sb(j,0==k&&m(c),f==B(e)&&q(e));"before"==
J(c,k,e,f);)k<c.childNodes.length?(c=c.childNodes[k],k=0):c.nodeType!=b.Node.TEXT_NODE||k==B(c)?(k=1+E(c),c=c.parentNode):(g=j[0],j=j.slice(1),g!=c.data[k]&&(c.insertData(k,g),c.deleteData(k+1,1)),k++)}}function Ea(l,m,q,k,e){var d,F={},Q;3>arguments.length?d=l:(d=a.createRange(),d.setStart(l,m),d.setEnd(q,k));2==arguments.length&&(F=m);5==arguments.length&&(F=e);var n=null!=F.blockMerging?!!F.blockMerging:!0,v=null!=F.stripWrappers?!!F.stripWrappers:!0;if(d){var p=d.startContainer;Q=d.startOffset;
for(var r=d.endContainer,s=d.endOffset,y;p.hasChildNodes();)if(Q==B(p)&&ja(p,p.parentNode)&&O(p))Q=1+E(p),p=p.parentNode;else{if(Q==B(p))break;y=p.childNodes[Q];if(X(y)||y.nodeType==b.Node.ELEMENT_NODE&&!y.hasChildNodes()||y.nodeType!=b.Node.ELEMENT_NODE&&y.nodeType!=b.Node.TEXT_NODE)break;p=y;Q=0}for(;r.hasChildNodes();)if(0==s&&ja(r,r.parentNode)&&O(r))s=E(r),r=r.parentNode;else{if(0==s)break;y=r.childNodes[s-1];if(X(y)||y.nodeType==b.Node.ELEMENT_NODE&&!y.hasChildNodes()||y.nodeType!=b.Node.ELEMENT_NODE&&
y.nodeType!=b.Node.TEXT_NODE)break;r=y;s=B(y)}if("after"!==J(r,s,p,Q))d.setEnd(d.startContainer,d.startOffset);else{r.nodeType==b.Node.TEXT_NODE&&(s==B(r)&&p!=r)&&(s=1+E(r),r=r.parentNode);d.setStart(p,Q);d.setEnd(r,s);for(var S=d.startContainer;ja(S,S.parentNode)&&O(S);)S=S.parentNode;if(!X(S)&&!aa(S)||!ka("span",S)||f(S,["td","th"]))S=null;for(F=d.endContainer;ja(F,F.parentNode)&&O(F);)F=F.parentNode;if(!X(F)&&!aa(F)||!ka("span",F)||f(F,["td","th"]))F=null;var t=d,x=[],z=b(qa(t)).filter(function(a){return A(a)&&
a.nodeType==b.Node.TEXT_NODE})[0];z&&(x.push(["createlink",M.createlink.value(t)]),b("bold italic strikethrough subscript superscript underline".split(" ")).forEach(function(a){-1!=b(M[a].inlineCommandActivatedValues).indexOf(Z(z,a))?x.push([a,!0]):x.push([a,!1])}),b(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(a){x.push([a,M[a].value(t)])}),x.push(["fontsize",Z(z,"fontsize")]));if(p==r&&A(p)&&p.nodeType==b.Node.TEXT_NODE)y=p.parentNode,p.deleteData(Q,s-Q),0<Q&&(" "===p.data.substr(Q-
1,1)&&Q<p.data.length&&" "===p.data.substr(Q,1))&&p.replaceData(Q-1,1,"\u00a0"),Wa(p,Q),d.setStart(d.startContainer,d.startOffset),d.setEnd(d.startContainer,d.startOffset),qb(x,d),(A(y)||aa(y))&&!O(y)&&Ja(y);else{A(p)&&p.nodeType==b.Node.TEXT_NODE&&p.deleteData(Q,B(p)-Q);var Va=oa(d,function(a){return A(a)&&!f(a,"thead tbody tfoot tr th td".split(" "))});for(Q=0;Q<Va.length;Q++){var K=Va[Q];y=K.parentNode;y.removeChild(K);if(v||!c(y,p)&&y!=p)for(;A(y)&&O(y)&&0==B(y);)K=y.parentNode,K.removeChild(y),
y=K;(A(y)||aa(y))&&!O(y)&&Ja(y)}A(r)&&r.nodeType==b.Node.TEXT_NODE&&r.deleteData(0,s);Wa(d.startContainer,d.startOffset);Wa(d.endContainer,d.endOffset);if(!n||!S||!F||!ja(S,F)||S==F)d.setEnd(d.startContainer,d.startOffset);else{1==S.children.length&&P(S.firstChild)&&S.removeChild(S.firstChild);1==F.children.length&&P(F.firstChild)&&F.removeChild(F.firstChild);if(c(S,F)){for(y=F;y.parentNode!=S;)y=y.parentNode;d.setStart(S,E(y));d.setEnd(S,E(y));if(!F.hasChildNodes()){for(;A(F)&&1==F.parentNode.childNodes.length&&
F.parentNode!=S;)y=F,y.removeChild(F),F=y;A(F)&&(!O(F)&&O(F.previousSibling)&&O(F.nextSibling))&&F.parentNode.insertBefore(document.createElement("br"),F.nextSibling);A(F)&&F.parentNode.removeChild(F);qb(x,d);return}if(!O(F.firstChild)){qb(x,d);return}v=[];for(v.push(F.firstChild);!g(v[v.length-1],"br")&&O(v[v.length-1].nextSibling);)v.push(v[v.length-1].nextSibling);for(n=va(v);v[0].parentNode!=S;)wa(v,d);A(v[0].previousSibling)&&g(v[0].previousSibling,"br")&&v[0].parentNode.removeChild(v[0].previousSibling)}else if(u(S,
F)){d.setStart(S,B(S));d.setEnd(S,B(S));for(y=S;y.parentNode!=F;)y=y.parentNode;O(y.nextSibling)&&g(S.lastChild,"br")&&S.removeChild(S.lastChild);F=[];y.nextSibling&&(!g(y.nextSibling,"br")&&!X(y.nextSibling))&&F.push(y.nextSibling);F.length&&(F[F.length-1].nextSibling&&!g(F[F.length-1].nextSibling,"br")&&!X(F[F.length-1].nextSibling))&&F.push(F[F.length-1].nextSibling);n=va(F);b(F).forEach(function(a){R(a,S,-1,d)});g(y.nextSibling,"br")&&y.parentNode.removeChild(y.nextSibling)}else{d.setStart(S,
B(S));d.setEnd(S,B(S));O(F.firstChild)&&g(S.lastChild,"br")&&S.removeChild(S.lastChild);for(n=va([].slice.call(j(F.childNodes)));F.hasChildNodes();)R(F.firstChild,S,-1,d);for(;!F.hasChildNodes();)y=F.parentNode,y.removeChild(F),F=y}Aa(n,d);Ja(S)}qb(x,d)}}}}function rb(a,l){a.hasChildNodes()?wa([].slice.call(j(a.childNodes)),l):a.parentNode.removeChild(a)}function yb(a,l){if(a.length){var b=a[0];if(f(b.parentNode,["OL","UL"])){var m=b.parentNode.tagName;xa(a,function(a){return s(a,m)},function(){return b.ownerDocument.createElement(m)},
l)}else{var q=xa(a,function(a){return Va(a)},function(){return b.ownerDocument.createElement("blockquote")},l);Sa(q,l)}}}function tb(a,l){if(A(a))if(Va(a))rb(a,l);else if(Q(a))a.removeAttribute("class"),a.removeAttribute("dir"),a.style.margin="",a.style.padding="",a.style.border="",""==a.getAttribute("style")&&a.removeAttribute("style"),I(a,"div",l);else{for(var m=a.parentNode,q=[];A(m)&&m.nodeType==b.Node.ELEMENT_NODE&&!Va(m)&&!f(m,["ol","ul"]);)q.push(m),m=m.parentNode;if(!A(m)||!Va(m)){m=a.parentNode;
for(q=[];A(m)&&m.nodeType==b.Node.ELEMENT_NODE&&!Q(m)&&!f(m,["ol","ul"]);)q.push(m),m=m.parentNode}if(f(a,["OL","UL"])&&(!A(m)||!Q(m))){a.removeAttribute("reversed");a.removeAttribute("start");a.removeAttribute("type");q=[].slice.call(j(a.childNodes));if(a.attributes.length&&!f(a.parentNode,["OL","UL"]))I(a,"div",l);else{var c=va([].slice.call(j(a.childNodes)));rb(a,l);Aa(c,l)}for(c=0;c<q.length;c++)Sa(q[c],l)}else if(A(m)&&Q(m)){q.push(m);for(c=m;q.length;){var m=q.pop(),k=a.parentNode==m?a:q[q.length-
1];O(k)&&(!g(k,"BR")&&g(k.nextSibling,"BR"))&&k.parentNode.removeChild(k.nextSibling);var e=[].slice.call(j(m.childNodes),0,E(k)),m=[].slice.call(j(m.childNodes),1+E(k));yb(e,l);yb(m,l)}tb(c,l)}}}function Hb(a,l){function m(){return document.createElement("li")}function q(a){return f(a,["ol","ul"])}function c(a){return function(l){return s(l,a)}}function k(a){return function(){return document.createElement(a)}}function e(a,l,b){return function(){if(!A(l[0].parentNode)||!Va(l[0].parentNode)||!A(l[0].parentNode.previousSibling)||
!s(l[0].parentNode.previousSibling,a))return document.createElement(a);var m=l[0].parentNode.previousSibling;gb(m.lastChild,b);(!A(m.lastChild)||!s(m.lastChild,a))&&m.appendChild(document.createElement(a));return m.lastChild}}var d=pb()==a?"disable":"enable";a=a.toUpperCase();var F="OL"==a?"UL":"OL",n=[],u;for(u=l.endContainer;u!=l.commonAncestorContainer;u=u.parentNode)g(u,"li")&&n.unshift(u);for(u=l.startContainer;u;u=u.parentNode)g(u,"li")&&n.unshift(u);b(n).forEach(function(a){gb(a,l)});n=sa(l);
"enable"==d&&b(G(n,function(a){return A(a)&&s(a,F)})).forEach(function(b){if(A(b.previousSibling)&&s(b.previousSibling,a)||A(b.nextSibling)&&s(b.nextSibling,a)){b=[].slice.call(j(b.childNodes));var m=va(b);wa(b,l);xa(b,function(l){return s(l,a)},function(){return null},l);Aa(m,l)}else I(b,a,l)});n=oa(n,function(a){return A(a)&&!Q(a)&&(f(a,["OL","UL"])||f(a.parentNode,["OL","UL"])||ka(a,"li"))});"enable"==d&&(n=b(n).filter(function(a){return!f(a,["ol","ul"])||f(a.parentNode,["ol","ul"])}));if("disable"==
d)for(;n.length;)if(d=[],d.push(n.shift()),s(d[0],a))tb(d[0],l);else{for(;n.length&&n[0]==d[d.length-1].nextSibling&&!s(n[0],a);)d.push(n.shift());u=va(d);wa(d,l);var v;for(v=0;v<d.length;v++)Sa(d[v],l);Aa(u,l)}else for(;n.length;){for(d=[];!d.length||n.length&&n[0]==d[d.length-1].nextSibling;)if(f(n[0],["p","div"]))d.push(I(n[0],"li",l)),n.shift();else if(f(n[0],["li","ol","ul"]))d.push(n.shift());else{for(u=[];!u.length||n.length&&n[0]==u[u.length-1].nextSibling&&O(n[0])&&O(u[u.length-1])&&!g(u[u.length-
1],"br");)u.push(n.shift());d.push(xa(u,void 0,m,l))}!s(d[0].parentNode,a)&&!b(d).every(q)&&(s(d[0].parentNode,F)?(u=va(d),wa(d,l),xa(d,c(a),k(a),l),Aa(u,l)):Sa(xa(d,c(a),e(a,d,l),l),l))}}function ub(a,l){function m(a){return function(l){return g(l,"div")&&b(l.attributes).every(function(b){return"align"==b.name&&b.value.toLowerCase()==a||"style"==b.name&&1==n(l)&&l.style.textAlign==a})}}function q(a){return function(){var l=document.createElement("div");l.setAttribute("style","text-align: "+a);return l}}
for(var c=sa(l),k=G(c,function(a){return a.nodeType==b.Node.ELEMENT_NODE&&A(a)&&(p(a,"align")||""!=a.style.textAlign||g(a,"center"))}),c=0;c<k.length;c++){var e=k[c];e.removeAttribute("align");e.style.textAlign="";""==e.getAttribute("style")&&e.removeAttribute("style");f(e,["div","span","center"])&&!e.attributes.length&&rb(e,l);g(e,"center")&&e.attributes.length&&I(e,"div",l)}c=sa(Na);k=[];for(k=oa(c,function(l){return A(l)&&ka(l,"div")&&Da(l)!=a});k.length;){c=[];for(c.push(k.shift());k.length&&
k[0]==c[c.length-1].nextSibling;)c.push(k.shift());xa(c,m(a),q(a),l)}}function Ib(a,l){var m;if(a.collapsed){m=a.startOffset;if(l){if(a.startContainer&&a.startContainer.nodeType===b.Node.TEXT_NODE)for(;m<a.startContainer.data.length&&"\u200b"===a.startContainer.data.charAt(m);)m++}else if(a.startContainer&&a.startContainer.nodeType===b.Node.TEXT_NODE)for(;0<m&&"\u200b"===a.startContainer.data.charAt(m-1);)m--;m!==a.startOffset&&(a.setStart(a.startContainer,m),a.setEnd(a.startContainer,m))}}var Pb=
"http://www.w3.org/1999/xhtml",ob=!1,Na=null,M={},nb,wb,xb,Ra,Ka,Gb,mb=0,Y={ADDRESS:!0,ARTICLE:!0,ASIDE:!0,BLOCKQUOTE:!0,CAPTION:!0,CENTER:!0,COL:!0,COLGROUP:!0,DD:!0,DETAILS:!0,DIR:!0,DIV:!0,DL:!0,DT:!0,FIELDSET:!0,FIGCAPTION:!0,FIGURE:!0,FOOTER:!0,FORM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,HEADER:!0,HGROUP:!0,HR:!0,LI:!0,LISTING:!0,MENU:!0,NAV:!0,OL:!0,P:!0,PLAINTEXT:!0,PRE:!0,SECTION:!0,SUMMARY:!0,TABLE:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0,UL:!0,XMP:!0},Qb={inline:!0,"inline-block":!0,
"inline-table":!0,none:!0},ib=function(a){if(!hb||hb.startContainer!=a.startContainer||hb.endContainer!=a.endContainer||hb.startOffset!=a.startOffset||hb.endOffset!=a.endOffset)vb={},Xa={},hb=a.cloneRange()},vb={},Xa={},hb=null;nb=function(a,l){ib(l);return vb[a]};wb=function(a,l,b){ib(b);vb[a]=l};xb=function(a,l){ib(l);delete vb[a]};Ra=function(a,l){ib(l);return Xa[a]};Ka=function(a,l,b){ib(b);Xa[a]=l;"backcolor"==a?Xa.hilitecolor=l:"hilitecolor"==a&&(Xa.backcolor=l)};Gb=function(a,l){ib(l);delete Xa[a];
"backcolor"==a?delete Xa.hilitecolor:"hilitecolor"==a&&delete Xa.backcolor};var Ta={A:!0,ABBR:!0,B:!0,BDI:!0,BDO:!0,CITE:!0,CODE:!0,DFN:!0,EM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,I:!0,KBD:!0,MARK:!0,P:!0,PRE:!0,Q:!0,RP:!0,RT:!0,RUBY:!0,S:!0,SAMP:!0,SMALL:!0,SPAN:!0,STRONG:!0,SUB:!0,SUP:!0,U:!0,VAR:!0,ACRONYM:!0,LISTING:!0,STRIKE:!0,XMP:!0,BIG:!0,BLINK:!0,FONT:!0,MARQUEE:!0,NOBR:!0,TT:!0},Za={colgroup:!0,table:!0,tbody:!0,tfoot:!0,thead:!0,tr:!0},$a={script:!0,style:!0,plaintext:!0,xmp:!0},jb=d.extend({H1:!0,
H2:!0,H3:!0,H4:!0,H5:!0,H6:!0},Y),Pa={CAPTION:!0,COL:!0,COLGROUP:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0},Ya={DD:!0,DT:!0},db={A:d.extend({A:!0},Y),DD:Ya,DT:Ya,LI:{LI:!0},NOBR:d.extend({NOBR:!0},Y),H1:jb,H2:jb,H3:jb,H4:jb,H5:jb,H6:jb,TD:Pa,TH:Pa,ABBR:Y,B:Y,BDI:Y,BDO:Y,CITE:Y,CODE:Y,DFN:Y,EM:Y,I:Y,KBD:Y,MARK:Y,P:Y,PRE:Y,Q:Y,RP:Y,RT:Y,RUBY:Y,S:Y,SAMP:Y,SMALL:Y,SPAN:Y,STRONG:Y,SUB:Y,SUP:Y,U:Y,VAR:Y,ACRONYM:Y,LISTING:Y,STRIKE:Y,XMP:Y,BIG:Y,BLINK:Y,FONT:Y,MARQUEE:Y,TT:Y},bb="subscript bold fontname fontsize forecolor hilitecolor italic strikethrough underline".split(" ");
M.backcolor={action:function(a,l){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||ca(a)||"transparent"==a.toLowerCase())&&na("backcolor",a,l)},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(a,l){return T(a)===T(l)}};M.bold={action:function(a,l){ia("bold",l)?na("bold","normal",l):na("bold","bold",l)},inlineCommandActivatedValues:["bold","600","700","800","900"],relevantCssProperty:"fontWeight",equivalentValues:function(a,
l){return a==l||"bold"==a&&"700"==l||"700"==a&&"bold"==l||"normal"==a&&"400"==l||"400"==a&&"normal"==l}};M.createlink={action:function(a,l){""!==a&&(b(qa(C())).forEach(function(l){b(y(l)).forEach(function(l){A(l)&&(g(l,"a")&&p(l,"href"))&&l.setAttribute("href",a)})}),na("createlink",a,l))},standardInlineValueCommand:!0};M.fontname={action:function(a,l){na("fontname",a,l)},standardInlineValueCommand:!0,relevantCssProperty:"fontFamily"};M.fontsize={action:function(a,l){""!==a&&(a=U(a),(-1!=d.inArray(a,
"xx-small x-small small medium large x-large xx-large xxx-large".split(" "))||/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc)$/.test(a))&&na("fontsize",a,l))},indeterm:function(){return 2<=b(qa(C(),function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE})).map(function(a){return Z(a,"fontsize")},!0).filter(function(a,l,m){return-1==b(m.slice(0,l)).indexOf(a)}).length},value:function(a){var l=qa(a,function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE})[0];void 0===l&&(l=a.startContainer);a=Z(l,"fontsize");return Ba(a)},
relevantCssProperty:"fontSize"};M.forecolor={action:function(a,l){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||ca(a)||"transparent"==a.toLowerCase())&&na("forecolor",a,l)},standardInlineValueCommand:!0,relevantCssProperty:"color",equivalentValues:function(a,l){return T(a)===T(l)}};M.hilitecolor={action:function(a,l){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||ca(a)||"transparent"==a.toLowerCase())&&na("hilitecolor",a,l)},indeterm:function(){return 2<=
b(qa(C(),function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE})).map(function(a){return Z(a,"hilitecolor")},!0).filter(function(a,l,m){return-1==b(m.slice(0,l)).indexOf(a)}).length},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(a,l){return T(a)===T(l)}};M.italic={action:function(a,l){ia("italic",l)?na("italic","normal",l):na("italic","italic",l)},inlineCommandActivatedValues:["italic","oblique"],relevantCssProperty:"fontStyle"};M.removeformat={action:function(a,
l){function m(a){return A(a)&&f(a,"abbr acronym b bdi bdo big blink cite code dfn em font i ins kbd mark nobr q s samp small span strike strong sub sup tt u var".split(" "))}var q,c;q=qa(C(),m);b(q).forEach(function(a){for(;a.hasChildNodes();)R(a.firstChild,a.parentNode,E(a),C());a.parentNode.removeChild(a)});A(C().startContainer)&&(C().startContainer.nodeType==b.Node.TEXT_NODE&&0!=C().startOffset&&C().startOffset!=B(C().startContainer))&&(C().startContainer==C().endContainer?(q=C().endOffset-C().startOffset,
c=C().startContainer.splitText(C().startOffset),C().setStart(c,0),C().setEnd(c,q)):C().setStart(C().startContainer.splitText(C().startOffset),0));A(C().endContainer)&&(C().endContainer.nodeType==b.Node.TEXT_NODE&&0!=C().endOffset&&C().endOffset!=B(C().endContainer))&&(c=[C().startContainer,C().startOffset],q=[C().endContainer,C().endOffset],C().setEnd(document.documentElement,0),q[0].splitText(q[1]),C().setStart(c[0],c[1]),C().setEnd(q[0],q[1]));b(qa(C(),A)).forEach(function(a){for(;m(a.parentNode)&&
ja(a.parentNode,a);)wa([a],C())});b("subscript bold fontname fontsize forecolor hilitecolor italic strikethrough underline".split(" ")).forEach(function(a){na(a,null,l)})}};M.strikethrough={action:function(a,l){ia("strikethrough",l)?na("strikethrough",null,l):na("strikethrough","line-through",l)},inlineCommandActivatedValues:["line-through"]};M.subscript={action:function(a,l){var b=ia("subscript",l);na("subscript",null,l);b||na("subscript","subscript",l)},indeterm:function(){var a=qa(C(),function(a){return A(a)&&
a.nodeType==b.Node.TEXT_NODE});return b(a).some(function(a){return"subscript"==Z(a,"subscript")})&&b(a).some(function(a){return"subscript"!=Z(a,"subscript")})||b(a).some(function(a){return"mixed"==Z(a,"subscript")})},inlineCommandActivatedValues:["subscript"]};M.superscript={action:function(a,l){var b=ia("superscript",l);na("superscript",null,l);b||na("superscript","superscript",l)},indeterm:function(){var a=qa(C(),function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE});return b(a).some(function(a){return"superscript"==
Z(a,"superscript")})&&b(a).some(function(a){return"superscript"!=Z(a,"superscript")})||b(a).some(function(a){return"mixed"==Z(a,"superscript")})},inlineCommandActivatedValues:["superscript"]};M.underline={action:function(a,l){ia("underline",l)?na("underline",null,l):na("underline","underline",l)},inlineCommandActivatedValues:["underline"]};M.unlink={action:function(){var a=C(),l=[],b;for(b=a.startContainer;b;b=b.parentNode)g(b,"A")&&p(b,"href")&&l.unshift(b);for(b=a.startContainer;b!=e(a.endContainer);b=
v(b))g(b,"A")&&(p(b,"href")&&(W(b,a)||c(b,a.endContainer)||b==a.endContainer))&&l.push(b);for(b=0;b<l.length;b++)Ma(l[b],"unlink",a)},standardInlineValueCommand:!0};var fb="p";M["delete"]={action:function(l,m){var q;d.browser.msie&&7>=d.browser.version&&Ib(m,!1);if(m.collapsed){Wa(m.startContainer,m.startOffset);for(var k=m.startContainer,e=m.startOffset,j=q=!1;;)if(0<e&&(q=g(k.childNodes[e-1],"br")||!1,j=g(k.childNodes[e-1],"hr")||!1),0==e&&A(k.previousSibling)&&L(k.previousSibling))k.parentNode.removeChild(k.previousSibling);
else if(0<=e-1&&e-1<k.childNodes.length&&A(k.childNodes[e-1])&&(L(k.childNodes[e-1])||q||j)){if(k.removeChild(k.childNodes[e-1]),e--,q||j){m.setStart(k,e);m.setEnd(k,e);return}}else if(0==e&&O(k)||L(k))e=E(k),k=k.parentNode;else{if(0<=e-1&&e-1<k.childNodes.length&&A(k.childNodes[e-1])&&g(k.childNodes[e-1],"a")){rb(k.childNodes[e-1],m);return}if(0<=e-1&&e-1<k.childNodes.length&&!X(k.childNodes[e-1])&&!f(k.childNodes[e-1],["br","img"]))k=k.childNodes[e-1],e=B(k);else break}a:{q=k;if(q.nodeType===b.Node.TEXT_NODE&&
0<e)for(j=e-1;0<=j;j--)if("\t"!==q.data.charAt(j)&&"\r"!==q.data.charAt(j)&&"\n"!==q.data.charAt(j)||160===q.data.charCodeAt(j)){q=!1;break a}q=q.previousSibling&&q.previousSibling.className&&0<=q.previousSibling.className.indexOf("aloha-table-wrapper")?q.previousSibling:q.parentNode&&q.parentNode.previousSibling&&q.parentNode.previousSibling.className&&0<=q.parentNode.previousSibling.className.indexOf("aloha-table-wrapper")?q.parentNode.previousSibling:q.parentNode&&q.parentNode.previousSibling&&
Ga(q.parentNode.previousSibling)&&q.parentNode.previousSibling.previousSibling&&q.parentNode.previousSibling.previousSibling.className&&0<=q.parentNode.previousSibling.previousSibling.className.indexOf("aloha-table-wrapper")?q.parentNode.previousSibling.previousSibling:!1}if(q)q.parentNode.removeChild(q);else if(k.nodeType==b.Node.TEXT_NODE&&0!=e)m.setStart(k,e-1),m.setEnd(k,e-1),Ea(k,e-1,k,e);else if(k.nodeType==b.Node.TEXT_NODE&&0==e&&d.browser.msie)e=1,m.setStart(k,e),m.setEnd(k,e),m.startOffset=
0,Ea(m);else if(!O(k))if(0<=e-1&&e-1<k.childNodes.length&&f(k.childNodes[e-1],["br","hr","img"]))m.setStart(k,e),m.setEnd(k,e),Ea(m);else if(f(k,["li","dt","dd"])&&k==k.parentNode.firstChild&&0==e){e=[];for(q=k.parentNode;q;q=q.parentNode)g(q,"li")&&e.unshift(q);for(q=0;q<e.length;q++)gb(e[q],m);q=va([k]);wa([k],m);Aa(q,m);f(k,["dd","dt"])&&b(y(k)).every(function(a){return!ja(k,a)||!ka(k,a)})&&(k=I(k,fb,m));Sa(k,m);for(q=0;q<e.length;q++)Rb(e[q].parentNode,m)}else{q=k;for(j=e;;)if(0==j)j=E(q),q=q.parentNode;
else if(0<=j-1&&j-1<q.childNodes.length&&A(q.childNodes[j-1])&&L(q.childNodes[j-1]))q.removeChild(q.childNodes[j-1]),j--;else break;if(0==e&&b(y(k).concat(k)).filter(function(a){return A(a)&&ja(a,k)&&Q(a)}).length){e=a.createRange();e.setStart(k,0);e.setEnd(k,0);e=sa(e);e=oa(e,function(a){return A(a)&&!ba(a)});for(q=0;q<e.length;q++)tb(e[q],m)}else if(!g(q.childNodes[j],"table"))if(0<=j-1&&j-1<q.childNodes.length&&g(q.childNodes[j-1],"table"))m.setStart(q,j-1),m.setEnd(q,j);else if(0==e&&(g(q.childNodes[j-
1],"hr")||g(q.childNodes[j-1],"br")&&(g(q.childNodes[j-1].previousSibling,"br")||!O(q.childNodes[j-1].previousSibling))))m.setStart(k,e),m.setEnd(k,e),Ea(q,j-1,q,j);else{if(f(q.childNodes[j],["li","dt","dd"])&&O(q.childNodes[j].firstChild)&&0!=j){var F=q.childNodes[j-1];O(F.lastChild)&&!g(F.lastChild,"br")&&F.appendChild(document.createElement("br"));O(F.lastChild)&&F.appendChild(document.createElement("br"))}if(f(q.childNodes[j],["li","dt","dd"])&&f(q.childNodes[j-1],["li","dt","dd"]))q=q.childNodes[j-
1],j=B(q),k=q.nextSibling,e=0;else for(;0<=j-1&&j-1<q.childNodes.length;)A(q.childNodes[j-1])&&L(q.childNodes[j-1])?(q.removeChild(q.childNodes[j-1]),j--):(q=q.childNodes[j-1],j=B(q));F=a.createRange();F.setStart(q,j);F.setEnd(k,e);Ea(F);if(!document.body&&!m.startContainer||!(document.body==m.startContainer||c(document.body,m.startContainer)))F.startContainer.hasChildNodes()||F.startContainer.nodeType==b.Node.TEXT_NODE?(m.setStart(F.startContainer,F.startOffset),m.setEnd(F.startContainer,F.startOffset)):
(m.setStart(F.startContainer.parentNode,E(F.startContainer)),m.setEnd(F.startContainer.parentNode,E(F.startContainer)))}}}else Ea(m)}};var kb="address dd div dt h1 h2 h3 h4 h5 h6 p pre".split(" ");M.formatblock={action:function(a){function l(a){return function(l){return A(l)&&ja(l,a)&&s(l,kb)&&!b(z(l)).some(ma)}}function m(a){return function(l){return s(l,a)&&!l.attributes.length}}function q(){return!1}function c(a){return function(){return document.createElement(a)}}var k;/^<.*>$/.test(a)&&(a=a.slice(1,
-1));a=a.toLowerCase();if(-1!=b(kb).indexOf(a)){var e=sa(C()),n=oa(e,function(a){return A(a)&&(eb(a)||ka(a,"p")||f(a,["dd","dt"]))&&!b(z(a)).some(ma)}),Q=va(n);for(k=0;k<n.length;k++)for(var u=n[k];b(y(u)).some(l(u));)wa([u],e);for(Aa(Q,e);n.length;){if(F(n[0]))k=[].slice.call(j(n[0].childNodes)),Q=va(k),rb(n[0],e),Aa(Q,e),n.shift();else{k=[];for(k.push(n.shift());n.length&&n[0]==k[k.length-1].nextSibling&&!F(n[0])&&!g(k[k.length-1],"BR");)k.push(n.shift())}Sa(xa(k,-1==d.inArray(a,["div","p"])?m(a):
q,c(a),e),e)}}},indeterm:function(){var a=sa(C()),a=G(a,function(a){return ea(a)&&A(a)&&!a.hasChildNodes()});if(!a.length)return!1;var l=null,m;for(m=0;m<a.length;m++){for(var q=a[m];A(q.parentNode)&&ja(q,q.parentNode)&&!s(q,kb);)q=q.parentNode;var c="";A(q)&&(s(q,kb)&&!b(z(q)).some(ma))&&(c=q.tagName);if(null===l)l=c;else if(l!=c)return!0}return!1},value:function(){var a=sa(C()),a=G(a,function(a){return ea(a)&&A(a)&&!a.hasChildNodes()});if(!a.length)return"";for(a=a[0];A(a.parentNode)&&ja(a,a.parentNode)&&
!s(a,kb);)a=a.parentNode;return A(a)&&s(a,kb)&&!b(z(a)).some(ma)?a.tagName.toLowerCase():""}};M.forwarddelete={action:function(a,l){d.browser.msie&&7>=d.browser.version&&Ib(l,!0);if(l.collapsed){Wa(l.startContainer,l.startOffset);for(var m=l.startContainer,q=l.startOffset;;)if(q==B(m)&&A(m.nextSibling)&&L(m.nextSibling))m.parentNode.removeChild(m.nextSibling);else if(q<m.childNodes.length&&A(m.childNodes[q])&&L(m.childNodes[q]))m.removeChild(m.childNodes[q]);else if(q<m.childNodes.length&&P(m.childNodes[q]))q++;
else if(q==B(m)&&O(m)||L(m))q=1+E(m),m=m.parentNode;else if(q<m.childNodes.length&&!X(m.childNodes[q])&&!f(m.childNodes[q],["br","img"]))m=m.childNodes[q],q=0;else break;Wa(l.startContainer,l.startOffset);var c=Fa(m,q);if(c)c.parentNode.removeChild(c);else if(m.nodeType==b.Node.TEXT_NODE&&q!=B(m)){l.setStart(m,q);l.setEnd(m,q);for(c=q+1;c!=m.length&&/^[\u0300-\u036f\u0591-\u05bd\u05c1\u05c2]$/.test(m.data[c]);)c++;Ea(m,q,m,c)}else if(!O(m))if(q<m.childNodes.length&&f(m.childNodes[q],["br","hr","img"]))l.setStart(m,
q),l.setEnd(m,q),Ea(m,q,m,q+1);else{for(var k=m,c=q;;)if(c==B(k))c=1+E(k),k=k.parentNode;else if(c<k.childNodes.length&&A(k.childNodes[c])&&L(k.childNodes[c]))k.removeChild(k.childNodes[c]);else break;if(!g(k.childNodes[c-1],"table"))if(g(k.childNodes[c],"table"))l.setStart(k,c),l.setEnd(k,c+1);else if(q==B(m)&&f(k.childNodes[c],["br","hr"]))l.setStart(m,q),l.setEnd(m,q),Ea(k,c,k,c+1);else{for(;c<k.childNodes.length;)A(k.childNodes[c])&&L(k.childNodes[c])?k.removeChild(k.childNodes[c]):(k=k.childNodes[c],
c=0);Ea(m,q,k,c)}}}else Ea(l)}};M.indent={action:function(){var a=[],l;for(l=C().endContainer;l!=C().commonAncestorContainer;l=l.parentNode)g(l,"LI")&&a.unshift(l);for(l=C().startContainer;l!=C().commonAncestorContainer;l=l.parentNode)g(l,"LI")&&a.unshift(l);for(l=C().commonAncestorContainer;l;l=l.parentNode)g(l,"LI")&&a.unshift(l);for(l=0;l<a.length;l++)gb(a[l],C());a=sa(C());l=[];l=oa(a,function(a){return A(a)&&(ka(a,"div")||ka(a,"ol"))});for(l.length&&(g(l[0],"LI")&&f(l[0].parentNode,["OL","UL"])&&
g(l[0].previousSibling,"LI"))&&gb(l[0].previousSibling,a);l.length;){var b=[];for(b.push(l.shift());l.length&&l[0]==b[b.length-1].nextSibling;)b.push(l.shift());yb(b,a)}}};M.inserthorizontalrule={action:function(l,m){for(;0==m.startOffset&&m.startContainer.parentNode;)m.setStart(m.startContainer.parentNode,E(m.startContainer));for(;m.endOffset==B(m.endContainer)&&m.endContainer.parentNode;)m.setEnd(m.endContainer.parentNode,1+E(m.endContainer));Ea(m,{blockMerging:!1});if(A(C().startContainer)||aa(C().startContainer)){C().startContainer.nodeType==
b.Node.TEXT_NODE&&0==C().startOffset&&(C().setStart(C().startContainer.parentNode,E(C().startContainer)),C().collapse(!0));C().startContainer.nodeType==b.Node.TEXT_NODE&&C().startOffset==B(C().startContainer)&&(C().setStart(C().startContainer.parentNode,1+E(C().startContainer)),C().collapse(!0));var q=document.createElement("hr");m.insertNode(q);Sa(q,m);m.setStart(q.parentNode,1+E(q));m.setEnd(q.parentNode,1+E(q));a.getSelection().removeAllRanges();a.getSelection().addRange(m)}}};M.inserthtml={action:function(a,
l){Ea(l);if(A(l.startContainer)||aa(l.startContainer)){var m=l.createContextualFragment(a),q=m.lastChild;if(q){var c=z(m);X(l.startContainer)&&b(l.startContainer.childNodes).filter(function(a,l){return A(a)&&P(a)&&E(a)>=l.startOffset},!0).forEach(function(a){a.parentNode.removeChild(a)});l.insertNode(m);X(l.startContainer)&&Ja(l.startContainer);l.setStart(q.parentNode,1+E(q));l.setEnd(q.parentNode,1+E(q));for(m=0;m<c.length;m++)Sa(c[m],l);ya(l)}}}};M.insertimage={action:function(l){if(""!==l){var b=
C();Ea(b,{stripWrappers:!1});if(A(C().startContainer)||aa(C().startContainer)){X(b.startContainer)&&(1==b.startContainer.childNodes.length&&g(b.startContainer.firstChild,"br")&&0==b.startOffset)&&b.startContainer.removeChild(b.startContainer.firstChild);var m=document.createElement("img");m.setAttribute("src",l);b.insertNode(m);b.setStart(m.parentNode,1+E(m));b.setEnd(m.parentNode,1+E(m));a.getSelection().removeAllRanges();a.getSelection().addRange(b);m.removeAttribute("width");m.removeAttribute("height")}}}};
M.insertlinebreak={action:function(l,m){Ea(m,{stripWrappers:!1});if(A(m.startContainer)||aa(m.startContainer))if(m.startContainer.nodeType!=b.Node.ELEMENT_NODE||ka("br",m.startContainer))if(m.startContainer.nodeType==b.Node.ELEMENT_NODE||ka("br",m.startContainer.parentNode)){var q,c;m.startContainer.nodeType==b.Node.TEXT_NODE&&0==m.startOffset&&(q=m.startContainer.parentNode,c=E(m.startContainer),a.getSelection().collapse(q,c),m.setStart(q,c),m.setEnd(q,c));m.startContainer.nodeType==b.Node.TEXT_NODE&&
m.startOffset==B(m.startContainer)&&(q=m.startContainer.parentNode,c=1+E(m.startContainer),a.getSelection().collapse(q,c),m.setStart(q,c),m.setEnd(q,c));q=document.createElement("br");m.insertNode(q);a.getSelection().collapse(q.parentNode,1+E(q));m.setStart(q.parentNode,1+E(q));m.setEnd(q.parentNode,1+E(q));fa(q)&&(m.insertNode(S()),a.getSelection().collapse(q.parentNode,1+E(q)),m.setStart(q.parentNode,1+E(q)),m.setEnd(q.parentNode,1+E(q)));d.browser.msie&&8>d.browser.version&&q.parentNode.removeAttribute("style")}}};
M.insertorderedlist={action:function(a,l){Hb("ol",l)},indeterm:function(){return/^mixed( ol)?$/.test(pb())},state:function(){return"ol"==pb()}};var lb={LI:!0,DT:!0,DD:!0};M.insertparagraph={action:function(l,m){var q;Ea(m);var c=Ia(m.startContainer);c&&d(c).find("ul,ol,li").each(function(){d(this).contents().each(function(){if(Ga(this)){var a=E(this);m.startContainer===this.parentNode&&m.startOffset>a?m.startOffset--:m.startContainer===this&&(m.startContainer=this.parentNode,m.startOffset=a);m.endContainer===
this.parentNode&&m.endOffset>a?m.endOffset--:m.endContainer===this&&(m.endContainer=this.parentNode,m.endOffset=a);d(this).remove()}})});if(A(m.startContainer)||aa(m.startContainer)){var c=m.startContainer,k=m.startOffset;c.nodeType==b.Node.TEXT_NODE&&(0!=k&&k!=B(c))&&c.splitText(k);c.nodeType==b.Node.TEXT_NODE&&k==B(c)&&(k=1+E(c),c=c.parentNode);if(c.nodeType==b.Node.TEXT_NODE||c.nodeType==b.Node.COMMENT_NODE)k=E(c),c=c.parentNode;a.getSelection().collapse(c,k);m.setStart(c,k);m.setEnd(c,k);for(var e=
c;!F(e)&&A(e.parentNode)&&ja(c,e.parentNode);)e=e.parentNode;if(!A(e)||!ja(e,c)||!F(e)){var j=fb;q=sa(m);q=oa(q,function(a){return ka(a,"p")}).slice(0,1);if(!q.length){if(!ka(j,m.startContainer))return;e=document.createElement(j);m.insertNode(e);e.appendChild(S());a.getSelection().collapse(e,0);m.setStart(e,0);m.setEnd(e,0);return}for(;q[q.length-1].nextSibling&&ka(q[q.length-1].nextSibling,"p");)q.push(q[q.length-1].nextSibling);e=xa(q,function(){return!1},function(){return document.createElement(j)},
m)}var n;if("ADDRESS"==e.tagName||"LISTING"==e.tagName||"PRE"==e.tagName){var Q=document.createElement("br");q=e.offsetHeight;m.insertNode(Q);n=e.offsetHeight;a.getSelection().collapse(c,k+1);m.setStart(c,k+1);m.setEnd(c,k+1);q==n&&!u(v(Q),e)&&(m.insertNode(S()),a.getSelection().collapse(c,k+1),m.setEnd(c,k+1))}else if(lb[e.tagName]&&(!e.hasChildNodes()||1==e.childNodes.length&&g(e.firstChild,"br"))){if(wa([e],m),f(e,["dd","dt"])&&b(y(e)).every(function(a){return!ja(e,a)||!ka(e,a)})&&(e=I(e,fb,m)),
Sa(e,m),g(e,"li")&&g(e.nextSibling,"li")&&f(e.nextSibling.firstChild,["ol","ul"])){c=e.nextSibling;k=e.nextSibling.childNodes.length;for(q=0;q<k;q++)e.appendChild(c.childNodes[0]);c.parentNode.removeChild(c)}}else{k=a.createRange();k.setStart(m.startContainer,m.startOffset);for(k.setEnd(e,B(e));0==k.startOffset&&k.startContainer!=e;)k.setStart(k.startContainer.parentNode,E(k.startContainer));for(;k.startOffset==B(k.startContainer)&&k.startContainer!=e;)k.setStart(k.startContainer.parentNode,1+E(k.startContainer));
c=oa(k);c=!c.length||1==c.length&&g(c[0],"br");c=/^H[1-6]$/.test(e.tagName)&&c?fb:"DT"==e.tagName&&c?"dd":"DD"==e.tagName&&c?"dt":e.tagName.toLowerCase();c=document.createElement(c);ua(e,c);c.removeAttribute("id");e.parentNode.insertBefore(c,e.nextSibling);n=G(k);k=k.extractContents();Q=z(k);for(q=0;q<Q.length;q++)Q[q].nodeType==b.Node.ELEMENT_NODE&&-1==b(n).indexOf(Q[q])&&Q[q].removeAttribute("id");q=[];if(n=k.firstChild){do Ga(n)||q.push(n);while(null!=(n=n.nextSibling))}g(c,"li")&&(q.length&&f(q[0],
["ul","ol"]))&&(q=c.offsetHeight,Q=S(),c.appendChild(Q),n=c.offsetHeight,q!==n&&c.removeChild(Q));c.appendChild(k);Ja(e);Ja(c);a.getSelection().collapse(c,0);m.setStart(c,0);m.setEnd(c,0)}}}};M.inserttext={action:function(l,m){var q;Ea(m,{stripWrappers:!1});if(A(m.startContainer)||aa(m.startContainer))if(1<l.length)for(q=0;q<l.length;q++)M.inserttext.action(l[q],m);else if(""!=l)if("\n"==l)M.insertparagraph.action("",m);else{q=m.startContainer;var c=m.startOffset;0<=c-1&&(c-1<q.childNodes.length&&
q.childNodes[c-1].nodeType==b.Node.TEXT_NODE)&&(q=q.childNodes[c-1],c=B(q));0<=c&&(c<q.childNodes.length&&q.childNodes[c].nodeType==b.Node.TEXT_NODE)&&(q=q.childNodes[c],c=0);var k=q.nodeType==b.Node.ELEMENT_NODE?q:q.parentNode;" "==l&&(k.nodeType==b.Node.ELEMENT_NODE&&-1==d.inArray(b.getComputedStyle(k).whiteSpace,["pre","pre-wrap"]))&&(l="\u00a0");var e=[];void 0!==Ra("createlink",m)&&e.push(["createlink",Ra("createlink",m)]);b("bold italic strikethrough subscript superscript underline".split(" ")).forEach(function(a){void 0!==
nb(a,m)&&e.push([a,nb(a,m)])});b(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(a){void 0!==Ra(a,m)&&e.push([a,Ra(a,m)])});q.nodeType==b.Node.TEXT_NODE?(q.insertData(c,l),a.getSelection().collapse(q,c),m.setStart(q,c),a.getSelection().extend(q,c+1),m.setEnd(q,c+1)):(1==q.childNodes.length&&fa(q.firstChild)&&q.removeChild(q.firstChild),q=document.createTextNode(l),m.insertNode(q),a.getSelection().collapse(q,0),m.setStart(q,0),a.getSelection().extend(q,1),m.setEnd(q,1));qb(e);Wa(m.startContainer,
m.startOffset);Wa(m.endContainer,m.endOffset);a.getSelection().collapseToEnd();m.collapse(!1)}}};M.insertunorderedlist={action:function(a,l){Hb("ul",l)},indeterm:function(){return/^mixed( ul)?$/.test(pb())},state:function(){return"ul"==pb()}};M.justifycenter={action:function(a,l){ub("center",l)},indeterm:function(){var a=G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return b(a).some(function(a){return"center"==Da(a)})&&b(a).some(function(a){return"center"!=Da(a)})},state:function(){var a=
G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return a.length&&b(a).every(function(a){return"center"==Da(a)})},value:function(){var a=G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return a.length?Da(a[0]):"left"}};M.justifyfull={action:function(a,l){ub("justify",l)},indeterm:function(){var a=G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return b(a).some(function(a){return"justify"==Da(a)})&&b(a).some(function(a){return"justify"!=Da(a)})},state:function(){var a=
G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return a.length&&b(a).every(function(a){return"justify"==Da(a)})},value:function(){var a=G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return a.length?Da(a[0]):"left"}};M.justifyleft={action:function(a,l){ub("left",l)},indeterm:function(){var a=G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return b(a).some(function(a){return"left"==Da(a)})&&b(a).some(function(a){return"left"!=Da(a)})},state:function(){var a=
G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return a.length&&b(a).every(function(a){return"left"==Da(a)})},value:function(){var a=G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return a.length?Da(a[0]):"left"}};M.justifyright={action:function(a,l){ub("right",l)},indeterm:function(){var a=G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return b(a).some(function(a){return"right"==Da(a)})&&b(a).some(function(a){return"right"!=Da(a)})},state:function(){var a=
G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return a.length&&b(a).every(function(a){return"right"==Da(a)})},value:function(){var a=G(sa(C()),function(a){return A(a)&&ea(a)&&!a.hasChildNodes()});return a.length?Da(a[0]):"left"}};M.outdent={action:function(){var a=[],l;for(l=C().endContainer;l!=C().commonAncestorContainer;l=l.parentNode)g(l,"li")&&a.unshift(l);for(l=C().startContainer;l;l=l.parentNode)g(l,"li")&&a.unshift(l);b(a).forEach(function(a){gb(a,C())});a=sa(C());for(l=oa(a,
function(a){return A(a)&&(!b(z(a)).some(A)||f(a,["ol","ul"])||g(a,"li")&&f(a.parentNode,["ol","ul"]))});l.length;){for(;l.length&&(f(l[0],["OL","UL"])||!f(l[0].parentNode,["OL","UL"]));)tb(l.shift(),a);if(!l.length)break;var m=[];for(m.push(l.shift());l.length&&l[0]==m[m.length-1].nextSibling&&!f(l[0],["OL","UL"]);)m.push(l.shift());var q=va(m);wa(m,a);b(m).forEach(Sa);Aa(q,a)}}};M.selectall={action:function(){var l=document.body;l||(l=document.documentElement);l?a.getSelection().selectAllChildren(l):
a.getSelection().removeAllRanges()}};M.stylewithcss={action:function(a){ob="false"!=String(a).toLowerCase()},state:function(){return ob}};M.usecss={action:function(a){ob="false"==String(a).toLowerCase()}};var cb=[],ab;for(ab in M)M.hasOwnProperty(ab)&&cb.push(ab);b(cb).forEach(function(a){null==M[a].relevantCssProperty&&(M[a].relevantCssProperty=null);null!=M[a].inlineCommandActivatedValues&&null==M[a].indeterm&&(M[a].indeterm=function(l){l=b(qa(l,function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE})).map(function(l){return Z(l,
a)});var m=b(l).filter(function(l){return-1!=b(M[a].inlineCommandActivatedValues).indexOf(l)});return 1<=m.length&&1<=l.length-m.length});null!=M[a].inlineCommandActivatedValues&&(M[a].state=function(l){var m=qa(l,function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE});return 0==m.length?-1!=b(M[a].inlineCommandActivatedValues).indexOf(Z(l.startContainer,a)):b(m).every(function(l){return-1!=b(M[a].inlineCommandActivatedValues).indexOf(Z(l,a))})});null!=M[a].standardInlineValueCommand&&(M[a].indeterm=
function(){var l=b(qa(C())).filter(function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE},!0).map(function(l){return Z(l,a)}),m;for(m=1;m<l.length;m++)if(l[m]!=l[m-1])return!0;return!1},M[a].value=function(l){var m=qa(l,function(a){return A(a)&&a.nodeType==b.Node.TEXT_NODE})[0];"undefined"==typeof m&&(m=l.startContainer);return Z(m,a)})});return{commands:M,execCommand:ha,queryCommandIndeterm:function(a,l){var b=a=a.toLowerCase();return V(a,"indeterm",l,function(){return!H(b,l)?!1:M[b].indeterm(l)})},
queryCommandState:ia,queryCommandValue:da,queryCommandEnabled:H,queryCommandSupported:function(a){a=a.toLowerCase();return M.hasOwnProperty(a)},copyAttributes:ua,createEndBreak:S,isEndBreak:function(a){return g(a,"br")&&a.parentNode.lastChild===a},ensureContainerEditable:Ja,isEditingHost:aa,isEditable:A}});define("aloha/selection","aloha/core jquery util/class util/range util/arrays util/strings aloha/console PubSub aloha/engine aloha/ecma5shims aloha/rangy-core".split(" "),function(a,b,d,p,r,s,t,
g,f,n){function j(c,e){var d=a.activeEditable?a.activeEditable.obj.parent()[0]:null,d=b(c).parentsUntil(d).get(),f;f=[];var j,g,n;1===c.nodeType&&"BODY"!==c.nodeName&&"HTML"!==c.nodeName?f.push(c.cloneNode(!1).outerHTML):f.push("#"+c.nodeType);n=0;for(g=d.length;n<g;n++){j=d[n];if("BODY"===j.nodeName||"HTML"===j.nodeName)break;f.push(j.cloneNode(!1).outerHTML)}f=f.join("");return e&&c===e.node&&r.equal(e.parents,d)&&f===e.html?null:{node:c,parents:d,html:f}}function e(a){var c;if(b.browser.msie&&
(a.startContainer===a.endContainer&&a.startOffset===a.endOffset&&3==a.startContainer.nodeType&&a.startOffset==a.startContainer.data.length&&a.startContainer.nextSibling)&&(c=a.startContainer.nextSibling,"OL"===c.nodeName||"UL"===c.nodeName))" "==a.startContainer.data[a.startContainer.data.length-1]?a.startOffset=a.endOffset=a.startOffset-1:a.startContainer.data+=" "}var v=window.GENTICS,x=null,c=null;p=d.extend({_constructor:function(){this.rangeObject={};this.preventSelectionChangedFlag=!1;this.tagHierarchy=
{textNode:{},abbr:{textNode:!0},b:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0,strong:!0},pre:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0},blockquote:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0,p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0},ins:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,
br:!0,span:!0,img:!0,a:!0,u:!0,p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0},ul:{li:!0},ol:{li:!0},li:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,a:!0},tr:{td:!0,th:!0},table:{tr:!0},div:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,table:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,p:!0,div:!0,pre:!0,blockquote:!0,a:!0},h1:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,
span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0}};this.tagHierarchy={textNode:this.tagHierarchy.textNode,abbr:this.tagHierarchy.abbr,br:this.tagHierarchy.textNode,img:this.tagHierarchy.textNode,b:this.tagHierarchy.b,strong:this.tagHierarchy.b,code:this.tagHierarchy.b,q:this.tagHierarchy.b,blockquote:this.tagHierarchy.blockquote,cite:this.tagHierarchy.b,i:this.tagHierarchy.b,em:this.tagHierarchy.b,sup:this.tagHierarchy.b,sub:this.tagHierarchy.b,span:this.tagHierarchy.b,del:this.tagHierarchy.del,ins:this.tagHierarchy.ins,
u:this.tagHierarchy.b,p:this.tagHierarchy.b,pre:this.tagHierarchy.pre,a:this.tagHierarchy.b,ul:this.tagHierarchy.ul,ol:this.tagHierarchy.ol,li:this.tagHierarchy.li,td:this.tagHierarchy.li,div:this.tagHierarchy.div,h1:this.tagHierarchy.h1,h2:this.tagHierarchy.h1,h3:this.tagHierarchy.h1,h4:this.tagHierarchy.h1,h5:this.tagHierarchy.h1,h6:this.tagHierarchy.h1,table:this.tagHierarchy.table};this.replacingElements={h1:{p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,pre:!0,blockquote:!0}};this.replacingElements=
{h1:this.replacingElements.h1,h2:this.replacingElements.h1,h3:this.replacingElements.h1,h4:this.replacingElements.h1,h5:this.replacingElements.h1,h6:this.replacingElements.h1,pre:this.replacingElements.h1,p:this.replacingElements.h1,blockquote:this.replacingElements.h1};this.allowedToStealElements={h1:{textNode:!0}};this.allowedToStealElements={h1:this.allowedToStealElements.h1,h2:this.allowedToStealElements.h1,h3:this.allowedToStealElements.h1,h4:this.allowedToStealElements.h1,h5:this.allowedToStealElements.h1,
h6:this.allowedToStealElements.h1,p:this.tagHierarchy.b}},SelectionTree:function(){this.domobj={};this.selection=void 0;this.children=[]},onChange:function(b,c,e){this.updateSelectionTimeout&&window.clearTimeout(this.updateSelectionTimeout);var d=this;this.updateSelectionTimeout=window.setTimeout(function(){var f=new a.Selection.SelectionRange(!0);if(!f.startContainer||"HTML"===f.startContainer.nodeName||"BODY"===f.startContainer.nodeName){if(!this.updateSelectionTimeout)d.onChange(b,c,10+2*(e||5))}else a.Selection._updateSelection(c,
f)},e||5)},preventSelectionChanged:function(){this.preventSelectionChangedFlag=!0},isSelectionChangedPrevented:function(){var a=this.preventSelectionChangedFlag;this.preventSelectionChangedFlag=!1;return a},isSelectionEditable:function(){return this.rangeObject.commonAncestorContainer&&b(this.rangeObject.commonAncestorContainer).contentEditable()},isFloatingMenuVisible:function(){var c=b(a.Selection.rangeObject.commonAncestorContainer).attr("data-aloha-floatingmenu-visible");return"undefined"!==c&&
"true"===c?!0:!1},updateSelection:function(a){return this._updateSelection(a,null)},_updateSelection:function(k,e){if(k&&k.originalEvent&&!0===k.originalEvent.stopSelectionUpdate||"undefined"===typeof e)return!1;this.rangeObject=e=e||new a.Selection.SelectionRange(!0);e.update();if(e&&(e.startContainer&&e.endContainer)&&0<b(e.commonAncestorContainer).closest(".aloha-editable").length){var d=!(3===e.startContainer.nodeType&&!b(e.startContainer.parentNode).contentEditable()),f=!(3===e.endContainer.nodeType&&
!b(e.endContainer.parentNode).contentEditable());if(!d||!f)return a.getSelection().removeAllRanges(),!0}if(this.isSelectionChangedPrevented())return!0;a.trigger("aloha-selection-changed-before",[this.rangeObject,k]);a.trigger("aloha-selection-changed",[this.rangeObject,k]);var d=this.rangeObject,n=d.startContainer,f=d.endContainer;if(!n||!f)t.warn("aloha/selection","encountered range object without start or end container");else if(n=j(n,x),f=j(f,c),n||f)x=n,c=f,g.pub("aloha.selection.context-change",
{range:d,event:k});a.trigger("aloha-selection-changed-after",[this.rangeObject,k]);return!0},getSelectionTree:function(b){if(!b)return this.rangeObject.getSelectionTree();if(!b.commonAncestorContainer)return a.Log.error(this,"the rangeObject is missing the commonAncestorContainer"),!1;this.inselection=!1;v.Utils.Dom.doCleanup({merge:!0},b)&&(b.update(),b.select());return this.recursiveGetSelectionTree(b,b.commonAncestorContainer)},recursiveGetSelectionTree:function(c,e){var d=0,f=this,j=[];b(e).contents().each(function(b){var g=
"none",n=!1,u=!1,v=!1,p=!1,r=!1,s=!1;c.isCollapsed()&&(e===c.startContainer&&c.startOffset==b)&&(j[d]=new a.Selection.SelectionTree,j[d].selection="collapsed",j[d].domobj=void 0,f.inselection=!1,v=!0,d++);if(!f.inselection&&!v){var t;try{t=this.nodeType}catch(x){return}switch(t){case 3:this===c.startContainer&&(f.inselection=!0,g=0<c.startOffset?"partial":"full",n=c.startOffset,u=this.length);break;case 1:this===c.startContainer&&0===c.startOffset&&(f.inselection=!0,g="full"),e===c.startContainer&&
c.startOffset===b&&(f.inselection=!0,g="full")}}if(f.inselection&&!v){"none"==g&&(g="full");switch(this.nodeType){case 3:this===c.endContainer&&(f.inselection=!1,c.endOffset<this.length&&(g="partial"),!1===n&&(n=0),u=c.endOffset);break;case 1:this===c.endContainer&&0===c.endOffset&&(f.inselection=!1)}e===c.endContainer&&c.endOffset<=b&&(f.inselection=!1,g="none")}j[d]=new a.Selection.SelectionTree;j[d].domobj=this;j[d].selection=g;"partial"==g&&(j[d].startOffset=n,j[d].endOffset=u);j[d].children=
f.recursiveGetSelectionTree(c,this);g=j[d].children.length;if(0<g){for(b=0;b<g;++b)switch(j[d].children[b].selection){case "none":p=!0;break;case "full":s=!0;break;case "partial":r=!0}r||s&&p?j[d].selection="partial":s&&(!r&&!p)&&(j[d].selection="full")}d++});c.isCollapsed()&&(e===c.startContainer&&c.startOffset==e.childNodes.length)&&(j[d]=new a.Selection.SelectionTree,j[d].selection="collapsed",j[d].domobj=void 0);return j},getRangeObject:function(){return this.rangeObject},isRangeObjectWithinMarkup:function(c,
e,d,f,j){var g=this;c=b(!e?c.startContainer:c.endContainer).parents();var n=!1,u=-1;"undefined"!==typeof f&&"function"!==typeof f&&a.Log.error(this,"parameter tagComparator is not a function");"undefined"===typeof f&&(f=function(a,b){return g.standardTextLevelSemanticsComparator(a,b)});0<c.length&&c.each(function(){if(this===j)return a.Log.debug(g,"reached limit dom obj"),!1;if(f(this,d))return!1===n&&(n=[]),a.Log.debug(g,"reached object equal to markup"),u++,n[u]=this,!0});return n},standardSectionsAndGroupingContentComparator:function(b,
c){if(1!==b.nodeType)return a.Log.debug(this,"only element nodes (nodeType == 1) can be compared"),!1;if(!c[0].nodeName)return!1;var e=a.Selection.replacingElements[b.nodeName.toLowerCase()];return e&&e[c[0].nodeName.toLowerCase()]},standardTagNameComparator:function(b,c){if(1===b.nodeType)return b.nodeName!=c[0].nodeName?!1:!0;a.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return!1},standardTextLevelSemanticsComparator:function(b,c){if(1===b.nodeType)return b.nodeName!=c[0].nodeName||
!this.standardAttributesComparator(b,c)?!1:!0;a.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return!1},standardAttributesComparator:function(a,b){var c=s.words(a&&a.className||""),e=s.words(b.length&&b[0].className||"");r.sortUnique(c);r.sortUnique(e);return r.equal(c,e)},changeMarkup:function(c,e,d){var j=e[0].tagName.toLowerCase(),g,u,v=this.isRangeObjectWithinMarkup(c,!1,e,d,g),p=this.isRangeObjectWithinMarkup(c,!0,e,d,g),r,s,t,x;if(this.replacingElements[j])u=c,c=new this.SelectionRange(c),
j=a.activeEditable?a.activeEditable.obj.get(0):b("body"),c.update(j),e.isReplacingElement=!0;else if(c.isCollapsed())return a.Log.debug(this,"early returning from applying markup because nothing is currently selected"),!1;g=a.activeEditable?a.activeEditable.obj[0]:b("body");if(!e.isReplacingElement&&0===c.startOffset&&null!=(t=this.getTextNodeSibling(!1,c.commonAncestorContainer.parentNode,c.startContainer)))x=this.isRangeObjectWithinMarkup({startContainer:t,startOffset:0},!1,e,d,g);if(!e.isReplacingElement&&
c.endOffset===c.endContainer.length&&null!=(r=this.getTextNodeSibling(!0,c.commonAncestorContainer.parentNode,c.endContainer)))s=this.isRangeObjectWithinMarkup({startContainer:r,startOffset:0},!1,e,d,g);if(!e.isReplacingElement&&v&&!p)a.Log.info(this,"markup 2 non-markup"),this.prepareForRemoval(c.getSelectionTree(),e,d),b(v).addClass("preparedForRemoval"),this.insertCroppedMarkups(v,c,!1,d);else if(!e.isReplacingElement&&v&&p)a.Log.info(this,"markup 2 markup"),this.prepareForRemoval(c.getSelectionTree(),
e,d),this.splitRelevantMarkupObject(v,p,c,d);else if(!e.isReplacingElement&&(!v&&p||s||x))a.Log.info(this,"non-markup 2 markup OR with next2markup"),x&&s?(v=new a.Selection.SelectionRange(c),v.startContainer=b(x[x.length-1]).textNodes()[0],v.startOffset=0,v.endContainer=b(s[s.length-1]).textNodes().last()[0],v.endOffset=v.endContainer.length,v.update(),this.applyMarkup(v.getSelectionTree(),c,e,d),a.Log.info(this,"double extending previous markup(previous and after selection), actually wrapping it ...")):
x&&!s&&!p?(this.extendExistingMarkupWithSelection(x,c,!1,d),a.Log.info(this,"extending previous markup")):x&&!s&&p?(v=new a.Selection.SelectionRange(c),v.startContainer=b(x[x.length-1]).textNodes()[0],v.startOffset=0,v.endContainer=b(p[p.length-1]).textNodes().last()[0],v.endOffset=v.endContainer.length,v.update(),this.applyMarkup(v.getSelectionTree(),c,e,d),a.Log.info(this,"double extending previous markup(previous and relevant at the end), actually wrapping it ...")):!x&&s?(this.extendExistingMarkupWithSelection(s,
c,!0,d),a.Log.info(this,"extending following markup backwards")):this.extendExistingMarkupWithSelection(p,c,!0,d);else if(e.isReplacingElement||!v&&!p&&!x&&!s){a.Log.info(this,"non-markup 2 non-markup");c.startContainer!==c.endContainer?p=!1:1!=c.startContainer.nodeType?p=!1:(p=c.startContainer.firstChild,p=!p||!p.nextSibling&&"BR"==p.nodeName);if(p){e=e.clone();d=c.startContainer!==c.endContainer?!1:1!=c.startContainer.nodeType?!1:f.isEndBreak(c.startContainer);d&&e[0].appendChild(f.createEndBreak());
a.activeEditable&&b.browser.mozilla&&a.activeEditable.obj.focus();f.isEditable(c.startContainer)?(f.copyAttributes(c.startContainer,e[0]),b(c.startContainer).after(e[0]).remove()):f.isEditingHost(c.startContainer)&&(b(c.startContainer).append(e[0]),f.ensureContainerEditable(e[0]));u.startContainer=e[0];u.endContainer=e[0];u.startOffset=0;u.endOffset=0;return}this.applyMarkup(c.getSelectionTree(),c,e,d,{setRangeObject2NewMarkup:!0});u.startContainer=c.startContainer;u.endContainer=c.endContainer;u.startOffset=
c.startOffset;u.endOffset=c.endOffset}e.isReplacingElement&&(u&&(u.startContainer.className&&-1<u.startContainer.className.indexOf("preparedForRemoval"))&&(d=b(u.startContainer).parents(e[0].tagName).get(0),u.startContainer=d,c.startContainer=d),u&&(u.endContainer.className&&-1<u.endContainer.className.indexOf("preparedForRemoval"))&&(d=b(u.endContainer).parents(e[0].tagName).get(0),u.endContainer=d,c.endContainer=d));b(".preparedForRemoval").zap();e.isReplacingElement?(n.Node.ELEMENT_NODE===u.startContainer.nodeType&&
(u.startContainer.childNodes&&u.startContainer.childNodes.length<u.startOffset)&&(u.startOffset=u.startContainer.childNodes.length,c.startOffset=u.startContainer.childNodes.length),n.Node.ELEMENT_NODE===u.endContainer.nodeType&&(u.endContainer.childNodes&&u.endContainer.childNodes.length<u.endOffset)&&(u.endOffset=u.endContainer.childNodes.length,c.endOffset=u.endContainer.childNodes.length),c.endContainer=u.endContainer,c.endOffset=u.endOffset,c.startContainer=u.startContainer,c.startOffset=u.startOffset,
u.update(),u.select()):(c.update(),c.select())},areMarkupObjectsAsLongAsRangeObject:function(a,c,e){var d,f,j;if(0!==e.startOffset)return!1;d=0;for(j=a.length;d<j;d++)if(f=b(a[d]),f.textNodes().first()[0]!==e.startContainer)return!1;d=0;for(a=c.length;d<a;d++)if(f=b(c[d]),f=f.textNodes().last()[0],f!==e.endContainer||f.length!=e.endOffset)return!1;return!0},splitRelevantMarkupObject:function(a,c,e,d){b(a).addClass("preparedForRemoval");b(c).addClass("preparedForRemoval");if(this.areMarkupObjectsAsLongAsRangeObject(a,
c,e))return!0;var f=this.intersectRelevantMarkupObjects(a,c);f?(this.insertCroppedMarkups([f],e,!1,d),this.insertCroppedMarkups([f],e,!0,d)):(this.insertCroppedMarkups(a,e,!1,d),this.insertCroppedMarkups(c,e,!0,d));return!0},intersectRelevantMarkupObjects:function(a,b){var c=!1,e,d,f,j,g,n;if(!a||!b)return c;g=a.length;n=b.length;for(e=0;e<g;e++){d=a[e];for(f=0;f<n;f++)j=b[f],d===j&&(c=d)}return c},extendExistingMarkupWithSelection:function(a,c,e,d){var f,j,g,n,u,v,p;e||(f=!0);e&&(j=!0);e=[];g=0;
for(n=a.length;g<n;g++)e[g]=new this.SelectionRange,u=a[g],j&&!f&&(e[g].startContainer=c.startContainer,e[g].startOffset=c.startOffset,v=b(u).textNodes(!0),p=v.length-1,e[g].endContainer=v[p],e[g].endOffset=v[p].length,e[g].update(),this.applyMarkup(e[g].getSelectionTree(),c,this.getClonedMarkup4Wrapping(u),d,{setRangeObject2NewMarkup:!0})),!j&&f&&(v=b(u).textNodes(!0),e[g].startContainer=v[0],e[g].startOffset=0,e[g].endContainer=c.endContainer,e[g].endOffset=c.endOffset,e[g].update(),this.applyMarkup(e[g].getSelectionTree(),
c,this.getClonedMarkup4Wrapping(u),d,{setRangeObject2NewMarkup:!0}));return!0},getClonedMarkup4Wrapping:function(a){a=b(a.outerHTML).removeClass("preparedForRemoval").empty();0===a.attr("class").length&&a.removeAttr("class");return a},insertCroppedMarkups:function(a,c,e,d){var f,j,g,n,u;e?j=!0:f=!0;e=[];for(n=0;n<a.length;n++){e[n]=new this.SelectionRange;u=a[n];if(f&&!j){g=b(u).textNodes(!0);e[n].startContainer=g[0];e[n].startOffset=0;if(e[n].startContainer===c.startContainer&&e[n].startOffset===
c.startOffset)continue;0===c.startOffset?(e[n].endContainer=this.getTextNodeSibling(!1,u,c.startContainer),e[n].endOffset=e[n].endContainer.length):(e[n].endContainer=c.startContainer,e[n].endOffset=c.startOffset);e[n].update();this.applyMarkup(e[n].getSelectionTree(),c,this.getClonedMarkup4Wrapping(u),d,{setRangeObject2NextSibling:!0})}!f&&j&&(e[n].startContainer=c.endContainer,e[n].startOffset=c.endOffset,g=b(u).textNodes(!0),e[n].endContainer=g[g.length-1],e[n].endOffset=g[g.length-1].length,e[n].update(),
this.applyMarkup(e[n].getSelectionTree(),c,this.getClonedMarkup4Wrapping(u),d,{setRangeObject2PreviousSibling:!0}))}return!0},changeMarkupOnSelection:function(a){var b=this.getRangeObject();this.changeMarkup(b,a,this.getStandardTagComparator(a));v.Utils.Dom.doCleanup({merge:!0},b);b.update();b.select();this.rangeObject=b},applyMarkup:function(b,c,e,d,f){var j,g;f=f||{};this.prepareForRemoval(b,e,d);b=this.optimizeSelectionTree4Markup(b,e,d);for(j=0;j<b.length;j++)g=b[j],g.wrappable?this.wrapMarkupAroundSelectionTree(g.elements,
c,e,d,f):(a.Log.debug(this,"dive further into non-wrappable object"),this.applyMarkup(g.element.children,c,e,d,f))},getMarkupType:function(c){var e=b(c)[0].nodeName.toLowerCase();c.outerHtml&&a.Log.debug(this,"Node name detected: "+e+" for: "+c.outerHtml());if("#text"==e)return"textNode";if(this.replacingElements[e])return"sectionOrGroupingContent";if(this.tagHierarchy[e])return"textLevelSemantics";a.Log.warn(this,"unknown markup passed to this.getMarkupType(...): "+c.outerHtml())},getStandardTagComparator:function(a){var b=
this;switch(this.getMarkupType(a)){case "textNode":a=function(){return!1};break;case "sectionOrGroupingContent":a=function(a,c){return b.standardSectionsAndGroupingContentComparator(a,c)};break;default:a=function(a,c){return b.standardTextLevelSemanticsComparator(a,c)}}return a},prepareForRemoval:function(c,e,d){var f,j;"undefined"!==typeof d&&"function"!==typeof d&&a.Log.error(this,"parameter tagComparator is not a function");"undefined"===typeof d&&(d=this.getStandardTagComparator(e));for(f=0;f<
c.length;f++){j=c[f];if(j.domobj&&("full"==j.selection||"partial"==j.selection&&e.isReplacingElement)&&1===j.domobj.nodeType&&d(j.domobj,e))a.Log.debug(this,"Marking for removal: "+j.domobj.nodeName),b(j.domobj).addClass("preparedForRemoval");"none"!=j.selection&&0<j.children.length&&this.prepareForRemoval(j.children,e,d)}},wrapMarkupAroundSelectionTree:function(c,e,d,f,j){var g=[],n=-1,u="",v="",p,r,s;a.Log.debug(this,"The formatting <"+d[0].tagName+"> will be wrapped around the selection");for(p=
0;p<c.length;p++)if(r=c[p],r.domobj&&!this.canTag1WrapTag2(r.domobj.parentNode.tagName.toLowerCase(),d[0].tagName.toLowerCase()))a.Log.info(this,"Skipping the wrapping of <"+d[0].tagName.toLowerCase()+"> because this tag is not allowed inside <"+r.domobj.parentNode.tagName.toLowerCase()+">");else if(!r.domobj||!(3===r.domobj.nodeType&&0===b.trim(r.domobj.nodeValue).length)){if(r.domobj&&"partial"==r.selection&&!d.isReplacingElement)if(void 0!==r.startOffset&&void 0===r.endOffset)n++,u+=r.domobj.data.substr(0,
r.startOffset),r.domobj.data=r.domobj.data.substr(r.startOffset,r.domobj.data.length-r.startOffset),g[n]=r.domobj;else if(void 0!==r.endOffset&&void 0===r.startOffset)n++,v+=r.domobj.data.substr(r.endOffset,r.domobj.data.length-r.endOffset),r.domobj.data=r.domobj.data.substr(0,r.endOffset),g[n]=r.domobj;else if(void 0!==r.endOffset&&void 0!==r.startOffset){if(r.startOffset==r.endOffset){a.Log.debug(this,"skipping empty selection");continue}n++;u+=r.domobj.data.substr(0,r.startOffset);s=r.domobj.data.substr(r.startOffset,
r.endOffset-r.startOffset);v+=r.domobj.data.substr(r.endOffset,r.domobj.data.length-r.endOffset);r.domobj.data=s;g[n]=r.domobj}else a.Log.debug(this,"diving into object"),this.applyMarkup(r.children,e,d,f,j);if(r.domobj&&("full"==r.selection||"partial"==r.selection&&d.isReplacingElement))n++,g[n]=r.domobj}0<g.length&&(g=b(g),b.each(g,function(a,c){b.browser.msie&&(3==c.nodeType&&!c.nextSibling&&!c.previousSibling&&c.parentNode&&"li"==c.parentNode.nodeName.toLowerCase())&&(c.data=b.trim(c.data))}),
c=g.wrapAll(d).parent(),c.before(u).after(v),j.setRangeObject2NewMarkup&&(u=g.textNodes(),-1!=u.index(e.startContainer)&&(e.startOffset=0),-1!=u.index(e.endContainer)&&(e.endOffset=e.endContainer.length)),j.setRangeObject2NextSibling&&(u=!0,v=c.textNodes(!0).last()[0],-1!=g.index(e.startContainer)&&(e.startContainer=this.getTextNodeSibling(u,c.parent(),v),e.startOffset=0),-1!=g.index(e.endContainer)&&(e.endContainer=this.getTextNodeSibling(u,c.parent(),v),e.endOffset-=v.length)),j.setRangeObject2PreviousSibling&&
(u=!1,v=c.textNodes(!0).first()[0],-1!=g.index(e.startContainer)&&(e.startContainer=this.getTextNodeSibling(u,c.parent(),v),e.startOffset=0),-1!=g.index(e.endContainer)&&(e.endContainer=this.getTextNodeSibling(u,c.parent(),v),e.endOffset=e.endContainer.length)))},getTextNodeSibling:function(a,c,e){c=b(c).textNodes(!0);e=c.index(e);return-1==e?!1:c[e+(!a?-1:1)]||!1},optimizeSelectionTree4Markup:function(a,c,e){var d=[],f=0,j=0,g=this,n,u,v,r;"undefined"===typeof e&&(e=function(a,b){return g.standardTextLevelSemanticsComparator(b)});
for(n=0;n<a.length;n++)if(a[n].domobj&&"none"!=a[n].selection)if(c.isReplacingElement&&e(c[0],b(a[n].domobj)))void 0!==d[f]&&f++,d[f]={},d[f].wrappable=!0,d[f].elements=[],d[f].elements[j]=a[n],f++;else if(this.canMarkupBeApplied2ElementAsWhole([a[n]],c))if(void 0===d[f]&&(d[f]={},d[f].wrappable=!0,d[f].elements=[]),c.isReplacingElement){r=n;for(u=n-1;0<=u;u--)if(this.canMarkupBeApplied2ElementAsWhole([a[u]],c)&&this.isMarkupAllowedToStealSelectionTreeElement(a[u],c))r=u;else break;v=n;for(u=n+1;u<
a.length;u++)if(this.canMarkupBeApplied2ElementAsWhole([a[u]],c)&&this.isMarkupAllowedToStealSelectionTreeElement(a[u],c))v=u;else break;j=0;for(u=r;u<=v;u++)d[f].elements[j]=a[u],d[f].elements[j].selection="full",j++;j=0}else d[f].elements[j]=a[n],j++;else void 0!==d[f]&&f++,d[f]={},d[f].wrappable=!1,d[f].element=a[n],j=0,f++;return d},isMarkupAllowedToStealSelectionTreeElement:function(a,b){if(!a.domobj)return!1;var c=a.domobj.nodeName.toLowerCase(),c="#text"==c?"textNode":c,e=b[0].nodeName.toLowerCase();
return(e=this.allowedToStealElements[e])&&e[c]},canMarkupBeApplied2ElementAsWhole:function(a,b){var c,e,d;b.jquery&&(c=b[0].tagName);b.tagName&&(c=b.tagName);for(e=0;e<a.length;e++)if(d=a[e],d.domobj&&("none"!=d.selection||b.isReplacingElement))if(!this.canTag1WrapTag2(c,d.domobj.nodeName)||0<d.children.length&&!this.canMarkupBeApplied2ElementAsWhole(d.children,b))return!1;return!0},canTag1WrapTag2:function(a,b){a="#text"==a?"textNode":a.toLowerCase();b="#text"==b?"textNode":b.toLowerCase();var c=
this.tagHierarchy[a];return!c||!this.tagHierarchy[b]?!0:c[b]},mayInsertTag:function(b){var c;if("object"==typeof this.rangeObject.unmodifiableMarkupAtStart){for(c=0;c<this.rangeObject.unmodifiableMarkupAtStart.length;++c)if(!this.canTag1WrapTag2(this.rangeObject.unmodifiableMarkupAtStart[c].nodeName,b))return!1;return!0}a.Log.warn(this,"Unable to determine whether tag "+b+" may be inserted");return!0},toString:function(){return"Aloha.Selection"},SelectionRange:v.Utils.RangeObject.extend({_constructor:function(a){this._super(a);
a&&(a.commonAncestorContainer&&(this.commonAncestorContainer=a.commonAncestorContainer),a.selectionTree&&(this.selectionTree=a.selectionTree),a.limitObject&&(this.limitObject=a.limitObject),a.markupEffectiveAtStart&&(this.markupEffectiveAtStart=a.markupEffectiveAtStart),a.unmodifiableMarkupAtStart&&(this.unmodifiableMarkupAtStart=a.unmodifiableMarkupAtStart),a.splitObject&&(this.splitObject=a.splitObject))},commonAncestorContainer:void 0,selectionTree:void 0,markupEffectiveAtStart:[],unmodifiableMarkupAtStart:[],
limitObject:void 0,splitObject:void 0,select:function(){this._super();a.Selection.updateSelection()},update:function(a){this.updatelimitObject();this.updateMarkupEffectiveAtStart();this.updateCommonAncestorContainer(a);this.selectionTree=void 0},getSelectionTree:function(){this.selectionTree||(this.selectionTree=a.Selection.getSelectionTree(this));return this.selectionTree},getSelectedSiblings:function(a){var b=this.getSelectionTree();return this.recursionGetSelectedSiblings(a,b)},recursionGetSelectedSiblings:function(a,
b){var c=!1,e=!1,d;for(d=0;d<b.length;++d)if(b[d].domobj===a)e=!0,c=[];else if(!e&&b[d].children){if(c=this.recursionGetSelectedSiblings(a,b[d].children),!1!==c)break}else if(e&&b[d].domobj&&"collapsed"!=b[d].selection&&"none"!=b[d].selection)c.push(b[d].domobj);else if(e&&"none"==b[d].selection)break;return c},updateMarkupEffectiveAtStart:function(){this.markupEffectiveAtStart=[];this.unmodifiableMarkupAtStart=[];var a=this.getStartContainerParents(),b=!1,c,e,d;for(e=0;e<a.length;e++)d=a[e],!b&&
d!==this.limitObject?(this.markupEffectiveAtStart[e]=d,!c&&v.Utils.Dom.isSplitObject(d)&&(c=!0,this.splitObject=d)):(b=!0,this.unmodifiableMarkupAtStart.push(d));c||(this.splitObject=!1)},updatelimitObject:function(){if(a.editables&&0<a.editables.length){var c=this.getStartContainerParents(),e=a.editables,d,f,j,g;for(d=0;d<c.length;d++){f=c[d];for(j=0;j<e.length;j++)if(g=e[j].obj[0],f===g)return this.limitObject=f,!0}}this.limitObject=b("body");return!0},toString:function(a){return!a?"Aloha.Selection.SelectionRange":
"Aloha.Selection.SelectionRange {start ["+this.startContainer.nodeValue+"] offset "+this.startOffset+", end ["+this.endContainer.nodeValue+"] offset "+this.endOffset+"}"}})});var u=d.extend({_constructor:function(a){this._nativeSelection=a;this.ranges=[];this.preventChange=!1},anchorNode:null,anchorOffset:0,focusNode:null,focusOffset:0,isCollapsed:!1,rangeCount:0,collapse:function(a,b){this._nativeSelection.collapse(a,b)},collapseToStart:function(){throw"NOT_IMPLEMENTED";},extend:function(){},modify:function(){},
collapseToEnd:function(){throw"NOT_IMPLEMENTED";},selectAllChildren:function(){throw"NOT_IMPLEMENTED";},deleteFromDocument:function(){throw"NOT_IMPLEMENTED";},getRangeAt:function(a){a=this._nativeSelection.getRangeAt(a);e(a);return a},addRange:function(b){this._nativeSelection.addRange(b);var c=this._nativeSelection._ranges;e(b);c[0]=b;a.Selection.updateSelection()},removeRange:function(){this._nativeSelection.removeRange()},removeAllRanges:function(){this._nativeSelection.removeAllRanges()},refresh:function(){},
toString:function(){return"Aloha.Selection"},getRangeCount:function(){return this._nativeSelection.rangeCount}});a.getSelection=function(a){a=a!==document||a!==window?window:a;return new u(window.rangy.getSelection(a))};a.createRange=function(a){return window.rangy.createRange(a)};d=new p;return a.Selection=d});define("aloha/block-jump",["aloha/core","jquery","aloha/console"],function(a,b,d){function p(){if(r){var a=r.nodeValue.replace(/\u200b/,"");a===r.nodeValue&&d.warn("Expected to remove the zero width text node fix, but couldn't find it");
var p=r;p.deleteData(0,p.length);""!==a&&(p.nextSibling&&3===p.nextSibling.nodeType?p.nextSibling.insertData(0,a):p.previousSibling&&3===p.previousSibling.nodeType?p.previousSibling.insertData(p.previousSibling.length,a):p.insertData(0,a));setTimeout(function(){0===p.length&&b(p).remove()},0);r=null}}var r=null;return{removeZeroWidthTextNodeFix:p,insertZeroWidthTextNodeFix:function(d,t){p();r=document.createTextNode("\u200b");t?b(d).after(r):b(d).before(r);a.bind("aloha-selection-changed",function(b){p();
a.unbind(b)});return r}}});define("aloha/markup","aloha/core util/class jquery aloha/ecma5shims aloha/console aloha/block-jump".split(" "),function(a,b,d,p,r,s){function t(a){return"false"===d(a).attr("contenteditable")}function g(a){return a&&3===a.nodeType}function f(a){return!a?0:g(a)?a.length:a.childNodes.length}function n(a){return!a?null:a.nextSibling?g(a.nextSibling)&&!(0<a.nextSibling.data.replace(/\s+/g,"").length)||"BR"===a.nextSibling.nodeName&&a.nextSibling===a.parentNode.lastChild||""===
a.nextSibling.innerHTML&&!t(a.nextSibling)?n(a.nextSibling):a.nextSibling:a.parentNode?n(a.parentNode):null}function j(a){return!a?null:a.previousSibling?g(a.previousSibling)&&!(0<a.previousSibling.data.replace(/\s+/g,"").length)?j(a.previousSibling):""===a.previousSibling.innerHTML&&!t(a.previousSibling)?j(a.previouSibling):a.previousSibling:a.parentNode?j(a.parentNode):null}function e(a){var b;if(b=window.$_alohaPlaceholder){b=a.startContainer;a=a.endContainer;var e=window.$_alohaPlaceholder;b=
!(e.is(b)||e.is(a)||(x?p.compareDocumentPosition(e[0],b)&16:0<d(e[0]).find(b).length)||(x?p.compareDocumentPosition(e[0],a)&16:0<d(e[0]).find(a).length))}b&&(0===window.$_alohaPlaceholder.html().replace(/^(&nbsp;)*$/,"").length&&window.$_alohaPlaceholder.remove(),window.$_alohaPlaceholder=null)}var v=window.GENTICS,x=!!(d.browser.msie&&9>parseInt(d.browser.version,10));a.Markup=b.extend({keyHandlers:{},addKeyHandler:function(a,b){this.keyHandlers[a]||(this.keyHandlers[a]=[]);this.keyHandlers[a].push(b)},
removeKeyHandler:function(a){this.keyHandlers[a]&&(this.keyHandlers[a]=null)},insertBreak:function(){var b=a.Selection.rangeObject,e,k,f;b.isCollapsed()||this.removeSelectedMarkup();f=d("<br/>");v.Utils.Dom.insertIntoDOM(f,b,a.activeEditable.obj);if(k=v.Utils.Dom.searchAdjacentTextNode(f.parent().get(0),v.Utils.Dom.getIndexInParent(f.get(0))+1,!1))e=k.data.search(/\S/),0<e&&(k.data=k.data.substring(e));b.startContainer=b.endContainer=f.get(0).parentNode;b.startOffset=b.endOffset=v.Utils.Dom.getIndexInParent(f.get(0))+
1;b.correctRange();b.clearCaches();b.select()},preProcessKeyStrokes:function(b){if("keydown"!==b.type)return!1;var d,k;if(this.keyHandlers[b.keyCode]){d=this.keyHandlers[b.keyCode];for(k=0;k<d.length;++k)if(!d[k](b))return!1}if(37===b.keyCode||39===b.keyCode)return a.getSelection().getRangeCount()&&(d=a.getSelection().getRangeAt(0),this.processCursor(d,b.keyCode))?(e(a.Selection.rangeObject),!0):!1;if(8===b.keyCode)return b.preventDefault(),a.execCommand("delete",!1),!1;if(46===b.keyCode)return a.execCommand("forwarddelete",
!1),!1;if(13===b.keyCode){if(b.shiftKey)return a.execCommand("insertlinebreak",!1),!1;a.execCommand("insertparagraph",!1);return!1}return!0},processCursor:function(b,u){if(!b.collapsed)return!0;s.removeZeroWidthTextNodeFix();var k=b.startContainer,r=a.getSelection();if(!k)return!0;var p,D;if(d.browser.msie&&7>=parseInt(d.browser.version,10)&&g(k))if(37==u){for(D=b.startOffset;0<D&&"\u200b"===k.data.charAt(D-1);)D--;D!=b.startOffset&&(b.setStart(b.startContainer,D),b.setEnd(b.startContainer,D),r=a.getSelection(),
r.removeAllRanges(),r.addRange(b))}else if(39==u){for(D=b.startOffset;D<k.data.length&&"\u200b"===k.data.charAt(D);)D++;D!=b.startOffset&&(b.setStart(b.startContainer,D),b.setEnd(b.startContainer,D),r.removeAllRanges(),r.addRange(b))}if(x&&!d(k).contentEditable()&&(D=d(k).parents("[contenteditable=false]"),0<D.length))if(D.parent().hasClass("aloha-editable"))p=D[0];else return!0;var K;if(!p){K=37===u||38===u;D=b.startOffset;if(g(k))if(K){if(1!==D&&!(0===D||D<=k.data.length-k.data.replace(/^\s+/,"").length))return!0}else{p=
k;r=f(p);if(r===D)p=!0;else{var E=g(p);p=E&&p.data.replace(/\s+$/,"").length===D?!0:1===r&&!E?"BR"===p.childNodes[0].nodeName:!1}if(!p)return!0}else k=k.childNodes[D===f(k)?D-1:D];p=K?j(k):n(k)}return t(p)?(k=p,p=new v.Utils.RangeObject,D=K?j(k):n(k),!D||t(D)?(D=d("<div>&nbsp;</div>"),K?d(k).before(D):d(k).after(D),p.startContainer=p.endContainer=D[0],p.startOffset=p.endOffset=0,e(p),window.$_alohaPlaceholder=D):(3===b.startContainer.nodeType&&b.startContainer===b.endContainer&&""!==b.startContainer.nodeValue&&
(K?1===b.startOffset:b.endOffset+1===b.endContainer.length)||1===b.startContainer.nodeType&&(!b.startOffset||b.startContainer.childNodes[b.startOffset]&&1===b.startContainer.childNodes[b.startOffset].nodeType)?(D=s.insertZeroWidthTextNodeFix(k,K),p.startContainer=p.endContainer=D,p.startOffset=p.endOffset=K?1:0):(p.startContainer=p.endContainer=D,p.startOffset=p.endOffset=K?f(D):0,K||s.insertZeroWidthTextNodeFix(k,!0)),e(p)),p.select(),a.trigger("aloha-block-selected",k),a.Selection.preventSelectionChanged(),
!1):!0},processShiftEnter:function(a){this.insertHTMLBreak(a.getSelectionTree(),a)},processEnter:function(a){a.splitObject?this.splitRangeObject(a):this.insertHTMLBreak(a.getSelectionTree(),a)},insertHTMLCode:function(b){var e=a.Selection.rangeObject;this.insertHTMLBreak(e.getSelectionTree(),e,d(b))},insertHTMLBreak:function(b,e,k){var f,j,g,n,p;k=k||d("<br/>");f=0;for(j=b.length;f<j;++f)if(g=b[f],n=g.domobj?d(g.domobj):void 0,"none"!==g.selection)if("collapsed"==g.selection)0<f?(g=d(b[f-1].domobj),
g.after(k)):(g=d(b[1].domobj),g.before(k)),e.startContainer=e.endContainer=k[0].parentNode,e.startOffset=e.endOffset=v.Utils.Dom.getIndexInParent(k[0])+1,e.correctRange();else if(g.domobj&&3===g.domobj.nodeType){g.domobj.nextSibling&&(1==g.domobj.nextSibling.nodeType&&a.Selection.replacingElements[g.domobj.nextSibling.nodeName.toLowerCase()])&&n.after("<br/>");if(this.needEndingBreak()){for(p=g.domobj;p;)if(p.nextSibling)p=!1;else{p=p.parentNode;if(v.Utils.Dom.isBlockLevelElement(p)||v.Utils.Dom.isListElement(p))break;
p===e.limitObject&&(p=!1)}p&&d(p).append('<br class="aloha-cleanme" />')}n.between(k,g.startOffset);n=0;for(g=k[0];g;)g=g.previousSibling,++n;e.startContainer=k[0].parentNode;e.endContainer=k[0].parentNode;e.startOffset=n;e.endOffset=n;e.correctRange()}else g.domobj&&1===g.domobj.nodeType&&(0===n.parent().find("br.aloha-ephemera").length&&(d(e.limitObject).find("br.aloha-ephemera").remove(),d(e.commonAncestorContainer).append(this.getFillUpElement(e.splitObject))),n.after(k),e.startContainer=e.commonAncestorContainer,
e.endContainer=e.startContainer,e.startOffset=f+2,e.endOffset=f+2,e.update());e.select()},needEndingBreak:function(){return!d.browser.msie},getSelectedText:function(){var b=a.Selection.rangeObject;return b.isCollapsed()?!1:this.getFromSelectionTree(b.getSelectionTree(),!0)},getFromSelectionTree:function(a,b){var e="",f,j,g,n;f=0;for(j=a.length;f<j;f++)g=a[f],"partial"==g.selection?3===g.domobj.nodeType?e+=g.domobj.data.substring(g.startOffset,g.endOffset):1===g.domobj.nodeType&&g.children&&(b?e+=
this.getFromSelectionTree(g.children,b):(n=d(g.domobj.outerHTML).empty(),n.html(this.getFromSelectionTree(g.children,b)),e+=n.outerHTML())):"full"==g.selection&&(3===g.domobj.nodeType?e+=d(g.domobj).text():1===g.domobj.nodeType&&g.children&&(e+=b?d(g.domobj).text():d(g.domobj).outerHTML()));return e},getSelectedMarkup:function(){var b=a.Selection.rangeObject;return b.isCollapsed()?null:this.getFromSelectionTree(b.getSelectionTree(),!1)},removeSelectedMarkup:function(){var b=a.Selection.rangeObject,
e;b.isCollapsed()||(e=new a.Selection.SelectionRange,this.removeFromSelectionTree(b.getSelectionTree(),e),e.update(),v.Utils.Dom.doCleanup({merge:!0,removeempty:!0},a.Selection.rangeObject),a.Selection.rangeObject=e,e.correctRange(),e.update(),e.select(),a.Selection.updateSelection())},removeFromSelectionTree:function(a,b){var e,f,j,g,n;j=0;for(n=a.length;j<n;j++)g=a[j],"partial"==g.selection?3===g.domobj.nodeType?(f="",0<g.startOffset&&(f+=g.domobj.data.substring(0,g.startOffset)),g.endOffset<g.domobj.data.length&&
(f+=g.domobj.data.substring(g.endOffset,g.domobj.data.length)),g.domobj.data=f,b.startContainer||(b.startContainer=b.endContainer=g.domobj,b.startOffset=b.endOffset=g.startOffset)):1===g.domobj.nodeType&&g.children&&(this.removeFromSelectionTree(g.children,b),e?e.nodeName==g.domobj.nodeName&&(d(e).append(d(g.domobj).contents()),d(g.domobj).remove()):e=g.domobj):"full"==g.selection&&(b.startContainer||((f=v.Utils.Dom.searchAdjacentTextNode(g.domobj.parentNode,v.Utils.Dom.getIndexInParent(g.domobj)+
1,!1,{blocklevel:!1}))?(b.startContainer=b.endContainer=f,b.startOffset=b.endOffset=0):(b.startContainer=b.endContainer=g.domobj.parentNode,b.startOffset=b.endOffset=v.Utils.Dom.getIndexInParent(g.domobj)+1)),d(g.domobj).remove())},splitRangeObject:function(b){d(b.splitObject);var e,f;b.update(b.splitObject);e=b.getSelectionTree();f=this.getSplitFollowUpContainer(b);this.splitRangeObjectHelper(e,b,f);f.hasClass("preparedForRemoval")&&f.removeClass("preparedForRemoval");e=this.getInsertAfterObject(b,
f);d(f).insertAfter(e);"li"===b.splitObject.nodeName.toLowerCase()&&!a.Selection.standardTextLevelSemanticsComparator(b.splitObject,f)&&d(b.splitObject).remove();b.startContainer=null;e=f.contents();0<e.length&&(1==e.get(0).nodeType&&"br"===e.get(0).nodeName.toLowerCase())&&(b.startContainer=f.get(0));b.startContainer||(b.startContainer=f.textNodes(!0,!0).first().get(0));b.startContainer||(b.startContainer=f.textNodes(!1).first().parent().get(0));b.startContainer?(b.endContainer=b.startContainer,
b.startOffset=0,b.endOffset=0):(b.startContainer=b.endContainer=f.parent().get(0),b.startOffset=b.endOffset=v.Utils.Dom.getIndexInParent(f.get(0)));b.update();b.select()},getInsertAfterObject:function(b,e){var f,j,g;for(j=0;j<b.markupEffectiveAtStart.length;j++)if(g=b.markupEffectiveAtStart[j],g===b.splitObject&&(f=!0),f&&a.Selection.canTag1WrapTag2(d(g).parent()[0].nodeName,e[0].nodeName))return g;return!1},getFillUpElement:function(){return d.browser.msie?!1:d('<br class="aloha-cleanme"/>')},removeElementContentWhitespaceObj:function(a){var b=
0,e=[],d,f;for(d=0;d<a.length;++d)f=a[d],f.isElementContentWhitespace&&(e[e.length]=d);for(d=0;d<e.length;++d)f=e[d],a.splice(f-b,1),++b},splitRangeObjectHelper:function(b,e,f,j){f||a.Log.warn(this,"no followUpContainer, no inBetweenMarkup, nothing to do...");var g=this.getFillUpElement(e.splitObject),n=d(e.splitObject),p=!1,r,s,x,t,W;if(0<b.length){x=f.contents();x.length!==b.length&&this.removeElementContentWhitespaceObj(x);s=0;for(W=b.length;s<W;++s)r=b[s],"none"===r.selection&&!1===p||r.domobj&&
3===r.domobj.nodeType&&r===b[b.length-1]&&r.startOffset===r.domobj.data.length?1<f.textNodes().length||1===r.domobj.nodeType&&0===r.children.length?x.eq(s).remove():v.Utils.Dom.isSplitObject(f[0])?g?f.html(g):f.empty():(f.empty(),f.addClass("preparedForRemoval")):"none"!==r.selection?(r.domobj&&(3===r.domobj.nodeType&&void 0!==r.startOffset)&&(p=r.domobj.data,0<r.startOffset?r.domobj.data=p.substr(0,r.startOffset):1<b.length?d(r.domobj).remove():(t=d(r.domobj).parent(),v.Utils.Dom.isSplitObject(t[0])?
g?t.html(g):t.empty():t.remove()),0<p.length-r.startOffset?x[s].data=p.substr(r.startOffset,p.length):1<x.length?x.eq(s).remove():v.Utils.Dom.isBlockLevelElement(f[0])?g?f.html(g):f.empty():(f.empty(),f.addClass("preparedForRemoval"))),p=!0,0<r.children.length&&this.splitRangeObjectHelper(r.children,e,x.eq(s),j)):"none"===r.selection&&!0===p&&d(r.domobj).remove()}else a.Log.error(this,"can not split splitObject due to an empty selection tree");n.find("br.aloha-ephemera:gt(0)").remove();f.find("br.aloha-ephemera:gt(0)").remove();
n.find(".preparedForRemoval").remove();f.find(".preparedForRemoval").remove();0===n.contents().length&&(v.Utils.Dom.isSplitObject(n[0])&&g)&&n.html(g);0===f.contents().length&&(v.Utils.Dom.isSplitObject(f[0])&&g)&&f.html(g)},getSplitFollowUpContainer:function(a){var b;switch(a.splitObject.nodeName.toLowerCase()){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":if((b=d(a.splitObject).textNodes(":not(.aloha-cleanme)").last()[0])&&a.startContainer===b&&a.startOffset===b.length)return b=d("<p></p>"),
a=d(a.splitObject.outerHTML).contents(),b.append(a),b;break;case "li":if("br"===a.startContainer.nodeName.toLowerCase()&&d(a.startContainer).hasClass("aloha-ephemera"))return b=d("<p></p>"),a=d(a.splitObject.outerHTML).contents(),b.append(a),b;if(!a.splitObject.nextSibling&&0===d.trim(d(a.splitObject).text()).length)return b=d("<p></p>")}return d(a.splitObject.outerHTML)},transformDomObject:function(a,b,e){var f=d(a);b=d("<"+b+">");var j,g=f[0].cloneNode(!1).attributes;if(g)for(j=0;j<g.length;++j)("undefined"===
typeof g[j].specified||g[j].specified)&&b.attr(g[j].nodeName,g[j].nodeValue);f[0].style&&f[0].style.cssText&&(b[0].style.cssText=f[0].style.cssText);f.contents().appendTo(b);f.replaceWith(b);e&&(e.startContainer==a&&(e.startContainer=b.get(0)),e.endContainer==a&&(e.endContainer=b.get(0)));return b},toString:function(){return"Aloha.Markup"}});a.Markup=new a.Markup;return a.Markup});define("aloha/observable",["jquery"],function(a){return{_eventHandlers:null,bind:function(a,d,p){this._eventHandlers=
this._eventHandlers||{};this._eventHandlers[a]||(this._eventHandlers[a]=[]);this._eventHandlers[a].push({handler:d,scope:p||window})},unbind:function(b,d){this._eventHandlers=this._eventHandlers||{};this._eventHandlers[b]&&(this._eventHandlers[b]=d?a.grep(this._eventHandlers[b],function(a){return a.handler===d?!1:!0}):[])},trigger:function(b){this._eventHandlers=this._eventHandlers||{};if(this._eventHandlers[b]){var d=[];a.each(arguments,function(a,b){0<a&&d.push(b)});a.each(this._eventHandlers[b],
function(a,b){b.handler.apply(b.scope,d)})}},unbindAll:function(){this._eventHandlers=null}}});define("aloha/registry",["jquery","aloha/observable","util/class"],function(a,b,d){return d.extend(b,{_entries:null,_ids:null,_constructor:function(){this._entries={};this._ids=[]},register:function(a,b){this._entries[a]=b;this._ids.push(a);this.trigger("register",b,a)},unregister:function(a){var b,d=this._entries[a];delete this._entries[a];for(b in this._ids)if(this._ids.hasOwnProperty(b)&&this._ids[b]===
a){this._ids.splice(b,1);break}this.trigger("unregister",d,a)},get:function(a){return this._entries[a]},has:function(a){return this._entries[a]?!0:!1},getEntries:function(){return a.extend({},this._entries)},getIds:function(){return a.extend([],this._ids)}})});define("aloha/contenthandlermanager",["aloha/registry","util/class","aloha/console"],function(a,b,d){return new (a.extend({createHandler:function(a){if("function"!==typeof a.handleContent)throw"ContentHandler has no function handleContent().";
return new (b.extend({handleContent:function(){}},a))},handleContent:function(a,b){var s=b.contenthandler||this.getIds(),t,g;for(g=0;g<s.length&&!((t=this.get(s[g]))&&("function"===typeof t.handleContent?a=t.handleContent(a,b):d.error("A valid content handler needs the method handleContent.")),null===a);g++);return a}}))});define("util/trees",["jquery"],function(a){function b(b,d,f){var c=a.type(b),j,k,g;if("array"===c){c=f?b:[];g=j=0;for(k=b.length;g<k;g++)f=d(b[g]),f.length&&(c[j++]=f[0]);j!==c.length&&
(c=c.slice(0,j))}else if("object"===c)for(j in c=f?b:{},b)b.hasOwnProperty(j)&&(f=d(b[j]),f.length?c[j]=f[0]:delete c[j]);else c=b;return c}function d(a,d){return b(a,d,!0)}function p(a,b){var d,c,f;if(1===a.nodeType)for(c=a.firstChild;c;)d=b(c),f=c.nextSibling,d.length?d[0]!==c&&a.replaceChild(d[0],c):a.removeChild(c),c=f;return a}function r(a,b,d,c){return[d(b(c),a)]}function s(a,b,d,c){return[b(d(c,a))]}function t(a,b,d,c){return b(c)?[]:[d(c,a)]}function g(a,b,d,c){a=d(c,a);return b(a)?[]:[a]}
function f(a,b,d,c){function f(c){return a(f,b,d,c)}return f(c)[0]}function n(b){b=a.type(b);return"object"!==b&&"array"!==b}function j(a,f,j){function c(a){return n(a)?[f(a)]:[g(a,c)]}var g=j?d:b;return c(a)[0]}return{prewalk:function(a,j,g){return f(r,j,g?d:b,a)},postwalk:function(a,j,g){return f(s,j,g?d:b,a)},preprune:function(a,j,g){return f(t,j,g?d:b,a)},postprune:function(a,j,n){return f(g,j,n?d:b,a)},prewalkDom:function(a,b,d){return f(r,b,p,d?a:a.cloneNode(!0))},postwalkDom:function(a,b,d){return f(s,
b,p,d?a:a.cloneNode(!0))},prepruneDom:function(a,b,d){return f(t,b,p,d?a:a.cloneNode(!0))},postpruneDom:function(a,b,d){return f(g,b,p,d?a:a.cloneNode(!0))},isLeaf:n,leaves:j,clone:function(a){function d(a){return[b(a,d)]}return d(a)[0]},flatten:function(a){var b=[];j(a,function(a){b.push(a);return a},!0);return b},walk:b,walkInplace:d,walkDomInplace:p}});define("util/maps",[],function(){return{isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},fillTuples:function(a,b){for(var d=
b.length,p;d--;)p=b[d],a[p[0]]=p[1];return a},fillKeys:function(a,b,d){for(var p=b.length;p--;)a[b[p]]=d;return a},keys:function(a){var b=[],d;for(d in a)a.hasOwnProperty(d)&&b.push(d);return b}}});define("util/browser",["jquery"],function(a){return{ie7:a.browser.msie&&8>parseInt(a.browser.version,10)}});define("util/dom2",["jquery","util/maps","util/strings","util/browser"],function(a,b,d,p){function r(a){var b=[];a=a.cloneNode(!1).outerHTML;for(var d;null!=(d=t.exec(a));)b.push(d[1]);return b}function s(a,
b){var n={},j,e,r,p,c,u,k;u=0;for(c=a.length;u<c;u++)if(r=a[u],r.className){e=d.words(r.className);for(k=0;k<e.length;k++)p=e[k],b[p]&&((j=n[p])?j.push(r):n[p]=[r])}return n}var t=/\s([^\/<>\s=]+)(?:=(?:"[^"]*"|'[^']*'|[^>\/\s]+))?/g;return{moveNextAll:function(a,b,d){for(;b;){var j=b.nextSibling;a.insertBefore(b,d);b=j}},attrNames:r,attrs:function(b){var d=[],n=r(b),j,e;j=0;for(e=n.length;j<e;j++){var p=n[j],s=a.attr(b,p),s=null==s?"":s.toString();d.push([p,s])}return d},indexByClass:function(d,
f){var n;n=p.ie7?d.getElementsByTagName("*"):a(d).find("."+b.keys(f).join(",."));return s(n,f)},indexByName:function(b,d){var n,j={},e;n=0;for(e=d.length;n<e;n++){var p=d[n];j[p]=a.makeArray(b.getElementsByTagName(p))}return j},indexByClassHaveList:s}});define("util/functions",[],function(){return{identity:function(a){return a}}});define("util/misc",[],function(){return{anyRx:function(a,b){var d,p;d=0;for(p=a.length;d<p;d++)if(a[d].test(b))return!0;return!1}}});define("aloha/ephemera","jquery aloha/core aloha/console util/strings util/trees util/arrays util/maps util/dom2 util/functions util/misc PubSub".split(" "),
function(a,b,d,p,r,s,t,g,f,n,j){function e(a,b,e,d){return(e=e[b])&&(!0===e||-1!==s.indexOf(e,a.nodeName))?!0:n.anyRx(d,b)}var v={classMap:{"aloha-ephemera-wrapper":!0,"aloha-ephemera-filler":!0,"aloha-ephemera-attr":!0,"aloha-ephemera":!0,"aloha-cleanme":!0},attrMap:{hidefocus:!0,hideFocus:!0,tabindex:!0,tabIndex:!0,contenteditable:["TABLE"],contentEditable:["TABLE"]},attrRxs:[/^(?:nodeIndex|sizcache|sizset|jquery)[\w\d]*$/i],pruneFns:[]},x="aloha-";return{ephemera:function(a){a&&(v=a);j.pub("aloha.ephemera",
{ephemera:v});return v},classes:function(){var a=Array.prototype.slice.call(arguments);t.fillKeys(v.classMap,a,!0);var b=a,e,f;e=0;for(f=b.length;e<f;e++)-1===b[e].indexOf(x)&&(d.warn('Class "'+b[e]+'" was set to be ephemeral,which hurts peformance. Add the common substring "'+x+'" to the class to fix this problem.'),x="");j.pub("aloha.ephemera.classes",{ephemera:v,newClasses:a})},attributes:function(){var a=Array.prototype.slice.call(arguments);t.fillKeys(v.attrMap,a,!0);j.pub("aloha.ephemera.attributes",
{ephemera:v,newAttributes:a})},markElement:function(b){a(b).addClass("aloha-ephemera")},markAttr:function(b,e){b=a(b);var d=b.attr("data-aloha-ephemera-attr");null==d||""===d?d=e:-1===s.indexOf(p.words(d),e)&&(d+=" "+e);b.attr("data-aloha-ephemera-attr",d);b.addClass("aloha-ephemera-attr")},markWrapper:function(b){a(b).addClass("aloha-ephemera-wrapper")},markFiller:function(b){a(b).addClass("aloha-ephemera-filler")},prune:function(b,d){function f(b){var c;a:{var j=d;c=f;if(1===b.nodeType){var n;b:{n=
b;var v=n.className;if(v&&-1!==v.indexOf(x)){v=p.words(v);if(-1!==s.indexOf(v,"aloha-cleanme")||-1!==s.indexOf(v,"aloha-ephemera")){a.removeData(n);n=!1;break b}if(-1!==s.indexOf(v,"aloha-ephemera-wrapper")||-1!==s.indexOf(v,"aloha-ephemera-filler")){g.moveNextAll(n.parentNode,n.firstChild,n.nextSibling);a.removeData(n);n=!1;break b}if(-1!==s.indexOf(v,"aloha-ephemera-attr")){var t=a(n),J=t.attr("data-aloha-ephemera-attr"),N;t.removeAttr("data-aloha-ephemera-attr");if("string"===typeof J){N=p.words(J);
for(J=0;J<N.length;J++)t.removeAttr(N[J])}}t=s.filter(v,function(a){return!j.classMap[a]});t.length!==v.length&&(0===t.length?a(n).removeAttr("class"):n.className=t.join(" "))}var v=null,t=g.attrNames(n),W;N=0;for(W=t.length;N<W;N++)J=t[N],e(n,J,j.attrMap,j.attrRxs)&&(v=v||a(n),v.removeAttr(J));n=!0}if(!n){c=[];break a}b=r.walkDomInplace(b,c)}c=(b=s.reduce(j.pruneFns,b,s.applyNotNull))?[b]:[]}return c}d=d||v;return f(b)[0]},isAttrEphemeral:e}});define("aloha/editable","aloha/core util/class jquery aloha/pluginmanager aloha/selection aloha/markup aloha/contenthandlermanager aloha/console aloha/block-jump aloha/ephemera util/dom2".split(" "),
function(a,b,d,p,r,s,t,g,f,n){var j=window.unescape,e=window.GENTICS,v=!1,x={};a.defaults.contentHandler={};a.defaults.contentHandler.initEditable=["blockelement","sanitize"];a.defaults.contentHandler.getContents=["blockelement","sanitize","basic"];"undefined"===typeof a.settings.contentHandler&&(a.settings.contentHandler={});var c=function(a){return d(a).html()};a.Editable=b.extend({_constructor:function(b){b.attr("id")||b.attr("id",e.Utils.guid());this.originalObj=this.obj=b;this.ready=!1;this.sccDelimiters=
[":",";",".","!","?",",",j("%u0009"),j("%u0020"),j("%u0008"),j("%u007F"),"Enter"];this.sccIdle=5E3;this.sccDelay=500;this.sccTimerDelay=this.sccTimerIdle=!1;this.keyCodeMap={93:"Apps",18:"Alt",20:"CapsLock",17:"Control",40:"Down",35:"End",13:"Enter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",36:"Home",45:"Insert",37:"Left",224:"Meta",34:"PageDown",33:"PageUp",19:"Pause",44:"PrintScreen",39:"Right",145:"Scroll",16:"Shift",38:"Up",
91:"Win",92:"Win"};this.placeholderClass="aloha-placeholder";a.registerEditable(this)},init:function(){var b=this;if((this.settings=a.settings)&&a.settings.smartContentChange)a.settings.smartContentChange.delimiters&&(this.sccDelimiters=a.settings.smartContentChange.delimiters),a.settings.smartContentChange.idle&&(this.sccIdle=a.settings.smartContentChange.idle),a.settings.smartContentChange.delay&&(this.sccDelay=a.settings.smartContentChange.delay);if(this.check(this.obj)){"undefined"===typeof a.settings.contentHandler.getContents&&
(a.settings.contentHandler.getContents=a.defaults.contentHandler.getContents);"undefined"===typeof a.settings.contentHandler.initEditable&&(a.settings.contentHandler.initEditable=a.defaults.contentHandler.initEditable);var c=b.obj.html(),c=t.handleContent(c,{contenthandler:a.settings.contentHandler.initEditable,command:"initEditable"});b.obj.html(c);a.bind("aloha-ready",function(){b.obj.addClass("aloha-editable").contentEditable(!0);b.obj.mousedown(function(c){if(!a.eventHandled)return a.eventHandled=
!0,b.activate(c)});b.obj.mouseup(function(){a.eventHandled=!1});b.obj.focus(function(a){return b.activate(a)});b.obj.add(".aloha-block",b.obj).keydown(function(a){var c=s.preProcessKeyStrokes(a);b.keyCode=a.which;c||b.smartContentChange(a);return c});b.obj.keypress(function(b){a.activeEditable.smartContentChange(b)});b.obj.keyup(function(b){if(27===b.keyCode)return a.deactivateEditable(),!1});b.obj.contentEditableSelectionChange(function(a){r.onChange(b.obj,a);return b.obj});b.setUnmodified();b.snapshotContent=
b.getContents();d.browser.mozilla&&b.initEmptyEditable();b.initPlaceholder();b.ready=!0;window.setTimeout(function(){a.disableObjectResizing()},20);a.trigger("aloha-editable-created",[b])})}else this.destroy()},isActive:!1,originalContent:null,range:void 0,check:function(){var a=this,b=this.obj,c=b.get(0).nodeName.toLowerCase(),e="a abbr address article aside b bdo blockquote cite code command del details dfn div dl em footer h1 h2 h3 h4 h5 h6 header i ins menu nav p pre q ruby section small span strong sub sup var".split(" "),
f;for(f=0;f<e.length;++f)if(c===e[f])return!0;switch(c){case "textarea":case "input":return c=d('<div id="'+this.getId()+'-aloha" class="aloha-'+c+'" />').insertAfter(b),c.height(b.height()).width(b.width()).html(b.val()),b.hide(),b.parents("form:first").submit(function(){b.val(a.getContents())}),this.obj=c,!0}return!1},initPlaceholder:function(){a.settings.placeholder&&this.isEmpty()&&this.addPlaceholder()},isEmpty:function(){var a=d.trim(this.getContents());return 0===a.length||("<br>"===a?!0:!1)},
initEmptyEditable:function(){var a=this.obj;this.empty(this.getContents())&&d(a).prepend('<br class="aloha-cleanme" />')},addPlaceholder:function(){var b=d("<div>"),c=d("<span>"),f,j=this.obj;f=e.Utils.Dom.allowsNesting(j[0],b[0])?b:c;0===d("."+this.placeholderClass,j).length&&(d(j).append(f.addClass(this.placeholderClass)),d.each(a.settings.placeholder,function(a,b){j.is(a)&&f.html(b)}),d("br",j).remove())},removePlaceholder:function(a,b){var c=this.placeholderClass,e;0!==d("."+this.placeholderClass,
a).length&&(!0===b?window.setTimeout(function(){e=new r.SelectionRange;e.startContainer=e.endContainer=a.get(0);e.startOffset=e.endOffset=0;d("."+c,a).remove();e.select()},100):d("."+c,a).remove())},destroy:function(){this===a.getActiveEditable()&&this.blur();switch(this.originalObj.get(0).nodeName.toLowerCase()){case "textarea":case "input":this.originalObj.val(this.getContents()),this.obj.remove(),this.originalObj.show()}this.ready=!1;this.removePlaceholder(this.obj);this.obj.removeClass("aloha-editable").contentEditable(!1).unbind("mousedown click dblclick focus keydown keypress keyup");
a.trigger("aloha-editable-destroyed",[this]);a.unregisterEditable(this)},setUnmodified:function(){this.originalContent=this.getContents()},isModified:function(){return this.originalContent!==this.getContents()},toString:function(){return"Aloha.Editable"},isDisabled:function(){return!this.obj.contentEditable()||"false"===this.obj.contentEditable()},disable:function(){return this.isDisabled()||this.obj.contentEditable(!1)},enable:function(){return this.isDisabled()&&this.obj.contentEditable(!0)},activate:function(b){var c=
a.getActiveEditable();if(v)v=!1;else if((!b||!("focus"===b.type&&null!==c&&c.obj.parent().get(0)===b.currentTarget))&&!this.isActive&&!this.isDisabled())this.obj.addClass("aloha-editable-active"),a.activateEditable(this),v=!0,this.removePlaceholder(this.obj,!0),v=!1,this.isActive=!0,a.trigger("aloha-editable-activated",{oldActive:c,editable:this})},blur:function(){this.obj.blur();this.isActive=!1;this.initPlaceholder();this.obj.removeClass("aloha-editable-active");a.trigger("aloha-editable-deactivated",
{editable:this});a.activeEditable.smartContentChange({type:"blur"},null)},empty:function(a){return null===a||""===d.trim(a)||"<br/>"===a},getContents:function(b){var e=this.obj.html(),j=x[this.getId()];if(!j||e!==j.raw){f.removeZeroWidthTextNodeFix();var g=this.obj.clone(!1);this.removePlaceholder(g);g=d(n.prune(g[0]));p.makeClean(g);g=d("<div>"+t.handleContent(g.html(),{contenthandler:a.settings.contentHandler.getContents,command:"getContents"})+"</div>");j=x[this.getId()]={};j.raw=e;j.element=g}if(b)return j.element.clone().contents();
null==j.serialized&&(j.serialized=c(j.element[0]));return j.serialized},setContents:function(b,e){var d=null;a.getActiveEditable()===this&&(a.deactivateEditable(),d=this);this.obj.html(b);null!==d&&d.activate();this.smartContentChange({type:"set-contents"});return e?this.obj.contents():c(this.obj[0])},getId:function(){return this.obj.attr("id")},smartContentChange:function(b){function c(){null==n&&(n=e.getSnapshotContent());return n}var e=this,f=null,j;if(b&&(b.metaKey||b.crtlKey||b.altKey))return!1;
b&&b.originalEvent&&(j=/U\+(\w{4})/,j.exec(b.originalEvent.keyIdentifier),f=this.keyCodeMap[this.keyCode]||String.fromCharCode(b.which)||"unknown");var n=null;0<=d.inArray(f,this.sccDelimiters)?(clearTimeout(this.sccTimerIdle),clearTimeout(this.sccTimerDelay),this.sccTimerDelay=window.setTimeout(function(){a.trigger("aloha-smart-content-changed",{editable:e,keyIdentifier:b.originalEvent.keyIdentifier,keyCode:b.keyCode,"char":f,triggerType:"keypress",getSnapshotContent:c});g.debug("Aloha.Editable",
"smartContentChanged: event type keypress triggered")},this.sccDelay)):b&&"paste"===b.type?a.trigger("aloha-smart-content-changed",{editable:e,keyIdentifier:null,keyCode:null,"char":null,triggerType:"paste",getSnapshotContent:c}):b&&"blur"===b.type?a.trigger("aloha-smart-content-changed",{editable:e,keyIdentifier:null,keyCode:null,"char":null,triggerType:"blur",getSnapshotContent:c}):b&&"block-change"===b.type?a.trigger("aloha-smart-content-changed",{editable:e,keyIdentifier:null,keyCode:null,"char":null,
triggerType:"block-change",getSnapshotContent:c}):null!==f&&(clearTimeout(this.sccTimerDelay),clearTimeout(this.sccTimerIdle),this.sccTimerIdle=window.setTimeout(function(){a.trigger("aloha-smart-content-changed",{editable:e,keyIdentifier:null,keyCode:null,"char":null,triggerType:"idle",getSnapshotContent:c})},this.sccIdle))},getSnapshotContent:function(){var a=this.snapshotContent;this.snapshotContent=this.getContents();return a}});a.Editable.setContentSerializer=function(a){c=a};a.Editable.getContentSerializer=
function(){return c}});define("aloha/plugin",["aloha/core","jquery","util/class","aloha/pluginmanager","aloha/console"],function(a,b,d,p,r){var s=d.extend({name:null,defaults:{},settings:{},dependencies:[],_constructor:function(a){"string"!==typeof a?r.error("Cannot initialise unnamed plugin, skipping"):this.name=a},checkDependencies:function(){var d=!0,g=this;b.each(this.dependencies,function(){a.isPluginLoaded(this)||(d=!1,r.error("plugin."+g.name,'Required plugin "'+this+'" not found.'))});return d},
init:function(){},getEditableConfig:function(a){var d=null,f=!1,n=this;this.settings.editables&&b.each(this.settings.editables,function(j,e){var p;if(a.is(j))if(f=!0,e instanceof Array)d=[],d=b.merge(d,e);else if("object"===typeof e)for(p in d={},d["aloha-editable-selector"]=j,e)e.hasOwnProperty(p)&&(e[p]instanceof Array?d[p]=e[p]:"object"===typeof e[p]?(d[p]={},d[p]=b.extend(!0,d[p],n.config[p],e[p])):d[p]=e[p]);else d=e});f||(d="undefined"===typeof this.settings.config||!this.settings.config?this.config:
this.settings.config);return d},makeClean:function(){},getUID:function(){r.deprecated("plugin","getUID() is deprecated. Use plugin.name instead.");return this.name},toString:function(){return this.name},log:function(a,b){r.deprecated("plugin","log() is deprecated. Use Aloha.console instead.");r.log(a,this,b)}});s.create=function(d,g){var f=new (s.extend(g))(d);f.settings=b.extendObjects(!0,f.defaults,a.settings[d]);p.register(f);return f};return s});define("aloha/command",["aloha/core","aloha/registry",
"aloha/engine","util/dom","aloha/contenthandlermanager"],function(a,b,d,p,r){var s={execCommand:function(b,g,f,n){var j={commandId:b,preventDefault:!1};a.trigger("aloha-command-will-execute",j);if(!0!==j.preventDefault){if(!n){if(!a.getSelection().getRangeCount())return;n=a.getSelection().getRangeAt(0)}"inserthtml"===b.toLowerCase()&&(f=r.handleContent(f,{contenthandler:a.settings.contentHandler.insertHtml,command:"insertHtml"}));d.execCommand(b,g,f,n);a.getSelection().getRangeCount()&&(n=a.getSelection().getRangeAt(0),
g=n.commonAncestorContainer,g.parentNode&&(g=g.parentNode),f=new window.GENTICS.Utils.RangeObject,f.startContainer=n.startContainer,f.startOffset=n.startOffset,f.endContainer=n.endContainer,f.endOffset=n.endOffset,p.doCleanup({merge:!0,removeempty:!1},f,g),f.select());a.trigger("aloha-command-executed",b)}},queryCommandEnabled:function(b,g){if(!g){if(!a.getSelection().getRangeCount())return;g=a.getSelection().getRangeAt(0)}return d.queryCommandEnabled(b,g)},queryCommandIndeterm:function(b,g){if(!g){if(!a.getSelection().getRangeCount())return;
g=a.getSelection().getRangeAt(0)}return d.queryCommandIndeterm(b,g)},queryCommandState:function(b,g){if(!g){if(!a.getSelection().getRangeCount())return;g=a.getSelection().getRangeAt(0)}return d.queryCommandState(b,g)},queryCommandSupported:function(a){return d.queryCommandSupported(a)},queryCommandValue:function(b,g){if(!g){if(!a.getSelection().getRangeCount())return;g=a.getSelection().getRangeAt(0)}return d.queryCommandValue(b,g)},querySupportedCommands:function(){var a=[],b;for(b in d.commands)d.commands.hasOwnProperty(b)&&
a.push(b);return a}},s=new (b.extend(s));a.execCommand=s.execCommand;a.queryCommandEnabled=s.queryCommandEnabled;a.queryCommandIndeterm=s.queryCommandIndeterm;a.queryCommandState=s.queryCommandState;a.queryCommandSupported=s.queryCommandSupported;a.queryCommandValue=s.queryCommandValue;a.querySupportedCommands=s.querySupportedCommands;return s});define("aloha/jquery.aloha",["aloha/core","aloha/selection","jquery","aloha/console"],function(a,b,d,p){function r(a,b,d,j){if(!(b!==j.target&&(/textarea|input|select/i.test(j.target.nodeName)||
"text"===j.target.type)))return a.apply(b,d)}function s(a){var b,n,j,e;if("string"===typeof a.data){b=a.handler;n=a.data.toLowerCase().split(" ");j={};for(e=0;e<n.length;e++)j[n[e]]=!0;a.handler=function(a){if(this===a.target){var e="keypress"!==a.type&&d.hotkeys.specialKeys[a.which],c="";a.altKey&&"alt"!==e&&(c+="alt+");a.ctrlKey&&"ctrl"!==e&&(c+="ctrl+");a.metaKey&&(!a.ctrlKey&&"meta"!==e)&&(c+="meta+");a.shiftKey&&"shift"!==e&&(c+="shift+");if(e){if(j[c+e])return r(b,this,arguments,a)}else if(e=
String.fromCharCode(a.which).toLowerCase(),j[c+e]||j[c+d.hotkeys.shiftNums[e]]||"shift+"===c&&j[d.hotkeys.shiftNums[e]])return r(b,this,arguments,a)}}}}var t=window.XMLSerializer;d.fn.between=function(a,b){var d;3!==this[0].nodeType?(d=this.children().size(),b>d&&(b=d),0>=b?this.prepend(a):this.children().eq(b-1).after(a)):0>=b?this.before(a):(b>=this[0].length||(d=this[0].data,this[0].data=d.substring(0,b),this.after(d.substring(b,d.length))),this.after(a))};d.fn.contentEditable=function(a){var b=
d(this),n="contenteditable";d.browser.msie&&7==parseInt(d.browser.version,10)&&(n="contentEditable");if("undefined"===typeof a){if("undefined"===typeof b[0]){p.warn("The jquery object did not contain any valid elements.");return}return"undefined"===typeof b[0].isContentEditable?(p.warn("Could not determine whether the is editable or not. I assume it is."),!0):b[0].isContentEditable}""===a?b.removeAttr(n):b.attr(n,a&&"false"!==a?"true":"false");return b};d.fn.aloha=function(){var b=d(this);a.bind("aloha-ready",
function(){b.each(function(){a.isEditable(this)||(new a.Editable(d(this))).init()})});return b};d.fn.mahalo=function(){return this.each(function(){a.isEditable(this)&&a.getEditableById(d(this).attr("id")).destroy()})};d.fn.contentEditableSelectionChange=function(a){var f=this;this.keyup(function(d){b.getRangeObject();a(d)});this.dblclick(function(b){a(b)});this.mousedown(function(){f.selectionStarted=!0});d(document).mouseup(function(d){b.eventOriginalTarget=f;f.selectionStarted&&a(d);b.eventOriginalTarget=
!1;f.selectionStarted=!1});return this};d.fn.outerHtml=d.fn.outerHtml||function(){var a=d(this).get(0);if("undefined"!=typeof a.outerHTML)return a.outerHTML;try{return(new t).serializeToString(a)}catch(b){try{return a.xml}catch(n){}}};d.fn.zap=function(){return this.each(function(){d(this.childNodes).insertBefore(this)}).remove()};d.fn.textNodes=function(a,b){var n=[],j=function(e){var p,r;if(3===e.nodeType&&d.trim(e.data)&&!b||3===e.nodeType&&b||"BR"==e.nodeName&&!a)n.push(e);else{p=0;for(r=e.childNodes.length;p<
r;++p)j(e.childNodes[p])}};j(this[0]);return d(n)};d.extendObjects=d.fn.extendObjects=function(a,b){var n,j,e,p,r;n=1;var c=a||{},s=arguments.length,k=!1,t;"boolean"===typeof c&&(k=c,c=b||{},n=2);"object"!==typeof c&&!d.isFunction(c)&&(c={});s===n&&(c=this,--n);for(t=n;t<s;t++)if(null!=(n=arguments[t]))for(j in n)n.hasOwnProperty(j)&&(e=c[j],p=n[j],c!==p&&(k&&p&&(d.isPlainObject(p)||!0===(r=d.isArray(p)))?(r?(r=!1,e=e&&d.isArray(e)?e:[]):e=e&&d.isPlainObject(e)?e:{},c[j]=d.isArray(p)?p:d.extendObjects(k,
e,p)):void 0!==p&&(c[j]=p)));return c};d.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",
123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};d.each(["keydown","keyup","keypress"],function(){d.event.special[this]={add:s}})});define("aloha/sidebar",["aloha/core","jquery","aloha/selection","PubSub"],function(a,b,d,p){var r=+new Date;b.easing.easeOutExpo||b.extend(b.easing,{easeOutExpo:function(a,b,d,f,c){return b==c?d+f:
f*(-Math.pow(2,-10*b/c)+1)+d},easeOutElastic:function(a,b,d,f,c){a=Math;var g=1.70158,k=0,n=f;if(!b)return d;if(1==(b/=c))return d+f;k||(k=0.3*c);n<a.abs(f)?(n=f,g=k/4):g=k/(2*a.PI)*a.asin(f/n);return n*a.pow(2,-10*b)*a.sin((b*c-g)*2*a.PI/k)+f+d}});var s=function(a){this.id=null;this.folds={};this.button=null;this.title=b('<div class="aloha-sidebar-panel-title"><span class="aloha-sidebar-panel-title-arrow"></span><span class="aloha-sidebar-panel-title-text">Untitled</span></div>');this.content=b('<div class="aloha-sidebar-panel-content"><div class="aloha-sidebar-panel-content-inner"><div class="aloha-sidebar-panel-content-inner-text"></div></div></div>');
this.effectiveElement=this.element=null;this.expanded=!1;this.isActive=!0;this.init(a)},t=function(d){var e=this;this.id="aloha-sidebar-"+ ++r;this.panels={};this.container=b('<div class="aloha-ui aloha-sidebar-bar"><div class="aloha-sidebar-handle"><span class="aloha-sidebar-handle-icon"></span></div><div class="aloha-sidebar-inner"><ul class="aloha-sidebar-panels"></ul></div></div>');this.width=300;this.isCompletelyOpen=this.isOpen=this.opened=!1;this.settings={rotateIcons:!b.browser.msie,overlayPage:!0};
b(function(){"undefined"!==typeof a.settings.sidebar&&a.settings.sidebar.disabled||e.init(d)})},g=null,f=null;b.extend(t.prototype,{init:function(a){var e=this,d;"object"===typeof a&&(d=a.panels,delete a.panels);b.extend(this,a);"object"===typeof d&&b.each(d,function(){e.addPanel(this,!0)});a=this.container;"right"===this.position&&a.addClass("aloha-sidebar-right");a.hide().appendTo(b("body")).click(function(){e.barClicked.apply(e,arguments)}).find(".aloha-sidebar-panels").width(this.width);a.width(this.width);
this.width=a.width();this.updateHeight();this.initToggler();this.container.css("right"===this.position?"marginRight":"marginLeft",-this.width);this.opened&&this.open(0);this.toggleHandleIcon(this.isOpen);this.subscribeToEvents();b(window).resize(function(){e.updateHeight();e.correctHeight()});this.correctHeight()},show:function(){this.container.css("display","block");return this},hide:function(){this.container.css("display","none");return this},checkActivePanels:function(a){var e=[];if("undefined"!==
typeof a&&"undefined"!==typeof a.markupEffectiveAtStart){var d=a.markupEffectiveAtStart.length,f;for(f=0;f<d;++f)e.push(b(a.markupEffectiveAtStart[f]))}var c=this;b.each(this.panels,function(){c.showActivePanel(this,e)});this.correctHeight()},subscribeToEvents:function(){var b=this;p.sub("aloha.selection.context-change",function(a){b.isOpen&&b.checkActivePanels(a.range);b.lastRange=a.range});a.bind("aloha-editable-deactivated",function(){b.isOpen&&b.checkActivePanels();b.lastRange=null});this.container.mousedown(function(b){b.originalEvent.stopSelectionUpdate=
!0;a.eventHandled=!0});this.container.mouseup(function(b){b.originalEvent.stopSelectionUpdate=!0;a.eventHandled=!1})},correctHeight:function(){if(this.isOpen)if(this.isCompletelyOpen){var a=b(window).height(),e=[],d=[],n;for(n in this.panels)this.panels.hasOwnProperty(n)&&this.panels[n].isActive&&(d.push(this.panels[n]),e.push(n));if(0!==d.length&&(e=e.sort().join(","),!(f===e&&g===a))){g=a;f=e;for(var a=this.container.find(".aloha-sidebar-inner").height()-(d[0].title.outerHeight()+10)*d.length,c,
p,k,r=0,s=Math,t;0<d.length&&0<a;){a+=r;r=0;k=[];for(t=d.length-1;0<=t;--t)e=d[t],c=e.content.find(".aloha-sidebar-panel-content-inner"),n=s.min(c.height("auto").height(),s.floor(a/(t+1))),c.height(n),a-=n,p=c.find(".aloha-sidebar-panel-content-inner-text"),p.height()>n?(k.push(e),r+=n,c.css({"overflow-x":"hidden","overflow-y":"scroll"})):c.css("overflow-y","hidden"),e.expanded&&e.expand();d=k}}}else this.correctHeightWhenCompletelyOpen=!0},showActivePanel:function(a,e){e.push(null);a.content.parent("li");
var d=a.activeOn,f=b(),c=0,g=e.length,k;for(k=0;k<g;++k)d(e[k])&&(++c,e[k]&&b.merge(f,e[k]));c?a.activate(f):a.deactivate()},initToggler:function(){var d=this,e=this.container,f=e.find(".aloha-sidebar-handle-icon"),g,c="right"===this.position;this.opened&&this.rotateHandleArrow(c?0:180,0);b(function(){"undefined"!==typeof a.settings.sidebar&&(a.settings.sidebar.handle&&a.settings.sidebar.handle.top)&&(b(e.find(".aloha-sidebar-handle"))[0].style.top=a.settings.sidebar.handle.top)});e.find(".aloha-sidebar-handle").click(function(){g&&
clearInterval(g);f.stop().css("marginLeft",4);d.isOpen?(b(this).removeClass("aloha-sidebar-toggled"),d.close(),d.isOpen=!1):(b(this).addClass("aloha-sidebar-toggled"),d.open(),d.isOpen=!0)}).hover(function(){var a=d.isOpen?-1:1;g&&clearInterval(g);f.stop();b(this).stop().animate(c?{marginLeft:"-="+5*a}:{marginRight:"-="+5*a},200);g=setInterval(function(){a*=-1;f.animate(c?{left:"-="+4*a}:{right:"-="+4*a},300)},300)},function(){g&&clearInterval(g);f.stop().css(c?"left":"right",5);b(this).stop().animate(c?
{marginLeft:0}:{marginRight:0},600,"easeOutElastic")})},roundCorners:function(){var a=this.container,b=a.find(".aloha-sidebar-panels>li:not(.aloha-sidebar-deactivated)");a.find(".aloha-sidebar-panel-top, .aloha-sidebar-panel-bottom").removeClass("aloha-sidebar-panel-top").removeClass("aloha-sidebar-panel-bottom");b.first().find(".aloha-sidebar-panel-title").addClass("aloha-sidebar-panel-top");b.last().find(".aloha-sidebar-panel-content").addClass("aloha-sidebar-panel-bottom")},updateHeight:function(){var a=
b(window).height();this.container.height(a).find(".aloha-sidebar-inner").height(a)},barClicked:function(a){this.handleBarclick(b(a.target))},handleBarclick:function(a){a.hasClass("aloha-sidebar-panel-title")?this.togglePanel(a):!a.hasClass("aloha-sidebar-panel-content")&&(!a.hasClass("aloha-sidebar-handle")&&!a.hasClass("aloha-sidebar-bar"))&&this.handleBarclick(a.parent())},getPanelById:function(a){return this.panels[a]},getPanelByElement:function(a){a="LI"===a[0].tagName?a:a.parent("li");return this.getPanelById(a[0].id)},
togglePanel:function(a){this.getPanelByElement(a).toggle()},rotateHandleIcon:function(a,b){var d=this.container.find(".aloha-sidebar-handle-icon");d.animate({angle:a},{duration:"number"===typeof b||"string"===typeof b?b:500,easing:"easeOutExpo",step:function(a){d.css({"-o-transform":"rotate("+a+"deg)","-webkit-transform":"rotate("+a+"deg)","-moz-transform":"rotate("+a+"deg)","-ms-transform":"rotate("+a+"deg)"})}})},toggleHandleIcon:function(a){a^="right"===this.position;if(this.settings.rotateIcons)this.rotateHandleIcon(a?
180:0,0);else{var b=this.container.find(".aloha-sidebar-handle-icon");a?b.addClass("aloha-sidebar-handle-icon-left"):b.removeClass("aloha-sidebar-handle-icon-left")}},open:function(a){if(this.isOpen)return this;var e="right"===this.position,d=e?{marginRight:0}:{marginLeft:0},f=this;this.toggleHandleIcon(!0);this.container.animate(d,"number"===typeof a||"string"===typeof a?a:500,"easeOutExpo");this.settings.overlayPage||b("body").animate(e?{marginRight:"+="+this.width}:{marginLeft:"+="+this.width},
500,"easeOutExpo",function(){f.isCompletelyOpen=!0;f.correctHeightWhenCompletelyOpen&&f.correctHeight()});this.isOpen=!0;this.correctHeight();this.lastRange&&this.checkActivePanels(this.lastRange);b("body").trigger("aloha-sidebar-opened",this);return this},close:function(a){if(!this.isOpen)return this;var e="right"===this.position,d=e?{marginRight:-this.width}:{marginLeft:-this.width};this.toggleHandleIcon(!1);this.container.animate(d,"number"===typeof a||"string"===typeof a?a:500,"easeOutExpo");
this.settings.overlayPage||b("body").animate(e?{marginRight:"-="+this.width}:{marginLeft:"-="+this.width},500,"easeOutExpo");this.isCompletelyOpen=this.isOpen=!1;return this},activatePanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.activate(b);this.roundCorners();return this},expandPanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.expand(b);return this},collapsePanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.collapse(b);return this},
addPanel:function(a){a instanceof s||(a.width||(a.width=this.width),a.sidebar=this,a=new s(a));this.panels[a.id]=a;this.container.find(".aloha-sidebar-panels").append(a.element);this.checkActivePanels(d.getRangeObject());return a}});b.extend(s.prototype,{init:function(a){this.setTitle(a.title).setContent(a.content);delete a.title;delete a.content;b.extend(this,a);this.id||(this.id="aloha-sidebar-"+ ++r);this.element=b('<li id="'+this.id+'">').append(this.title,this.content);this.expanded&&this.content.height("auto");
this.toggleTitleIcon(this.expanded);this.coerceActiveOn();this.title.attr("unselectable","on").css("-moz-user-select","none").each(function(){this.onselectstart=function(){return!1}});"function"===typeof this.onInit&&this.onInit.apply(this)},toggleTitleIcon:function(a){if(this.sidebar.settings.rotateIcons)this.rotateTitleIcon(a?90:0);else{var b=this.title.find(".aloha-sidebar-panel-title-arrow");a?b.addClass("aloha-sidebar-panel-title-arrow-down"):b.removeClass("aloha-sidebar-panel-title-arrow-down")}},
coerceActiveOn:function(){if("function"!==typeof this.activeOn){var a=this.activeOn,b=typeof a;this.activeOn="boolean"===b?function(){return a}:"undefined"===b?function(){return!0}:"string"===b?function(b){return b?b.is(a):!1}:function(){return!1}}},activate:function(a){this.isActive=!0;this.content.parent("li").show().removeClass("aloha-sidebar-deactivated");this.effectiveElement=a;"function"===typeof this.onActivate&&this.onActivate.call(this,a)},deactivate:function(){this.isActive&&(this.isActive=
!1,this.content.parent("li").hide().addClass("aloha-sidebar-deactivated"),this.effectiveElement=null)},toggle:function(){this.expanded?this.collapse():this.expand()},expand:function(a){var b=this,d=this.content,f=d.height(),c=d.height("auto").height();d.height(f).stop().animate({height:c},500,"easeOutExpo",function(){"function"===typeof a&&a.call(b)});this.element.removeClass("collapsed");this.toggleTitleIcon(!0);this.expanded=!0;return this},collapse:function(a,b){var d=this;this.element.addClass("collapsed");
this.content.stop().animate({height:5},250,"easeOutExpo",function(){"function"===typeof b&&b.call(d)});this.toggleTitleIcon(!1);this.expanded=!1;return this},setTitle:function(a){this.title.find(".aloha-sidebar-panel-title-text").html(a);return this},setContent:function(a){if(!a||""===a)a="&nbsp;";this.content.find(".aloha-sidebar-panel-content-inner-text").html(a);return this},rotateTitleIcon:function(a,b){var d=this.title.find(".aloha-sidebar-panel-title-arrow");d.animate({angle:a},{duration:"number"===
typeof b?b:500,easing:"easeOutExpo",step:function(a){d.css({"-o-transform":"rotate("+a+"deg)","-webkit-transform":"rotate("+a+"deg)","-moz-transform":"rotate("+a+"deg)","-ms-transform":"rotate("+a+"deg)"})}})},renderEffectiveParents:function(a,e){for(var d=a.first(),f=[],c=[],g=this.activeOn,k,n;0<d.length&&!d.is(".aloha-editable");){if(g(d)){c.push("<span>"+d[0].tagName.toLowerCase()+"</span>");k=c.length;for(n=[];k--;)n.push(c[k]);f.push('<div class="aloha-sidebar-panel-parent"><div class="aloha-sidebar-panel-parent-path">'+
n.join("")+'</div><div class="aloha-sidebar-panel-parent-contentaloha-sidebar-opened">'+("function"===typeof e?e(d):"----")+"</div></div>")}d=d.parent()}this.setContent(f.join(""));b(".aloha-sidebar-panel-parent-path").click(function(){var a=b(this).parent().find(".aloha-sidebar-panel-parent-content");a.hasClass("aloha-sidebar-opened")?a.hide().removeClass("aloha-sidebar-opened"):a.show().addClass("aloha-sidebar-opened")});this.content.height("auto").find(".aloha-sidebar-panel-content-inner").height("auto")}});
var n=new t({position:"left",width:250}),t=new t({position:"right",width:250});a.Sidebar={left:n,right:t};return a.Sidebar});window.GENTICS=window.GENTICS||{};window.GENTICS.Utils=window.GENTICS.Utils||{};define("util/position",["jquery"],function(a){var b=window.GENTICS;b.Utils.Position={};b.Utils.Position.w=a(window);b.Utils.Position.Scroll={top:0,left:0,isScrolling:!1};b.Utils.Position.ScrollCorrection={top:100,left:50};b.Utils.Position.Mouse={x:0,y:0,oldX:0,oldY:0,isMoving:!1,triggeredMouseStop:!0};
b.Utils.Position.mouseStopCallbacks=[];b.Utils.Position.mouseMoveCallbacks=[];b.Utils.Position.update=function(){var a=this.w.scrollTop(),b=this.w.scrollLeft();if(this.Scroll.isScrolling)this.Scroll.top==a&&this.Scroll.left==b&&(this.Scroll.isScrolling=!1);else if(this.Scroll.top!=a||this.Scroll.left!=b)this.Scroll.isScrolling=!0;this.Scroll.top=a;this.Scroll.left=b;if(this.Mouse.x==this.Mouse.oldX&&this.Mouse.y==this.Mouse.oldY){if(this.Mouse.isMoving=!1,!this.Mouse.triggeredMouseStop){this.Mouse.triggeredMouseStop=
!0;for(a=0;a<this.mouseStopCallbacks.length;a++)this.mouseStopCallbacks[a].call()}}else{this.Mouse.isMoving=!0;this.Mouse.triggeredMouseStop=!1;for(a=0;a<this.mouseMoveCallbacks.length;a++)this.mouseMoveCallbacks[a].call()}this.Mouse.oldX=this.Mouse.x;this.Mouse.oldY=this.Mouse.y};b.Utils.Position.addMouseStopCallback=function(a){this.mouseStopCallbacks.push(a);return this.mouseStopCallbacks.length-1};b.Utils.Position.addMouseMoveCallback=function(a){this.mouseMoveCallbacks.push(a);return this.mouseMoveCallbacks.length-
1};a(function(){window.setInterval(function(){b.Utils.Position.update()},500)});a("html").mousemove(function(a){b.Utils.Position.Mouse.x=a.pageX;b.Utils.Position.Mouse.y=a.pageY})});define("aloha/repositorymanager",["aloha/core","util/class","jquery","aloha/console"],function(a,b,d,p){a.RepositoryManager=b.extend({repositories:[],settings:{},initialized:!1,init:function(){var b=this.repositories;a.settings&&a.settings.repositories&&(this.settings=a.settings.repositories);this.settings.timeout=this.settings.timeout||
5E3;var d=b.length,p;for(p=0;p<d;++p)this.initRepository(b[p]);this.initialized=!0},register:function(a){this.getRepository(a.repositoryId)?p.warn(this,"A repository with name { "+a.repositoryId+" } already registerd. Ignoring this."):(this.repositories.push(a),this.initialized&&this.initRepository(a))},initRepository:function(a){a.settings||(a.settings={});this.settings[a.repositoryId]&&d.extend(a.settings,this.settings[a.repositoryId]);a.init()},getRepository:function(a){var b=this.repositories,
d,g=b.length;for(d=0;d<g;++d)if(b[d].repositoryId===a)return b[d];return null},query:function(a,b){function t(a){return function(){k.apply(a,arguments)}}var g=this,f,n=[],j={numItems:0,hasMoreItems:!1},e=[],v=0,x,c,u,k=function(a,c){if(0!==v){var e=a?a.length:0;if(e){if(!a[0].repositoryId){var f=this.repositoryId,k;for(k=0;k<e;++k)a[k].repositoryId=f}d.merge(n,a)}c&&j?(j.numItems=d.isNumeric(c.numItems)&&d.isNumeric(j.numItems)?j.numItems+c.numItems:void 0,j.hasMoreItems="boolean"===typeof c.hasMoreItems&&
"boolean"===typeof j.hasMoreItems?j.hasMoreItems||c.hasMoreItems:void 0,c.timeout&&(j.timeout=!0)):j=void 0;p.debug(this,"The repository "+this.repositoryId+" returned with "+e+" results.");0===--v&&g.queryCallback(b,n,j,x)}},y=parseInt(a.timeout,10)||this.settings.timeout;x=window.setTimeout(function(){0<v&&p.warn(this,v+" repositories did not return before the configured timeout of "+y+"ms.");v=0;j=j||{};j.timeout=!0;g.queryCallback(b,n,j,x)},y);a.repositoryId?e.push(this.getRepository(a.repositoryId)):
e=this.repositories;u=e.length;var z=[];for(c=0;c<u;++c)if(f=e[c],(!a.repositoryId||f.repositoryId===a.repositoryId)&&"function"===typeof f.query)++v,z.push(f);u=z.length;for(c=0;c<u;++c)f=z[c],f.query(a,t(f));0===v&&this.queryCallback(b,n,j,x)},queryCallback:function(a,b,d,g){g&&clearTimeout(g);b={items:b,results:b.length};d&&(b.numItems=d.numItems,b.hasMoreItems=d.hasMoreItems,b.timeout=d.timeout);a.call(this,b)},getChildren:function(b,p){function t(a){return function(){u.apply(a,arguments)}}var g=
this,f,n=[],j=[],e=0,v,x,c,u=function(a){0!==e&&(n&&a&&d.merge(n,a),0===--e&&g.getChildrenCallback(p,n,v))};if("aloha"===b.inFolderId){var k=b.repositoryFilter,y=k&&k.length;c=this.repositories.length;for(x=0;x<c;++x)f=this.repositories[x],(!y||-1<d.inArray(f.repositoryId,k))&&j.push(new a.RepositoryFolder({id:f.repositoryId,name:f.repositoryName,repositoryId:f.repositoryId,type:"repository",hasMoreItems:!0}));g.getChildrenCallback(p,j,null)}else{j=this.repositories;f=parseInt(b.timeout,10)||this.settings.timeout;
v=window.setTimeout(function(){e=0;g.getChildrenCallback(p,n,v)},f);c=j.length;for(x=0;x<c;++x)if(f=j[x],(!b.repositoryId||f.repositoryId===b.repositoryId)&&"function"===typeof f.getChildren)++e,f.getChildren(b,t(f));0===e&&this.getChildrenCallback(p,n,v)}},getChildrenCallback:function(a,b,d){d&&clearTimeout(d);a.call(this,b)},makeClean:function(a){var b=this,d={},g=0,f=b.repositories.length;a.find("[data-gentics-aloha-repository="+this.prefix+"]").each(function(){for(;g<f;)d.makeClean(a),g+=1;p.debug(b,
"Passing contents of HTML Element with id { "+this.attr("id")+" } for cleaning to repository { "+d.repositoryId+" }");d.makeClean(this)})},markObject:function(a,b){if(a)if(b){var t=this.getRepository(b.repositoryId);t?(d(a).attr({"data-gentics-aloha-repository":b.repositoryId,"data-gentics-aloha-object-id":b.id}),t.markObject(a,b)):p.error(this,"Trying to apply a repository { "+b.name+" } to an object, but item has no repositoryId.")}else d(a).removeAttr("data-gentics-aloha-repository").removeAttr("data-gentics-aloha-object-id")},
getObject:function(a,b){var p=this,g=d(a),f=this.getRepository(g.attr("data-gentics-aloha-repository")),n=g.attr("data-gentics-aloha-object-id");f&&n&&(this.itemCache=this.itemCache||[],this.itemCache[f.repositoryId]=this.itemCache[f.repositoryId]||[],this.itemCache[f.repositoryId][n]?b.call(this,[this.itemCache[f.repositoryId][n]]):f.getObjectById(n,function(a){p.itemCache[f.repositoryId][n]=a[0];b.call(this,a)}))},folderOpened:function(a){var b=this.getRepository(a.repositoryId);"function"===typeof b.folderOpened&&
b.folderOpened(a)},folderClosed:function(a){var b=this.getRepository(a.repositoryId);"function"===typeof b.folderClosed&&b.folderClosed(a)},folderSelected:function(a){var b=this.getRepository(a.repositoryId);"function"===typeof b.folderSelected&&b.folderSelected(a)},getSelectedFolder:function(){var a,b=this.repositories.length,d;for(a=0;a<b;++a)if("function"===typeof this.repositories[a].getSelectedFolder&&(d=this.repositories[a].getSelectedFolder()))return d},toString:function(){return"repositorymanager"}});
a.RepositoryManager=new a.RepositoryManager;return a.RepositoryManager});define("aloha/repository",["aloha/core","util/class","aloha/repositorymanager"],function(a,b,d){b=b.extend({_constructor:function(a,b){this.repositoryId=a;this.settings={};this.repositoryName=b||a;d.register(this)},init:function(){},query:null,getChildren:null,makeClean:function(){},markObject:function(){},setTemplate:function(a){this.template=a?a:null},hasTemplate:function(){return this.template?!0:!1},getTemplate:function(){return this.template},
getObjectById:function(){return!0}});return a.AbstractRepository=b});define("aloha/repositoryobjects",["aloha/core","util/class"],function(a,b){var d=window.GENTICS;a.RepositoryObject=function(){};a.RepositoryDocument=b.extend({_constructor:function(a){this.type="document";a.id&&(a.name&&a.repositoryId)&&(d.Utils.applyProperties(this,a),this.baseType="document")}});a.RepositoryFolder=b.extend({_constructor:function(a){this.type="folder";a.id&&(a.name&&a.repositoryId)&&(d.Utils.applyProperties(this,
a),this.baseType="folder")}})});var Ta=window,zb=function(){var a={},b=Array.prototype.slice.call(arguments),d,p,r;for(p=0;p<b.length;p++)for(d in r=b[p],r)r.hasOwnProperty(d)&&(a[d]=b[p][d]);return a},Tb=function(a,b){define(a,function(){return b})};ba=function(){var a;Aloha.defaults={};Aloha.settings=Aloha.settings||{};var b,d=Aloha.settings.plugins&&Aloha.settings.plugins.load,p=Aloha.settings.baseUrl,r,s=/\/aloha.js(\?\S*)?$/,t=/\/[^\/]*\.js$/,g;if(!d||!p){a=document.getElementsByTagName("script");
for(g=0;g<a.length;g++){b=a[g];r=b.getAttribute("data-aloha-plugins");if(null!=r){d||(d=r);p||(p=b.src.replace(t,""));break}!p&&s.test(b.src)&&(p=b.src.replace(s,""))}}"string"===typeof d&&""!==d&&(d=d.replace(/\s+/g,"").split(","));a=p;b=d||[];var d={},f=[],p={};r={};var n,j,s=Aloha.settings.basePath||"",t=Aloha.settings.bundles||{};for(g=0;g<b.length;g++){n=b[g].split("/");j=n[0];n=n[1];j=t[j]?s+t[j]:s+"../plugins/"+j;var e=d,v=j,x=n,c=["nls","css","vendor","res"],u=void 0,k=void 0;e[x]=v+"/"+x+
"/lib";for(k=0;k<c.length;k++)u=c[k],e[x+"/"+u]=v+"/"+x+"/"+u;p[n]=j+"/"+n;f.push(n+"/"+n+"-plugin");r[n]={jquery:"aloha/jquery"}}Aloha.settings.baseUrl=a;Aloha.settings.loadedPlugins=[];Aloha.settings._pluginBaseUrlByName=p;a=zb({aloha:{jquery:"aloha/jquery"},"aloha/jquery":{jquery:"jquery"},jqueryui:{jquery:"aloha/jquery"},vendor:{jquery:"aloha/jquery"},util:{jquery:"aloha/jquery"},RepositoryBrowser:{jquery:"aloha/jquery"},jstree:{jquery:"aloha/jquery"},jqgrid:{jquery:"aloha/jquery"},"jqgrid-locale-en":{jquery:"aloha/jquery"},
"jqgrid-locale-de":{jquery:"aloha/jquery"},"jquery-layout":{jquery:"aloha/jquery"}},r);a={context:"aloha",locale:Aloha.settings.locale||"en",baseUrl:Aloha.settings.baseUrl,map:a};(Ta.__DEPS__||(Ta.__DEPS__={})).lang=a.locale;var y=zb(a,Aloha.settings.requireConfig);y.paths=zb({jquery:"vendor/jquery-1.7.2",jqueryui:"vendor/jquery-ui-1.9.0.custom-aloha"},{PubSub:"vendor/pubsub/js/pubsub-unminified",Class:"vendor/class",RepositoryBrowser:"vendor/repository-browser/js/repository-browser-unminified",jstree:"vendor/jquery.jstree",
jqgrid:"vendor/jquery.jqgrid","jquery-layout":"vendor/jquery.layout-1.3.0-rc30.7","jqgrid-locale-en":"vendor/grid.locale.en","jqgrid-locale-de":"vendor/grid.locale.de","repository-browser-i18n-de":"vendor/repository-browser/js/repository-browser-unminified","repository-browser-i18n-en":"vendor/repository-browser/js/repository-browser-unminified"},d,y.paths);d=Aloha.settings.predefinedModules||{};Aloha.settings.jQuery&&(d.jquery=Aloha.settings.jQuery);for(var z in d)d.hasOwnProperty(z)&&(Tb(z,d[z]),
delete y.paths[z]);var D=require.config(y);Aloha.require=function(a){return 1===arguments.length&&"function"===typeof a?D(["aloha"],a):D.apply(this,arguments)};var K;Aloha.bind=function(a,b){Aloha.require(["aloha/jquery"],function(c){Aloha.bind=function(a,b){K=K||c.Deferred();"aloha-ready"===a?"alohaReady"!==Aloha.stage?K.done(b):b():c(Aloha,"body").bind(a,b);return this};Aloha.bind(a,b)});return this};Aloha.trigger=function(a,b){Aloha.require(["aloha/jquery"],function(c){Aloha.trigger=function(a,
b){K=K||c.Deferred();"aloha-ready"===a&&c(K.resolve);c(Aloha,"body").trigger(a,b);return this};Aloha.trigger(a,b)});return this};Aloha.unbind=function(a){Aloha.require(["aloha/jquery"],function(b){Aloha.unbind=function(a){b(Aloha,"body").unbind(a)};Aloha.unbind(a)})};Aloha.ready=function(a){this.bind("aloha-ready",a);return this};var E=Aloha.settings.jQuery;define("aloha/jquery",["jquery"],function(a){return E||a});Aloha.jQuery=E;define("aloha","aloha/jquery util/json2 aloha/rangy-core util/class util/lang util/range util/dom aloha/core aloha/editable aloha/console aloha/markup aloha/plugin aloha/selection aloha/command aloha/jquery.aloha aloha/sidebar util/position aloha/repositorymanager aloha/repository aloha/repositoryobjects aloha/contenthandlermanager".split(" "),
function(a){Aloha.jQuery=a;Aloha.settings=a.extendObjects(!0,{},Aloha.defaults,Aloha.settings);return Aloha});Aloha.stage="loadingAloha";require(y,["aloha","aloha/jquery"],function(a,b){a.stage="loadPlugins";require(y,f,function(){b(function(){window.rangy.init();a.init()})})})};Ta.Aloha=Ta.Aloha||{};if(!(ua=Ta.Aloha.deferInit))a:{ua=document.getElementsByTagName("script");for(Pa=0;Pa<ua.length;Pa++)if("true"===ua[Pa].getAttribute("data-aloha-defer-init")){ua=!0;break a}ua=!1}ua?Ta.Aloha.deferInit=
ba:Aloha._load=ba;define("ui/context",["aloha","jquery","util/class"],function(a,b,d){var p;p=b("#aloha-ui-context");p.length||(p=b("<div>",{"class":"aloha",id:"aloha-ui-context"}),b(function(){p.appendTo("body")}));a=d.extend({surfaces:[],containers:[]});b.extend(a,{selector:"#aloha-ui-context",element:p});return a});define("ui/scopes",["jquery","PubSub","util/maps"],function(a,b,d){function p(a,b){if(r.hasOwnProperty(b))for(var e=r[b],d=0;d<e.length;d++){var f=e[d];a.push(f);p(a,f)}}var r={"Aloha.empty":[],
"Aloha.global":["Aloha.empty"],"Aloha.continuoustext":["Aloha.global"]},s=[],t={},g=!1;Aloha.bind("aloha-selection-changed-before",function(){g=!1});Aloha.bind("aloha-selection-changed-after",function(a,b,e){"undefined"!==typeof e&&!g&&f.setScope("Aloha.continuoustext")});var f={enterScope:function(a,d){d=d||"_globalCounter";var e=t[a];e||(e=t[a]={});var f=e[d]||0,f=f+1;(e[d]=f)||b.pub("aloha.ui.scope.change")},leaveScope:function(a,f,e){f=f||"_globalCounter";var g=t[a];if(g){var p=g[f];p&&((p-=1)&&
!e?g[f]=p:(delete g[f],d.isEmpty(g)&&delete t[a],b.pub("aloha.ui.scope.change")))}},isActiveScope:function(b){return t[b]||-1!==a.inArray(b,s)?!0:!1},getPrimaryScope:function(){return s[0]},setScope:function(a){g=!0;s[0]!=a&&(s=[a],p(s,a),b.pub("aloha.ui.scope.change"))},createScope:function(a,b){b?"string"===typeof b&&(b=[b]):b=["Aloha.empty"];r[a]=b}};return f});define("ui/container",["jquery","util/class","ui/scopes"],function(a,b,d){var p=0,r={},s=function(){return!0};b=b.extend({element:null,
_constructor:function(b,g){var f;a:{var n=g.showOn;switch(a.type(n)){case "function":f=n;break a;case "object":if(n.scope){f=r[n.scope]?r[n.scope]:r[n.scope]=function(){return d.isActiveScope(n.scope)};break a}throw"Invalid showOn configuration";default:f=s}}var j;f.showOnId||(f.showOnId=++p);j=f.showOnId;var e=b.containers[j];this.context=b;e||(e=b.containers[j]={shouldShow:f,containers:[]});e.containers.push(this)},show:function(){},hide:function(){},focus:function(){},foreground:function(){},childVisible:function(){},
childFocus:function(){},childForeground:function(){}});a.extend(b,{showContainersForContext:function(a,b){var d,n,j;if(a.containers)for(n in j=a.containers,j)if(j.hasOwnProperty(n)){d=j[n];var e=d.containers;d=d.shouldShow(b)?"show":"hide";for(var p=void 0,p=0;p<e.length;p++)e[p][d]()}}});return b});define("ui/surface",["aloha/core","jquery","util/class","ui/container"],function(a,b,d){var p=d.extend({_constructor:function(a){a.surfaces.push(this)},isActive:function(){return!0}});b.extend(p,{range:null,
show:function(a){b.each(a.surfaces,function(a,b){b.show()})},hide:function(a){b.each(a.surfaces,function(a,b){b.hide()})},trackRange:function(b){b.bind("mousedown",function(b){b.originalEvent.stopSelectionUpdate=!0;a.eventHandled=!0;p.suppressHide=!0;a.activeEditable&&(b=a.getSelection(),p.range=0<b.getRangeCount()?b.getRangeAt(0):null)});b.bind("mouseup",function(b){b.originalEvent.stopSelectionUpdate=!0;a.eventHandled=!1;p.suppressHide=!1})}});return p});define("ui/component",["aloha/core","jquery",
"util/class"],function(a,b,d){var p=0;return d.extend({id:0,isInstance:!0,container:null,type:null,visible:!0,_constructor:function(){this.id=p++;this.init()},adoptParent:function(a){this.container=a},init:function(){},isVisible:function(){return this.visible},show:function(a){!1===a?this.hide():this.visible||(this.visible=!0,this.element.show(),this.container&&this.container.childVisible(this,!0))},hide:function(){this.visible&&(this.visible=!1,this.element.hide(),this.container&&this.container.childVisible(this,
!1))},focus:function(){this.element.focus();this.container&&this.container.childFocus(this)},foreground:function(){this.container&&this.container.childForeground(this)},enable:function(){},disable:function(){}})});define("jqueryui",["jquery"],function(a){var b=a,d=function(a,m){var q,c;q=a.nodeName.toLowerCase();if("area"===q){q=a.parentNode;c=q.name;if(!a.href||!c||"map"!==q.nodeName.toLowerCase())return!1;q=b("img[usemap=#"+c+"]")[0];return!!q&&p(q)}return(/input|select|textarea|button|object/.test(q)?
!a.disabled:"a"===q?a.href||m:m)&&p(a)},p=function(a){return!b(a).parents().andSelf().filter(function(){return"hidden"===b.css(this,"visibility")||b.expr.filters.hidden(this)}).length},r=0,s=/^ui-id-\d+$/;b.ui=b.ui||{};b.ui.version||(b.extend(b.ui,{version:"1.9.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,
SPACE:32,TAB:9,UP:38}}),b.fn.extend({_focus:b.fn.focus,focus:function(a,m){return"number"===typeof a?this.each(function(){var q=this;setTimeout(function(){b(q).focus();m&&m.call(q)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=b.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(b.css(this,"position"))&&/(auto|scroll)/.test(b.css(this,"overflow")+b.css(this,
"overflow-y")+b.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?b(document):a},zIndex:function(a){if(void 0!==a)return this.css("zIndex",a);if(this.length){a=b(this[0]);for(var m;a.length&&a[0]!==document;){m=a.css("position");if("absolute"===m||"relative"===m||"fixed"===m)if(m=parseInt(a.css("zIndex"),10),!isNaN(m)&&0!==
m)return m;a=a.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&b(this).removeAttr("id")})}}),b("<a>").outerWidth(1).jquery||b.each(["Width","Height"],function(a,m){function q(a,l,m,q){b.each(c,function(){l-=parseFloat(b.css(a,"padding"+this))||0;m&&(l-=parseFloat(b.css(a,"border"+this+"Width"))||0);q&&(l-=parseFloat(b.css(a,"margin"+this))||0)});return l}var c="Width"===m?
["Left","Right"]:["Top","Bottom"],e=m.toLowerCase(),d={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,outerWidth:b.fn.outerWidth,outerHeight:b.fn.outerHeight};b.fn["inner"+m]=function(a){return void 0===a?d["inner"+m].call(this):this.each(function(){b(this).css(e,q(this,a)+"px")})};b.fn["outer"+m]=function(a,l){return"number"!==typeof a?d["outer"+m].call(this,a):this.each(function(){b(this).css(e,q(this,a,!0,l)+"px")})}}),b.extend(b.expr[":"],{data:b.expr.createPseudo?b.expr.createPseudo(function(a){return function(m){return!!b.data(m,
a)}}):function(a,m,q){return!!b.data(a,q[3])},focusable:function(a){return d(a,!isNaN(b.attr(a,"tabindex")))},tabbable:function(a){var m=b.attr(a,"tabindex"),q=isNaN(m);return(q||0<=m)&&d(a,!q)}}),b(function(){var a=document.body,m=a.appendChild(m=document.createElement("div"));m.offsetHeight;b.extend(m.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});b.support.minHeight=100===m.offsetHeight;b.support.selectstart="onselectstart"in m;a.removeChild(m).style.display="none"}),b.fn.extend({disableSelection:function(){return this.bind((b.support.selectstart?
"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),b.extend(b.ui,{plugin:{add:function(a,m,q){var c;a=b.ui[a].prototype;for(c in q)a.plugins[c]=a.plugins[c]||[],a.plugins[c].push([m,q[c]])},call:function(a,b,q){var c=a.plugins[b];if(c&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(b=0;b<c.length;b++)a.options[c[b][0]]&&c[b][1].apply(a.element,q)}},contains:b.contains,hasScroll:function(a,
m){if("hidden"===b(a).css("overflow"))return!1;var q=m&&"left"===m?"scrollLeft":"scrollTop",c=!1;if(0<a[q])return!0;a[q]=1;c=0<a[q];a[q]=0;return c},isOverAxis:function(a,b,q){return a>b&&a<b+q},isOver:function(a,m,q,c,e,d){return b.ui.isOverAxis(a,q,e)&&b.ui.isOverAxis(m,c,d)}}));var t=a,g=0,f=Array.prototype.slice,n=t.cleanData;t.cleanData=function(a){for(var b=0,q;null!=(q=a[b]);b++)try{t(q).triggerHandler("remove")}catch(c){}n(a)};t.widget=function(a,b,q){var c,e,d,f,g=a.split(".")[0];a=a.split(".")[1];
c=g+"-"+a;q||(q=b,b=t.Widget);t.expr[":"][c.toLowerCase()]=function(a){return!!t.data(a,c)};t[g]=t[g]||{};e=t[g][a];d=t[g][a]=function(a,l){if(!this._createWidget)return new d(a,l);arguments.length&&this._createWidget(a,l)};t.extend(d,e,{version:q.version,_proto:t.extend({},q),_childConstructors:[]});f=new b;f.options=t.widget.extend({},f.options);t.each(q,function(a,l){if(t.isFunction(l)){var c=function(){return b.prototype[a].apply(this,arguments)},e=function(l){return b.prototype[a].apply(this,
l)};q[a]=function(){var a=this._super,b=this._superApply,m;this._super=c;this._superApply=e;m=l.apply(this,arguments);this._super=a;this._superApply=b;return m}}});d.prototype=t.widget.extend(f,{widgetEventPrefix:a},q,{constructor:d,namespace:g,widgetName:a,widgetBaseClass:c,widgetFullName:c});e?(t.each(e._childConstructors,function(a,l){var b=l.prototype;t.widget(b.namespace+"."+b.widgetName,d,l._proto)}),delete e._childConstructors):b._childConstructors.push(d);t.widget.bridge(a,d)};t.widget.extend=
function(a){for(var b=f.call(arguments,1),q=0,c=b.length,e,d;q<c;q++)for(e in b[q])d=b[q][e],b[q].hasOwnProperty(e)&&void 0!==d&&(a[e]=t.isPlainObject(d)?t.widget.extend({},a[e],d):d);return a};t.widget.bridge=function(a,b){var q=b.prototype.widgetFullName;t.fn[a]=function(c){var e="string"===typeof c,d=f.call(arguments,1),g=this;c=!e&&d.length?t.widget.extend.apply(null,[c].concat(d)):c;e?this.each(function(){var b,m=t.data(this,q);if(!m)return t.error("cannot call methods on "+a+" prior to initialization; attempted to call method '"+
c+"'");if(!t.isFunction(m[c])||"_"===c.charAt(0))return t.error("no such method '"+c+"' for "+a+" widget instance");b=m[c].apply(m,d);if(b!==m&&void 0!==b)return g=b&&b.jquery?g.pushStack(b.get()):b,!1}):this.each(function(){var a=t.data(this,q);a?a.option(c||{})._init():new b(c,this)});return g}};t.Widget=function(){};t.Widget._childConstructors=[];t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,b){b=t(b||
this.defaultElement||this)[0];this.element=t(b);this.uuid=g++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=t.widget.extend({},this.options,this._getCreateOptions(),a);this.bindings=t();this.hoverable=t();this.focusable=t();b!==this&&(t.data(b,this.widgetName,this),t.data(b,this.widgetFullName,this),this._on({remove:"destroy"}),this.document=t(b.style?b.ownerDocument:b.document||b),this.window=t(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",
null,this._getCreateEventData());this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");
this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(a,b){var q=a,c,e,d;if(0===arguments.length)return t.widget.extend({},this.options);if("string"===typeof a)if(q={},c=a.split("."),a=c.shift(),c.length){e=q[a]=t.widget.extend({},this.options[a]);for(d=0;d<c.length-1;d++)e[c[d]]=e[c[d]]||{},e=e[c[d]];a=c.pop();if(void 0===b)return void 0===e[a]?null:e[a];e[a]=b}else{if(void 0===b)return void 0===this.options[a]?null:this.options[a];q[a]=
b}this._setOptions(q);return this},_setOptions:function(a){for(var b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){this.options[a]=b;"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"));return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(a,
b){b?(a=t(a),this.bindings=this.bindings.add(a)):(b=a,a=this.element);var q=this;t.each(b,function(b,m){function c(){if(!(!0===q.options.disabled||t(this).hasClass("ui-state-disabled")))return("string"===typeof m?q[m]:m).apply(q,arguments)}"string"!==typeof m&&(c.guid=m.guid=m.guid||c.guid||t.guid++);var e=b.match(/^(\w+)\s*(.*)$/),d=e[1]+q.eventNamespace;(e=e[2])?q.widget().delegate(e,d,c):a.bind(d,c)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(b).undelegate(b)},
_delay:function(a,b){var q=this;return setTimeout(function(){return("string"===typeof a?q[a]:a).apply(q,arguments)},b||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){t(a.currentTarget).addClass("ui-state-hover")},mouseleave:function(a){t(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){t(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){t(a.currentTarget).removeClass("ui-state-focus")}})},
_trigger:function(a,b,q){var c,e=this.options[a];q=q||{};b=t.Event(b);b.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();b.target=this.element[0];if(a=b.originalEvent)for(c in a)c in b||(b[c]=a[c]);this.element.trigger(b,q);return!(t.isFunction(e)&&!1===e.apply(this.element[0],[b].concat(q))||b.isDefaultPrevented())}};t.each({show:"fadeIn",hide:"fadeOut"},function(a,b){t.Widget.prototype["_"+a]=function(q,c,e){"string"===typeof c&&(c={effect:c});var d,f=!c?a:!0===c||"number"===
typeof c?b:c.effect||b;c=c||{};"number"===typeof c&&(c={duration:c});d=!t.isEmptyObject(c);c.complete=e;c.delay&&q.delay(c.delay);if(d&&t.effects&&(t.effects.effect[f]||!1!==t.uiBackCompat&&t.effects[f]))q[a](c);else if(f!==a&&q[f])q[f](c.duration,c.easing,e);else q.queue(function(b){t(this)[a]();e&&e.call(q[0]);b()})}});!1!==t.uiBackCompat&&(t.Widget.prototype._getCreateOptions=function(){return t.metadata&&t.metadata.get(this.element[0])[this.widgetName]});var j=!1;a(document).mouseup(function(){j=
!1});a.widget("ui.mouse",{version:"1.9.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(m){if(!0===a.data(m.target,b.widgetName+".preventClickEvent"))return a.removeData(m.target,b.widgetName+".preventClickEvent"),m.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);
this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!j){this._mouseStarted&&this._mouseUp(b);this._mouseDownEvent=b;var m=this,q=1===b.which,c="string"===typeof this.options.cancel&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;if(!q||c||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=
setTimeout(function(){m.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(b),!this._mouseStarted))return b.preventDefault(),!0;!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(a){return m._mouseMove(a)};this._mouseUpDelegate=function(a){return m._mouseUp(a)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+
this.widgetName,this._mouseUpDelegate);b.preventDefault();return j=!0}},_mouseMove:function(b){if(a.browser.msie&&!(9<=document.documentMode)&&!b.button)return this._mouseUp(b);if(this._mouseStarted)return this._mouseDrag(b),b.preventDefault();this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&((this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b))?this._mouseDrag(b):this._mouseUp(b));return!this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+
this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});
var e=function(a,b,q){return[parseInt(a[0],10)*(K.test(a[0])?b/100:1),parseInt(a[1],10)*(K.test(a[1])?q/100:1)]};a.ui=a.ui||{};var v,x=Math.max,c=Math.abs,u=Math.round,k=/left|center|right/,y=/top|center|bottom/,z=/[\+\-]\d+%?/,D=/^\w+/,K=/%$/,E=a.fn.position;a.position={scrollbarWidth:function(){if(void 0!==v)return v;var b,m,q=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>");m=q.children()[0];a("body").append(q);b=m.offsetWidth;
q.css("overflow","scroll");m=m.offsetWidth;b===m&&(m=q[0].clientWidth);q.remove();return v=b-m},getScrollInfo:function(b){var m=b.isWindow?"":b.element.css("overflow-x"),q=b.isWindow?"":b.element.css("overflow-y"),q="scroll"===q||"auto"===q&&b.height<b.element[0].scrollHeight;return{width:"scroll"===m||"auto"===m&&b.width<b.element[0].scrollWidth?a.position.scrollbarWidth():0,height:q?a.position.scrollbarWidth():0}},getWithinInfo:function(b){b=a(b||window);var m=a.isWindow(b[0]);return{element:b,
isWindow:m,offset:b.offset()||{left:0,top:0},scrollLeft:b.scrollLeft(),scrollTop:b.scrollTop(),width:m?b.width():b.outerWidth(),height:m?b.height():b.outerHeight()}}};a.fn.position=function(b){if(!b||!b.of)return E.apply(this,arguments);b=a.extend({},b);var m,q,d,f,g,j=a(b.of),n=a.position.getWithinInfo(b.within),p=a.position.getScrollInfo(n),r=j[0],s=(b.collision||"flip").split(" "),v={};9===r.nodeType?(q=j.width(),d=j.height(),f={top:0,left:0}):a.isWindow(r)?(q=j.width(),d=j.height(),f={top:j.scrollTop(),
left:j.scrollLeft()}):r.preventDefault?(b.at="left top",q=d=0,f={top:r.pageY,left:r.pageX}):(q=j.outerWidth(),d=j.outerHeight(),f=j.offset());g=a.extend({},f);a.each(["my","at"],function(){var a=(b[this]||"").split(" "),m,q;1===a.length&&(a=k.test(a[0])?a.concat(["center"]):y.test(a[0])?["center"].concat(a):["center","center"]);a[0]=k.test(a[0])?a[0]:"center";a[1]=y.test(a[1])?a[1]:"center";m=z.exec(a[0]);q=z.exec(a[1]);v[this]=[m?m[0]:0,q?q[0]:0];b[this]=[D.exec(a[0])[0],D.exec(a[1])[0]]});1===s.length&&
(s[1]=s[0]);"right"===b.at[0]?g.left+=q:"center"===b.at[0]&&(g.left+=q/2);"bottom"===b.at[1]?g.top+=d:"center"===b.at[1]&&(g.top+=d/2);m=e(v.at,q,d);g.left+=m[0];g.top+=m[1];return this.each(function(){var k,r,t=a(this),Ja=t.outerWidth(),y=t.outerHeight(),K=parseInt(a.css(this,"marginLeft"),10)||0,z=parseInt(a.css(this,"marginTop"),10)||0,B=Ja+K+(parseInt(a.css(this,"marginRight"),10)||0)+p.width,D=y+z+(parseInt(a.css(this,"marginBottom"),10)||0)+p.height,E=a.extend({},g),J=e(v.my,t.outerWidth(),
t.outerHeight());"right"===b.my[0]?E.left-=Ja:"center"===b.my[0]&&(E.left-=Ja/2);"bottom"===b.my[1]?E.top-=y:"center"===b.my[1]&&(E.top-=y/2);E.left+=J[0];E.top+=J[1];a.support.offsetFractions||(E.left=u(E.left),E.top=u(E.top));k={marginLeft:K,marginTop:z};a.each(["left","top"],function(c,e){if(a.ui.position[s[c]])a.ui.position[s[c]][e](E,{targetWidth:q,targetHeight:d,elemWidth:Ja,elemHeight:y,collisionPosition:k,collisionWidth:B,collisionHeight:D,offset:[m[0]+J[0],m[1]+J[1]],my:b.my,at:b.at,within:n,
elem:t})});a.fn.bgiframe&&t.bgiframe();b.using&&(r=function(a){var m=f.left-E.left,e=m+q-Ja,g=f.top-E.top,k=g+d-y,n={target:{element:j,left:f.left,top:f.top,width:q,height:d},element:{element:t,left:E.left,top:E.top,width:Ja,height:y},horizontal:0>e?"left":0<m?"right":"center",vertical:0>k?"top":0<g?"bottom":"middle"};q<Ja&&c(m+e)<q&&(n.horizontal="center");d<y&&c(g+k)<d&&(n.vertical="middle");n.important=x(c(m),c(e))>x(c(g),c(k))?"horizontal":"vertical";b.using.call(this,a,n)});t.offset(a.extend(E,
{using:r}))})};a.ui.position={fit:{left:function(a,b){var q=b.within,c=q.isWindow?q.scrollLeft:q.offset.left,e=q.width,d=a.left-b.collisionPosition.marginLeft,q=c-d,f=d+b.collisionWidth-e-c;b.collisionWidth>e?0<q&&0>=f?(c=a.left+q+b.collisionWidth-e-c,a.left+=q-c):a.left=0<f&&0>=q?c:q>f?c+e-b.collisionWidth:c:a.left=0<q?a.left+q:0<f?a.left-f:x(a.left-d,a.left)},top:function(a,b){var q=b.within,c=q.isWindow?q.scrollTop:q.offset.top,e=b.within.height,d=a.top-b.collisionPosition.marginTop,q=c-d,f=d+
b.collisionHeight-e-c;b.collisionHeight>e?0<q&&0>=f?(c=a.top+q+b.collisionHeight-e-c,a.top+=q-c):a.top=0<f&&0>=q?c:q>f?c+e-b.collisionHeight:c:a.top=0<q?a.top+q:0<f?a.top-f:x(a.top-d,a.top)}},flip:{left:function(a,b){var q=b.within,e=q.offset.left+q.scrollLeft,d=q.width,f=q.isWindow?q.scrollLeft:q.offset.left,g=a.left-b.collisionPosition.marginLeft,q=g-f,k=g+b.collisionWidth-d-f,g="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,j="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:
0,n=-2*b.offset[0];if(0>q){if(e=a.left+g+j+n+b.collisionWidth-d-e,0>e||e<c(q))a.left+=g+j+n}else if(0<k&&(e=a.left-b.collisionPosition.marginLeft+g+j+n-f,0<e||c(e)<k))a.left+=g+j+n},top:function(a,b){var q=b.within,e=q.offset.top+q.scrollTop,d=q.height,f=q.isWindow?q.scrollTop:q.offset.top,g=a.top-b.collisionPosition.marginTop,q=g-f,k=g+b.collisionHeight-d-f,g="top"===b.my[1]?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,j="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,n=-2*
b.offset[1];if(0>q){if(e=a.top+g+j+n+b.collisionHeight-d-e,a.top+g+j+n>q&&(0>e||e<c(q)))a.top+=g+j+n}else if(0<k&&(e=a.top-b.collisionPosition.marginTop+g+j+n-f,a.top+g+j+n>k&&(0<e||c(e)<k)))a.top+=g+j+n}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments);a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments);a.ui.position.fit.top.apply(this,arguments)}}};var B,J,N,W,oa=document.getElementsByTagName("body")[0];N=document.createElement("div");
B=document.createElement(oa?"div":"body");J={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};oa&&a.extend(J,{position:"absolute",left:"-1000px",top:"-1000px"});for(W in J)B.style[W]=J[W];B.appendChild(N);J=oa||document.documentElement;J.insertBefore(B,J.firstChild);N.style.cssText="position: absolute; left: 10.7432222px;";N=a(N).offset().left;a.support.offsetFractions=10<N&&11>N;B.innerHTML="";J.removeChild(B);if(!1!==a.uiBackCompat){var G=a.fn.position;a.fn.position=function(b){if(!b||
!b.offset)return G.call(this,b);var m=b.offset.split(" "),q=b.at.split(" ");1===m.length&&(m[1]=m[0]);/^\d/.test(m[0])&&(m[0]="+"+m[0]);/^\d/.test(m[1])&&(m[1]="+"+m[1]);1===q.length&&(/left|center|right/.test(q[0])?q[1]="center":(q[1]=q[0],q[0]="center"));return G.call(this,a.extend(b,{at:q[0]+m[0]+" "+q[1]+m[1],offset:void 0}))}}a.widget("ui.draggable",a.ui.mouse,{version:"1.9.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",
cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");
this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(b){var m=this.options;if(this.helper||m.disabled||a(b.target).is(".ui-resizable-handle"))return!1;this.handle=this._getHandle(b);if(!this.handle)return!1;a(!0===m.iframeFix?"iframe":m.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+
"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")});return!0},_mouseStart:function(b){var m=this.options;this.helper=this._createHelper(b);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();a.ui.ddmanager&&(a.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,
left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;m.cursorAt&&this._adjustOffsetFromHelper(m.cursorAt);m.containment&&this._setContainment();if(!1===this._trigger("start",b))return this._clear(),!1;this._cacheHelperProportions();a.ui.ddmanager&&
!m.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b);this._mouseDrag(b,!0);a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b);return!0},_mouseDrag:function(b,m){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!m){var q=this._uiHash();if(!1===this._trigger("drag",b,q))return this._mouseUp({}),!1;this.position=q.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=
this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);return!1},_mouseStop:function(b){var m=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(m=a.ui.ddmanager.drop(this,b));this.dropped&&(m=this.dropped,this.dropped=!1);for(var q=this.element[0],c=!1;q&&(q=q.parentNode);)q==document&&(c=!0);if(!c&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!m||"valid"==this.options.revert&&m||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,
m)){var e=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",b)&&e._clear()})}else!1!==this._trigger("stop",b)&&this._clear();return!1},_mouseUp:function(b){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b);return a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();
return this},_getHandle:function(b){var m=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(m=!0)});return m},_createHelper:function(b){var m=this.options;b=a.isFunction(m.helper)?a(m.helper.apply(this.element[0],[b])):"clone"==m.helper?this.element.clone().removeAttr("id"):this.element;b.parents("body").length||b.appendTo("parent"==m.appendTo?this.element[0].parentNode:m.appendTo);b[0]!=
this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute");return b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+
this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),
10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),
10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=["document"==b.containment?0:a(window).scrollLeft()-this.offset.relative.left-
this.offset.parent.left,"document"==b.containment?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==b.containment?0:a(window).scrollLeft())+a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==b.containment?0:a(window).scrollTop())+(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&
b.containment.constructor!=Array){var b=a(b.containment),m=b[0];if(m){b.offset();var c="hidden"!=a(m).css("overflow");this.containment=[(parseInt(a(m).css("borderLeftWidth"),10)||0)+(parseInt(a(m).css("paddingLeft"),10)||0),(parseInt(a(m).css("borderTopWidth"),10)||0)+(parseInt(a(m).css("paddingTop"),10)||0),(c?Math.max(m.scrollWidth,m.offsetWidth):m.offsetWidth)-(parseInt(a(m).css("borderLeftWidth"),10)||0)-(parseInt(a(m).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-
this.margins.right,(c?Math.max(m.scrollHeight,m.offsetHeight):m.offsetHeight)-(parseInt(a(m).css("borderTopWidth"),10)||0)-(parseInt(a(m).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=b}}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,m){m||(m=this.position);var c="absolute"==b?1:-1,e="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],
this.offsetParent[0]))?this.offsetParent:this.scrollParent,d=/(html|body)/i.test(e[0].tagName);return{top:m.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():d?0:e.scrollTop())*c,left:m.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():d?0:e.scrollLeft())*c}},_generatePosition:function(b){var m=this.options,c="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&
a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(c[0].tagName),d=b.pageX,f=b.pageY;if(this.originalPosition){var g;this.containment&&(this.relative_container?(g=this.relative_container.offset(),g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]):g=this.containment,b.pageX-this.offset.click.left<g[0]&&(d=g[0]+this.offset.click.left),b.pageY-this.offset.click.top<g[1]&&(f=g[1]+
this.offset.click.top),b.pageX-this.offset.click.left>g[2]&&(d=g[2]+this.offset.click.left),b.pageY-this.offset.click.top>g[3]&&(f=g[3]+this.offset.click.top));m.grid&&(f=m.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/m.grid[1])*m.grid[1]:this.originalPageY,f=g?!(f-this.offset.click.top<g[1]||f-this.offset.click.top>g[3])?f:!(f-this.offset.click.top<g[1])?f-m.grid[1]:f+m.grid[1]:f,d=m.grid[0]?this.originalPageX+Math.round((d-this.originalPageX)/m.grid[0])*m.grid[0]:this.originalPageX,
d=g?!(d-this.offset.click.left<g[0]||d-this.offset.click.left>g[2])?d:!(d-this.offset.click.left<g[0])?d-m.grid[0]:d+m.grid[0]:d)}return{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:c.scrollTop()),left:d-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");
this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(b,m,c){c=c||this._uiHash();a.ui.plugin.call(this,b,[m,c]);"drag"==b&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,b,m,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.ui.plugin.add("draggable","connectToSortable",
{start:function(b,m){var c=a(this).data("draggable"),e=c.options,d=a.extend({},m,{item:c.element});c.sortables=[];a(e.connectToSortable).each(function(){var m=a.data(this,"sortable");m&&!m.options.disabled&&(c.sortables.push({instance:m,shouldRevert:m.options.revert}),m.refreshPositions(),m._trigger("activate",b,d))})},stop:function(b,m){var c=a(this).data("draggable"),e=a.extend({},m,{item:c.element});a.each(c.sortables,function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=
!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"==c.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,m){var c=a(this).data("draggable"),e=this;a.each(c.sortables,function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=
c.helperProportions;this.instance.offset.click=c.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return m.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,
!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",b),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=
!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",b),c.dropped=!1)})}});a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),m=a(this).data("draggable").options;b.css("cursor")&&(m._cursor=b.css("cursor"));b.css("cursor",
m.cursor)},stop:function(){var b=a(this).data("draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(b,m){var c=a(m.helper),e=a(this).data("draggable").options;c.css("opacity")&&(e._opacity=c.css("opacity"));c.css("opacity",e.opacity)},stop:function(b,m){var c=a(this).data("draggable").options;c._opacity&&a(m.helper).css("opacity",c._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("draggable");
b.scrollParent[0]!=document&&"HTML"!=b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var m=a(this).data("draggable"),c=m.options,e=!1;if(m.scrollParent[0]!=document&&"HTML"!=m.scrollParent[0].tagName){if(!c.axis||"x"!=c.axis)m.overflowOffset.top+m.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?m.scrollParent[0].scrollTop=e=m.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-m.overflowOffset.top<c.scrollSensitivity&&(m.scrollParent[0].scrollTop=e=m.scrollParent[0].scrollTop-
c.scrollSpeed);if(!c.axis||"y"!=c.axis)m.overflowOffset.left+m.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?m.scrollParent[0].scrollLeft=e=m.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-m.overflowOffset.left<c.scrollSensitivity&&(m.scrollParent[0].scrollLeft=e=m.scrollParent[0].scrollLeft-c.scrollSpeed)}else{if(!c.axis||"x"!=c.axis)b.pageY-a(document).scrollTop()<c.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<
c.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed));if(!c.axis||"y"!=c.axis)b.pageX-a(document).scrollLeft()<c.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed))}!1!==e&&(a.ui.ddmanager&&!c.dropBehaviour)&&a.ui.ddmanager.prepareOffsets(m,b)}});a.ui.plugin.add("draggable","snap",{start:function(){var b=
a(this).data("draggable"),m=b.options;b.snapElements=[];a(m.snap.constructor!=String?m.snap.items||":data(draggable)":m.snap).each(function(){var m=a(this),c=m.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:m.outerWidth(),height:m.outerHeight(),top:c.top,left:c.left})})},drag:function(b,m){for(var c=a(this).data("draggable"),e=c.options,d=e.snapTolerance,f=m.offset.left,g=f+c.helperProportions.width,k=m.offset.top,j=k+c.helperProportions.height,n=c.snapElements.length-1;0<=n;n--){var p=
c.snapElements[n].left,r=p+c.snapElements[n].width,u=c.snapElements[n].top,s=u+c.snapElements[n].height;if(p-d<f&&f<r+d&&u-d<k&&k<s+d||p-d<f&&f<r+d&&u-d<j&&j<s+d||p-d<g&&g<r+d&&u-d<k&&k<s+d||p-d<g&&g<r+d&&u-d<j&&j<s+d){if("inner"!=e.snapMode){var v=Math.abs(u-j)<=d,t=Math.abs(s-k)<=d,x=Math.abs(p-g)<=d,y=Math.abs(r-f)<=d;v&&(m.position.top=c._convertPositionTo("relative",{top:u-c.helperProportions.height,left:0}).top-c.margins.top);t&&(m.position.top=c._convertPositionTo("relative",{top:s,left:0}).top-
c.margins.top);x&&(m.position.left=c._convertPositionTo("relative",{top:0,left:p-c.helperProportions.width}).left-c.margins.left);y&&(m.position.left=c._convertPositionTo("relative",{top:0,left:r}).left-c.margins.left)}var K=v||t||x||y;"outer"!=e.snapMode&&(v=Math.abs(u-k)<=d,t=Math.abs(s-j)<=d,x=Math.abs(p-f)<=d,y=Math.abs(r-g)<=d,v&&(m.position.top=c._convertPositionTo("relative",{top:u,left:0}).top-c.margins.top),t&&(m.position.top=c._convertPositionTo("relative",{top:s-c.helperProportions.height,
left:0}).top-c.margins.top),x&&(m.position.left=c._convertPositionTo("relative",{top:0,left:p}).left-c.margins.left),y&&(m.position.left=c._convertPositionTo("relative",{top:0,left:r-c.helperProportions.width}).left-c.margins.left));!c.snapElements[n].snapping&&(v||t||x||y||K)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,b,a.extend(c._uiHash(),{snapItem:c.snapElements[n].item}));c.snapElements[n].snapping=v||t||x||y||K}else c.snapElements[n].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,
b,a.extend(c._uiHash(),{snapItem:c.snapElements[n].item})),c.snapElements[n].snapping=!1}}});a.ui.plugin.add("draggable","stack",{start:function(){var b=a(this).data("draggable").options,b=a.makeArray(a(b.stack)).sort(function(b,l){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(l).css("zIndex"),10)||0)});if(b.length){var m=parseInt(b[0].style.zIndex)||0;a(b).each(function(a){this.style.zIndex=m+a});this[0].style.zIndex=m+b.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(b,
m){var c=a(m.helper),e=a(this).data("draggable").options;c.css("zIndex")&&(e._zIndex=c.css("zIndex"));c.css("zIndex",e.zIndex)},stop:function(b,m){var c=a(this).data("draggable").options;c._zIndex&&a(m.helper).css("zIndex",c._zIndex)}});a.widget("ui.droppable",{version:"1.9.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,m=b.accept;this.isover=0;this.isout=1;this.accept=
a.isFunction(m)?m:function(a){return a.is(m)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[];a.ui.ddmanager.droppables[b.scope].push(this);b.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=a.ui.ddmanager.droppables[this.options.scope],m=0;m<b.length;m++)b[m]==this&&b.splice(m,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,
m){"accept"==b&&(this.accept=a.isFunction(m)?m:function(a){return a.is(m)});a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var m=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);m&&this._trigger("activate",b,this.ui(m))},_deactivate:function(b){var m=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);m&&this._trigger("deactivate",b,this.ui(m))},_over:function(b){var m=a.ui.ddmanager.current;
if(m&&(m.currentItem||m.element)[0]!=this.element[0])if(this.accept.call(this.element[0],m.currentItem||m.element))this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(m))},_out:function(b){var m=a.ui.ddmanager.current;if(m&&(m.currentItem||m.element)[0]!=this.element[0])if(this.accept.call(this.element[0],m.currentItem||m.element))this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(m))},_drop:function(b,
m){var c=m||a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return!1;var e=!1;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==c.options.scope&&b.accept.call(b.element[0],c.currentItem||c.element)&&a.ui.intersect(c,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return e=!0,!1});return e?!1:this.accept.call(this.element[0],c.currentItem||
c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(c)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});a.ui.intersect=function(b,m,c){if(!m.offset)return!1;var e=(b.positionAbs||b.position.absolute).left,d=e+b.helperProportions.width,f=(b.positionAbs||b.position.absolute).top,
g=f+b.helperProportions.height,k=m.offset.left,j=k+m.proportions.width,n=m.offset.top,p=n+m.proportions.height;switch(c){case "fit":return k<=e&&d<=j&&n<=f&&g<=p;case "intersect":return k<e+b.helperProportions.width/2&&d-b.helperProportions.width/2<j&&n<f+b.helperProportions.height/2&&g-b.helperProportions.height/2<p;case "pointer":return a.ui.isOver((b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,
n,k,m.proportions.height,m.proportions.width);case "touch":return(f>=n&&f<=p||g>=n&&g<=p||f<n&&g>p)&&(e>=k&&e<=j||d>=k&&d<=j||e<k&&d>j);default:return!1}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,m){var c=a.ui.ddmanager.droppables[b.options.scope]||[],e=m?m.type:null,d=(b.currentItem||b.element).find(":data(droppable)").andSelf(),f=0;a:for(;f<c.length;f++)if(!(c[f].options.disabled||b&&!c[f].accept.call(c[f].element[0],b.currentItem||b.element))){for(var g=
0;g<d.length;g++)if(d[g]==c[f].element[0]){c[f].proportions.height=0;continue a}c[f].visible="none"!=c[f].element.css("display");c[f].visible&&("mousedown"==e&&c[f]._activate.call(c[f],m),c[f].offset=c[f].element.offset(),c[f].proportions={width:c[f].element[0].offsetWidth,height:c[f].element[0].offsetHeight})}},drop:function(b,m){var c=!1;a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(this.options&&(!this.options.disabled&&(this.visible&&a.ui.intersect(b,this,this.options.tolerance))&&
(c=this._drop.call(this,m)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)))this.isout=1,this.isover=0,this._deactivate.call(this,m)});return c},dragStart:function(b,m){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,m)})},drag:function(b,m){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,m);a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&
!this.greedyChild&&this.visible){var c=a.ui.intersect(b,this,this.options.tolerance);if(c=!c&&1==this.isover?"isout":c&&0==this.isover?"isover":null){var e;if(this.options.greedy){var d=this.options.scope,f=this.element.parents(":data(droppable)").filter(function(){return a.data(this,"droppable").options.scope===d});f.length&&(e=a.data(f[0],"droppable"),e.greedyChild="isover"==c?1:0)}e&&"isover"==c&&(e.isover=0,e.isout=1,e._out.call(e,m));this[c]=1;this["isout"==c?"isover":"isout"]=0;this["isover"==
c?"_over":"_out"].call(this,m);e&&"isout"==c&&(e.isout=0,e.isover=1,e._over.call(e,m))}}})},dragStop:function(b,m){b.element.parentsUntil("body").unbind("scroll.droppable");b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,m)}};a.widget("ui.resizable",a.ui.mouse,{version:"1.9.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,
minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,m=this.options;this.element.addClass("ui-resizable");a.extend(this,{_aspectRatio:!!m.aspectRatio,aspectRatio:m.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:m.helper||m.ghost||m.animate?m.helper||"ui-resizable-helper":null});this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),
width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,
marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize());this.handles=m.handles||(!a(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",
se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var c=this.handles.split(",");this.handles={};for(var e=0;e<c.length;e++){var d=a.trim(c[e]),f=a('<div class="ui-resizable-handle ui-resizable-'+d+'"></div>');f.css({zIndex:m.zIndex});"se"==d&&f.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[d]=".ui-resizable-"+d;this.element.append(f)}}this._renderAxis=
function(b){b=b||this.element;for(var l in this.handles){this.handles[l].constructor==String&&(this.handles[l]=a(this.handles[l],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var m=a(this.handles[l],this.element),c=0,c=/sw|ne|nw|se|n|s/.test(l)?m.outerHeight():m.outerWidth(),m=["padding",/ne|nw|n/.test(l)?"Top":/se|sw|s/.test(l)?"Bottom":/^e$/.test(l)?"Right":"Left"].join("");b.css(m,c);this._proportionallyResize()}a(this.handles[l])}};
this._renderAxis(this.element);this._handles=a(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=a&&a[1]?a[1]:"se"}});m.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){m.disabled||(a(this).removeClass("ui-resizable-autohide"),b._handles.show())}).mouseleave(function(){!m.disabled&&!b.resizing&&(a(this).addClass("ui-resizable-autohide"),
b._handles.hide())}));this._mouseInit()},_destroy:function(){this._mouseDestroy();var b=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var m=this.element;m.after(this.originalElement.css({position:m.css("position"),width:m.outerWidth(),height:m.outerHeight(),top:m.css("top"),left:m.css("left")})).remove()}this.originalElement.css("resize",
this.originalResizeStyle);b(this.originalElement);return this},_mouseCapture:function(b){var m=!1,c;for(c in this.handles)a(this.handles[c])[0]==b.target&&(m=!0);return!this.options.disabled&&m},_mouseStart:function(b){var m=this.options,c=this.element.position(),e=this.element;this.resizing=!0;this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()};(e.is(".ui-draggable")||/absolute/.test(e.css("position")))&&e.css({position:"absolute",top:c.top,left:c.left});this._renderProxy();
var c=T(this.helper.css("left")),d=T(this.helper.css("top"));m.containment&&(c+=a(m.containment).scrollLeft()||0,d+=a(m.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:c,top:d};this.size=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalSize=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalPosition={left:c,top:d};this.sizeDiff={width:e.outerWidth()-
e.width(),height:e.outerHeight()-e.height()};this.originalMousePosition={left:b.pageX,top:b.pageY};this.aspectRatio="number"==typeof m.aspectRatio?m.aspectRatio:this.originalSize.width/this.originalSize.height||1;m=a(".ui-resizable-"+this.axis).css("cursor");a("body").css("cursor","auto"==m?this.axis+"-resize":m);e.addClass("ui-resizable-resizing");this._propagate("start",b);return!0},_mouseDrag:function(a){var b=this.helper,c=this.originalMousePosition,e=this._change[this.axis];if(!e)return!1;c=
e.apply(this,[a,a.pageX-c.left||0,a.pageY-c.top||0]);this._updateVirtualBoundaries(a.shiftKey);if(this._aspectRatio||a.shiftKey)c=this._updateRatio(c,a);c=this._respectSize(c,a);this._propagate("resize",a);b.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(c);this._trigger("resize",a,this.ui());return!1},_mouseStop:function(b){this.resizing=
!1;var m=this.options;if(this._helper){var c=this._proportionallyResizeElements,e=c.length&&/textarea/i.test(c[0].nodeName),c=e&&a.ui.hasScroll(c[0],"left")?0:this.sizeDiff.height,e=e?0:this.sizeDiff.width,e={width:this.helper.width()-e,height:this.helper.height()-c},c=parseInt(this.element.css("left"),10)+(this.position.left-this.originalPosition.left)||null,d=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;m.animate||this.element.css(a.extend(e,{top:d,left:c}));
this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!m.animate&&this._proportionallyResize()}a("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",b);this._helper&&this.helper.remove();return!1},_updateVirtualBoundaries:function(a){var b=this.options,c,e,d,b={minWidth:ca(b.minWidth)?b.minWidth:0,maxWidth:ca(b.maxWidth)?b.maxWidth:Infinity,minHeight:ca(b.minHeight)?b.minHeight:0,maxHeight:ca(b.maxHeight)?b.maxHeight:
Infinity};if(this._aspectRatio||a)a=b.minHeight*this.aspectRatio,e=b.minWidth/this.aspectRatio,c=b.maxHeight*this.aspectRatio,d=b.maxWidth/this.aspectRatio,a>b.minWidth&&(b.minWidth=a),e>b.minHeight&&(b.minHeight=e),c<b.maxWidth&&(b.maxWidth=c),d<b.maxHeight&&(b.maxHeight=d);this._vBoundaries=b},_updateCache:function(a){this.offset=this.helper.offset();ca(a.left)&&(this.position.left=a.left);ca(a.top)&&(this.position.top=a.top);ca(a.height)&&(this.size.height=a.height);ca(a.width)&&(this.size.width=
a.width)},_updateRatio:function(a){var b=this.position,c=this.size,e=this.axis;ca(a.height)?a.width=a.height*this.aspectRatio:ca(a.width)&&(a.height=a.width/this.aspectRatio);"sw"==e&&(a.left=b.left+(c.width-a.width),a.top=null);"nw"==e&&(a.top=b.top+(c.height-a.height),a.left=b.left+(c.width-a.width));return a},_respectSize:function(a){var b=this._vBoundaries,c=this.axis,e=ca(a.width)&&b.maxWidth&&b.maxWidth<a.width,d=ca(a.height)&&b.maxHeight&&b.maxHeight<a.height,f=ca(a.width)&&b.minWidth&&b.minWidth>
a.width,g=ca(a.height)&&b.minHeight&&b.minHeight>a.height;f&&(a.width=b.minWidth);g&&(a.height=b.minHeight);e&&(a.width=b.maxWidth);d&&(a.height=b.maxHeight);var k=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,n=/sw|nw|w/.test(c),c=/nw|ne|n/.test(c);f&&n&&(a.left=k-b.minWidth);e&&n&&(a.left=k-b.maxWidth);g&&c&&(a.top=j-b.minHeight);d&&c&&(a.top=j-b.maxHeight);(b=!a.width&&!a.height)&&!a.left&&a.top?a.top=null:b&&(!a.top&&a.left)&&(a.left=null);return a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=
this.helper||this.element,m=0;m<this._proportionallyResizeElements.length;m++){var c=this._proportionallyResizeElements[m];if(!this.borderDif){var e=[c.css("borderTopWidth"),c.css("borderRightWidth"),c.css("borderBottomWidth"),c.css("borderLeftWidth")],d=[c.css("paddingTop"),c.css("paddingRight"),c.css("paddingBottom"),c.css("paddingLeft")];this.borderDif=a.map(e,function(a,b){var l=parseInt(a,10)||0,c=parseInt(d[b],10)||0;return l+c})}c.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||
0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||a('<div style="overflow:hidden;"></div>');var c=a.browser.msie&&7>a.browser.version,e=c?1:0,c=c?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+c,height:this.element.outerHeight()+c,position:"absolute",left:this.elementOffset.left-e+"px",top:this.elementOffset.top-e+"px",zIndex:++b.zIndex});
this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){return{left:this.originalPosition.left+b,width:this.originalSize.width-b}},n:function(a,b,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,e){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,e]))},sw:function(b,
c,e){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,e]))},ne:function(b,c,e){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,e]))},nw:function(b,c,e){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,e]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]);"resize"!=b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,
helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("resizable").options,c=function(b){a(b).each(function(){var b=a(this);b.data("resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"==typeof b.alsoResize&&!b.alsoResize.parentNode?b.alsoResize.length?
(b.alsoResize=b.alsoResize[0],c(b.alsoResize)):a.each(b.alsoResize,function(a){c(a)}):c(b.alsoResize)},resize:function(b,c){var e=a(this).data("resizable"),d=e.options,f=e.originalSize,g=e.originalPosition,k={height:e.size.height-f.height||0,width:e.size.width-f.width||0,top:e.position.top-g.top||0,left:e.position.left-g.left||0},j=function(b,l){a(b).each(function(){var b=a(this),e=a(this).data("resizable-alsoresize"),d={},q=l&&l.length?l:b.parents(c.originalElement[0]).length?["width","height"]:
["width","height","top","left"];a.each(q,function(a,b){var l=(e[b]||0)+(k[b]||0);l&&0<=l&&(d[b]=l||null)});b.css(d)})};"object"==typeof d.alsoResize&&!d.alsoResize.nodeType?a.each(d.alsoResize,function(a,b){j(a,b)}):j(d.alsoResize)},stop:function(){a(this).removeData("resizable-alsoresize")}});a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("resizable"),e=c.options,d=c._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName),g=f&&a.ui.hasScroll(d[0],"left")?
0:c.sizeDiff.height,f={width:c.size.width-(f?0:c.sizeDiff.width),height:c.size.height-g},g=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(f,k&&g?{top:k,left:g}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var e={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),
10),left:parseInt(c.element.css("left"),10)};d&&d.length&&a(d[0]).css({width:e.width,height:e.height});c._updateCache(e);c._propagate("resize",b)}})}});a.ui.plugin.add("resizable","containment",{start:function(){var b=a(this).data("resizable"),c=b.element,e=b.options.containment;if(c=e instanceof a?e.get(0):/parent/.test(e)?c.parent().get(0):e)if(b.containerElement=a(c),/document/.test(e)||e==document)b.containerOffset={left:0,top:0},b.containerPosition={left:0,top:0},b.parentData={element:a(document),
left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};else{var d=a(c),f=[];a(["Top","Right","Left","Bottom"]).each(function(a,b){f[a]=T(d.css("padding"+b))});b.containerOffset=d.offset();b.containerPosition=d.position();b.containerSize={height:d.innerHeight()-f[3],width:d.innerWidth()-f[1]};var e=b.containerOffset,g=b.containerSize.height,k=b.containerSize.width,k=a.ui.hasScroll(c,"left")?c.scrollWidth:k,g=a.ui.hasScroll(c)?c.scrollHeight:g;b.parentData=
{element:c,left:e.left,top:e.top,width:k,height:g}}},resize:function(b){var c=a(this).data("resizable"),e=c.options,d=c.containerOffset,f=c.position;b=c._aspectRatio||b.shiftKey;var g={top:0,left:0},k=c.containerElement;k[0]!=document&&/static/.test(k.css("position"))&&(g=d);if(f.left<(c._helper?d.left:0))c.size.width+=c._helper?c.position.left-d.left:c.position.left-g.left,b&&(c.size.height=c.size.width/c.aspectRatio),c.position.left=e.helper?d.left:0;if(f.top<(c._helper?d.top:0))c.size.height+=
c._helper?c.position.top-d.top:c.position.top,b&&(c.size.width=c.size.height*c.aspectRatio),c.position.top=c._helper?d.top:0;c.offset.left=c.parentData.left+c.position.left;c.offset.top=c.parentData.top+c.position.top;e=Math.abs(c.offset.left-g.left+c.sizeDiff.width);d=Math.abs((c._helper?c.offset.top-g.top:c.offset.top-d.top)+c.sizeDiff.height);f=c.containerElement.get(0)==c.element.parent().get(0);g=/relative|absolute/.test(c.containerElement.css("position"));f&&g&&(e-=c.parentData.left);e+c.size.width>=
c.parentData.width&&(c.size.width=c.parentData.width-e,b&&(c.size.height=c.size.width/c.aspectRatio));d+c.size.height>=c.parentData.height&&(c.size.height=c.parentData.height-d,b&&(c.size.width=c.size.height*c.aspectRatio))},stop:function(){var b=a(this).data("resizable"),c=b.options,e=b.containerOffset,d=b.containerPosition,f=b.containerElement,g=a(b.helper),k=g.offset(),j=g.outerWidth()-b.sizeDiff.width,g=g.outerHeight()-b.sizeDiff.height;b._helper&&(!c.animate&&/relative/.test(f.css("position")))&&
a(this).css({left:k.left-d.left-e.left,width:j,height:g});b._helper&&(!c.animate&&/static/.test(f.css("position")))&&a(this).css({left:k.left-d.left-e.left,width:j,height:g})}});a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("resizable"),c=b.options,e=b.size;b.ghost=b.originalElement.clone();b.ghost.css({opacity:0.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:
"");b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}});a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("resizable"),c=b.options,e=b.size,d=b.originalSize,f=b.originalPosition,g=b.axis;c.grid="number"==typeof c.grid?[c.grid,c.grid]:c.grid;var k=Math.round((e.width-
d.width)/(c.grid[0]||1))*(c.grid[0]||1),c=Math.round((e.height-d.height)/(c.grid[1]||1))*(c.grid[1]||1);/^(se|s|e)$/.test(g)?(b.size.width=d.width+k,b.size.height=d.height+c):/^(ne)$/.test(g)?(b.size.width=d.width+k,b.size.height=d.height+c,b.position.top=f.top-c):(/^(sw)$/.test(g)?(b.size.width=d.width+k,b.size.height=d.height+c):(b.size.width=d.width+k,b.size.height=d.height+c,b.position.top=f.top-c),b.position.left=f.left-k)}});var T=function(a){return parseInt(a,10)||0},ca=function(a){return!isNaN(parseInt(a,
10))};a.widget("ui.selectable",a.ui.mouse,{version:"1.9.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable");this.dragged=!1;var c;this.refresh=function(){c=a(b.options.filter,b.element[0]);c.addClass("ui-selectee");c.each(function(){var b=a(this),l=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:l.left,top:l.top,right:l.left+b.outerWidth(),bottom:l.top+b.outerHeight(),startselected:!1,
selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})};this.refresh();this.selectees=c.addClass("ui-selectee");this._mouseInit();this.helper=a("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(b){var c=this;this.opos=[b.pageX,b.pageY];if(!this.options.disabled){var e=
this.options;this.selectees=a(e.filter,this.element[0]);this._trigger("start",b);a(e.appendTo).append(this.helper);this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0});e.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var e=a.data(this,"selectable-item");e.startselected=!0;!b.metaKey&&!b.ctrlKey&&(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,c._trigger("unselecting",b,{unselecting:e.element}))});
a(b.target).parents().andSelf().each(function(){var e=a.data(this,"selectable-item");if(e){var d=!b.metaKey&&!b.ctrlKey||!e.$element.hasClass("ui-selected");e.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting");e.unselecting=!d;e.selecting=d;(e.selected=d)?c._trigger("selecting",b,{selecting:e.element}):c._trigger("unselecting",b,{unselecting:e.element});return!1}})}},_mouseDrag:function(b){var c=this;this.dragged=!0;if(!this.options.disabled){var e=
this.options,d=this.opos[0],f=this.opos[1],g=b.pageX,k=b.pageY;if(d>g)var j=g,g=d,d=j;f>k&&(j=k,k=f,f=j);this.helper.css({left:d,top:f,width:g-d,height:k-f});this.selectees.each(function(){var j=a.data(this,"selectable-item");if(j&&j.element!=c.element[0]){var n=!1;"touch"==e.tolerance?n=!(j.left>g||j.right<d||j.top>k||j.bottom<f):"fit"==e.tolerance&&(n=j.left>d&&j.right<g&&j.top>f&&j.bottom<k);n?(j.selected&&(j.$element.removeClass("ui-selected"),j.selected=!1),j.unselecting&&(j.$element.removeClass("ui-unselecting"),
j.unselecting=!1),j.selecting||(j.$element.addClass("ui-selecting"),j.selecting=!0,c._trigger("selecting",b,{selecting:j.element}))):(j.selecting&&((b.metaKey||b.ctrlKey)&&j.startselected?(j.$element.removeClass("ui-selecting"),j.selecting=!1,j.$element.addClass("ui-selected"),j.selected=!0):(j.$element.removeClass("ui-selecting"),j.selecting=!1,j.startselected&&(j.$element.addClass("ui-unselecting"),j.unselecting=!0),c._trigger("unselecting",b,{unselecting:j.element}))),j.selected&&(!b.metaKey&&
!b.ctrlKey&&!j.startselected)&&(j.$element.removeClass("ui-selected"),j.selected=!1,j.$element.addClass("ui-unselecting"),j.unselecting=!0,c._trigger("unselecting",b,{unselecting:j.element})))}});return!1}},_mouseStop:function(b){var c=this;this.dragged=!1;a(".ui-unselecting",this.element[0]).each(function(){var e=a.data(this,"selectable-item");e.$element.removeClass("ui-unselecting");e.unselecting=!1;e.startselected=!1;c._trigger("unselected",b,{unselected:e.element})});a(".ui-selecting",this.element[0]).each(function(){var e=
a.data(this,"selectable-item");e.$element.removeClass("ui-selecting").addClass("ui-selected");e.selecting=!1;e.selected=!0;e.startselected=!0;c._trigger("selected",b,{selected:e.element})});this._trigger("stop",b);this.helper.remove();return!1}});a.widget("ui.sortable",a.ui.mouse,{version:"1.9.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",
items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?"x"===a.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");
this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var e=this;if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(b);var d=null;a(b.target).parents().each(function(){if(a.data(this,e.widgetName+
"-item")==e)return d=a(this),!1});a.data(b.target,e.widgetName+"-item")==e&&(d=a(b.target));if(!d)return!1;if(this.options.handle&&!c){var f=!1;a(this.options.handle,d).find("*").andSelf().each(function(){this==b.target&&(f=!0)});if(!f)return!1}this.currentItem=d;this._removeCurrentsFromItems();return!0},_mouseStart:function(b,c,e){c=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(b);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=
this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;c.cursorAt&&
this._adjustOffsetFromHelper(c.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();c.containment&&this._setContainment();c.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",c.cursor));c.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",c.opacity));c.zIndex&&
(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",c.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());this._trigger("start",b,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!e)for(e=this.containers.length-1;0<=e;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));a.ui.ddmanager&&(a.ui.ddmanager.current=this);a.ui.ddmanager&&
!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b);this.dragging=!0;this.helper.addClass("ui-sortable-helper");this._mouseDrag(b);return!0},_mouseDrag:function(b){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,e=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<
c.scrollSensitivity?this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft-
c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+
c.scrollSpeed)));!1!==e&&(a.ui.ddmanager&&!c.dropBehaviour)&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(c=this.items.length-1;0<=c;c--){var e=this.items[c],d=e.item[0],f=this._intersectsWithPointer(e);if(f&&e.instance===this.currentContainer&&d!=this.currentItem[0]&&
this.placeholder[1==f?"next":"prev"]()[0]!=d&&!a.contains(this.placeholder[0],d)&&("semi-dynamic"==this.options.type?!a.contains(this.element[0],d):1)){this.direction=1==f?"down":"up";if("pointer"==this.options.tolerance||this._intersectsWithSides(e))this._rearrange(b,e);else break;this._trigger("change",b,this._uiHash());break}}this._contactContainers(b);a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);this._trigger("sort",b,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(b,
c){if(b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var e=this,d=this.placeholder.offset();this.reverting=!0;a(this.helper).animate({left:d.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:d.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){e._clear(b)})}else this._clear(b,
c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;0<=b;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}this.placeholder&&(this.placeholder[0].parentNode&&
this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&(this.helper&&this.helper[0].parentNode)&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),e=[];b=b||{};a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||
"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&e.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))});!e.length&&b.key&&e.push(b.key+"=");return e.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),e=[];b=b||{};c.each(function(){e.push(a(b.item||this).attr(b.attribute||"id")||"")});return e},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,e=this.positionAbs.top,d=e+this.helperProportions.height,f=a.left,g=f+a.width,k=
a.top,j=k+a.height,n=this.offset.click.top,p=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?e+n>k&&e+n<j&&b+p>f&&b+p<g:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&k<e+this.helperProportions.height/2&&d-this.helperProportions.height/2<j},_intersectsWithPointer:function(b){var c="x"===this.options.axis||
a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height);b="y"===this.options.axis||a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width);c=c&&b;b=this._getDragVerticalDirection();var e=this._getDragHorizontalDirection();return!c?!1:this.floating?e&&"right"==e||"down"==b?2:1:b&&("down"==b?2:1)},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height);b=a.ui.isOverAxis(this.positionAbs.left+
this.offset.click.left,b.left+b.width/2,b.width);var e=this._getDragVerticalDirection(),d=this._getDragHorizontalDirection();return this.floating&&d?"right"==d&&b||"left"==d&&!b:e&&("down"==e&&c||"up"==e&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!=a&&(0<a?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!=a&&(0<a?"right":"left")},refresh:function(a){this._refreshItems(a);
this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=[],e=[],d=this._connectWith();if(d&&b)for(b=d.length-1;0<=b;b--)for(var f=a(d[b]),g=f.length-1;0<=g;g--){var k=a.data(f[g],this.widgetName);k&&(k!=this&&!k.options.disabled)&&e.push([a.isFunction(k.options.items)?k.options.items.call(k.element):a(k.options.items,k.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),
k])}e.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=e.length-1;0<=b;b--)e[b][0].each(function(){c.push(this)});return a(c)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data("+this.widgetName+"-item)"),b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,
1)},_refreshItems:function(b){this.items=[];this.containers=[this];var c=this.items,e=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(var f=d.length-1;0<=f;f--)for(var g=a(d[f]),k=g.length-1;0<=k;k--){var j=a.data(g[k],this.widgetName);j&&(j!=this&&!j.options.disabled)&&(e.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):
a(j.options.items,j.element),j]),this.containers.push(j))}for(f=e.length-1;0<=f;f--){b=e[f][1];d=e[f][0];k=0;for(g=d.length;k<g;k++)j=a(d[k]),j.data(this.widgetName+"-item",b),c.push({item:j,instance:b,width:0,height:0,left:0,top:0})}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;0<=c;c--){var e=this.items[c];if(!(e.instance!=this.currentContainer&&this.currentContainer&&e.item[0]!=this.currentItem[0])){var d=
this.options.toleranceElement?a(this.options.toleranceElement,e.item):e.item;b||(e.width=d.outerWidth(),e.height=d.outerHeight());d=d.offset();e.left=d.left;e.top=d.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;0<=c;c--)d=this.containers[c].element.offset(),this.containers[c].containerCache.left=d.left,this.containers[c].containerCache.top=d.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),
this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c=b.options;if(!c.placeholder||c.placeholder.constructor==String){var e=c.placeholder;c.placeholder={element:function(){var c=a(document.createElement(b.currentItem[0].nodeName)).addClass(e||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];e||(c.style.visibility="hidden");return c},update:function(a,d){if(!e||c.forcePlaceholderSize)d.height()||
d.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),d.width()||d.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}}}b.placeholder=a(c.placeholder.element.call(b.element,b.currentItem));b.currentItem.after(b.placeholder);c.placeholder.update(b,b.placeholder)},_contactContainers:function(b){for(var c=null,e=null,d=this.containers.length-
1;0<=d;d--)if(!a.contains(this.currentItem[0],this.containers[d].element[0]))if(this._intersectsWith(this.containers[d].containerCache)){if(!c||!a.contains(this.containers[d].element[0],c.element[0]))c=this.containers[d],e=d}else this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",b,this._uiHash(this)),this.containers[d].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[e]._trigger("over",b,this._uiHash(this)),this.containers[e].containerCache.over=1;
else if(this.currentContainer!=this.containers[e]){for(var c=1E4,d=null,f=this.positionAbs[this.containers[e].floating?"left":"top"],g=this.items.length-1;0<=g;g--)if(a.contains(this.containers[e].element[0],this.items[g].item[0])){var k=this.containers[e].floating?this.items[g].item.offset().left:this.items[g].item.offset().top;Math.abs(k-f)<c&&(c=Math.abs(k-f),d=this.items[g],this.direction=0<k-f?"down":"up")}if(d||this.options.dropOnEmpty)this.currentContainer=this.containers[e],d?this._rearrange(b,
d,null,!0):this._rearrange(b,null,this.containers[e].element,!0),this._trigger("change",b,this._uiHash()),this.containers[e]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[e]._trigger("over",b,this._uiHash(this)),this.containers[e].containerCache.over=1}},_createHelper:function(b){var c=this.options;b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"==c.helper?this.currentItem.clone():
this.currentItem;b.parents("body").length||a("parent"!=c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(b[0]);b[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")});(""==b[0].style.width||c.forceHelperSize)&&b.width(this.currentItem.width());(""==b[0].style.height||c.forceHelperSize)&&b.height(this.currentItem.height());
return b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();
var b=this.offsetParent.offset();"absolute"==this.cssPosition&&(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"==b.containment?document:window).height()||
document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],b=a(b.containment).offset(),e="hidden"!=a(c).css("overflow");this.containment=[b.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,b.left+(e?Math.max(c.scrollWidth,
c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);var e="absolute"==b?1:-1,d="absolute"==this.cssPosition&&!(this.scrollParent[0]!=
document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(d[0].tagName);return{top:c.top+this.offset.relative.top*e+this.offset.parent.top*e-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:d.scrollTop())*e,left:c.left+this.offset.relative.left*e+this.offset.parent.left*e-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:d.scrollLeft())*e}},_generatePosition:function(b){var c=this.options,e="absolute"==this.cssPosition&&
!(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,d=/(html|body)/i.test(e[0].tagName);"relative"==this.cssPosition&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=b.pageX,g=b.pageY;this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<
this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),c.grid&&(g=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1],g=this.containment?!(g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3])?g:!(g-this.offset.click.top<this.containment[1])?
g-c.grid[1]:g+c.grid[1]:g,f=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0],f=this.containment?!(f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2])?f:!(f-this.offset.click.left<this.containment[0])?f-c.grid[0]:f+c.grid[0]:f));return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():d?0:e.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-
this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():d?0:e.scrollLeft())}},_rearrange:function(a,b,c,e){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?b.item[0]:b.item[0].nextSibling);var d=this.counter=this.counter?++this.counter:1;this._delay(function(){d==this.counter&&this.refreshPositions(!e)})},_clear:function(b,c){this.reverting=!1;var e=[];!this._noFinalSort&&this.currentItem.parent().length&&
this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var d in this._storedCSS)if("auto"==this._storedCSS[d]||"static"==this._storedCSS[d])this._storedCSS[d]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||
this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&e.push(function(a){this._trigger("update",a,this._uiHash())});this!==this.currentContainer&&!c&&(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)));for(d=this.containers.length-1;0<=d;d--)c||e.push(function(a){return function(b){a._trigger("deactivate",
b,this._uiHash(this))}}.call(this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[d])),this.containers[d].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",
b,this._uiHash());for(d=0;d<e.length;d++)e[d].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1}c||this._trigger("beforeStop",b,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!c){for(d=0;d<e.length;d++)e[d].call(this,b);this._trigger("stop",b,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&
this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}});var U=0,Ba={},V={};Ba.height=Ba.paddingTop=Ba.paddingBottom=Ba.borderTopWidth=Ba.borderBottomWidth="hide";V.height=V.paddingTop=V.paddingBottom=V.borderTopWidth=V.borderBottomWidth="show";a.widget("ui.accordion",{version:"1.9.0",options:{active:0,animate:{},collapsible:!1,
event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var b=this.accordionId="ui-accordion-"+(this.element.attr("id")||++U),c=this.options;this.prevShow=this.prevHide=a();this.element.addClass("ui-accordion ui-widget ui-helper-reset");this.headers=this.element.find(c.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");
this._hoverable(this.headers);this._focusable(this.headers);this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();!c.collapsible&&!1===c.active&&(c.active=0);0>c.active&&(c.active+=this.headers.length);this.active=this._findActive(c.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top");this.active.next().addClass("ui-accordion-content-active").show();this._createIcons();this.originalHeight=
this.element[0].style.height;this.refresh();this.element.attr("role","tablist");this.headers.attr("role","tab").each(function(c){var e=a(this),d=e.attr("id"),m=e.next(),f=m.attr("id");d||(d=b+"-header-"+c,e.attr("id",d));f||(f=b+"-panel-"+c,m.attr("id",f));e.attr("aria-controls",f);m.attr("aria-labelledby",d)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();this.active.length?
this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0);this._on(this.headers,{keydown:"_keydown"});this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._setupEvents(c.event)},_getCreateEventData:function(){return{header:this.active,content:!this.active.length?a():this.active.next()}},_createIcons:function(){var b=this.options.icons;b&&(a("<span>").addClass("ui-accordion-header-icon ui-icon "+b.header).prependTo(this.headers),
this.active.children(".ui-accordion-header-icon").removeClass(b.header).addClass(b.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&
this.removeAttribute("id")});this._destroyIcons();a=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});"content"!==this.options.heightStyle&&(this.element.css("height",this.originalHeight),a.css("height",
""))},_setOption:function(a,b){"active"===a?this._activate(b):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(a,b),"collapsible"===a&&(!b&&!1===this.options.active)&&this._activate(0),"icons"===a&&(this._destroyIcons(),b&&this._createIcons()),"disabled"===a&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!b))},_keydown:function(b){if(!b.altKey&&!b.ctrlKey){var c=a.ui.keyCode,e=this.headers.length,d=this.headers.index(b.target),
f=!1;switch(b.keyCode){case c.RIGHT:case c.DOWN:f=this.headers[(d+1)%e];break;case c.LEFT:case c.UP:f=this.headers[(d-1+e)%e];break;case c.SPACE:case c.ENTER:this._eventHandler(b);break;case c.HOME:f=this.headers[0];break;case c.END:f=this.headers[e-1]}f&&(a(b.target).attr("tabIndex",-1),a(f).attr("tabIndex",0),f.focus(),b.preventDefault())}},_panelKeyDown:function(b){b.keyCode===a.ui.keyCode.UP&&b.ctrlKey&&a(b.currentTarget).prev().focus()},refresh:function(){var b,c,e=this.options.heightStyle,d=
this.element.parent();this.element.css("height",this.originalHeight);"fill"===e?(a.support.minHeight||(c=d.css("overflow"),d.css("overflow","hidden")),b=d.height(),this.element.siblings(":visible").each(function(){var c=a(this),e=c.css("position");"absolute"===e||"fixed"===e||(b-=c.outerHeight(!0))}),c&&d.css("overflow",c),this.headers.each(function(){b-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,b-a(this).innerHeight()+a(this).height()))}).css("overflow",
"auto")):"auto"===e&&(b=0,this.headers.next().each(function(){b=Math.max(b,a(this).height("").height())}).height(b));"content"!==e&&this.element.height(this.element.height())},_activate:function(b){b=this._findActive(b)[0];b!==this.active[0]&&(b=b||this.active[0],this._eventHandler({target:b,currentTarget:b,preventDefault:a.noop}))},_findActive:function(b){return"number"===typeof b?this.headers.eq(b):a()},_setupEvents:function(b){var c={};b&&(a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),
this._on(this.headers,c))},_eventHandler:function(b){var c=this.options,e=this.active,d=a(b.currentTarget),f=d[0]===e[0],g=f&&c.collapsible,k=g?a():d.next(),j=e.next(),k={oldHeader:e,oldPanel:j,newHeader:g?a():d,newPanel:k};b.preventDefault();f&&!c.collapsible||!1===this._trigger("beforeActivate",b,k)||(c.active=g?!1:this.headers.index(d),this.active=f?a():d,this._toggle(k),e.removeClass("ui-accordion-header-active ui-state-active"),c.icons&&e.children(".ui-accordion-header-icon").removeClass(c.icons.activeHeader).addClass(c.icons.header),
f||(d.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),c.icons&&d.children(".ui-accordion-header-icon").removeClass(c.icons.header).addClass(c.icons.activeHeader),d.next().addClass("ui-accordion-content-active")))},_toggle:function(b){var c=b.newPanel,e=this.prevShow.length?this.prevShow:b.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=c;this.prevHide=e;this.options.animate?this._animate(c,e,b):(e.hide(),c.show(),this._toggleComplete(b));
e.attr({"aria-expanded":"false","aria-hidden":"true"});e.prev().attr("aria-selected","false");c.length&&e.length?e.prev().attr("tabIndex",-1):c.length&&this.headers.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1);c.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(a,b,c){var e,d,f,g=this,k=0,j=a.length&&(!b.length||a.index()<b.index()),n=this.options.animate||{},j=j&&n.down||n,p=function(){g._toggleComplete(c)};
"number"===typeof j&&(f=j);"string"===typeof j&&(d=j);d=d||j.easing||n.easing;f=f||j.duration||n.duration;if(!b.length)return a.animate(V,f,d,p);if(!a.length)return b.animate(Ba,f,d,p);e=a.show().outerHeight();b.animate(Ba,{duration:f,easing:d,step:function(a,b){b.now=Math.round(a)}});a.hide().animate(V,{duration:f,easing:d,complete:p,step:function(a,c){c.now=Math.round(a);"height"!==c.prop?k+=c.now:"content"!==g.options.heightStyle&&(c.now=Math.round(e-b.outerHeight()-k),k=0)}})},_toggleComplete:function(a){var b=
a.oldPanel;b.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");b.length&&(b.parent()[0].className=b.parent()[0].className);this._trigger("activate",null,a)}});if(!1!==a.uiBackCompat){B=a.ui.accordion.prototype;a.extend(B.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var H=B._create;B._create=function(){if(this.options.navigation){var b=this,c=this.element.find(this.options.header),
e=c.next(),d=c.add(e).find("a").filter(this.options.navigationFilter)[0];d&&c.add(e).each(function(c){if(a.contains(this,d))return b.options.active=Math.floor(c/2),!1})}H.call(this)};B=a.ui.accordion.prototype;a.extend(B.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var da=B._create,ha=B._setOption;a.extend(B,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle();da.call(this)},_setOption:function(a,b){if("autoHeight"===a||"clearStyle"===
a||"fillSpace"===a)this.options.heightStyle=this._mergeHeightStyle();ha.apply(this,arguments)},_mergeHeightStyle:function(){var a=this.options;if(a.fillSpace)return"fill";if(a.clearStyle)return"content";if(a.autoHeight)return"auto"}});B=a.ui.accordion.prototype;a.extend(B.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var ia=B._createIcons;B._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected);
ia.call(this)};B=a.ui.accordion.prototype;B.activate=B._activate;var ba=B._findActive;B._findActive=function(a){-1===a&&(a=!1);a&&"number"!==typeof a&&(a=this.headers.index(this.headers.filter(a)),-1===a&&(a=!1));return ba.call(this,a)};a.ui.accordion.prototype.resize=a.ui.accordion.prototype.refresh;B=a.ui.accordion.prototype;a.extend(B.options,{change:null,changestart:null});var ma=B._trigger;B._trigger=function(a,b,c){var e=ma.apply(this,arguments);if(!e)return!1;"beforeActivate"===a?e=ma.call(this,
"changestart",b,{oldHeader:c.oldHeader,oldContent:c.oldPanel,newHeader:c.newHeader,newContent:c.newPanel}):"activate"===a&&(e=ma.call(this,"change",b,{oldHeader:c.oldHeader,oldContent:c.oldPanel,newHeader:c.newHeader,newContent:c.newPanel}));return e};B=a.ui.accordion.prototype;a.extend(B.options,{animate:null,animated:"slide"});var X=B._create;B._create=function(){var a=this.options;null===a.animate&&(a.animate=a.animated?"slide"===a.animated?300:"bounceslide"===a.animated?{duration:200,down:{easing:"easeOutBounce",
duration:1E3}}:a.animated:!1);X.call(this)}}var O=0;a.widget("ui.autocomplete",{version:"1.9.0",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var b,c,e;this.isMultiLine=this._isMultiLine();this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"];this.isNewMenu=
!0;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on({keydown:function(d){if(this.element.prop("readOnly"))c=e=b=!0;else{c=e=b=!1;var f=a.ui.keyCode;switch(d.keyCode){case f.PAGE_UP:b=!0;this._move("previousPage",d);break;case f.PAGE_DOWN:b=!0;this._move("nextPage",d);break;case f.UP:b=!0;this._keyEvent("previous",d);break;case f.DOWN:b=!0;this._keyEvent("next",d);break;case f.ENTER:case f.NUMPAD_ENTER:this.menu.active&&(b=!0,d.preventDefault(),this.menu.select(d));
break;case f.TAB:this.menu.active&&this.menu.select(d);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(d),d.preventDefault());break;default:c=!0,this._searchTimeout(d)}}},keypress:function(e){if(b)b=!1,e.preventDefault();else if(!c){var d=a.ui.keyCode;switch(e.keyCode){case d.PAGE_UP:this._move("previousPage",e);break;case d.PAGE_DOWN:this._move("nextPage",e);break;case d.UP:this._keyEvent("previous",e);break;case d.DOWN:this._keyEvent("next",e)}}},input:function(a){e?
(e=!1,a.preventDefault()):this._searchTimeout(a)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(a){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),this._change(a))}});this._initSource();this.menu=a("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:a(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu");this._on(this.menu.element,{mousedown:function(b){b.preventDefault();
this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur});var c=this.menu.element[0];a(b.target).closest(".ui-menu-item").length||this._delay(function(){var b=this;this.document.one("mousedown",function(l){l.target!==b.element[0]&&(l.target!==c&&!a.contains(c,l.target))&&b.close()})})},menufocus:function(b,c){if(this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type))){this.menu.blur();this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)});
return}var l=c.item.data("ui-autocomplete-item")||c.item.data("item.autocomplete");!1!==this._trigger("focus",b,{item:l})?b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(l.value):this.liveRegion.text(l.value)},menuselect:function(a,b){var c=b.item.data("ui-autocomplete-item")||b.item.data("item.autocomplete"),l=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=l,this._delay(function(){this.previous=l;this.selectedItem=c}));!1!==this._trigger("select",
a,{item:c})&&this._value(c.value);this.term=this._value();this.close(a);this.selectedItem=c}});this.liveRegion=a("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element);a.fn.bgiframe&&this.menu.element.bgiframe();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();
this.liveRegion.remove()},_setOption:function(a,b){this._super(a,b);"source"===a&&this._initSource();"appendTo"===a&&this.menu.element.appendTo(this.document.find(b||"body")[0]);"disabled"===a&&(b&&this.xhr)&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var b,c,e=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(c,e){e(a.ui.autocomplete.filter(b,
c.term))}):"string"===typeof this.options.source?(c=this.options.source,this.source=function(b,l){e.xhr&&e.xhr.abort();e.xhr=a.ajax({url:c,data:b,dataType:"json",success:function(a){l(a)},error:function(){l([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching);this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){a=null!=a?a:this._value();this.term=this._value();
if(a.length<this.options.minLength)return this.close(b);if(!1!==this._trigger("search",b))return this._search(a)},_search:function(a){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:a},this._response())},_response:function(){var a=this,b=++O;return function(c){b===O&&a.__response(c);a.pending--;a.pending||a.element.removeClass("ui-autocomplete-loading")}},__response:function(a){a&&(a=this._normalize(a));this._trigger("response",null,{content:a});
!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0;this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"===
typeof b?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,b);this.menu.refresh();c.show();this._resizeMenu();c.position(a.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var e=
this;a.each(c,function(a,c){e._renderItemData(b,c)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){return a("<li>").append(a("<a>").text(c.label)).appendTo(b)},_move:function(a,b){if(this.menu.element.is(":visible"))if(this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a))this._value(this.term),this.menu.blur();else this.menu[a](b);else this.search(null,b)},widget:function(){return this.menu.element},
_value:function(a){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(a,b),b.preventDefault()}});a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,c){var e=RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return e.test(a.label||a.value||a)})}});a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",
results:function(a){return a+(1<a?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(a){var b;this._superApply(arguments);!this.options.disabled&&!this.cancelSearch&&(b=a&&a.length?this.options.messages.results(a.length):this.options.messages.noResults,this.liveRegion.text(b))}});var aa,A,ua,Ia,ja=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},fa=function(b){var c=b.name,e=b.form,d=a([]);c&&(d=e?a(e).find("[name='"+
c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form}));return d};a.widget("ui.button",{version:"1.9.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,ja);"boolean"!==typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled);
this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var b=this,c=this.options,e="checkbox"===this.type||"radio"===this.type,d="ui-state-hover"+(!e?" ui-state-active":"");null===c.label&&(c.label="input"===this.type?this.buttonElement.val():this.buttonElement.html());this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter"+this.eventNamespace,function(){c.disabled||(a(this).addClass("ui-state-hover"),this===aa&&
a(this).addClass("ui-state-active"))}).bind("mouseleave"+this.eventNamespace,function(){c.disabled||a(this).removeClass(d)}).bind("click"+this.eventNamespace,function(a){c.disabled&&(a.preventDefault(),a.stopImmediatePropagation())});this.element.bind("focus"+this.eventNamespace,function(){b.buttonElement.addClass("ui-state-focus")}).bind("blur"+this.eventNamespace,function(){b.buttonElement.removeClass("ui-state-focus")});e&&(this.element.bind("change"+this.eventNamespace,function(){Ia||b.refresh()}),
this.buttonElement.bind("mousedown"+this.eventNamespace,function(a){c.disabled||(Ia=!1,A=a.pageX,ua=a.pageY)}).bind("mouseup"+this.eventNamespace,function(a){if(!c.disabled&&(A!==a.pageX||ua!==a.pageY))Ia=!0}));"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(c.disabled||Ia)return!1;a(this).toggleClass("ui-state-active");b.buttonElement.attr("aria-pressed",b.element[0].checked)}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(c.disabled||
Ia)return!1;a(this).addClass("ui-state-active");b.buttonElement.attr("aria-pressed","true");var e=b.element[0];fa(e).not(e).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(c.disabled)return!1;a(this).addClass("ui-state-active");aa=this;b.document.one("mouseup",function(){aa=null})}).bind("mouseup"+this.eventNamespace,function(){if(c.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown"+
this.eventNamespace,function(b){if(c.disabled)return!1;(b.keyCode===a.ui.keyCode.SPACE||b.keyCode===a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()}));this._setOption("disabled",c.disabled);this._resetButton()},_determineButtonType:function(){var a,b;this.type=this.element.is("[type=checkbox]")?
"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button";"checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),(a=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),
this.buttonElement.prop("aria-pressed",a)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){this._super(a,b);"disabled"===a?b?this.element.prop("disabled",!0):this.element.prop("disabled",!1):this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b);"radio"===this.type?fa(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",
"false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
c=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),e=this.options.icons,d=e.primary&&e.secondary,f=[];e.primary||e.secondary?(this.options.text&&f.push("ui-button-text-icon"+(d?"s":e.primary?"-primary":"-secondary")),e.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+e.primary+"'></span>"),e.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+e.secondary+"'></span>"),this.options.text||(f.push(d?"ui-button-icons-only":
"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(c)))):f.push("ui-button-text-only");b.addClass(f.join(" "))}}});a.widget("ui.buttonset",{version:"1.9.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b);this._super(a,b)},refresh:function(){var b=
"rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}});
(function(a,b){function c(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),
weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,
beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};a.extend(this._defaults,this.regional[""]);this.dpDiv=e(a('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function e(b){return b.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a",
"mouseout",function(){a(this).removeClass("ui-state-hover");-1!=this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover");-1!=this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){if(!a.datepicker._isDisabledDatepicker(g.inline?b.parent()[0]:g.input[0]))a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
a(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover")})}function d(c,e){a.extend(c,e);for(var f in e)if(null==e[f]||e[f]==b)c[f]=e[f];return c}a.extend(a.ui,{datepicker:{version:"1.9.0"}});var f=(new Date).getTime(),g;a.extend(c.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",
arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){d(this._defaults,a||{});return this},_attachDatepicker:function(b,c){var e=null,d;for(d in this._defaults){var m=b.getAttribute("date:"+d);if(m){e=e||{};try{e[d]=eval(m)}catch(f){e[d]=m}}}d=b.nodeName.toLowerCase();m="div"==d||"span"==d;b.id||(this.uuid+=1,b.id="dp"+this.uuid);var q=this._newInst(a(b),m);q.settings=a.extend({},c||{},e||{});"input"==d?this._connectDatepicker(b,q):m&&this._inlineDatepicker(b,q)},_newInst:function(b,
c){return{id:b[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:!c?this.dpDiv:e(a('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}},_connectDatepicker:function(b,c){var e=a(b);c.append=a([]);c.trigger=a([]);e.hasClass(this.markerClassName)||(this._attachments(e,c),e.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
function(a,b,e){c.settings[b]=e}).bind("getData.datepicker",function(a,b){return this._get(c,b)}),this._autoSize(c),a.data(b,"datepicker",c),c.settings.disabled&&this._disableDatepicker(b))},_attachments:function(b,c){var e=this._get(c,"appendText"),d=this._get(c,"isRTL");c.append&&c.append.remove();e&&(c.append=a('<span class="'+this._appendClass+'">'+e+"</span>"),b[d?"before":"after"](c.append));b.unbind("focus",this._showDatepicker);c.trigger&&c.trigger.remove();e=this._get(c,"showOn");("focus"==
e||"both"==e)&&b.focus(this._showDatepicker);if("button"==e||"both"==e){var e=this._get(c,"buttonText"),m=this._get(c,"buttonImage");c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:m,alt:e,title:e}):a('<button type="button"></button>').addClass(this._triggerClass).html(""==m?e:a("<img/>").attr({src:m,alt:e,title:e})));b[d?"before":"after"](c.trigger);c.trigger.click(function(){a.datepicker._datepickerShowing&&a.datepicker._lastInput==b[0]?a.datepicker._hideDatepicker():
(a.datepicker._datepickerShowing&&a.datepicker._lastInput!=b[0]&&a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(b[0]));return!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var e=function(a){for(var b=0,c=0,e=0;e<a.length;e++)a[e].length>b&&(b=a[e].length,c=e);return c};b.setMonth(e(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(e(this._get(a,c.match(/DD/)?"dayNames":
"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(b,c){var e=a(b);e.hasClass(this.markerClassName)||(e.addClass(this.markerClassName).append(c.dpDiv).bind("setData.datepicker",function(a,b,e){c.settings[b]=e}).bind("getData.datepicker",function(a,b){return this._get(c,b)}),a.data(b,"datepicker",c),this._setDate(c,this._getDefaultDate(c),!0),this._updateDatepicker(c),this._updateAlternate(c),c.settings.disabled&&this._disableDatepicker(b),
c.dpDiv.css("display","block"))},_dialogDatepicker:function(b,c,e,m,f){b=this._dialogInst;b||(this.uuid+=1,this._dialogInput=a('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),b=this._dialogInst=this._newInst(this._dialogInput,!1),b.settings={},a.data(this._dialogInput[0],"datepicker",b));d(b.settings,m||{});c=c&&c.constructor==Date?this._formatDate(b,c):c;this._dialogInput.val(c);
this._pos=f?f.length?f:[f.pageX,f.pageY]:null;this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");b.settings.onSelect=e;this._inDialog=!0;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);a.blockUI&&a.blockUI(this.dpDiv);
a.data(this._dialogInput[0],"datepicker",b);return this},_destroyDatepicker:function(b){var c=a(b),e=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var d=b.nodeName.toLowerCase();a.removeData(b,"datepicker");"input"==d?(e.append.remove(),e.trigger.remove(),c.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==d||"span"==d)&&c.removeClass(this.markerClassName).empty()}},
_enableDatepicker:function(b){var c=a(b),e=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var d=b.nodeName.toLowerCase();if("input"==d)b.disabled=!1,e.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==d||"span"==d)c=c.children("."+this._inlineClass),c.children().removeClass("ui-state-disabled"),c.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=a.map(this._disabledInputs,
function(a){return a==b?null:a})}},_disableDatepicker:function(b){var c=a(b),e=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var d=b.nodeName.toLowerCase();if("input"==d)b.disabled=!0,e.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==d||"span"==d)c=c.children("."+this._inlineClass),c.children().addClass("ui-state-disabled"),c.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!0);this._disabledInputs=a.map(this._disabledInputs,function(a){return a==b?null:a});this._disabledInputs[this._disabledInputs.length]=b}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(b){try{return a.data(b,"datepicker")}catch(c){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(c,e,f){var q=this._getInst(c);if(2==arguments.length&&"string"==typeof e)return"defaults"==
e?a.extend({},a.datepicker._defaults):q?"all"==e?a.extend({},q.settings):this._get(q,e):null;var g=e||{};"string"==typeof e&&(g={},g[e]=f);if(q){this._curInst==q&&this._hideDatepicker();var k=this._getDateDatepicker(c,!0),j=this._getMinMaxDate(q,"min"),n=this._getMinMaxDate(q,"max");d(q.settings,g);null!==j&&(g.dateFormat!==b&&g.minDate===b)&&(q.settings.minDate=this._formatDate(q,j));null!==n&&(g.dateFormat!==b&&g.maxDate===b)&&(q.settings.maxDate=this._formatDate(q,n));this._attachments(a(c),q);
this._autoSize(q);this._setDate(q,k);this._updateAlternate(q);this._updateDatepicker(q)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);c&&!c.inline&&this._setDateFromField(c,b);return c?this._getDate(c):null},_doKeyDown:function(b){var c=
a.datepicker._getInst(b.target),e=!0,d=c.dpDiv.is(".ui-datepicker-rtl");c._keyEvent=!0;if(a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker();e=!1;break;case 13:return e=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",c.dpDiv),e[0]&&a.datepicker._selectDay(b.target,c.selectedMonth,c.selectedYear,e[0]),(b=a.datepicker._get(c,"onSelect"))?(e=a.datepicker._formatDate(c),b.apply(c.input?c.input[0]:null,[e,c])):a.datepicker._hideDatepicker(),
!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(c,"stepBigMonths"):-a.datepicker._get(c,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(c,"stepBigMonths"):+a.datepicker._get(c,"stepMonths"),"M");break;case 35:(b.ctrlKey||b.metaKey)&&a.datepicker._clearDate(b.target);e=b.ctrlKey||b.metaKey;break;case 36:(b.ctrlKey||b.metaKey)&&a.datepicker._gotoToday(b.target);e=b.ctrlKey||b.metaKey;
break;case 37:if(b.ctrlKey||b.metaKey)a.datepicker._adjustDate(b.target,d?1:-1,"D");e=b.ctrlKey||b.metaKey;b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(c,"stepBigMonths"):-a.datepicker._get(c,"stepMonths"),"M");break;case 38:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,-7,"D");e=b.ctrlKey||b.metaKey;break;case 39:if(b.ctrlKey||b.metaKey)a.datepicker._adjustDate(b.target,d?-1:1,"D");e=b.ctrlKey||b.metaKey;b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,
b.ctrlKey?+a.datepicker._get(c,"stepBigMonths"):+a.datepicker._get(c,"stepMonths"),"M");break;case 40:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,7,"D");e=b.ctrlKey||b.metaKey;break;default:e=!1}else 36==b.keyCode&&b.ctrlKey?a.datepicker._showDatepicker(this):e=!1;e&&(b.preventDefault(),b.stopPropagation())},_doKeyPress:function(c){var e=a.datepicker._getInst(c.target);if(a.datepicker._get(e,"constrainInput")){var e=a.datepicker._possibleChars(a.datepicker._get(e,"dateFormat")),d=String.fromCharCode(c.charCode==
b?c.keyCode:c.charCode);return c.ctrlKey||c.metaKey||" ">d||!e||-1<e.indexOf(d)}},_doKeyUp:function(b){b=a.datepicker._getInst(b.target);if(b.input.val()!=b.lastVal)try{if(a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),b.input?b.input.val():null,a.datepicker._getFormatConfig(b)))a.datepicker._setDateFromField(b),a.datepicker._updateAlternate(b),a.datepicker._updateDatepicker(b)}catch(c){a.datepicker.log(c)}return!0},_showDatepicker:function(b){b=b.target||b;"input"!=b.nodeName.toLowerCase()&&
(b=a("input",b.parentNode)[0]);if(!(a.datepicker._isDisabledDatepicker(b)||a.datepicker._lastInput==b)){var c=a.datepicker._getInst(b);a.datepicker._curInst&&a.datepicker._curInst!=c&&(a.datepicker._curInst.dpDiv.stop(!0,!0),c&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0]));var e=a.datepicker._get(c,"beforeShow"),e=e?e.apply(b,[b,c]):{};if(!1!==e){d(c.settings,e);c.lastVal=null;a.datepicker._lastInput=b;a.datepicker._setDateFromField(c);a.datepicker._inDialog&&
(b.value="");a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(b),a.datepicker._pos[1]+=b.offsetHeight);var m=!1;a(b).parents().each(function(){m|="fixed"==a(this).css("position");return!m});e={left:a.datepicker._pos[0],top:a.datepicker._pos[1]};a.datepicker._pos=null;c.dpDiv.empty();c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});a.datepicker._updateDatepicker(c);e=a.datepicker._checkOffset(c,e,m);c.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":m?"fixed":
"absolute",display:"none",left:e.left+"px",top:e.top+"px"});if(!c.inline){var e=a.datepicker._get(c,"showAnim"),f=a.datepicker._get(c,"duration"),q=function(){var b=c.dpDiv.find("iframe.ui-datepicker-cover");if(b.length){var e=a.datepicker._getBorders(c.dpDiv);b.css({left:-e[0],top:-e[1],width:c.dpDiv.outerWidth(),height:c.dpDiv.outerHeight()})}};c.dpDiv.zIndex(a(b).zIndex()+1);a.datepicker._datepickerShowing=!0;if(a.effects&&(a.effects.effect[e]||a.effects[e]))c.dpDiv.show(e,a.datepicker._get(c,
"showOptions"),f,q);else c.dpDiv[e||"show"](e?f:null,q);(!e||!f)&&q();c.input.is(":visible")&&!c.input.is(":disabled")&&c.input.focus();a.datepicker._curInst=c}}}},_updateDatepicker:function(b){this.maxRows=4;var c=a.datepicker._getBorders(b.dpDiv);g=b;b.dpDiv.empty().append(this._generateHTML(b));this._attachHandlers(b);var e=b.dpDiv.find("iframe.ui-datepicker-cover");e.length&&e.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()});b.dpDiv.find("."+this._dayOverClass+
" a").mouseover();c=this._getNumberOfMonths(b);e=c[1];b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<e&&b.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",17*e+"em");b.dpDiv[(1!=c[0]||1!=c[1]?"add":"remove")+"Class"]("ui-datepicker-multi");b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");b==a.datepicker._curInst&&(a.datepicker._datepickerShowing&&b.input&&b.input.is(":visible")&&!b.input.is(":disabled")&&b.input[0]!=
document.activeElement)&&b.input.focus();if(b.yearshtml){var d=b.yearshtml;setTimeout(function(){d===b.yearshtml&&b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml);d=b.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(b,c,e){var d=b.dpDiv.outerWidth(),m=b.dpDiv.outerHeight(),f=b.input?b.input.outerWidth():
0,q=b.input?b.input.outerHeight():0,g=document.documentElement.clientWidth+(e?0:a(document).scrollLeft()),k=document.documentElement.clientHeight+(e?0:a(document).scrollTop());c.left-=this._get(b,"isRTL")?d-f:0;c.left-=e&&c.left==b.input.offset().left?a(document).scrollLeft():0;c.top-=e&&c.top==b.input.offset().top+q?a(document).scrollTop():0;c.left-=Math.min(c.left,c.left+d>g&&g>d?Math.abs(c.left+d-g):0);c.top-=Math.min(c.top,c.top+m>k&&k>m?Math.abs(m+q):0);return c},_findPos:function(b){for(var c=
this._getInst(b),c=this._get(c,"isRTL");b&&("hidden"==b.type||1!=b.nodeType||a.expr.filters.hidden(b));)b=b[c?"previousSibling":"nextSibling"];b=a(b).offset();return[b.left,b.top]},_hideDatepicker:function(b){var c=this._curInst;if(c&&!(b&&c!=a.data(b,"datepicker"))&&this._datepickerShowing){b=this._get(c,"showAnim");var e=this._get(c,"duration"),d=function(){a.datepicker._tidyDialog(c)};if(a.effects&&(a.effects.effect[b]||a.effects[b]))c.dpDiv.hide(b,a.datepicker._get(c,"showOptions"),e,d);else c.dpDiv["slideDown"==
b?"slideUp":"fadeIn"==b?"fadeOut":"hide"](b?e:null,d);b||d();this._datepickerShowing=!1;(b=this._get(c,"onClose"))&&b.apply(c.input?c.input[0]:null,[c.input?c.input.val():"",c]);this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){b=
a(b.target);var c=a.datepicker._getInst(b[0]);(b[0].id!=a.datepicker._mainDivId&&0==b.parents("#"+a.datepicker._mainDivId).length&&!b.hasClass(a.datepicker.markerClassName)&&!b.closest("."+a.datepicker._triggerClass).length&&a.datepicker._datepickerShowing&&(!a.datepicker._inDialog||!a.blockUI)||b.hasClass(a.datepicker.markerClassName)&&a.datepicker._curInst!=c)&&a.datepicker._hideDatepicker()}},_adjustDate:function(b,c,e){b=a(b);var d=this._getInst(b[0]);this._isDisabledDatepicker(b[0])||(this._adjustInstDate(d,
c+("M"==e?this._get(d,"showCurrentAtPos"):0),e),this._updateDatepicker(d))},_gotoToday:function(b){b=a(b);var c=this._getInst(b[0]);if(this._get(c,"gotoCurrent")&&c.currentDay)c.selectedDay=c.currentDay,c.drawMonth=c.selectedMonth=c.currentMonth,c.drawYear=c.selectedYear=c.currentYear;else{var e=new Date;c.selectedDay=e.getDate();c.drawMonth=c.selectedMonth=e.getMonth();c.drawYear=c.selectedYear=e.getFullYear()}this._notifyChange(c);this._adjustDate(b)},_selectMonthYear:function(b,c,e){b=a(b);var d=
this._getInst(b[0]);d["selected"+("M"==e?"Month":"Year")]=d["draw"+("M"==e?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10);this._notifyChange(d);this._adjustDate(b)},_selectDay:function(b,c,e,d){var m=a(b);!a(d).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(m[0])&&(m=this._getInst(m[0]),m.selectedDay=m.currentDay=a("a",d).html(),m.selectedMonth=m.currentMonth=c,m.selectedYear=m.currentYear=e,this._selectDate(b,this._formatDate(m,m.currentDay,m.currentMonth,m.currentYear)))},
_clearDate:function(b){b=a(b);this._getInst(b[0]);this._selectDate(b,"")},_selectDate:function(b,c){var e=a(b),e=this._getInst(e[0]);c=null!=c?c:this._formatDate(e);e.input&&e.input.val(c);this._updateAlternate(e);var d=this._get(e,"onSelect");d?d.apply(e.input?e.input[0]:null,[c,e]):e.input&&e.input.trigger("change");e.inline?this._updateDatepicker(e):(this._hideDatepicker(),this._lastInput=e.input[0],"object"!=typeof e.input[0]&&e.input.focus(),this._lastInput=null)},_updateAlternate:function(b){var c=
this._get(b,"altField");if(c){var e=this._get(b,"altFormat")||this._get(b,"dateFormat"),d=this._getDate(b),m=this.formatDate(e,d,this._getFormatConfig(b));a(c).each(function(){a(this).val(m)})}},noWeekends:function(a){a=a.getDay();return[0<a&&6>a,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0);a.setDate(1);return Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(b,c,e){if(null==b||null==c)throw"Invalid arguments";
c="object"==typeof c?c.toString():c+"";if(""==c)return null;for(var d=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof d?d:(new Date).getFullYear()%100+parseInt(d,10),m=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,f=(e?e.dayNames:null)||this._defaults.dayNames,q=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,g=(e?e.monthNames:null)||this._defaults.monthNames,k=e=-1,j=-1,n=-1,p=!1,r=function(a){(a=Q+1<b.length&&b.charAt(Q+1)==a)&&Q++;return a},u=function(a){var b=
r(a);a=RegExp("^\\d{1,"+("@"==a?14:"!"==a?20:"y"==a&&b?4:"o"==a?3:2)+"}");a=c.substring(t).match(a);if(!a)throw"Missing number at position "+t;t+=a[0].length;return parseInt(a[0],10)},s=function(b,e,d){b=a.map(r(b)?d:e,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});var m=-1;a.each(b,function(a,b){var e=b[1];if(c.substr(t,e.length).toLowerCase()==e.toLowerCase())return m=b[0],t+=e.length,!1});if(-1!=m)return m+1;throw"Unknown name at position "+t;},v=function(){if(c.charAt(t)!=
b.charAt(Q))throw"Unexpected literal at position "+t;t++},t=0,Q=0;Q<b.length;Q++)if(p)"'"==b.charAt(Q)&&!r("'")?p=!1:v();else switch(b.charAt(Q)){case "d":j=u("d");break;case "D":s("D",m,f);break;case "o":n=u("o");break;case "m":k=u("m");break;case "M":k=s("M",q,g);break;case "y":e=u("y");break;case "@":var x=new Date(u("@"));e=x.getFullYear();k=x.getMonth()+1;j=x.getDate();break;case "!":x=new Date((u("!")-this._ticksTo1970)/1E4);e=x.getFullYear();k=x.getMonth()+1;j=x.getDate();break;case "'":r("'")?
v():p=!0;break;default:v()}if(t<c.length&&(m=c.substr(t),!/^\s+/.test(m)))throw"Extra/unparsed characters found in date: "+m;-1==e?e=(new Date).getFullYear():100>e&&(e+=(new Date).getFullYear()-(new Date).getFullYear()%100+(e<=d?0:-100));if(-1<n){k=1;j=n;do{d=this._getDaysInMonth(e,k-1);if(j<=d)break;k++;j-=d}while(1)}x=this._daylightSavingAdjust(new Date(e,k-1,j));if(x.getFullYear()!=e||x.getMonth()+1!=k||x.getDate()!=j)throw"Invalid date";return x},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",
RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,c){if(!b)return"";var e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,l=(c?c.dayNames:null)||this._defaults.dayNames,d=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort;c=(c?c.monthNames:null)||this._defaults.monthNames;var m=
function(b){(b=k+1<a.length&&a.charAt(k+1)==b)&&k++;return b},f=function(a,b,c){b=""+b;if(m(a))for(;b.length<c;)b="0"+b;return b},q="",g=!1;if(b)for(var k=0;k<a.length;k++)if(g)"'"==a.charAt(k)&&!m("'")?g=!1:q+=a.charAt(k);else switch(a.charAt(k)){case "d":q+=f("d",b.getDate(),2);break;case "D":var j;j=b.getDay();var n=e,p=l;j=m("D")?p[j]:n[j];q+=j;break;case "o":q+=f("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/864E5),3);
break;case "m":q+=f("m",b.getMonth()+1,2);break;case "M":j=b.getMonth();n=d;p=c;j=m("M")?p[j]:n[j];q+=j;break;case "y":q+=m("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case "@":q+=b.getTime();break;case "!":q+=1E4*b.getTime()+this._ticksTo1970;break;case "'":m("'")?q+="'":g=!0;break;default:q+=a.charAt(k)}return q},_possibleChars:function(a){for(var b="",c=!1,e=function(b){(b=l+1<a.length&&a.charAt(l+1)==b)&&l++;return b},l=0;l<a.length;l++)if(c)"'"==a.charAt(l)&&!e("'")?
c=!1:b+=a.charAt(l);else switch(a.charAt(l)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":e("'")?b+="'":c=!0;break;default:b+=a.charAt(l)}return b},_get:function(a,c){return a.settings[c]!==b?a.settings[c]:this._defaults[c]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),e=a.lastVal=a.input?a.input.val():null,l,d;l=d=this._getDefaultDate(a);var m=this._getFormatConfig(a);try{l=this.parseDate(c,e,m)||
d}catch(f){this.log(f),e=b?"":e}a.selectedDay=l.getDate();a.drawMonth=a.selectedMonth=l.getMonth();a.drawYear=a.selectedYear=l.getFullYear();a.currentDay=e?l.getDate():0;a.currentMonth=e?l.getMonth():0;a.currentYear=e?l.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(b,c,e){if(null==c||""===c)c=e;else{var d;if("string"==typeof c)a:{try{d=a.datepicker.parseDate(a.datepicker._get(b,
"dateFormat"),c,a.datepicker._getFormatConfig(b));break a}catch(m){}var f=(c.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date;b=f.getFullYear();d=f.getMonth();for(var f=f.getDate(),q=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,g=q.exec(c);g;){switch(g[2]||"d"){case "d":case "D":f+=parseInt(g[1],10);break;case "w":case "W":f+=7*parseInt(g[1],10);break;case "m":case "M":d+=parseInt(g[1],10);f=Math.min(f,a.datepicker._getDaysInMonth(b,d));break;case "y":case "Y":b+=parseInt(g[1],10),f=Math.min(f,
a.datepicker._getDaysInMonth(b,d))}g=q.exec(c)}d=new Date(b,d,f)}else"number"==typeof c?isNaN(c)?c=e:(b=new Date,b.setDate(b.getDate()+c),c=b):c=new Date(c.getTime()),d=c;c=d}if(c=c&&"Invalid Date"==c.toString()?e:c)c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0);return this._daylightSavingAdjust(c)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(12<a.getHours()?a.getHours()+2:0);return a},_setDate:function(a,b,c){var e=!b,l=a.selectedMonth,d=a.selectedYear;b=this._restrictMinMax(a,
this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();(l!=a.selectedMonth||d!=a.selectedYear)&&!c&&this._notifyChange(a);this._adjustInstDate(a);a.input&&a.input.val(e?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""==a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_attachHandlers:function(b){var c=
this._get(b,"stepMonths"),e="#"+b.id.replace(/\\\\/g,"\\");b.dpDiv.find("[data-handler]").map(function(){a(this).bind(this.getAttribute("data-event"),{prev:function(){window["DP_jQuery_"+f].datepicker._adjustDate(e,-c,"M")},next:function(){window["DP_jQuery_"+f].datepicker._adjustDate(e,+c,"M")},hide:function(){window["DP_jQuery_"+f].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+f].datepicker._gotoToday(e)},selectDay:function(){window["DP_jQuery_"+f].datepicker._selectDay(e,+this.getAttribute("data-month"),
+this.getAttribute("data-year"),this);return!1},selectMonth:function(){window["DP_jQuery_"+f].datepicker._selectMonthYear(e,this,"M");return!1},selectYear:function(){window["DP_jQuery_"+f].datepicker._selectMonthYear(e,this,"Y");return!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(b){var c=new Date,c=this._daylightSavingAdjust(new Date(c.getFullYear(),c.getMonth(),c.getDate())),e=this._get(b,"isRTL"),d=this._get(b,"showButtonPanel"),m=this._get(b,"hideIfNoPrevNext"),f=this._get(b,
"navigationAsDateFormat"),q=this._getNumberOfMonths(b),g=this._get(b,"showCurrentAtPos"),k=this._get(b,"stepMonths"),j=1!=q[0]||1!=q[1],n=this._daylightSavingAdjust(!b.currentDay?new Date(9999,9,9):new Date(b.currentYear,b.currentMonth,b.currentDay)),p=this._getMinMaxDate(b,"min"),r=this._getMinMaxDate(b,"max"),g=b.drawMonth-g,u=b.drawYear;0>g&&(g+=12,u--);if(r)for(var s=this._daylightSavingAdjust(new Date(r.getFullYear(),r.getMonth()-q[0]*q[1]+1,r.getDate())),s=p&&s<p?p:s;this._daylightSavingAdjust(new Date(u,
g,1))>s;)g--,0>g&&(g=11,u--);b.drawMonth=g;b.drawYear=u;var s=this._get(b,"prevText"),s=!f?s:this.formatDate(s,this._daylightSavingAdjust(new Date(u,g-k,1)),this._getFormatConfig(b)),s=this._canAdjustMonth(b,-1,u,g)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"e":"w")+'">'+s+"</span></a>":m?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+
(e?"e":"w")+'">'+s+"</span></a>",v=this._get(b,"nextText"),v=!f?v:this.formatDate(v,this._daylightSavingAdjust(new Date(u,g+k,1)),this._getFormatConfig(b)),m=this._canAdjustMonth(b,1,u,g)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+v+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"w":"e")+'">'+v+"</span></a>":m?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+v+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"w":
"e")+'">'+v+"</span></a>",k=this._get(b,"currentText"),v=this._get(b,"gotoCurrent")&&b.currentDay?n:c,k=!f?k:this.formatDate(k,v,this._getFormatConfig(b)),f=!b.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(b,"closeText")+"</button>":"",d=d?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(e?f:"")+(this._isInRange(b,v)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+
k+"</button>":"")+(e?"":f)+"</div>":"",f=parseInt(this._get(b,"firstDay"),10),f=isNaN(f)?0:f,k=this._get(b,"showWeek"),v=this._get(b,"dayNames");this._get(b,"dayNamesShort");var t=this._get(b,"dayNamesMin"),Q=this._get(b,"monthNames"),x=this._get(b,"monthNamesShort"),wa=this._get(b,"beforeShowDay"),y=this._get(b,"showOtherMonths"),K=this._get(b,"selectOtherMonths");this._get(b,"calculateWeek");for(var Va=this._getDefaultDate(b),z="",B=0;B<q[0];B++){var eb="";this.maxRows=4;for(var D=0;D<q[1];D++){var E=
this._daylightSavingAdjust(new Date(u,g,b.selectedDay)),J=" ui-corner-all",A="";if(j){A+='<div class="ui-datepicker-group';if(1<q[1])switch(D){case 0:A+=" ui-datepicker-group-first";J=" ui-corner-"+(e?"right":"left");break;case q[1]-1:A+=" ui-datepicker-group-last";J=" ui-corner-"+(e?"left":"right");break;default:A+=" ui-datepicker-group-middle",J=""}A+='">'}for(var A=A+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+J+'">'+(/all|left/.test(J)&&0==B?e?m:s:"")+(/all|right/.test(J)&&
0==B?e?s:m:"")+this._generateMonthYearHeader(b,g,u,p,r,0<B||0<D,Q,x)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),N=k?'<th class="ui-datepicker-week-col">'+this._get(b,"weekHeader")+"</th>":"",J=0;7>J;J++)var C=(J+f)%7,N=N+("<th"+(5<=(J+f+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+v[C]+'">'+t[C]+"</span></th>");A+=N+"</tr></thead><tbody>";N=this._getDaysInMonth(u,g);u==b.selectedYear&&g==b.selectedMonth&&(b.selectedDay=Math.min(b.selectedDay,N));J=(this._getFirstDayOfMonth(u,
g)-f+7)%7;N=Math.ceil((J+N)/7);this.maxRows=N=j?this.maxRows>N?this.maxRows:N:N;for(var C=this._daylightSavingAdjust(new Date(u,g,1-J)),H=0;H<N;H++){for(var A=A+"<tr>",W=!k?"":'<td class="ui-datepicker-week-col">'+this._get(b,"calculateWeek")(C)+"</td>",J=0;7>J;J++){var G=wa?wa.apply(b.input?b.input[0]:null,[C]):[!0,""],I=C.getMonth()!=g,L=I&&!K||!G[0]||p&&C<p||r&&C>r,W=W+('<td class="'+(5<=(J+f+6)%7?" ui-datepicker-week-end":"")+(I?" ui-datepicker-other-month":"")+(C.getTime()==E.getTime()&&g==b.selectedMonth&&
b._keyEvent||Va.getTime()==C.getTime()&&Va.getTime()==E.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(I&&!y?"":" "+G[1]+(C.getTime()==n.getTime()?" "+this._currentClass:"")+(C.getTime()==c.getTime()?" ui-datepicker-today":""))+'"'+((!I||y)&&G[2]?' title="'+G[2]+'"':"")+(L?"":' data-handler="selectDay" data-event="click" data-month="'+C.getMonth()+'" data-year="'+C.getFullYear()+'"')+">"+(I&&!y?"&#xa0;":L?'<span class="ui-state-default">'+C.getDate()+
"</span>":'<a class="ui-state-default'+(C.getTime()==c.getTime()?" ui-state-highlight":"")+(C.getTime()==n.getTime()?" ui-state-active":"")+(I?" ui-priority-secondary":"")+'" href="#">'+C.getDate()+"</a>")+"</td>");C.setDate(C.getDate()+1);C=this._daylightSavingAdjust(C)}A+=W+"</tr>"}g++;11<g&&(g=0,u++);A+="</tbody></table>"+(j?"</div>"+(0<q[0]&&D==q[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");eb+=A}z+=eb}z+=d+(a.browser.msie&&7>parseInt(a.browser.version,10)&&!b.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':
"");b._keyEvent=!1;return z},_generateMonthYearHeader:function(a,b,c,e,l,d,m,f){var q=this._get(a,"changeMonth"),g=this._get(a,"changeYear"),k=this._get(a,"showMonthAfterYear"),j='<div class="ui-datepicker-title">',n="";if(d||!q)n+='<span class="ui-datepicker-month">'+m[b]+"</span>";else{m=e&&e.getFullYear()==c;for(var p=l&&l.getFullYear()==c,n=n+'<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">',r=0;12>r;r++)if((!m||r>=e.getMonth())&&(!p||r<=l.getMonth()))n+='<option value="'+
r+'"'+(r==b?' selected="selected"':"")+">"+f[r]+"</option>";n+="</select>"}k||(j+=n+(d||!q||!g?"&#xa0;":""));if(!a.yearshtml)if(a.yearshtml="",d||!g)j+='<span class="ui-datepicker-year">'+c+"</span>";else{f=this._get(a,"yearRange").split(":");var u=(new Date).getFullYear();m=function(a){a=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?u+parseInt(a,10):parseInt(a,10);return isNaN(a)?u:a};b=m(f[0]);f=Math.max(b,m(f[1]||""));b=e?Math.max(b,e.getFullYear()):b;f=l?Math.min(f,l.getFullYear()):
f;for(a.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';b<=f;b++)a.yearshtml+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>";j+=a.yearshtml;a.yearshtml=null}j+=this._get(a,"yearSuffix");k&&(j+=(d||!q||!g?"&#xa0;":"")+n);return j+"</div>"},_adjustInstDate:function(a,b,c){var e=a.drawYear+("Y"==c?b:0),l=a.drawMonth+("M"==c?b:0);b=Math.min(a.selectedDay,this._getDaysInMonth(e,l))+("D"==c?b:0);e=this._restrictMinMax(a,
this._daylightSavingAdjust(new Date(e,l,b)));a.selectedDay=e.getDate();a.drawMonth=a.selectedMonth=e.getMonth();a.drawYear=a.selectedYear=e.getFullYear();("M"==c||"Y"==c)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),e=this._getMinMaxDate(a,"max"),c=c&&b<c?c:b;return e&&c>e?e:c},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,
"numberOfMonths");return null==a?[1,1]:"number"==typeof a?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,e){var l=this._getNumberOfMonths(a);c=this._daylightSavingAdjust(new Date(c,e+(0>b?b:l[0]*l[1]),1));0>b&&c.setDate(this._getDaysInMonth(c.getFullYear(),
c.getMonth()));return this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min"),e=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!e||b.getTime()<=e.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff"),b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,
"monthNames")}},_formatDate:function(a,b,c,e){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);b=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(e,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});a.fn.datepicker=function(b){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick).find(document.body).append(a.datepicker.dpDiv),
a.datepicker.initialized=!0);var c=Array.prototype.slice.call(arguments,1);return"string"==typeof b&&("isDisabled"==b||"getDate"==b||"widget"==b)||"option"==b&&2==arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c)):this.each(function(){"string"==typeof b?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,b)})};a.datepicker=new c;a.datepicker.initialized=!1;a.datepicker.uuid=
(new Date).getTime();a.datepicker.version="1.9.0";window["DP_jQuery_"+f]=a})(a);var La={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},Ga={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{version:"1.9.0",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",
using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");"string"!==typeof this.originalTitle&&(this.originalTitle="");this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.options.title=this.options.title||this.originalTitle;var b=this,c=this.options,e=c.title||"&#160;",d=(this.uiDialog=
a("<div>")).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c.dialogClass).css({display:"none",outline:0,zIndex:c.zIndex}).attr("tabIndex",-1).keydown(function(e){c.closeOnEscape&&(!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===a.ui.keyCode.ESCAPE)&&(b.close(e),e.preventDefault())}).mousedown(function(a){b.moveToTop(!1,a)}).appendTo("body");this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(d);var f=(this.uiDialogTitlebar=a("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(d),
g=a("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(a){a.preventDefault();b.close(a)}).appendTo(f);(this.uiDialogTitlebarCloseText=a("<span>")).addClass("ui-icon ui-icon-closethick").text(c.closeText).appendTo(g);var e=a("<span>").uniqueId().addClass("ui-dialog-title").html(e).prependTo(f),k=(this.uiDialogButtonPane=a("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");(this.uiButtonSet=a("<div>")).addClass("ui-dialog-buttonset").appendTo(k);
d.attr({role:"dialog","aria-labelledby":e.attr("id")});f.find("*").add(f).disableSelection();this._hoverable(g);this._focusable(g);c.draggable&&a.fn.draggable&&this._makeDraggable();c.resizable&&a.fn.resizable&&this._makeResizable();this._createButtons(c.buttons);this._isOpen=!1;a.fn.bgiframe&&d.bgiframe();this._on(d,{keydown:function(b){if(c.modal&&b.keyCode===a.ui.keyCode.TAB){var e=a(":tabbable",d),l=e.filter(":first"),e=e.filter(":last");if(b.target===e[0]&&!b.shiftKey)return l.focus(1),!1;if(b.target===
l[0]&&b.shiftKey)return e.focus(1),!1}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var a,b=this.oldPosition;this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();this.originalTitle&&this.element.attr("title",this.originalTitle);a=b.parent.children().eq(b.index);a.length&&a[0]!==this.element[0]?a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},
close:function(b){var c=this,e,d;if(this._isOpen&&!1!==this._trigger("beforeClose",b))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this.uiDialog.hide(this.options.hide,function(){c._trigger("close",b)}):(this.uiDialog.hide(),this._trigger("close",b)),a.ui.dialog.overlay.resize(),this.options.modal&&(e=0,a(".ui-dialog").each(function(){this!==c.uiDialog[0]&&(d=a(this).css("z-index"),isNaN(d)||(e=Math.max(e,d)))}),a.ui.dialog.maxZ=e),this},isOpen:function(){return this._isOpen},
moveToTop:function(b,c){var e=this.options;if(e.modal&&!b||!e.stack&&!e.modal)return this._trigger("focus",c);e.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=e.zIndex);this.overlay&&(a.ui.dialog.maxZ+=1,a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ,this.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ));e={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()};a.ui.dialog.maxZ+=1;this.uiDialog.css("z-index",a.ui.dialog.maxZ);this.element.attr(e);this._trigger("focus",c);return this},
open:function(){if(!this._isOpen){var b;b=this.options;var c=this.uiDialog;this._size();this._position(b.position);c.show(b.show);this.overlay=b.modal?new a.ui.dialog.overlay(this):null;this.moveToTop(!0);b=this.element.find(":tabbable");b.length||(b=this.uiDialogButtonPane.find(":tabbable"),b.length||(b=c));b.eq(0).focus();this._isOpen=!0;this._trigger("open");return this}},_createButtons:function(b){var c=this,e=!1;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();"object"===typeof b&&null!==
b&&a.each(b,function(){return!(e=!0)});e?(a.each(b,function(b,e){e=a.isFunction(e)?{click:e,text:b}:e;var d=a("<button type='button'>").attr(e,!0).unbind("click").click(function(){e.click.apply(c.element[0],arguments)}).appendTo(c.uiButtonSet);a.fn.button&&d.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=
this,e=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,d){a(this).addClass("ui-dialog-dragging");c._trigger("dragStart",e,b(d))},drag:function(a,e){c._trigger("drag",a,b(e))},stop:function(d,f){e.position=[f.position.left-c.document.scrollLeft(),f.position.top-c.document.scrollTop()];a(this).removeClass("ui-dialog-dragging");c._trigger("dragStop",d,b(f));a.ui.dialog.overlay.resize()}})},
_makeResizable:function(b){function c(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}b=void 0===b?this.options.resizable:b;var e=this,d=this.options,f=this.uiDialog.css("position");b="string"===typeof b?b:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:this._minHeight(),handles:b,start:function(b,
d){a(this).addClass("ui-dialog-resizing");e._trigger("resizeStart",b,c(d))},resize:function(a,b){e._trigger("resize",a,c(b))},stop:function(b,l){a(this).removeClass("ui-dialog-resizing");d.height=a(this).height();d.width=a(this).width();e._trigger("resizeStop",b,c(l));a.ui.dialog.overlay.resize()}}).css("position",f).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var c=
[],e=[0,0],d;if(b){if("string"===typeof b||"object"===typeof b&&"0"in b)c=b.split?b.split(" "):[b[0],b[1]],1===c.length&&(c[1]=c[0]),a.each(["left","top"],function(a,b){+c[a]===c[a]&&(e[a]=c[a],c[a]=b)}),b={my:c.join(" "),at:c.join(" "),offset:e.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;(d=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.position(b);d||this.uiDialog.hide()},_setOptions:function(b){var c=this,e=
{},d=!1;a.each(b,function(a,b){c._setOption(a,b);a in La&&(d=!0);a in Ga&&(e[a]=b)});d&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",e)},_setOption:function(b,c){var e,d=this.uiDialog;switch(b){case "buttons":this._createButtons(c);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+c);break;case "dialogClass":d.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c);break;case "disabled":c?d.addClass("ui-dialog-disabled"):
d.removeClass("ui-dialog-disabled");break;case "draggable":(e=d.is(":data(draggable)"))&&!c&&d.draggable("destroy");!e&&c&&this._makeDraggable();break;case "position":this._position(c);break;case "resizable":(e=d.is(":data(resizable)"))&&!c&&d.resizable("destroy");e&&"string"===typeof c&&d.resizable("option","handles",c);!e&&!1!==c&&this._makeResizable(c);break;case "title":a(".ui-dialog-title",this.uiDialogTitlebar).html(""+(c||"&#160;"))}this._super(b,c)},_size:function(){var b,c,e=this.options,
d=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});e.minWidth>e.width&&(e.width=e.minWidth);b=this.uiDialog.css({height:"auto",width:e.width}).outerHeight();c=Math.max(0,e.minHeight-b);"auto"===e.height?a.support.minHeight?this.element.css({minHeight:c,height:"auto"}):(this.uiDialog.show(),b=this.element.css("height","auto").height(),d||this.uiDialog.hide(),this.element.height(Math.max(b,c))):this.element.height(Math.max(e.height-b,0));this.uiDialog.is(":data(resizable)")&&
this.uiDialog.resizable("option","minHeight",this._minHeight())}});a.extend(a.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");a||(a=this.uuid+=1);return"ui-dialog-title-"+a},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}});a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus mousedown mouseup keydown keypress click".split(" "),function(a){return a+".dialog-overlay"}).join(" "),create:function(b){0===this.instances.length&&(setTimeout(function(){a.ui.dialog.overlay.instances.length&&
a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var c=this.oldInstances.pop()||a("<div>").addClass("ui-widget-overlay");a(document).bind("keydown.dialog-overlay",function(e){var d=a.ui.dialog.overlay.instances;0!==d.length&&(d[d.length-1]===c&&b.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===a.ui.keyCode.ESCAPE)&&(b.close(e),e.preventDefault())});
c.appendTo(document.body).css({width:this.width(),height:this.height()});a.fn.bgiframe&&c.bgiframe();this.instances.push(c);return c},destroy:function(b){var c=a.inArray(b,this.instances),e=0;-1!==c&&this.oldInstances.push(this.instances.splice(c,1)[0]);0===this.instances.length&&a([document,window]).unbind(".dialog-overlay");b.height(0).width(0).remove();a.each(this.instances,function(){e=Math.max(e,this.css("z-index"))});this.maxZ=e},height:function(){var b,c;return a.browser.msie?(b=Math.max(document.documentElement.scrollHeight,
document.body.scrollHeight),c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),b<c?a(window).height()+"px":b+"px"):a(document).height()+"px"},width:function(){var b,c;return a.browser.msie?(b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),b<c?a(window).width()+"px":b+"px"):a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=
b.add(this)});b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}});a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}});var pa=!1;a.widget("ui.menu",{version:"1.9.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",
!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,a.proxy(function(a){this.options.disabled&&a.preventDefault()},this));this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true");this._on({"mousedown .ui-menu-item > a":function(a){a.preventDefault()},"click .ui-state-disabled > a":function(a){a.preventDefault()},"click .ui-menu-item:has(a)":function(b){var c=a(b.target).closest(".ui-menu-item");!pa&&
c.not(".ui-state-disabled").length&&(pa=!0,this.select(b),c.has(".ui-menu").length?this.expand(b):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){var c=a(b.currentTarget);c.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(b,c)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.children(".ui-menu-item").eq(0);
b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b);pa=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();
this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,
"\\$&")}var e,d,f,g,k=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);
break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:k=!1,e=this.previousFilter||"",d=String.fromCharCode(b.keyCode),f=!1,clearTimeout(this.filterTimer),d===e?f=!0:d=e+d,g=RegExp("^"+c(d),"i"),e=this.activeMenu.children(".ui-menu-item").filter(function(){return g.test(a(this).children("a").text())}),e=f&&-1!==e.index(this.active.next())?this.active.nextAll(".ui-menu-item"):e,e.length||(d=String.fromCharCode(b.keyCode),g=RegExp("^"+c(d),"i"),e=this.activeMenu.children(".ui-menu-item").filter(function(){return g.test(a(this).children("a").text())})),
e.length?(this.focus(b,e),1<e.length?(this.previousFilter=d,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter):delete this.previousFilter}k&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(a):this.select(a))},refresh:function(){var b,c=this.options.icons.submenu,e=this.element.find(this.options.menus+":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,
"aria-hidden":"true","aria-expanded":"false"});b=e.add(this.element);b.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});b.children(":not(.ui-menu-item)").each(function(){var b=a(this);/[^\-\u2014\u2013\s]/.test(b.text())||b.addClass("ui-widget-content ui-menu-divider")});b.children(".ui-state-disabled").attr("aria-disabled","true");e.each(function(){var b=a(this),
e=b.prev("a"),d=a("<span>").addClass("ui-menu-icon ui-icon "+c).data("ui-menu-submenu-carat",!0);e.attr("aria-haspopup","true").prepend(d);b.attr("aria-labelledby",e.attr("id"))});this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(a,b){var c;this.blur(a,a&&"focus"===a.type);this._scrollIntoView(b);this.active=b.first();c=this.active.children("a").addClass("ui-state-focus");this.options.role&&
this.element.attr("aria-activedescendant",c.attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay);c=b.children(".ui-menu");c.length&&/^mouse/.test(a.type)&&this._startOpening(c);this.activeMenu=b.parent();this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,e,d;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||
0,e=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,c=b.offset().top-this.activeMenu.offset().top-c-e,e=this.activeMenu.scrollTop(),d=this.activeMenu.height(),b=b.height(),0>c?this.activeMenu.scrollTop(e+c):c+b>d&&this.activeMenu.scrollTop(e+c-d+b))},blur:function(a,b){b||clearTimeout(this.timer);this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer);"true"===a.attr("aria-hidden")&&
(this.timer=this._delay(function(){this._close();this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true");b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer);this.timer=this._delay(function(){var e=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));
e.length||(e=this.element);this._close(e);this.blur(b);this.activeMenu=e},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element);a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();
b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var e;this.active&&(e="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+
"All"](".ui-menu-item").eq(0));if(!e||!e.length||!this.active)e=this.activeMenu.children(".ui-menu-item")[b]();this.focus(c,e)},nextPage:function(b){var c,e,d;this.active?this.isLastItem()||(this._hasScroll()?(e=this.active.offset().top,d=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){c=a(this);return 0>c.offset().top-e-d}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item")[!this.active?"first":"last"]())):this.next(b)},previousPage:function(b){var c,
e,d;this.active?this.isFirstItem()||(this._hasScroll()?(e=this.active.offset().top,d=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){c=a(this);return 0<c.offset().top-e+d}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item").first())):this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||
this.collapseAll(b,!0);this._trigger("select",b,c)}});a.widget("ui.progressbar",{version:"1.9.0",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},
_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(a){if(void 0===a)return this._value();this._setOption("value",a);return this},_setOption:function(a,b){"value"===a&&(this.options.value=b,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete"));this._super(a,b)},_value:function(){var a=
this.options.value;"number"!==typeof a&&(a=0);return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var a=this.value(),b=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change"));this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(b.toFixed(0)+"%");this.element.attr("aria-valuenow",a)}});a.widget("ui.slider",a.ui.mouse,{version:"1.9.0",widgetEventPrefix:"slide",
options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b,c=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),d=c.values&&c.values.length||1,f=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(c.disabled?
" ui-slider-disabled ui-disabled":""));this.range=a([]);c.range&&(!0===c.range&&(c.values||(c.values=[this._valueMin(),this._valueMin()]),c.values.length&&2!==c.values.length&&(c.values=[c.values[0],c.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===c.range||"max"===c.range?" ui-slider-range-"+c.range:"")));for(b=e.length;b<d;b++)f.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=e.add(a(f.join("")).appendTo(this.element));
this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).mouseenter(function(){c.disabled||a(this).addClass("ui-state-hover")}).mouseleave(function(){a(this).removeClass("ui-state-hover")}).focus(function(){c.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(b){a(this).data("ui-slider-handle-index",
b)});this._on(this.handles,{keydown:function(b){var c,e,d,l=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),c=this._start(b,l),!1===c))return}d=this.options.step;c=this.options.values&&this.options.values.length?
e=this.values(l):e=this.value();switch(b.keyCode){case a.ui.keyCode.HOME:e=this._valueMin();break;case a.ui.keyCode.END:e=this._valueMax();break;case a.ui.keyCode.PAGE_UP:e=this._trimAlignValue(c+(this._valueMax()-this._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:e=this._trimAlignValue(c-(this._valueMax()-this._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(c===this._valueMax())return;e=this._trimAlignValue(c+d);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c===
this._valueMin())return;e=this._trimAlignValue(c-d)}this._slide(b,l,e)},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}});this._refreshValue();this._animateOff=!1},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all");
this._mouseDestroy()},_mouseCapture:function(b){var c,e,d,f,g,k=this;g=this.options;if(g.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:b.pageX,y:b.pageY});e=this._valueMax()-this._valueMin()+1;this.handles.each(function(b){var l=Math.abs(c-k.values(b));e>l&&(e=l,d=a(this),f=b)});!0===g.range&&this.values(1)===g.min&&(f+=1,d=a(this.handles[f]));if(!1===this._start(b,f))return!1;
this._mouseSliding=!0;this._handleIndex=f;d.addClass("ui-state-active").focus();g=d.offset();this._clickOffset=!a(b.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:b.pageX-g.left-d.width()/2,top:b.pageY-g.top-d.height()/2-(parseInt(d.css("borderTopWidth"),10)||0)-(parseInt(d.css("borderBottomWidth"),10)||0)+(parseInt(d.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(b,f,c);return this._animateOff=!0},_mouseStart:function(){return!0},_mouseDrag:function(a){var b=
this._normValueFromMouse({x:a.pageX,y:a.pageY});this._slide(a,this._handleIndex,b);return!1},_mouseStop:function(a){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(a,this._handleIndex);this._change(a,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b;"horizontal"===this.orientation?(b=this.elementSize.width,
a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));b=a/b;1<b&&(b=1);0>b&&(b=0);"vertical"===this.orientation&&(b=1-b);a=this._valueMax()-this._valueMin();b=this._valueMin()+b*a;return this._trimAlignValue(b)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());
return this._trigger("start",a,c)},_slide:function(a,b,c){var e;if(this.options.values&&this.options.values.length){e=this.values(b?0:1);if(2===this.options.values.length&&!0===this.options.range&&(0===b&&c>e||1===b&&c<e))c=e;c!==this.values(b)&&(e=this.values(),e[b]=c,a=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),this.values(b?0:1),!1!==a&&this.values(b,c,!0))}else c!==this.value()&&(a=this._trigger("slide",a,{handle:this.handles[b],value:c}),!1!==a&&this.value(c))},_stop:function(a,
b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());this._trigger("change",a,c)}},value:function(a){if(arguments.length)this.options.value=this._trimAlignValue(a),this._refreshValue(),
this._change(null,0);else return this._value()},values:function(b,c){var e,d,f;if(1<arguments.length)this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b);else if(arguments.length)if(a.isArray(arguments[0])){e=this.options.values;d=arguments[0];for(f=0;f<e.length;f+=1)e[f]=this._trimAlignValue(d[f]),this._change(null,f);this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(b):this.value();else return this._values()},_setOption:function(b,
c){var e,d=0;a.isArray(this.options.values)&&(d=this.options.values.length);a.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(e=0;e<d;e+=1)this._change(null,e);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);b=this.options.values.slice();for(c=0;c<b.length;c+=1)b[c]=
this._trimAlignValue(b[c]);return b},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=0<this.options.step?this.options.step:1,c=(a-this._valueMin())%b;a-=c;2*Math.abs(c)>=b&&(a+=0<c?b:-b);return parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,e,d,f,g=this.options.range,k=this.options,j=this,n=!this._animateOff?k.animate:
!1,p={};if(this.options.values&&this.options.values.length)this.handles.each(function(e){c=100*((j.values(e)-j._valueMin())/(j._valueMax()-j._valueMin()));p["horizontal"===j.orientation?"left":"bottom"]=c+"%";a(this).stop(1,1)[n?"animate":"css"](p,k.animate);if(!0===j.options.range)if("horizontal"===j.orientation){if(0===e)j.range.stop(1,1)[n?"animate":"css"]({left:c+"%"},k.animate);if(1===e)j.range[n?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:k.animate})}else{if(0===e)j.range.stop(1,1)[n?
"animate":"css"]({bottom:c+"%"},k.animate);if(1===e)j.range[n?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:k.animate})}b=c});else{e=this.value();d=this._valueMin();f=this._valueMax();c=f!==d?100*((e-d)/(f-d)):0;p["horizontal"===this.orientation?"left":"bottom"]=c+"%";this.handle.stop(1,1)[n?"animate":"css"](p,k.animate);if("min"===g&&"horizontal"===this.orientation)this.range.stop(1,1)[n?"animate":"css"]({width:c+"%"},k.animate);if("max"===g&&"horizontal"===this.orientation)this.range[n?"animate":
"css"]({width:100-c+"%"},{queue:!1,duration:k.animate});if("min"===g&&"vertical"===this.orientation)this.range.stop(1,1)[n?"animate":"css"]({height:c+"%"},k.animate);if("max"===g&&"vertical"===this.orientation)this.range[n?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:k.animate})}}});var ea=function(a){return function(){var b=this.element.val();a.apply(this,arguments);this._refresh();b!==this.element.val()&&this._trigger("change")}};a.widget("ui.spinner",{version:"1.9.0",defaultElement:"<input>",
widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},
_getCreateOptions:function(){var b={},c=this.element;a.each(["min","max","step"],function(a,e){var d=c.attr(e);void 0!==d&&d.length&&(b[e]=d)});return b},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",focus:function(){this.uiSpinner.addClass("ui-state-active");this.previous=this.element.val()},blur:function(a){this.cancelBlur?delete this.cancelBlur:(this._refresh(),this.uiSpinner.removeClass("ui-state-active"),this.previous!==this.element.val()&&this._trigger("change",
a))},mousewheel:function(a,b){if(b){if(!this.spinning&&!this._start(a))return!1;this._spin((0<b?1:-1)*this.options.step,a);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(a)},100);a.preventDefault()}},"mousedown .ui-spinner-button":function(b){function c(){this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=e,this._delay(function(){this.previous=e}))}var e;e=this.element[0]===this.document[0].activeElement?
this.previous:this.element.val();b.preventDefault();c.call(this);this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;c.call(this)});!1!==this._start(b)&&this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(b){if(a(b.currentTarget).hasClass("ui-state-active")){if(!1===this._start(b))return!1;this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)}},"mouseleave .ui-spinner-button":"_stop"},
_draw:function(){var a=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this._hoverable(a);this.element.attr("role","spinbutton");this.buttons=a.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()>Math.ceil(0.5*a.height())&&0<a.height()&&a.height(a.height());this.options.disabled&&this.disable()},_keydown:function(b){var c=this.options,e=a.ui.keyCode;
switch(b.keyCode){case e.UP:return this._repeat(null,1,b),!0;case e.DOWN:return this._repeat(null,-1,b),!0;case e.PAGE_UP:return this._repeat(null,c.page,b),!0;case e.PAGE_DOWN:return this._repeat(null,-c.page,b),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-state-default ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+
this.options.icons.down+"'>&#9660;</span></a>"},_start:function(a){if(!this.spinning&&!1===this._trigger("start",a))return!1;this.counter||(this.counter=1);return this.spinning=!0},_repeat:function(a,b,c){a=a||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,b,c)},a);this._spin(b*this.options.step,c)},_spin:function(a,b){var c=this.value()||0;this.counter||(this.counter=1);c=this._adjustValue(c+a*this._increment(this.counter));if(!this.spinning||!1!==this._trigger("spin",
b,{value:c}))this._value(c),this.counter++},_increment:function(b){var c=this.options.incremental;return c?a.isFunction(c)?c(b):Math.floor(b*b*b/5E4-b*b/500+17*b/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min)));return a},_precisionOf:function(a){a=a.toString();var b=a.indexOf(".");return-1===b?0:a.length-b-1},_adjustValue:function(a){var b,c=this.options;b=null!==c.min?c.min:0;a=Math.round((a-b)/
c.step)*c.step;a=b+a;a=parseFloat(a.toFixed(this._precision()));return null!==c.max&&a>c.max?c.max:null!==c.min&&a<c.min?c.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,b){if("culture"===a||"numberFormat"===a){var c=this._parse(this.element.val());this.options[a]=b;this.element.val(this._format(c))}else{if("max"===a||"min"===a||"step"===a)"string"===typeof b&&(b=this._parse(b));
this._super(a,b);"disabled"===a&&(b?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))}},_setOptions:ea(function(a){this._super(a);this._value(this.element.val())}),_parse:function(a){"string"===typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):+a);return""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?
Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(a,b){var c;""!==a&&(c=this._parse(a),null!==c&&(b||(c=this._adjustValue(c)),a=this._format(c)));this.element.val(a);this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.uiSpinner.replaceWith(this.element)},stepUp:ea(function(a){this._stepUp(a)}),_stepUp:function(a){this._spin((a||1)*this.options.step)},stepDown:ea(function(a){this._stepDown(a)}),_stepDown:function(a){this._spin((a||1)*-this.options.step)},pageUp:ea(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:ea(function(a){this._stepDown((a||1)*this.options.page)}),value:function(a){if(!arguments.length)return this._parse(this.element.val());ea(this._value).call(this,a)},widget:function(){return this.uiSpinner}});
var L=function(a){a=a.cloneNode(!1);return 1<a.hash.length&&a.href.replace(C,"")===location.href.replace(C,"")},P=0,C=/#.*$/;a.widget("ui.tabs",{version:"1.9.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var b=this,c=this.options,e=c.active;this.running=!1;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",
c.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur()});this._processTabs();if(null===e&&(location.hash&&this.anchors.each(function(a,b){if(b.hash===location.hash)return e=a,!1}),null===e&&(e=this.tabs.filter(".ui-tabs-active").index()),null===e||-1===e))e=this.tabs.length?0:!1;!1!==e&&
(e=this.tabs.index(this.tabs.eq(e)),-1===e&&(e=c.collapsible?!1:0));c.active=e;!c.collapsible&&(!1===c.active&&this.anchors.length)&&(c.active=0);a.isArray(c.disabled)&&(c.disabled=a.unique(c.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort());this.active=!1!==this.options.active&&this.anchors.length?this._findActive(this.options.active):a();this._refresh();this.active.length&&this.load(c.active)},_getCreateEventData:function(){return{tab:this.active,
panel:!this.active.length?a():this._getPanelForTab(this.active)}},_tabKeydown:function(b){var c=a(this.document[0].activeElement).closest("li"),e=this.tabs.index(c),d=!0;if(!this._handlePageNav(b)){switch(b.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:e++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:d=!1;e--;break;case a.ui.keyCode.END:e=this.anchors.length-1;break;case a.ui.keyCode.HOME:e=0;break;case a.ui.keyCode.SPACE:b.preventDefault();clearTimeout(this.activating);this._activate(e);
return;case a.ui.keyCode.ENTER:b.preventDefault();clearTimeout(this.activating);this._activate(e===this.options.active?!1:e);return;default:return}b.preventDefault();clearTimeout(this.activating);e=this._focusNextTab(e,d);b.ctrlKey||(c.attr("aria-selected","false"),this.tabs.eq(e).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",e)},this.delay))}},_panelKeydown:function(b){!this._handlePageNav(b)&&(b.ctrlKey&&b.keyCode===a.ui.keyCode.UP)&&(b.preventDefault(),
this.active.focus())},_handlePageNav:function(b){if(b.altKey&&b.keyCode===a.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(b.altKey&&b.keyCode===a.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(b,c){function e(){b>d&&(b=0);0>b&&(b=d);return b}for(var d=this.tabs.length-1;-1!==a.inArray(e(),this.options.disabled);)b=c?b+1:b-1;return b},_focusNextTab:function(a,b){a=this._findNextTab(a,
b);this.tabs.eq(a).focus();return a},_setOption:function(a,b){"active"===a?this._activate(b):"disabled"===a?this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",b),!b&&!1===this.options.active&&this._activate(0)),"event"===a&&this._setupEvents(b),"heightStyle"===a&&this._setupHeightStyle(b))},_tabId:function(a){return a.attr("aria-controls")||"ui-tabs-"+ ++P},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,
"\\$&"):""},refresh:function(){var b=this.options,c=this.tablist.children(":has(a[href])");b.disabled=a.map(c.filter(".ui-state-disabled"),function(a){return c.index(a)});this._processTabs();!1===b.active||!this.anchors.length?(b.active=!1,this.active=a()):this.active.length&&!a.contains(this.tablist[0],this.active[0])?this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active);this._refresh()},
_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true",
"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var b=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return a("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=
a();this.anchors.each(function(c,e){var d,f,g,k=a(e).uniqueId().attr("id"),j=a(e).closest("li"),n=j.attr("aria-controls");L(e)?(d=e.hash,f=b.element.find(b._sanitizeSelector(d))):(g=b._tabId(j),d="#"+g,f=b.element.find(d),f.length||(f=b._createPanel(g),f.insertAfter(b.panels[c-1]||b.tablist)),f.attr("aria-live","polite"));f.length&&(b.panels=b.panels.add(f));n&&j.data("ui-tabs-aria-controls",n);j.attr({"aria-controls":d.substring(1),"aria-labelledby":k});f.attr("aria-labelledby",k)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role",
"tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(b){return a("<div>").attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(b){a.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(var c=0,e;e=this.tabs[c];c++)!0===b||-1!==a.inArray(c,b)?a(e).addClass("ui-state-disabled").attr("aria-disabled","true"):a(e).removeClass("ui-state-disabled").removeAttr("aria-disabled");
this.options.disabled=b},_setupEvents:function(b){var c={click:function(a){a.preventDefault()}};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,c);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(b){var c,e,d=this.element.parent();"fill"===b?(a.support.minHeight||(e=d.css("overflow"),d.css("overflow",
"hidden")),c=d.height(),this.element.siblings(":visible").each(function(){var b=a(this),e=b.css("position");"absolute"===e||"fixed"===e||(c-=b.outerHeight(!0))}),e&&d.css("overflow",e),this.element.children().not(this.panels).each(function(){c-=a(this).outerHeight(!0)}),this.panels.each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===b&&(c=0,this.panels.each(function(){c=Math.max(c,a(this).height("").height())}).height(c))},_eventHandler:function(b){var c=
this.options,e=this.active,d=a(b.currentTarget).closest("li"),f=d[0]===e[0],g=f&&c.collapsible,k=g?a():this._getPanelForTab(d),j=!e.length?a():this._getPanelForTab(e),e={oldTab:e,oldPanel:j,newTab:g?a():d,newPanel:k};b.preventDefault();if(!d.hasClass("ui-state-disabled")&&!d.hasClass("ui-tabs-loading")&&!this.running&&!(f&&!c.collapsible||!1===this._trigger("beforeActivate",b,e)))c.active=g?!1:this.tabs.index(d),this.active=f?a():d,this.xhr&&this.xhr.abort(),!j.length&&!k.length&&a.error("jQuery UI Tabs: Mismatching fragment identifier."),
k.length&&this.load(this.tabs.index(d),b),this._toggle(b,e)},_toggle:function(b,c){function e(){f.running=!1;f._trigger("activate",b,c)}function d(){c.newTab.closest("li").addClass("ui-tabs-active ui-state-active");g.length&&f.options.show?f._show(g,f.options.show,e):(g.show(),e())}var f=this,g=c.newPanel,k=c.oldPanel;this.running=!0;k.length&&this.options.hide?this._hide(k,this.options.hide,function(){c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");d()}):(c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
k.hide(),d());k.attr({"aria-expanded":"false","aria-hidden":"true"});c.oldTab.attr("aria-selected","false");g.length&&k.length?c.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1);g.attr({"aria-expanded":"true","aria-hidden":"false"});c.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(b){b=this._findActive(b);b[0]!==this.active[0]&&(b.length||(b=this.active),b=b.find(".ui-tabs-anchor")[0],this._eventHandler({target:b,
currentTarget:b,preventDefault:a.noop}))},_findActive:function(b){return!1===b?a():this.tabs.eq(b)},_getIndex:function(a){"string"===typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']")));return a},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId();
this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")});this.tabs.each(function(){var b=a(this),c=b.data("ui-tabs-aria-controls");
c?b.attr("aria-controls",c):b.removeAttr("aria-controls")});"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(b){var c=this.options.disabled;!1!==c&&(void 0===b?c=!1:(b=this._getIndex(b),c=a.isArray(c)?a.map(c,function(a){return a!==b?a:null}):a.map(this.tabs,function(a,c){return c!==b?c:null})),this._setupDisabled(c))},disable:function(b){var c=this.options.disabled;if(!0!==c){if(void 0===b)c=!0;else{b=this._getIndex(b);if(-1!==a.inArray(b,c))return;c=a.isArray(c)?
a.merge([b],c).sort():[b]}this._setupDisabled(c)}},load:function(b,c){b=this._getIndex(b);var e=this,d=this.tabs.eq(b),f=d.find(".ui-tabs-anchor"),g=this._getPanelForTab(d),k={tab:d,panel:g};if(!L(f[0])&&(this.xhr=a.ajax(this._ajaxSettings(f,c,k)))&&"canceled"!==this.xhr.statusText)d.addClass("ui-tabs-loading"),g.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){g.html(a);e._trigger("load",c,k)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&e.panels.stop(!1,
!0);d.removeClass("ui-tabs-loading");g.removeAttr("aria-busy");a===e.xhr&&delete e.xhr},1)})},_ajaxSettings:function(b,c,e){var d=this;return{url:b.attr("href"),beforeSend:function(b,f){return d._trigger("beforeLoad",c,a.extend({jqXHR:b,ajaxSettings:f},e))}}},_getPanelForTab:function(b){b=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+b))}});if(!1!==a.uiBackCompat){a.ui.tabs.prototype._ui=function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}};a.widget("ui.tabs",
a.ui.tabs,{url:function(a,b){this.anchors.eq(a).attr("href",b)}});a.widget("ui.tabs",a.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var b=this;this._on({tabsbeforeload:function(c,e){a.data(e.tab[0],"cache.tabs")?c.preventDefault():e.jqXHR.success(function(){b.options.cache&&a.data(e.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(b,c,e){var d=this.options.ajaxOptions;return a.extend({},d,{error:function(a,b){try{d.error(a,b,e.tab.closest("li").index(),e.tab[0])}catch(c){}}},
this._superApply(arguments))},_setOption:function(a,b){"cache"===a&&!1===b&&this.anchors.removeData("cache.tabs");this._super(a,b)},_destroy:function(){this.anchors.removeData("cache.tabs");this._super()},url:function(a,b){this.anchors.eq(a).removeData("cache.tabs");this._superApply(arguments)}});a.widget("ui.tabs",a.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}});a.widget("ui.tabs",a.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super();this._on({tabsbeforeload:function(a,
b){if(a.target===this.element[0]&&this.options.spinner){var c=b.tab.find("span"),e=c.html();c.html(this.options.spinner);b.jqXHR.complete(function(){c.html(e)})}}})}});a.widget("ui.tabs",a.ui.tabs,{options:{enable:null,disable:null},enable:function(b){var c=this.options,e;if(b&&!0===c.disabled||a.isArray(c.disabled)&&-1!==a.inArray(b,c.disabled))e=!0;this._superApply(arguments);e&&this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b]))},disable:function(b){var c=this.options,e;if(b&&
!1===c.disabled||a.isArray(c.disabled)&&-1===a.inArray(b,c.disabled))e=!0;this._superApply(arguments);e&&this._trigger("disable",null,this._ui(this.anchors[b],this.panels[b]))}});a.widget("ui.tabs",a.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(b,c,e){void 0===e&&(e=this.anchors.length);var d,f=this.options;c=a(f.tabTemplate.replace(/#\{href\}/g,b).replace(/#\{label\}/g,c));var g=!b.indexOf("#")?b.replace("#",""):this._tabId(c);
c.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",!0);c.attr("aria-controls",g);b=e>=this.tabs.length;d=this.element.find("#"+g);d.length||(d=this._createPanel(g),b?0<e?d.insertAfter(this.panels.eq(-1)):d.appendTo(this.element):d.insertBefore(this.panels[e]));d.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide();b?c.appendTo(this.tablist):c.insertBefore(this.tabs[e]);f.disabled=a.map(f.disabled,function(a){return a>=e?++a:a});this.refresh();1===this.tabs.length&&
!1===f.active&&this.option("active",0);this._trigger("add",null,this._ui(this.anchors[e],this.panels[e]));return this},remove:function(b){b=this._getIndex(b);var c=this.options,e=this.tabs.eq(b).remove(),d=this._getPanelForTab(e).remove();e.hasClass("ui-tabs-active")&&2<this.anchors.length&&this._activate(b+(b+1<this.anchors.length?1:-1));c.disabled=a.map(a.grep(c.disabled,function(a){return a!==b}),function(a){return a>=b?--a:a});this.refresh();this._trigger("remove",null,this._ui(e.find("a")[0],
d[0]));return this}});a.widget("ui.tabs",a.ui.tabs,{length:function(){return this.anchors.length}});a.widget("ui.tabs",a.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(b){b=b.is("li")?b.find("a[href]"):b;b=b[0];return a(b).closest("li").attr("aria-controls")||b.title&&b.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+ ++P}});a.widget("ui.tabs",a.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(b){return a(this.options.panelTemplate).attr("id",
b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}});a.widget("ui.tabs",a.ui.tabs,{_create:function(){var a=this.options;null===a.active&&void 0!==a.selected&&(a.active=-1===a.selected?!1:a.selected);this._super();a.selected=a.active;!1===a.selected&&(a.selected=-1)},_setOption:function(a,b){if("selected"!==a)return this._super(a,b);var c=this.options;this._super("active",-1===b?!1:b);c.selected=c.active;!1===c.selected&&(c.selected=-1)},_eventHandler:function(a){this._superApply(arguments);
this.options.selected=this.options.active;!1===this.options.selected&&(this.options.selected=-1)}});a.widget("ui.tabs",a.ui.tabs,{options:{show:null,select:null},_create:function(){this._super();!1!==this.options.active&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(a,b,c){var e=this._superApply(arguments);if(!e)return!1;"beforeActivate"===a&&c.newTab.length?e=this._super("select",b,{tab:c.newTab.find(".ui-tabs-anchor")[0],
panel:c.newPanel[0],index:c.newTab.closest("li").index()}):"activate"===a&&c.newTab.length&&(e=this._super("show",b,{tab:c.newTab.find(".ui-tabs-anchor")[0],panel:c.newPanel[0],index:c.newTab.closest("li").index()}));return e}});a.widget("ui.tabs",a.ui.tabs,{select:function(a){a=this._getIndex(a);if(-1===a)if(this.options.collapsible&&-1!==this.options.selected)a=this.options.selected;else return;this.anchors.eq(a).trigger(this.options.event+this.eventNamespace)}});var R=0;a.widget("ui.tabs",a.ui.tabs,
{options:{cookie:null},_create:function(){var a=this.options,b;null==a.active&&a.cookie&&(b=parseInt(this._cookie(),10),-1===b&&(b=!1),a.active=b);this._super()},_cookie:function(b){var c=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++R)];arguments.length&&(c.push(!1===b?-1:b),c.push(this.options.cookie));return a.cookie.apply(null,c)},_refresh:function(){this._super();this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(a){this._superApply(arguments);
this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super();this.options.cookie&&this._cookie(null,this.options.cookie)}});a.widget("ui.tabs",a.ui.tabs,{_trigger:function(b,c,e){e=a.extend({},e);"load"===b&&(e.panel=e.panel[0],e.tab=e.tab.find(".ui-tabs-anchor")[0]);return this._super(b,c,e)}});a.widget("ui.tabs",a.ui.tabs,{options:{fx:null},_getFx:function(){var b,c,e=this.options.fx;e&&(a.isArray(e)?(b=e[0],c=e[1]):b=c=e);return e?{show:c,hide:b}:
null},_toggle:function(a,b){function c(){d.running=!1;d._trigger("activate",a,b)}function e(){b.newTab.closest("li").addClass("ui-tabs-active ui-state-active");f.length&&k.show?f.animate(k.show,k.show.duration,function(){c()}):(f.show(),c())}var d=this,f=b.newPanel,g=b.oldPanel,k=this._getFx();if(!k)return this._super(a,b);d.running=!0;g.length&&k.hide?g.animate(k.hide,k.hide.duration,function(){b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");e()}):(b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
g.hide(),e())}})}var Fa=0;a.widget("ui.tooltip",{version:"1.9.0",options:{content:function(){return a(this).attr("title")},hide:!0,items:"[title]",position:{my:"left+15 center",at:"right center",collision:"flipfit flipfit"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={}},_setOption:function(b,c){var e=this;"disabled"===b?(this[c?"_disable":"_enable"](),this.options[b]=c):(this._super(b,c),"content"===b&&a.each(this.tooltips,
function(a,b){e._updateContent(b)}))},_disable:function(){var b=this;a.each(this.tooltips,function(c,e){var d=a.Event("blur");d.target=d.currentTarget=e[0];b.close(d,!0)});this.element.find(this.options.items).andSelf().each(function(){var b=a(this);b.is("[title]")&&b.data("ui-tooltip-title",b.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var b=a(this);b.data("ui-tooltip-title")&&b.attr("title",b.data("ui-tooltip-title"))})},
open:function(b){var c=a(b?b.target:this.element).closest(this.options.items);c.length&&(this.options.track&&c.data("ui-tooltip-id")?(this._find(c).position(a.extend({of:c},this.options.position)),this._off(this.document,"mousemove")):(c.attr("title")&&c.data("ui-tooltip-title",c.attr("title")),c.data("tooltip-open",!0),this._updateContent(c,b)))},_updateContent:function(a,b){var c;c=this.options.content;var e=this;if("string"===typeof c)return this._open(b,a,c);(c=c.call(a[0],function(c){a.data("tooltip-open")&&
e._delay(function(){this._open(b,a,c)})}))&&this._open(b,a,c)},_open:function(b,c,e){function d(a){g.of=a;f.position(g)}var f,g;if(e)if(f=this._find(c),f.length)f.find(".ui-tooltip-content").html(e);else{c.is("[title]")&&(b&&"mouseover"===b.type?c.attr("title",""):c.removeAttr("title"));f=this._tooltip(c);var k=f.attr("id"),j=(c.attr("aria-describedby")||"").split(/\s+/);j.push(k);c.data("ui-tooltip-id",k).attr("aria-describedby",a.trim(j.join(" ")));f.find(".ui-tooltip-content").html(e);this.options.track&&
b&&/^mouse/.test(b.originalEvent.type)?(g=a.extend({},this.options.position),this._on(this.document,{mousemove:d}),d(b)):f.position(a.extend({of:c},this.options.position));f.hide();this._show(f,this.options.show);this._trigger("open",b,{tooltip:f});this._on(c,{mouseleave:"close",focusout:"close",keyup:function(b){b.keyCode===a.ui.keyCode.ESCAPE&&(b=a.Event(b),b.currentTarget=c[0],this.close(b,!0))}})}},close:function(b,c){var e=this,d=a(b?b.currentTarget:this.element),f=this._find(d);if(!this.closing&&
(c||!b||!("focusout"!==b.type&&this.document[0].activeElement===d[0]))){d.data("ui-tooltip-title")&&d.attr("title",d.data("ui-tooltip-title"));var g=d.data("ui-tooltip-id"),k=(d.attr("aria-describedby")||"").split(/\s+/),g=a.inArray(g,k);-1!==g&&k.splice(g,1);d.removeData("ui-tooltip-id");(k=a.trim(k.join(" ")))?d.attr("aria-describedby",k):d.removeAttr("aria-describedby");f.stop(!0);this._hide(f,this.options.hide,function(){a(this).remove();delete e.tooltips[this.id]});d.removeData("tooltip-open");
this._off(d,"mouseleave focusout keyup");this._off(this.document,"mousemove");this.closing=!0;this._trigger("close",b,{tooltip:f});this.closing=!1}},_tooltip:function(b){var c="ui-tooltip-"+Fa++,e=a("<div>").attr({id:c,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));a("<div>").addClass("ui-tooltip-content").appendTo(e);e.appendTo(this.document[0].body);a.fn.bgiframe&&e.bgiframe();this.tooltips[c]=b;return e},_find:function(b){return(b=
b.data("ui-tooltip-id"))?a("#"+b):a()},_destroy:function(){var b=this;a.each(this.tooltips,function(c,e){var d=a.Event("blur");d.target=d.currentTarget=e[0];b.close(d,!0);a("#"+c).remove();e.data("ui-tooltip-title")&&(e.attr("title",e.data("ui-tooltip-title")),e.removeData("ui-tooltip-title"))})}});if(!a.effects){var I=a,ga=!1!==I.uiBackCompat;I.effects={effect:{}};var Ua=function(a,b,c){var e=Ha[b.type]||{};if(null==a)return c||!b.def?null:b.def;a=e.floor?~~a:parseFloat(a);return isNaN(a)?b.def:
e.mod?(a+e.mod)%e.mod:0>a?0:e.max<a?e.max:a},xa=function(b){var c=la(),e=c._rgba=[];b=b.toLowerCase();$(qa,function(a,d){var f,g=d.re.exec(b);f=g&&d.parse(g);g=d.space||"rgba";if(f)return f=c[g](f),c[ta[g].cache]=f[ta[g].cache],e=c._rgba=f._rgba,!1});return e.length?("0,0,0,0"===e.join()&&a.extend(e,Z.transparent),c):Z[b]},ka=function(a,b,c){c=(c+1)%1;return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a},Ka=/^([\-+])=\s*(\d+\.?\d*)/,qa=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],la=a.Color=function(b,c,e,d){return new a.Color.fn.parse(b,c,e,d)},ta={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},Ha={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},za=la.support={};B=a("<p>")[0];var Z,$=a.each;B.style.cssText="background-color:rgba(1,1,1,.5)";
za.rgba=-1<B.style.backgroundColor.indexOf("rgba");$(ta,function(a,b){b.cache="_"+a;b.props.alpha={idx:3,type:"percent",def:1}});la.fn=a.extend(la.prototype,{parse:function(b,c,e,d){if(void 0===b)return this._rgba=[null,null,null,null],this;if(b.jquery||b.nodeType)b=a(b).css(c),c=void 0;var f=this,g=a.type(b),k=this._rgba=[];void 0!==c&&(b=[b,c,e,d],g="array");if("string"===g)return this.parse(xa(b)||Z._default);if("array"===g)return $(ta.rgba.props,function(a,c){k[c.idx]=Ua(b[c.idx],c)}),this;if("object"===
g)return b instanceof la?$(ta,function(a,c){b[c.cache]&&(f[c.cache]=b[c.cache].slice())}):$(ta,function(a,c){var e=c.cache;$(c.props,function(a,d){if(!f[e]&&c.to){if("alpha"===a||null==b[a])return;f[e]=c.to(f._rgba)}f[e][d.idx]=Ua(b[a],d,!0)});f[e]&&0>I.inArray(null,f[e].slice(0,3))&&(f[e][3]=1,c.from&&(f._rgba=c.from(f[e])))}),this},is:function(a){var b=la(a),c=!0,e=this;$(ta,function(a,d){var f,g=b[d.cache];g&&(f=e[d.cache]||d.to&&d.to(e._rgba)||[],$(d.props,function(a,b){if(null!=g[b.idx])return c=
g[b.idx]===f[b.idx]}));return c});return c},_space:function(){var a=[],b=this;$(ta,function(c,e){b[e.cache]&&a.push(c)});return a.pop()},transition:function(a,b){var c=la(a),e=c._space(),d=ta[e],f=0===this.alpha()?la("transparent"):this,g=f[d.cache]||d.to(f._rgba),k=g.slice(),c=c[d.cache];$(d.props,function(a,e){var d=e.idx,f=g[d],l=c[d],j=Ha[e.type]||{};null!==l&&(null===f?k[d]=l:(j.mod&&(l-f>j.mod/2?f+=j.mod:f-l>j.mod/2&&(f-=j.mod)),k[d]=Ua((l-f)*b+f,e)))});return this[e](k)},blend:function(b){if(1===
this._rgba[3])return this;var c=this._rgba.slice(),e=c.pop(),d=la(b)._rgba;return la(a.map(c,function(a,b){return(1-e)*d[b]+e*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return null==a?2<b?1:0:a});1===c[3]&&(c.pop(),b="rgb(");return b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){null==a&&(a=2<b?1:0);b&&3>b&&(a=Math.round(100*a)+"%");return a});1===c[3]&&(c.pop(),b="hsl(");return b+c.join()+")"},toHexString:function(b){var c=
this._rgba.slice(),e=c.pop();b&&c.push(~~(255*e));return"#"+a.map(c,function(a){a=(a||0).toString(16);return 1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}});la.fn.parse.prototype=la.fn;ta.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/255,c=a[1]/255,e=a[2]/255;a=a[3];var d=Math.max(b,c,e),f=Math.min(b,c,e),g=d-f,k=d+f,j=0.5*k;return[Math.round(f===d?0:b===d?60*(c-e)/g+360:c===d?60*
(e-b)/g+120:60*(b-c)/g+240)%360,0===j||1===j?j:0.5>=j?g/k:g/(2-k),j,null==a?1:a]};ta.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],e=a[2];a=a[3];c=0.5>=e?e*(1+c):e+c-e*c;e=2*e-c;return[Math.round(255*ka(e,c,b+1/3)),Math.round(255*ka(e,c,b)),Math.round(255*ka(e,c,b-1/3)),a]};$(ta,function(b,c){var e=c.props,d=c.cache,f=c.to,g=c.from;la.fn[b]=function(b){f&&!this[d]&&(this[d]=f(this._rgba));if(void 0===b)return this[d].slice();var c,k=
a.type(b),l="array"===k||"object"===k?b:arguments,j=this[d].slice();$(e,function(a,b){var c=l["object"===k?a:b.idx];null==c&&(c=j[b.idx]);j[b.idx]=Ua(c,b)});return g?(c=la(g(j)),c[d]=j,c):la(j)};$(e,function(c,e){la.fn[c]||(la.fn[c]=function(d){var f=a.type(d),g="alpha"===c?this._hsla?"hsla":"rgba":b,k=this[g](),j=k[e.idx];if("undefined"===f)return j;"function"===f&&(d=d.call(this,j),f=a.type(d));if(null==d&&e.empty)return this;"string"===f&&(f=Ka.exec(d))&&(d=j+parseFloat(f[2])*("+"===f[1]?1:-1));
k[e.idx]=d;return this[g](k)})})});$("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),function(b,c){a.cssHooks[c]={set:function(b,e){var d,f="";if("string"!==a.type(e)||(d=xa(e))){e=la(d||e);if(!za.rgba&&1!==e._rgba[3]){for(d="backgroundColor"===c?b.parentNode:b;(""===f||"transparent"===f)&&d&&d.style;)try{f=a.css(d,"backgroundColor"),d=d.parentNode}catch(g){}e=e.blend(f&&"transparent"!==
f?f:"_default")}e=e.toRgbaString()}try{b.style[c]=e}catch(k){}}};a.fx.step[c]=function(b){b.colorInit||(b.start=la(b.elem,c),b.end=la(b.end),b.colorInit=!0);a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}});a.cssHooks.borderColor={expand:function(a){var b={};$(["Top","Right","Bottom","Left"],function(c,e){b["border"+e+"Color"]=a});return b}};Z=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",
olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};var ra=function(){var a=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,b={},c,e;if(a&&a.length&&a[0]&&a[a[0]])for(e=a.length;e--;)c=a[e],"string"===typeof a[c]&&(b[I.camelCase(c)]=a[c]);else for(c in a)"string"===typeof a[c]&&(b[c]=a[c]);return b},va=["add","remove","toggle"],
Ma={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};I.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){I.fx.step[c]=function(b){if("none"!==b.end&&!b.setAttr||1===b.pos&&!b.setAttr)a.style(b.elem,c,b.end),b.setAttr=!0}});I.effects.animateClass=function(b,c,e,d){var f=I.speed(c,e,d);return this.queue(function(){var c=I(this),e=c.attr("class")||"",d,g=f.children?c.find("*").andSelf():c,g=g.map(function(){return{el:I(this),
start:ra.call(this)}});d=function(){I.each(va,function(a,e){if(b[e])c[e+"Class"](b[e])})};d();g=g.map(function(){this.end=ra.call(this.el[0]);var a=this.start,b=this.end,c={},e,d;for(e in b)if(d=b[e],a[e]!==d&&!Ma[e]&&(I.fx.step[e]||!isNaN(parseFloat(d))))c[e]=d;this.diff=c;return this});c.attr("class",e);g=g.map(function(){var b=this,c=I.Deferred(),e=a.extend({},f,{queue:!1,complete:function(){c.resolve(b)}});this.el.animate(this.diff,e);return c.promise()});I.when.apply(I,g.get()).done(function(){d();
I.each(arguments,function(){var a=this.el;I.each(this.diff,function(b){a.css(b,"")})});f.complete.call(c[0])})})};I.fn.extend({_addClass:I.fn.addClass,addClass:function(a,b,c,e){return b?I.effects.animateClass.call(this,{add:a},b,c,e):this._addClass(a)},_removeClass:I.fn.removeClass,removeClass:function(a,b,c,e){return b?I.effects.animateClass.call(this,{remove:a},b,c,e):this._removeClass(a)},_toggleClass:I.fn.toggleClass,toggleClass:function(a,b,c,e,d){return"boolean"===typeof b||void 0===b?c?I.effects.animateClass.call(this,
b?{add:a}:{remove:a},c,e,d):this._toggleClass(a,b):I.effects.animateClass.call(this,{toggle:a},b,c,e)},switchClass:function(a,b,c,e,d){return I.effects.animateClass.call(this,{add:b,remove:a},c,e,d)}});var Qa=function(a,b,c,e){I.isPlainObject(a)&&(b=a,a=a.effect);a={effect:a};void 0===b&&(b={});I.isFunction(b)&&(e=b,c=null,b={});if("number"===typeof b||I.fx.speeds[b])e=c,c=b,b={};I.isFunction(c)&&(e=c,c=null);b&&I.extend(a,b);c=c||b.duration;a.duration=I.fx.off?0:"number"===typeof c?c:c in I.fx.speeds?
I.fx.speeds[c]:I.fx.speeds._default;a.complete=e||b.complete;return a},Ca=function(a){return!a||"number"===typeof a||I.fx.speeds[a]?!0:"string"===typeof a&&!I.effects.effect[a]?ga&&I.effects[a]?!1:!0:!1};I.extend(I.effects,{version:"1.9.0",save:function(a,b){for(var c=0;c<b.length;c++)null!==b[c]&&a.data("ui-effects-"+b[c],a[0].style[b[c]])},restore:function(a,b){var c,e;for(e=0;e<b.length;e++)null!==b[e]&&(c=a.data("ui-effects-"+b[e]),void 0===c&&(c=""),a.css(b[e],c))},setMode:function(a,b){"toggle"===
b&&(b=a.is(":hidden")?"show":"hide");return b},getBaseline:function(a,b){var c,e;switch(a[0]){case "top":c=0;break;case "middle":c=0.5;break;case "bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case "left":e=0;break;case "center":e=0.5;break;case "right":e=1;break;default:e=a[1]/b.width}return{x:e,y:c}},createWrapper:function(a){if(a.parent().is(".ui-effects-wrapper"))return a.parent();var b={width:a.outerWidth(!0),height:a.outerHeight(!0),"float":a.css("float")},c=I("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",
background:"transparent",border:"none",margin:0,padding:0}),e={width:a.width(),height:a.height()},d=document.activeElement;try{d.id}catch(f){d=document.body}a.wrap(c);(a[0]===d||I.contains(a[0],d))&&I(d).focus();c=a.parent();"static"===a.css("position")?(c.css({position:"relative"}),a.css({position:"relative"})):(I.extend(b,{position:a.css("position"),zIndex:a.css("z-index")}),I.each(["top","left","bottom","right"],function(c,e){b[e]=a.css(e);isNaN(parseInt(b[e],10))&&(b[e]="auto")}),a.css({position:"relative",
top:0,left:0,right:"auto",bottom:"auto"}));a.css(e);return c.css(b).show()},removeWrapper:function(a){var b=document.activeElement;a.parent().is(".ui-effects-wrapper")&&(a.parent().replaceWith(a),(a[0]===b||I.contains(a[0],b))&&I(b).focus());return a},setTransition:function(a,b,c,e){e=e||{};I.each(b,function(b,d){var f=a.cssUnit(d);0<f[0]&&(e[d]=f[0]*c+f[1])});return e}});I.fn.extend({effect:function(a,b,c,e){function d(a){function b(){I.isFunction(e)&&e.call(c[0]);I.isFunction(a)&&a()}var c=I(this),
e=f.complete,g=f.mode;(c.is(":hidden")?"hide"===g:"show"===g)?b():j.call(c[0],f,b)}var f=Qa.apply(this,arguments),g=f.mode,k=f.queue,j=I.effects.effect[f.effect],n=!j&&ga&&I.effects[f.effect];return I.fx.off||!j&&!n?g?this[g](f.duration,f.complete):this.each(function(){f.complete&&f.complete.call(this)}):j?!1===k?this.each(d):this.queue(k||"fx",d):n.call(this,{options:f,duration:f.duration,callback:f.complete,mode:f.mode})},_show:I.fn.show,show:function(a){if(Ca(a))return this._show.apply(this,arguments);
var b=Qa.apply(this,arguments);b.mode="show";return this.effect.call(this,b)},_hide:I.fn.hide,hide:function(a){if(Ca(a))return this._hide.apply(this,arguments);var b=Qa.apply(this,arguments);b.mode="hide";return this.effect.call(this,b)},__toggle:I.fn.toggle,toggle:function(a){if(Ca(a)||"boolean"===typeof a||I.isFunction(a))return this.__toggle.apply(this,arguments);var b=Qa.apply(this,arguments);b.mode="toggle";return this.effect.call(this,b)},cssUnit:function(a){var b=this.css(a),c=[];I.each(["em",
"px","%","pt"],function(a,e){0<b.indexOf(e)&&(c=[parseFloat(b),e])});return c}});var Aa={};I.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,b){Aa[b]=function(b){return Math.pow(b,a+2)}});I.extend(Aa,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,--c))-1)/11;);
return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}});I.each(Aa,function(a,b){I.easing["easeIn"+a]=b;I.easing["easeOut"+a]=function(a){return 1-b(1-a)};I.easing["easeInOut"+a]=function(a){return 0.5>a?b(2*a)/2:1-b(-2*a+2)/2}})}var na=/up|down|vertical/,Pa=/up|left|vertical|horizontal/;a.effects.effect.blind=function(b,c){var e=a(this),d="position top bottom left right height width".split(" "),f=a.effects.setMode(e,b.mode||"hide"),g=b.direction||"up",k=na.test(g),j=k?"height":"width",n=k?"top":
"left",g=Pa.test(g),p={},r="show"===f,u,s,v;e.parent().is(".ui-effects-wrapper")?a.effects.save(e.parent(),d):a.effects.save(e,d);e.show();u=a.effects.createWrapper(e).css({overflow:"hidden"});s=u[j]();v=parseFloat(u.css(n))||0;p[j]=r?s:0;g||(e.css(k?"bottom":"right",0).css(k?"top":"left","auto").css({position:"absolute"}),p[n]=r?v:s+v);r&&(u.css(j,0),g||u.css(n,v+s));u.animate(p,{duration:b.duration,easing:b.easing,queue:!1,complete:function(){"hide"===f&&e.hide();a.effects.restore(e,d);a.effects.removeWrapper(e);
c()}})};a.effects.effect.bounce=function(b,c){var e=a(this),d="position top bottom left right height width".split(" "),f=a.effects.setMode(e,b.mode||"effect"),g="hide"===f,k="show"===f,j=b.direction||"up",f=b.distance,n=b.times||5,p=2*n+(k||g?1:0),r=b.duration/p,u=b.easing,s="up"===j||"down"===j?"top":"left",j="up"===j||"left"===j,v,t,x=e.queue(),y=x.length;(k||g)&&d.push("opacity");a.effects.save(e,d);e.show();a.effects.createWrapper(e);f||(f=e["top"===s?"outerHeight":"outerWidth"]()/3);k&&(t={opacity:1},
t[s]=0,e.css("opacity",0).css(s,j?2*-f:2*f).animate(t,r,u));g&&(f/=Math.pow(2,n-1));t={};for(k=t[s]=0;k<n;k++)v={},v[s]=(j?"-=":"+=")+f,e.animate(v,r,u).animate(t,r,u),f=g?2*f:f/2;g&&(v={opacity:0},v[s]=(j?"-=":"+=")+f,e.animate(v,r,u));e.queue(function(){g&&e.hide();a.effects.restore(e,d);a.effects.removeWrapper(e);c()});1<y&&x.splice.apply(x,[1,0].concat(x.splice(y,p+1)));e.dequeue()};a.effects.effect.clip=function(b,c){var e=a(this),d="position top bottom left right height width".split(" "),f=
"show"===a.effects.setMode(e,b.mode||"hide"),g="vertical"===(b.direction||"vertical"),k=g?"height":"width",g=g?"top":"left",j={},n,p;a.effects.save(e,d);e.show();n=a.effects.createWrapper(e).css({overflow:"hidden"});n="IMG"===e[0].tagName?n:e;p=n[k]();f&&(n.css(k,0),n.css(g,p/2));j[k]=f?p:0;j[g]=f?0:p/2;n.animate(j,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){f||e.hide();a.effects.restore(e,d);a.effects.removeWrapper(e);c()}})};a.effects.effect.drop=function(b,c){var e=a(this),
d="position top bottom left right opacity height width".split(" "),f=a.effects.setMode(e,b.mode||"hide"),g="show"===f,k=b.direction||"left",j="up"===k||"down"===k?"top":"left",k="up"===k||"left"===k?"pos":"neg",n={opacity:g?1:0},p;a.effects.save(e,d);e.show();a.effects.createWrapper(e);p=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0)/2;g&&e.css("opacity",0).css(j,"pos"===k?-p:p);n[j]=(g?"pos"===k?"+=":"-=":"pos"===k?"-=":"+=")+p;e.animate(n,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===
f&&e.hide();a.effects.restore(e,d);a.effects.removeWrapper(e);c()}})};var Oa=a;Oa.effects.effect.explode=function(a,b){function c(){p.push(this);p.length===e*d&&(f.css({visibility:"visible"}),Oa(p).remove(),g||f.hide(),b())}var e=a.pieces?Math.round(Math.sqrt(a.pieces)):3,d=e,f=Oa(this),g="show"===Oa.effects.setMode(f,a.mode||"hide"),k=f.show().css("visibility","hidden").offset(),j=Math.ceil(f.outerWidth()/d),n=Math.ceil(f.outerHeight()/e),p=[],r,u,s,v,t,x;for(r=0;r<e;r++){v=k.top+r*n;x=r-(e-1)/2;
for(u=0;u<d;u++)s=k.left+u*j,t=u-(d-1)/2,f.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-u*j,top:-r*n}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:j,height:n,left:s+(g?t*j:0),top:v+(g?x*n:0),opacity:g?0:1}).animate({left:s+(g?0:t*j),top:v+(g?0:x*n),opacity:g?1:0},a.duration||500,a.easing,c)}};a.effects.effect.fade=function(b,c){var e=a(this),d=a.effects.setMode(e,b.mode||"toggle");e.animate({opacity:d},
{queue:!1,duration:b.duration,easing:b.easing,complete:c})};a.effects.effect.fold=function(b,c){var e=a(this),d="position top bottom left right height width".split(" "),f=a.effects.setMode(e,b.mode||"hide"),g="show"===f,k="hide"===f,f=b.size||15,j=/([0-9]+)%/.exec(f),n=!!b.horizFirst,p=g!==n,r=p?["width","height"]:["height","width"],u=b.duration/2,s,v={},t={};a.effects.save(e,d);e.show();s=a.effects.createWrapper(e).css({overflow:"hidden"});p=p?[s.width(),s.height()]:[s.height(),s.width()];j&&(f=
parseInt(j[1],10)/100*p[k?0:1]);g&&s.css(n?{height:0,width:f}:{height:f,width:0});v[r[0]]=g?p[0]:f;t[r[1]]=g?p[1]:0;s.animate(v,u,b.easing).animate(t,u,b.easing,function(){k&&e.hide();a.effects.restore(e,d);a.effects.removeWrapper(e);c()})};a.effects.effect.highlight=function(b,c){var e=a(this),d=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(e,b.mode||"show"),g={backgroundColor:e.css("backgroundColor")};"hide"===f&&(g.opacity=0);a.effects.save(e,d);e.show().css({backgroundImage:"none",
backgroundColor:b.color||"#ffff99"}).animate(g,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===f&&e.hide();a.effects.restore(e,d);c()}})};a.effects.effect.pulsate=function(b,c){var e=a(this),d=a.effects.setMode(e,b.mode||"show"),f="show"===d,g="hide"===d,d=2*(b.times||5)+(f||"hide"===d?1:0),k=b.duration/d,j=0,n=e.queue(),p=n.length;if(f||!e.is(":visible"))e.css("opacity",0).show(),j=1;for(f=1;f<d;f++)e.animate({opacity:j},k,b.easing),j=1-j;e.animate({opacity:j},k,b.easing);
e.queue(function(){g&&e.hide();c()});1<p&&n.splice.apply(n,[1,0].concat(n.splice(p,d+1)));e.dequeue()};a.effects.effect.puff=function(b,c){var e=a(this),d=a.effects.setMode(e,b.mode||"hide"),f="hide"===d,g=parseInt(b.percent,10)||150,k=g/100,j={height:e.height(),width:e.width()};a.extend(b,{effect:"scale",queue:!1,fade:!0,mode:d,complete:c,percent:f?g:100,from:f?j:{height:j.height*k,width:j.width*k}});e.effect(b)};a.effects.effect.scale=function(b,c){var e=a(this),d=a.extend(!0,{},b),f=a.effects.setMode(e,
b.mode||"effect"),g=parseInt(b.percent,10)||(0===parseInt(b.percent,10)?0:"hide"===f?0:100),k=b.direction||"both",j=b.origin,n={height:e.height(),width:e.width(),outerHeight:e.outerHeight(),outerWidth:e.outerWidth()},p="horizontal"!==k?g/100:1,g="vertical"!==k?g/100:1;d.effect="size";d.queue=!1;d.complete=c;"effect"!==f&&(d.origin=j||["middle","center"],d.restore=!0);d.from=b.from||("show"===f?{height:0,width:0}:n);d.to={height:n.height*p,width:n.width*g,outerHeight:n.outerHeight*p,outerWidth:n.outerWidth*
g};d.fade&&("show"===f&&(d.from.opacity=0,d.to.opacity=1),"hide"===f&&(d.from.opacity=1,d.to.opacity=0));e.effect(d)};a.effects.effect.size=function(b,c){var e,d,f,g,k=a(this),j="position top bottom left right width height overflow opacity".split(" "),n="position top bottom left right overflow opacity".split(" "),p=["width","height","overflow"],r=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],s=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],
v=a.effects.setMode(k,b.mode||"effect"),t=b.restore||"effect"!==v,x=b.scale||"both",y=b.origin||["middle","center"],K,z=k.css("position");"show"===v&&k.show();K={height:k.height(),width:k.width(),outerHeight:k.outerHeight(),outerWidth:k.outerWidth()};k.from=b.from||K;k.to=b.to||K;f=k.from.height/K.height;g=k.from.width/K.width;e=k.to.height/K.height;d=k.to.width/K.width;if("box"===x||"both"===x)f!==e&&(j=j.concat(u),k.from=a.effects.setTransition(k,u,f,k.from),k.to=a.effects.setTransition(k,u,e,k.to)),
g!==d&&(j=j.concat(s),k.from=a.effects.setTransition(k,s,g,k.from),k.to=a.effects.setTransition(k,s,d,k.to));if(("content"===x||"both"===x)&&f!==e)j=j.concat(r),k.from=a.effects.setTransition(k,r,f,k.from),k.to=a.effects.setTransition(k,r,e,k.to);a.effects.save(k,t?j:n);k.show();a.effects.createWrapper(k);k.css("overflow","hidden").css(k.from);y&&(y=a.effects.getBaseline(y,K),k.from.top=(K.outerHeight-k.outerHeight())*y.y,k.from.left=(K.outerWidth-k.outerWidth())*y.x,k.to.top=(K.outerHeight-k.to.outerHeight)*
y.y,k.to.left=(K.outerWidth-k.to.outerWidth)*y.x);k.css(k.from);if("content"===x||"both"===x)u=u.concat(["marginTop","marginBottom"]).concat(r),s=s.concat(["marginLeft","marginRight"]),p=j.concat(u).concat(s),k.find("*[width]").each(function(){var c=a(this),k=c.height(),j=c.width();t&&a.effects.save(c,p);c.from={height:k*f,width:j*g};c.to={height:k*e,width:j*d};f!==e&&(c.from=a.effects.setTransition(c,u,f,c.from),c.to=a.effects.setTransition(c,u,e,c.to));g!==d&&(c.from=a.effects.setTransition(c,s,
g,c.from),c.to=a.effects.setTransition(c,s,d,c.to));c.css(c.from);c.animate(c.to,b.duration,b.easing,function(){t&&a.effects.restore(c,p)})});k.animate(k.to,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){0===k.to.opacity&&k.css("opacity",k.from.opacity);"hide"===v&&k.hide();a.effects.restore(k,t?j:n);t||("static"===z?k.css({position:"relative",top:k.to.top,left:k.to.left}):a.each(["top","left"],function(a,b){k.css(b,function(b,c){var e=parseInt(c,10),d=a?k.to.left:k.to.top;return"auto"===
c?d+"px":e+d+"px"})}));a.effects.removeWrapper(k);c()}})};a.effects.effect.shake=function(b,c){var e=a(this),d="position top bottom left right height width".split(" "),f=a.effects.setMode(e,b.mode||"effect"),g=b.direction||"left",k=b.distance||20,j=b.times||3,n=2*j+1,p=Math.round(b.duration/n),r="up"===g||"down"===g?"top":"left",u="up"===g||"left"===g,g={},s={},v={},t=e.queue(),x=t.length;a.effects.save(e,d);e.show();a.effects.createWrapper(e);g[r]=(u?"-=":"+=")+k;s[r]=(u?"+=":"-=")+2*k;v[r]=(u?"-=":
"+=")+2*k;e.animate(g,p,b.easing);for(k=1;k<j;k++)e.animate(s,p,b.easing).animate(v,p,b.easing);e.animate(s,p,b.easing).animate(g,p/2,b.easing).queue(function(){"hide"===f&&e.hide();a.effects.restore(e,d);a.effects.removeWrapper(e);c()});1<x&&t.splice.apply(t,[1,0].concat(t.splice(x,n+1)));e.dequeue()};a.effects.effect.slide=function(b,c){var e=a(this),d="position top bottom left right width height".split(" "),f=a.effects.setMode(e,b.mode||"show"),g="show"===f,k=b.direction||"left",j="up"===k||"down"===
k?"top":"left",k="up"===k||"left"===k,n,p={};a.effects.save(e,d);e.show();n=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0);a.effects.createWrapper(e).css({overflow:"hidden"});g&&e.css(j,k?isNaN(n)?"-"+n:-n:n);p[j]=(g?k?"+=":"-=":k?"-=":"+=")+n;e.animate(p,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===f&&e.hide();a.effects.restore(e,d);a.effects.removeWrapper(e);c()}})};a.effects.effect.transfer=function(b,c){var e=a(this),d=a(b.to),f="fixed"===d.css("position"),
g=a("body"),k=f?g.scrollTop():0,g=f?g.scrollLeft():0,j=d.offset(),d={top:j.top-k,left:j.left-g,height:d.innerHeight(),width:d.innerWidth()},j=e.offset(),n=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.className).css({top:j.top-k,left:j.left-g,height:e.innerHeight(),width:e.innerWidth(),position:f?"fixed":"absolute"}).animate(d,b.duration,b.easing,function(){n.remove();c()})}});define("ui/tab","aloha/core jquery ui/container ui/component PubSub jqueryui".split(" "),
function(a,b,d,p,r){var s=0,t={};a=d.extend({_elemBySlot:null,_groupBySlot:null,_groupByComponent:null,_constructor:function(a,d,n){var j,e,p,r,c;this._elemBySlot={};this._groupBySlot={};this._groupByComponent={};this._super(a,d);this.container=d.container;this.list=this.container.data("list");this.panels=this.container.data("panels");this.id="tab-ui-container-"+ ++s;this.panel=b("<div>",{id:this.id,unselectable:"on"});this.handle=b('<li><a href="'+location.href.replace(/#.*$/,"")+"#"+this.id+'">'+
d.label+"</a></li>");for(a=0;a<n.length;a++)if("string"==typeof n[a])1===n[a].length&&10===n[a].charCodeAt(0)?this.panel.append("<div>",{unselectable:"on"}):(e=b("<span>",{unselectable:"on"}),this._elemBySlot[n[a]]=e,this.panel.append(e));else{r=b("<div>",{"class":"aloha-ui-component-group aloha-ui-hidden",unselectable:"on"}).appendTo(this.panel);c={element:r,visibleCounter:0};p=n[a];for(j=0;j<p.length;j++)this._groupBySlot[p[j]]=c,p[j]&&1===p[j].length&&10===p[j].charCodeAt(0)?r.append(b("<div>",
{unselectable:"on"})):(e=b("<span>",{unselectable:"on"}),this._elemBySlot[p[j]]=e,r.append(e))}this.panel.append(b("<div>",{"class":"aloha-ui-clear",unselectable:"on"}));this.handle.appendTo(this.list);this.panel.appendTo(this.panels);this.container.tabs("refresh");d=d.container.data("aloha-tabs");this.index=d.length;d.push(this)},adoptInto:function(a,b){var d=this._elemBySlot[a],j;return d?(t[a]=b,b.adoptParent(this),d.append(b.element),j=this._groupBySlot[a],j&&(this._groupByComponent[b.id]=j,b.isVisible()&&
(j.visibleCounter||j.element.removeClass("aloha-ui-hidden"),j.visibleCounter+=1)),!0):!1},foreground:function(){this.container.tabs("select",this.index)},childForeground:function(){this.foreground()},hasVisibleComponents:function(){var a=this._elemBySlot,b;for(b in a)if(a.hasOwnProperty(b)&&t[b]&&t[b].visible)return!0;return!1},childVisible:function(a,b){b?a.container.show():a.container.hasVisibleComponents()||a.container.hide();var d=this._groupByComponent[a.id];d&&(b?(0===d.visibleCounter&&d.element.removeClass("aloha-ui-hidden"),
d.visibleCounter+=1):(d.visibleCounter-=1,0===d.visibleCounter&&d.element.addClass("aloha-ui-hidden")))},show:function(){this.list.children().length&&(this.handle.show(),this.visible=!0,this.container.show(),(!this.container.find(".ui-tabs-active").length||this.container.tabs("option","selected")===this.index)&&this.foreground())},hide:function(){var a=this.list.children();if(0!==a.length&&(this.handle.hide(),this.visible=!1,this.index===this.container.tabs("option","selected"))){var a=this.container.data("aloha-tabs"),
b;for(b=0;b<a.length;++b)if(a[b].visible){this.container.tabs("select",b);return}this.handle.removeClass("ui-tabs-active");this.container.hide()}}});return b.extend(a,{createContainer:function(){var a=b("<div>",{unselectable:"on"}),d=b("<ul>",{unselectable:"on"}).appendTo(a),n=b("<div>",{unselectable:"on"}).appendTo(a);return a.data("list",d).data("panels",n).data("aloha-tabs",[]).tabs({select:function(b,e){var d=a.data("aloha-tabs");a.data("aloha-active-container",d[e.index]);r.pub("aloha.ui.container.selected",
{data:d[e.index]})}}),a}}),a});define("ui/subguarded",["aloha/core","jquery","PubSub"],function(a,b,d){function p(a){var b=t[a]||[],d;for(d=0;d<b.length;d++)b[d].apply(null,[s[b[d].alohaUid]||[]].concat(arguments))}var r=0,s={},t={};return function(){var b=Array.prototype.slice.call(arguments),f=b.shift();"string"===typeof f&&(f=[f]);var n=b.shift(),j=n;j.alohaUid||(j.alohaUid=++r);j=n;s[j.alohaUid]||(s[j.alohaUid]=[]);s[j.alohaUid].push(b);for(var e,j=function(a,b,c){p(e,a,b,c)},v=function(){p(e)},
b=0;b<f.length;b++){var x=e=f[b],c=n;t[x]||(t[x]=[]);t[x].push(c);a.bind(e,j);d.sub(e,v)}}});define("vendor/amplify.store",["util/json2"],function(){var a={},b=function(a,b){d.addType(a,function(f,c,g){var k,j=c,n=(new Date).getTime();if(!f){j={};g=[];c=0;try{for(f=b.length;f=b.key(c++);)p.test(f)&&(k=da.parse(b.getItem(f)),k.expires&&k.expires<=n?g.push(f):j[f.replace(p,"")]=k.data);for(;f=g.pop();)b.removeItem(f)}catch(r){}return j}f="__amplify__"+f;if(void 0===c)if(k=(k=b.getItem(f))?da.parse(k):
{expires:-1},k.expires&&k.expires<=n)b.removeItem(f);else return k.data;else if(null===c)b.removeItem(f);else{k=da.stringify({data:c,expires:g.expires?n+g.expires:null});try{b.setItem(f,k)}catch(s){d[a]();try{b.setItem(f,k)}catch(t){throw d.error();}}}return j})},d=a.store=function(a,b,f,c){c=d.type;f&&(f.type&&f.type in d.types)&&(c=f.type);return d.types[c](a,b,f||{})};d.types={};d.type=null;d.addType=function(a,b){d.type||(d.type=a);d.types[a]=b;d[a]=function(b,c,f){f=f||{};f.type=a;return d(b,
c,f)}};d.error=function(){return"amplify.store quota exceeded"};var p=/^__amplify__/,r;for(r in{localStorage:1,sessionStorage:1})try{window[r].getItem&&b(r,window[r])}catch(s){}if(window.globalStorage)try{b("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===d.type&&(d.type="globalStorage")}catch(t){}a:if(!d.types.localStorage){var g=document.createElement("div");g.style.display="none";document.getElementsByTagName("head")[0].appendChild(g);try{g.addBehavior("#default#userdata"),
g.load("amplify")}catch(f){g.parentNode.removeChild(g);break a}d.addType("userData",function(a,b,f){g.load("amplify");var c,j,k=b,n=(new Date).getTime();if(!a){k={};j=[];for(a=0;b=g.XMLDocument.documentElement.attributes[a++];)c=da.parse(b.value),c.expires&&c.expires<=n?j.push(b.name):k[b.name]=c.data;for(;a=j.pop();)g.removeAttribute(a);g.save("amplify");return k}a=a.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");if(void 0===b)if(c=
(b=g.getAttribute(a))?da.parse(b):{expires:-1},c.expires&&c.expires<=n)g.removeAttribute(a);else return c.data;else null===b?g.removeAttribute(a):(j=g.getAttribute(a),c=da.stringify({data:b,expires:f.expires?n+f.expires:null}),g.setAttribute(a,c));try{g.save("amplify")}catch(p){null===j?g.removeAttribute(a):g.setAttribute(a,j);d.userData();try{g.setAttribute(a,c),g.save("amplify")}catch(r){throw null===j?g.removeAttribute(a):g.setAttribute(a,j),d.error();}}return k})}var n={},j={};d.addType("memory",
function(a,b,d){if(!a)return void 0===n?void 0:da.parse(da.stringify(n));if(void 0===b)return void 0===n[a]?void 0:da.parse(da.stringify(n[a]));j[a]&&(clearTimeout(j[a]),delete j[a]);if(null===b)return delete n[a],null;n[a]=b;d.expires&&(j[a]=setTimeout(function(){delete n[a];delete j[a]},d.expires));return b});return a});define("ui/floating","jquery aloha/core ui/surface ui/subguarded PubSub vendor/amplify.store".split(" "),function(a,b,d,p,r,s){function t(a,b,c,d){"absolute"===j&&(b.top+=n.scrollTop(),
b.left+=n.scrollLeft());e.offset=b;a.stop().animate(b,c,function(){d(b);r.pub("aloha.floating.changed",{position:e})})}function g(a){s.store("Aloha.FloatingMenu.pinned","true");s.store("Aloha.FloatingMenu.top",a.top);s.store("Aloha.FloatingMenu.left",a.left)}function f(a,b,c,e,d){for(b=0;b<a.length;b++)if(a[b][0].isActive())a[b][1](c,e,d)}var n=a(window),j=a.browser.msie&&/^7\.\d+/.test(a.browser.version)?"absolute":"fixed",e={style:j,offset:{top:0,left:0}};return{getPinState:function(){return"true"===
s.store("Aloha.FloatingMenu.pinned")?{top:parseInt(s.store("Aloha.FloatingMenu.top"),10),left:parseInt(s.store("Aloha.FloatingMenu.left"),10),isPinned:!0}:{top:null,left:null,isPinned:!1}},makeFloating:function(b,e){p(["aloha-selection-changed","aloha.ui.container.selected"],f,b,function(){b._move()});var c=function(){var a;a=e.pinLeft;var c=e.pinTop;0>c?c=0:c>n.height()&&(c=n.height()/2);0>a?a=0:a>n.width()&&(a=n.width()/2);a={top:c,left:a};e.setFloatingPosition(a);b.$element.css({top:a.top,left:a.left})};
n.scroll(function(){b._move(0)});n.resize(function(){e.isFloatingMode||c()});b.addPin();if(a.browser.msie){var d=b.$element.parent();b.$element.appendTo("body");b.$element.css("position",j);d.length?b.$element.appendTo(d):b.$element.detach()}else b.$element.css("position",j);e.isFloatingMode||c();b.$element.css("z-index",10100).draggable({distance:20,stop:function(a,b){e.setFloatingPosition(b.position);e.isFloatingMode||g(b.position)}})},floatSurface:function(b,e,c,d){"number"!==typeof c&&(c=500);
var f=(parseInt(a("body").css("marginTop"),10)||0)+(parseInt(a("body").css("paddingTop"),10)||0);b=b.$element;b.offset();var g=e.obj.offset(),j=n.scrollTop(),p=g.top-j-f,r=g.left,s=r+b.width()-n.width()-10;0<s&&(r-=s);p>=b.height()?(g.top-=j,g.top-=b.height()+10,t(b,g,c,d)):(e=p+b.height()>g.top+e.obj.height()?{top:g.top+e.obj.height(),left:r}:{top:f,left:r},e.top+=10,t(b,e,c,d))},togglePinSurface:function(a,b,c){a=a.$element;c?(s.store("Aloha.FloatingMenu.pinned",null),s.store("Aloha.FloatingMenu.top",
null),s.store("Aloha.FloatingMenu.left",null),a.find(".aloha-ui-pin").removeClass("aloha-ui-pin-down")):(g(b),a.find(".aloha-ui-pin").addClass("aloha-ui-pin-down"));a.css({position:"fixed",top:b.top})},POSITION_STYLE:j}});var Jb=function(a,b,d){for(var p in b)b.hasOwnProperty(p)&&(!a.hasOwnProperty(p)||d)?a[p]=b[p]:"object"===typeof b[p]&&Jb(a[p],b[p],d)},Ub=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(a){var b=a.config();return{version:"2.0.1",load:function(a,p,r,s){s=
s||{};s.locale&&(b.locale=s.locale);var t=Ub.exec(a),g=t[1],f=t[4],n=t[5],j=f.split("-"),e=[],v={},x,c="";t[5]?(g=t[1],a=g+n):(n=t[4],f=b.locale,f||(f=b.locale="undefined"===typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),j=f.split("-"));if(s.isBuild){e.push(a);s=g+"root/"+n;require._fileExists(p.toUrl(s))&&e.push(s);for(x=0;x<j.length;x++)s=j[x],c+=(c?"-":"")+s,s=e,t=g+c+"/"+n,require._fileExists(p.toUrl(t))&&s.push(t);p(e,function(){r()})}else p([a],function(a){var b=
[],d;d=g;var f=n;a.root&&(b.push("root"),(!0===a.root||1===a.root)&&e.push(d+"root/"+f));for(x=0;x<j.length;x++){d=j[x];d=c+=(c?"-":"")+d;var f=a,s=e,t=g,E=n;f[d]&&(b.push(d),(!0===f[d]||1===f[d])&&s.push(t+d+"/"+E))}p(e,function(){var c,e,d;for(c=b.length-1;-1<c&&b[c];c--){d=b[c];e=a[d];if(!0===e||1===e)e=p(g+d+"/"+n);Jb(v,e)}v.t=function(a,b){return this[a]?this[a]:b?b:a};r(v)})})}}});define("ui/nls/i18n",{root:{"button.bold.label":"Bold","button.italic.label":"Italic","button.strikethrough.label":"Strikethrough",
"button.subscript.label":"Subscript","button.superscript.label":"Superscript","button.underline.label":"Underline","button.p.label":"Paragraph","button.h1.label":"Heading 1","button.h2.label":"Heading 2","button.h3.label":"Heading 3","button.h4.label":"Heading 4","button.h5.label":"Heading 5","button.h6.label":"Heading 6","button.pre.label":"Preformatted text","button.removeFormatting.label":"Remove formatting","button.ol.label":"Insert ordered list","button.ul.label":"Insert unordered list","button.indent.label":"Indent list",
"button.outdent.label":"Outdent list","button.createLink.label":"Insert link","button.removeLink.label":"Remove link","button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.createLink.label":"Insert link","button.removeLink.label":"Remove link","button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.justifyLeft.label":"Align to the left","button.justifyRight.label":"Align to the right",
"button.justifyCenter.label":"Center","button.justifyFull.label":"Justify","button.horizontalRule.label":"Insert horizontal rule","button.createLanguageAnnotation.label":"Insert language annotation","button.metaview.label":"Switch between meta and normal view","button.quote.label":"Format selection as quote","button.blockquote.label":"Format selection as blockquote","tab.format.label":"Format","tab.insert.label":"Insert","tab.abbr.label":"Abbreviation","tab.img.label":"Image","tab.link.label":"Link",
"tab.list.label":"List","tab.table.label":"Table","tab.col.label":"Table Column","tab.row.label":"Table Row","tab.cell.label":"Table Cell","tab.wai-lang.label":"Language annotation"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("ui/toolbar","jquery aloha/core ui/surface ui/tab ui/floating ui/context i18n!ui/nls/i18n jqueryui".split(" "),function(a,b,d,p,r,s,t){var g=d.extend({_moveTimeout:null,$_container:null,_tabBySlot:null,_tabs:[],_constructor:function(b,d){var j,e,s,x;this._super(b);
this.$element=a("<div>",{"class":"aloha-ui aloha-ui-toolbar",unselectable:"on"});this.$_container=p.createContainer().appendTo(this.$element);this._tabBySlot={};for(s=0;s<d.length;s++){j=d[s];e=new p(b,{label:t.t(j.label,j.label),showOn:j.showOn,container:this.$_container},j.components);for(x in e._elemBySlot)e._elemBySlot.hasOwnProperty(x)&&(this._tabBySlot[x]=e);this._tabs.push({tab:e,settings:j})}r.makeFloating(this,g)},adoptInto:function(a,b){var d=this._tabBySlot[a];return d&&d.adoptInto(a,b)},
getActiveContainer:function(){return this.$_container.data("aloha-active-container")},getContainers:function(){return this.$_container.data("aloha-tabs")},_move:function(a){var d=this;d._moveTimeout&&clearTimeout(d._moveTimeout);d._moveTimeout=setTimeout(function(){d._moveTimeout=null;b.activeEditable&&g.isFloatingMode&&r.floatSurface(d,b.activeEditable,a,g.setFloatingPosition)},20)},addPin:function(){var b=a('<div class="aloha-ui-pin">'),d=this.$element;d.find(".ui-tabs").append(b);d.find(".ui-tabs").hover(function(){d.addClass("aloha-ui-hover")},
function(){d.removeClass("aloha-ui-hover")});g.isFloatingMode||b.addClass("aloha-ui-pin-down");var j=this;b.click(function(){g.isFloatingMode=!g.isFloatingMode;var b;g.isFloatingMode?b={top:g.pinTop,left:g.pinLeft}:(b=j.$element.offset(),b.top-=a(window).scrollTop());g.setFloatingPosition(b);r.togglePinSurface(j,b,g.isFloatingMode)})},show:function(){g.$surfaceContainer.children().detach();g.$surfaceContainer.append(this.$element);g.$surfaceContainer.stop().fadeTo(200,1);var a=g.getFloatingPosition();
this.$element.stop().css({top:a.top,left:a.left});this._move()},hide:function(){g.$surfaceContainer.stop().fadeOut(200,function(){g.$surfaceContainer.children().detach()})}});return a.extend(g,{$surfaceContainer:null,isFloatingMode:!0,pinLeft:0,pinTop:0,init:function(){g.$surfaceContainer=a("<div>",{"class":"aloha aloha-surface aloha-toolbar",unselectable:"on"}).hide();a(function(){g.$surfaceContainer.appendTo("body")});d.trackRange(g.$surfaceContainer);var b=r.getPinState();g.pinTop=b.top;g.pinLeft=
b.left;g.isFloatingMode=!b.isPinned},setFloatingPosition:function(a){g.pinTop=a.top;g.pinLeft=a.left},getFloatingPosition:function(){return{top:g.pinTop,left:g.pinLeft}}}),g.init(),g});define("ui/settings",["jquery","util/arrays","util/maps","util/trees"],function(a,b,d,p){return{defaultToolbarSettings:{tabs:[{label:"tab.format.label",showOn:{scope:"Aloha.continuoustext"},components:["bold strong italic emphasis underline \n subscript superscript strikethrough quote".split(" "),"formatLink formatAbbr formatNumeratedHeaders toggleDragDrop \n toggleMetaView wailang toggleFormatlessPaste".split(" "),
"alignLeft alignCenter alignRight alignJustify \n orderedList unorderedList indentList outdentList".split(" "),["formatBlock"]]},{label:"tab.insert.label",showOn:{scope:"Aloha.continuoustext"},components:["createTable characterPicker insertLink insertImage insertAbbr insertToc insertHorizontalRule insertTag".split(" ")]},{label:"tab.link.label",showOn:{scope:"link"},components:["editLink","removeLink","linkBrowser"]},{label:"tab.img.label",showOn:{scope:"image"},components:[["imageSource","\n","imageTitle"],
["imageResizeWidth","\n","imageResizeHeight"],"imageAlignLeft imageAlignRight imageAlignNone imageIncPadding \n imageCropButton imageCnrReset imageCnrRatio imageDecPadding".split(" "),["imageBrowser"]]},{label:"tab.abbr.label",showOn:{scope:"abbr"},components:[["abbrText","removeAbbr"]]},{label:"tab.wai-lang.label",showOn:{scope:"wai-lang"},components:[["wailangfield","removewailang"]]},{label:"tab.table.label",showOn:{scope:"table.cell"},components:[["mergecells","splitcells","tableCaption","tableSummary",
"formatTable"]]},{label:"tab.col.label",showOn:{scope:"table.column"},components:["addcolumnleft addcolumnright deletecolumns columnheader mergecellsColumn splitcellsColumn formatColumn".split(" ")]},{label:"tab.row.label",showOn:{scope:"table.row"},components:["addrowbefore addrowafter deleterows rowheader mergecellsRow splitcellsRow formatRow".split(" ")]},{label:"tab.cell.label",showOn:{scope:"table.cell"},components:[["alignTop","alignMiddle","alignBottom","formatCell"]]}]},combineToolbarSettings:function(r,
s,t){function g(b){return"array"===a.type(b)?!b.length:n[b]}var f=d.fillTuples({},b.map(s,function(a){return[a.label,a]})),n,j=r,e=d.fillKeys({},t,!0);for(t=0;t<j.length;t++)e[j[t].label]=!0,d.fillKeys(e,p.flatten(j[t].components),!0);n=e;var v;t=[];for(var x,c,j=0;j<r.length;j++)v=r[j],e=v.components||[],x=f[v.label],!v.exclusive&&x&&(c=p.postprune(x.components,g))&&(e=e.concat(c)),v=a.extend({},x||{},v),v.components=e,t.push(v);r=t;f=n;t=[];for(j=0;j<s.length;j++)if(v=s[j],!f[v.label]&&(e=p.postprune(v.components,
g)))v=a.extend({},v),v.components=e,t.push(v);return r.concat(t)}}});define("ui/ui-plugin","jquery aloha ui/context ui/container ui/surface ui/toolbar ui/scopes ui/settings PubSub jqueryui".split(" "),function(a,b,d,p,r,s,t,g,f){var n=new d;d=b.settings.toolbar;var j=g.defaultToolbarSettings;g=d?g.combineToolbarSettings(d.tabs||[],j.tabs,d.exclude||[]):j.tabs;var e=new s(n,g);b.bind("aloha-editable-activated",function(a){r.show(n);p.showContainersForContext(n,a)});b.bind("aloha-editable-deactivated",
function(){r.suppressHide||r.hide(n)});f.sub("aloha.ui.scope.change",function(){p.showContainersForContext(n);t.getPrimaryScope();var b=e._tabs,d=t.getPrimaryScope(),c,f;for(f=0;f<b.length;f++)if(c=b[f].settings,"object"===a.type(c.showOn)&&c.showOn.scope===d){b[f].tab.foreground();break}});return{adoptInto:function(a,b){return e.adoptInto(a,b)},showToolbar:function(a){r.show(n);p.showContainersForContext(n,a)}}});define("ui/ui",["jquery","ui/ui-plugin"],function(a,b){var d={};return{adopt:function(p,
r,s){"string"!==a.type(p)?(s=r,r=p,p=s.name):s=a.extend({name:p},s);r.isInstance||(r=s?r.extend(s):r,r=new r);d[p]=r;b.adoptInto(p,r);return r},getAdoptedComponent:function(a){return d[a]||null}}});define("ui/utils",["jquery","jqueryui"],function(a){function b(a){return a.html||a.text||a.tooltip}function d(a){return'<img class="aloha-ui-inline-icon" src="'+a+'">'}return{wrapWithLabel:function(b,d){return a("<label>",{"class":"aloha-ui-label"}).append(a("<span>",{"class":"aloha-ui-label-text",text:b})).append(d)},
makeButton:function(a,r,s){return a.button({label:b(r),text:!!r.text||!!r.html,icons:{primary:r.icon||r.iconUrl&&"aloha-ui-inline-icon-container"||null,secondary:s&&"aloha-jqueryui-icon ui-icon-triangle-1-s"||null}}),r.iconUrl&&a.button("widget").children(".ui-button-icon-primary").append(d(r.iconUrl)),a},makeButtonElement:function(b){return a("<button>",b).attr("type","button")},makeButtonLabel:b,makeButtonLabelWithIcon:function(a){var r=b(a);return a.iconUrl&&(r=d(a.iconUrl)+r),r},makeButtonIconFromUrl:d}});
define("ui/vendor/jquery-ui-autocomplete-html",["jquery","jqueryui"],function(a){var b=a.ui.autocomplete.prototype,d=b._initSource;a.extend(b,{_initSource:function(){this.options.html&&a.isArray(this.options.source)?this.source=function(b,d){var s;s=this.options.source;var t=RegExp(a.ui.autocomplete.escapeRegex(b.term),"i");s=a.grep(s,function(b){return t.test(a("<div>").html(b.label||b.value||b).text())});d(s)}:d.call(this)},_renderItem:function(b,d){return a("<li></li>").data("item.autocomplete",
d).append(a("<a></a>")[this.options.html?"html":"text"](d.label)).appendTo(b)}})});define("ui/port-helper-attribute-field","jquery ui/ui ui/component ui/scopes ui/context ui/utils aloha/repositorymanager aloha/selection aloha/console ui/vendor/jquery-ui-autocomplete-html".split(" "),function(a,b,d,p,r,s,t,g){return function(f){function n(a,b){b.item&&u(b.item.obj);j()}function j(){e();G&&ca!==a(G).attr(T)&&(W||t.markObject(G),""===x()&&p())}function e(){if(!E){var b=a(G),c=b.attr("data-original-background-color");
c?b.css("background-color",c):b.css("background-color","");b.removeAttr("data-original-background-color")}}function p(){null!=K&&(B.css("color","#AAA"),B.val(K))}function x(){return B.val()}function c(a){B.val(a);B.css("color","black")}function u(a){if(W=a){var b=a[z];c(b);oa=b;k(T,a[y]);t.markObject(G,a)}else oa=null}function k(b,c,e,d){if(G){var f=!0;"undefined"!=typeof d&&(d.match(RegExp(e))||(f=!1));f?a(G).attr(b,c):a(G).removeAttr(b)}}var y=f.valueField||"id",z=f.displayField||"name",D=f.objectTypeFilter||
["all"],K=f.placeholder,E=!!f.noTargetHighlight,B=f.element?a(f.element):a('<input id="aloha-attribute-field-'+f.name+'">'),J,N,W,oa,G,T,ca;f.cls&&B.addClass(f.cls);f.width&&B.width(f.width);J=b.adopt(f.name,d,{scope:f.scope,init:function(){f.element?this.element=B:f.label?(this.element=s.wrapWithLabel(f.label,B),f.labelClass&&this.element.addClass(f.labelClass)):this.element=a("<span>").append(B);B.autocomplete({html:!0,appendTo:r.selector,source:function(b,c){t.query({queryString:b.term,objectTypeFilter:D},
function(b){c(a.map(b.items,function(a){return{label:N.replace(/\{([^}]+)\}/g,function(b,c){return c in a?a[c]:""}),value:a.name,obj:a}}))})},select:n})}});B.bind("focus",function(b){a(b.target).is(":visible")&&(E||(e(),(b=a(G))&&(b.context&&b.context.style&&b.context.style["background-color"])&&b.attr("data-original-background-color",b.context.style["background-color"]),b.css("background-color","#80B5F2")),x()===K&&c(""))}).bind("blur",function(){j()}).bind("keydown",function(a){(13==a.keyCode||
27==a.keyCode)&&a.preventDefault()}).bind("keyup",function(a){W&&oa!==x()&&(oa=W=null);W||k(T,x());if(13==a.keyCode||27==a.keyCode)g.getRangeObject().select(),j()});p();var U={getInputElem:function(){return B[0]},hasInputElem:function(){return!0},getInputId:function(){return B.attr("id")},hide:function(){B.hide()},show:function(){B.show()},foreground:function(){J.foreground()},focus:function(){J.focus();B.focus()},getTargetObject:function(){return G},setTargetObject:function(b,e){G=b;T=e;u(null);
b&&e?(ca=a(b).attr(e),c(a(G).attr(T)),t.getObject(b,function(a){a&&0<a.length&&u(a[0])})):c("")},setAttribute:k,getItem:function(){return W},setItem:u,setValue:c,getValue:x,addListener:function(b,c){B.bind(b,a.proxy(c,U))},setObjectTypeFilter:function(a){D=a},setTemplate:function(a){N=a},setPlaceholder:p};return U}});define("ui/button",["jquery","ui/component","ui/utils","jqueryui"],function(a,b,d){return b.extend({init:function(){this._super();this.createButtonElement();d.makeButton(this.buttonElement,
this).button("widget").tooltip({tooltipClass:"aloha aloha-ui-tooltip",position:{my:"left top",at:"right bottom"}}).click(a.proxy(function(){this.buttonElement.tooltip("close",null,!0);this._onClick()},this))},_onClick:function(){this.click()},click:function(){},createButtonElement:function(){var a=d.makeButtonElement();this["class"]&&a.addClass(this["class"]);return this.element=this.buttonElement=a},disable:function(){this.element.button("option","disabled",!1)},enable:function(a){this.element.button("option",
"disabled",!1===a)}})});define("ui/toggleButton",["jquery","ui/button","jqueryui"],function(a,b){return b.extend({_checked:!1,setState:function(a){this._checked!==a&&((this._checked=a)?this.element.addClass("aloha-button-active"):this.element.removeClass("aloha-button-active"))},getState:function(){return this._checked},_onClick:function(){this.setState(!this._checked);this.click()}})});define("link/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link","button.removelink.tooltip":"Remove Link",
"newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link","link.target.self":"Self","link.target.blank":"Blank","link.target.parent":"Parent","link.target.top":"Top","link.target.framename":"Framename","link.target.legend":"Target","link.title.legend":"Title",insertLink:"ctrl+k"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("aloha/nls/i18n",{root:{"plugin.abbr.floatingmenu.tab.abbr":"Abbreviation","floatingmenu.tab.format":"Format","floatingmenu.tab.insert":"Insert",yes:"Yes",
no:"No",cancel:"Cancel","repository.no_item_found":"No item found.","repository.loading":"Loading","repository.no_items_found_yet":"No items found yet..."},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("link/link-plugin","aloha aloha/plugin aloha/ephemera jquery ui/port-helper-attribute-field ui/ui ui/scopes ui/surface ui/button ui/toggleButton i18n!link/nls/i18n i18n!aloha/nls/i18n aloha/console".split(" "),function(a,b,d,p,r,s,t,g,f,n,j){var e=window.GENTICS,v="",x;d.classes("aloha-link-pointer",
"aloha-link-text");return b.create("link",{config:["a"],targetregex:"",target:"",cssclassregex:null,cssclass:"",objectTypeFilter:[],onHrefChange:null,ignoreNextSelectionChangedEvent:!1,hrefUpdateInt:null,hotKey:{insertLink:j.t("insertLink","ctrl+k")},hrefValue:"http://",init:function(){var b=this;"undefined"!=typeof this.settings.targetregex&&(this.targetregex=this.settings.targetregex);"undefined"!=typeof this.settings.target&&(this.target=this.settings.target);"undefined"!=typeof this.settings.cssclassregex&&
(this.cssclassregex=this.settings.cssclassregex);"undefined"!=typeof this.settings.cssclass&&(this.cssclass=this.settings.cssclass);"undefined"!=typeof this.settings.objectTypeFilter&&(this.objectTypeFilter=this.settings.objectTypeFilter);"undefined"!=typeof this.settings.onHrefChange&&(this.onHrefChange=this.settings.onHrefChange);"undefined"!=typeof this.settings.hotKey&&p.extend(!0,this.hotKey,this.settings.hotKey);"undefined"!=typeof this.settings.hrefValue&&(this.hrefValue=this.settings.hrefValue);
this.createButtons();this.subscribeEvents();this.bindInteractions();a.ready(function(){b.initSidebar(a.Sidebar.right)})},nsSel:function(){var a=[];p.each(arguments,function(){a.push("."+(""==this?"aloha-link":"aloha-link-"+this))});return p.trim(a.join(" "))},nsClass:function(){var a=[];p.each(arguments,function(){a.push(""==this?"aloha-link":"aloha-link-"+this)});return p.trim(a.join(" "))},initSidebar:function(a){var b=this;b.sidebar=a;a.addPanel({id:b.nsClass("sidebar-panel-target"),title:j.t("floatingmenu.tab.link"),
content:"",expanded:!0,activeOn:"a, link",onInit:function(){var a=this;this.setContent('<div class="'+b.nsClass("target-container")+'"><fieldset><legend>'+j.t("link.target.legend")+'</legend><ul><li><input type="radio" name="targetGroup" class="'+b.nsClass("radioTarget")+'" value="_self" /><span>'+j.t("link.target.self")+'</span></li><li><input type="radio" name="targetGroup" class="'+b.nsClass("radioTarget")+'" value="_blank" /><span>'+j.t("link.target.blank")+'</span></li><li><input type="radio" name="targetGroup" class="'+
b.nsClass("radioTarget")+'" value="_parent" /><span>'+j.t("link.target.parent")+'</span></li><li><input type="radio" name="targetGroup" class="'+b.nsClass("radioTarget")+'" value="_top" /><span>'+j.t("link.target.top")+'</span></li><li><input type="radio" name="targetGroup" class="'+b.nsClass("radioTarget")+'" value="framename" /><span>'+j.t("link.target.framename")+'</span></li><li><input type="text" class="'+b.nsClass("framename")+'" /></li></ul></fieldset></div><div class="'+b.nsClass("title-container")+
'" ><fieldset><legend>'+j.t("link.title.legend")+'</legend><input type="text" class="'+b.nsClass("linkTitle")+'" /></fieldset></div>');p(b.nsSel("framename")).live("keyup",function(){p(a.effective).attr("target",p(this).val().replace('"',"&quot;").replace("'","&#39;"))});p(b.nsSel("radioTarget")).live("change",function(){"framename"==p(this).val()?p(b.nsSel("framename")).slideDown():(p(b.nsSel("framename")).slideUp().val(""),p(a.effective).attr("target",p(this).val()))});p(b.nsSel("linkTitle")).live("keyup",
function(){p(a.effective).attr("title",p(this).val().replace('"',"&quot;").replace("'","&#39;"))})},onActivate:function(a){var c=this;c.effective=a;if(null!=p(c.effective).attr("target")){var e=!0;p(b.nsSel("framename")).hide().val("");p(b.nsSel("radioTarget")).each(function(){p(this).removeAttr("checked");p(this).val()===p(c.effective).attr("target")&&(e=!1,p(this).attr("checked","checked"))});e&&(p(b.nsSel('radioTarget[value="framename"]')).attr("checked","checked"),p(b.nsSel("framename")).val(p(c.effective).attr("target")).show())}else p(b.nsSel("radioTarget")).first().attr("checked",
"checked"),p(c.effective).attr("target",p(b.nsSel("radioTarget")).first().val());c=this;c.effective=a;p(b.nsSel("linkTitle")).val(p(c.effective).attr("title"))}});a.show()},subscribeEvents:function(){var b=this,e={};a.bind("aloha-editable-created",function(a,d){var f=b.getEditableConfig(d.obj),f=-1!==p.inArray("a",f);if(e[d.getId()]=f)d.obj.bind("keydown",b.hotKey.insertLink,function(){b.findLinkMarkup()?(b.hrefField.foreground(),b.hrefField.focus()):b.insertLink(!0);return!1}),d.obj.find("a").each(function(){b.addLinkEventHandlers(this)})});
a.bind("aloha-editable-activated",function(){e[a.activeEditable.getId()]?(b._formatLinkButton.show(),b._insertLinkButton.show()):(b._formatLinkButton.hide(),b._insertLinkButton.hide())});var d=!1;a.bind("aloha-selection-changed",function(f,g){var j=!1;if(a.activeEditable&&e[a.activeEditable.getId()]){var n,j=!1;!b.ignoreNextSelectionChangedEvent&&a.Selection.isSelectionEditable()&&null!=a.activeEditable?(n=b.findLinkMarkup(g))?(b.toggleLinkScope(!0),b.hrefField.setTargetObject(n,"href"),0==p("#"+
b.hrefField.getInputId()).length&&(null!==b.hrefUpdateInt&&clearInterval(b.hrefUpdateInt),b.hrefUpdateInt=setInterval(function(){0<p("#"+b.hrefField.getInputId()).length&&(b.hrefField.setTargetObject(n,"href"),clearInterval(b.hrefUpdateInt))},200)),a.trigger("aloha-link-selected"),j=!0):(b.toggleLinkScope(!1),b.hrefField.setTargetObject(null),a.trigger("aloha-link-unselected")):b.toggleLinkScope(!1);b.ignoreNextSelectionChangedEvent=!1;j&&d!==j&&b.hrefField.foreground()}d=j});var f=this;a.bind("aloha-editable-deactivated",
function(){d&&(setTimeout(function(){d||f.toggleLinkScope(!1)},100),d=!1)})},toggleLinkScope:function(b){this._isScopeActive===b&&a.activeEditable&&this._isScopeActive_editableId===a.activeEditable.getId()||(this._isScopeActive=b,this._isScopeActive_editableId=a.activeEditable&&a.activeEditable.getId(),b?(this.hrefField.show(),this._insertLinkButton.hide(),a.activeEditable&&"A"===a.activeEditable.obj[0].nodeName?this._removeLinkButton.hide():this._removeLinkButton.show(),this._formatLinkButton.setState(!0),
t.enterScope(this.name,"link")):(this.hrefField.hide(),this._insertLinkButton.show(),this._removeLinkButton.hide(),this._formatLinkButton.setState(!1),t.leaveScope(this.name,"link",!0)))},addLinkEventHandlers:function(b){var e=this;p(b).mouseenter(function(){a.Log.debug(e,"mouse over link.");e.mouseOverLink=b;e.updateMousePointer()});p(b).mouseleave(function(){a.Log.debug(e,"mouse left link.");e.mouseOverLink=null;e.updateMousePointer()});p(b).click(function(b){if(b.metaKey)return a.activeEditable.blur(),
window.setTimeout(function(){location.href=b.target},0),b.stopPropagation(),!1})},createButtons:function(){var a=this;this._formatLinkButton=s.adopt("formatLink",n,{tooltip:j.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){a.formatLink()}});this._insertLinkButton=s.adopt("insertLink",f,{tooltip:j.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){a.insertLink(!1)}});this.hrefField=
r({name:"editLink",width:320,valueField:"url",cls:"aloha-link-href-field",scope:"Aloha.continuoustext"});this.hrefField.setTemplate("<span><b>{name}</b><br/>{url}</span>");this.hrefField.setObjectTypeFilter(this.objectTypeFilter);this._removeLinkButton=s.adopt("removeLink",f,{tooltip:j.t("button.removelink.tooltip"),icon:"aloha-icon aloha-icon-unlink",scope:"Aloha.continuoustext",click:function(){a.removeLink()}})},bindInteractions:function(){var b=this;this.hrefField.addListener("keyup",function(e){if(27==
e.keyCode){var d=b.hrefField.getValue();"/"==d[0]||("#"==d[0]||d.match(/^.*\.([a-z]){2,4}$/i)||d.match(/^([a-z]){3,10}:\/\/.+/i)||d.match(/^(mailto|tel):.+/i))||(d=b.hrefField.getValue(),b.hrefField.setValue(d),(d==b.hrefValue||""==d)&&b.removeLink(!1))}b.hrefChange();13==e.keyCode?(e=a.Selection.getRangeObject(),b.ignoreNextSelectionChangedEvent=!0,e.startContainer=e.endContainer,e.startOffset=e.endOffset,e.select(),b.ignoreNextSelectionChangedEvent=!0,d=p(b.hrefField.getInputElem()).attr("value"),
(d==b.hrefValue||""==d)&&b.removeLink(!1),window.setTimeout(function(){t.setScope("Aloha.continuoustext")},100)):(x=p(b.hrefField.getInputElem()).attr("value"),v!=x&&(v=x))});p(document).keydown(function(e){a.Log.debug(b,"Meta key down.");b.metaKey=e.metaKey;b.updateMousePointer()}).keyup(function(e){a.Log.debug(b,"Meta key up.");b.metaKey=e.metaKey;b.updateMousePointer()})},updateMousePointer:function(){this.metaKey&&this.mouseOverLink?(a.Log.debug(this,"set pointer"),p(this.mouseOverLink).removeClass("aloha-link-text"),
p(this.mouseOverLink).addClass("aloha-link-pointer")):(p(this.mouseOverLink).removeClass("aloha-link-pointer"),p(this.mouseOverLink).addClass("aloha-link-text"))},findLinkMarkup:function(b){"undefined"==typeof b&&(b=a.Selection.getRangeObject());if(a.activeEditable){var e=a.activeEditable.obj;e[0]&&"A"===e[0].nodeName&&(e=e.parent());return b.findMarkup(function(){return"A"==this.nodeName},e)}return null},formatLink:function(){a.activeEditable&&(this.findLinkMarkup(a.Selection.getRangeObject())?this.removeLink():
this.insertLink())},insertLink:function(b){var d=this,f=a.Selection.getRangeObject(),g;f.startContainer&&f.endContainer&&!this.findLinkMarkup(f)&&(this.hrefField.foreground(),f.isCollapsed()&&!1!==b&&e.Utils.Dom.extendToWord(f),f.isCollapsed()?(b=j.t("newlink.defaulttext"),g=p('<a href="'+d.hrefValue+'" class="aloha-new-link">'+b+"</a>"),e.Utils.Dom.insertIntoDOM(g,f,p(a.activeEditable.obj)),f.startContainer=f.endContainer=g.contents().get(0),f.startOffset=0,f.endOffset=b.length):(g=p('<a href="'+
d.hrefValue+'" class="aloha-new-link"></a>'),e.Utils.Dom.addMarkup(f,g,!1)),a.activeEditable.obj.find("a.aloha-new-link").each(function(){d.addLinkEventHandlers(this);p(this).removeClass("aloha-new-link")}),f.select(),this.hrefField.focus(),this.hrefField.hasInputElem()&&p(this.hrefField.getInputElem()).attr("value",d.hrefValue).select(),this.hrefChange())},removeLink:function(b){var d=a.Selection.getRangeObject(),f=this.findLinkMarkup();this.hrefField.setItem(null);f&&(e.Utils.Dom.removeFromDOM(f,
d,!0),d.startContainer=d.endContainer,d.startOffset=d.endOffset,d.select(),("undefined"==typeof b||!0===b)&&t.setScope("Aloha.continuoustext"))},hrefChange:function(){""!=this.target&&this.hrefField.setAttribute("target",this.target,this.targetregex,this.hrefField.getValue());null!=this.cssclassregex&&this.hrefField.setAttribute("class",this.cssclass,this.cssclassregex,this.hrefField.getValue());a.trigger("aloha-link-href-change",{obj:this.hrefField.getTargetObject(),href:this.hrefField.getValue(),
item:this.hrefField.getItem()});"function"==typeof this.onHrefChange&&this.onHrefChange.call(this,this.hrefField.getTargetObject(),this.hrefField.getValue(),this.hrefField.getItem())}})});define("ui/dialog",["jquery","ui/component"],function(a){function b(b){var d={};b.text&&(d.text=b.text);b.html&&(d.html=b.html);return a("<div>",d)}function d(b){for(var d in b)b.hasOwnProperty(d)&&(b[d]=function(b){return function(){b.apply(this);a(this).dialog("destroy").remove()}}(b[d]));return b}function p(a,
b){var d="aloha aloha-dialog";a.cls&&(d+=" "+a.cls);return{resizable:!1,modal:!0,title:a.title||b,dialogClass:d,zIndex:10200}}return{confirm:function(r){var s=r.buttons||{};s.Yes=s.Yes||r.yes||a.noop;s.No=s.No||r.no||a.noop;if(r.answer){var t=s.Yes,g=s.No;s.Yes=function(){t();r.answer(!0)};s.No=function(){g();r.answer(!1)}}var f=b(r).dialog(a.extend(p(r,"Confirm"),{buttons:d(s)}));return function(){f.dialog("destroy").remove()}},alert:function(r){var s=b(r).dialog(a.extend(p(r,"Alert"),{buttons:d({Dismiss:a.noop})}));
return function(){s.dialog("destroy").remove()}},progress:function(d){var s=a("<div>").progressbar({value:null!=d.value?d.value:100}),t=b(d).dialog(a.extend(p(d,"Progress"),{open:function(){a(this).append(s)}}));return function(a){null!=a?s.progressbar({value:a}):t.dialog("destroy").remove()}}}});define("ui/multiSplit",["jquery","ui/component","ui/button","ui/utils"],function(a,b,d,p){return b.extend({_activeButton:null,_isOpen:!1,init:function(){this._super();var b=this,d=this.element=a("<div>",
{"class":"aloha-multisplit"});this.contentElement=a("<div>",{"class":"aloha-multisplit-content"}).appendTo(d);this.toggleButton=p.makeButtonElement({"class":"aloha-multisplit-toggle",click:function(){b.toggle()}}).button().appendTo(d);this.buttons=[];var t=this.getButtons();0===t.length&&d.hide();for(d=0;d<t.length;d++)this.addButton(t[d]);a("body").click(function(a){b._isOpen&&!b.element.is(a.target)&&0===b.element.find(a.target).length&&b.close()})},addButton:function(a){var b=this,p=new (d.extend({tooltip:a.tooltip,
icon:a.wide?a.icon:"aloha-large-icon "+a.icon,iconOnly:a.wide?!1:!0,init:function(){this._super();a.init&&a.init.call(this)},click:function(){a.click.apply(b,arguments);b.close()}}));a.wide||p.element.addClass("aloha-large-button");b.buttons[a.name]={settings:a,component:p,element:p.element,visible:!0};var g=this.contentElement.children(".aloha-ui-multisplit-fullwidth");!a.wide&&g.length?g.before(p.element[0]):this.contentElement.append(p.element[0])},setActiveButton:function(a){a||(a=null);null!==
this._activeButton&&this.buttons[this._activeButton].element.removeClass("aloha-multisplit-active");this._activeButton=a;null!==a&&this.buttons[a].element.addClass("aloha-multisplit-active")},toggle:function(){this.element.toggleClass("aloha-multisplit-open");this._isOpen=!this._isOpen},open:function(){this.element.addClass("aloha-multisplit-open");this._isOpen=!0},close:function(){this.element.removeClass("aloha-multisplit-open");this._isOpen=!1},show:function(a){a||(a=null);null!==a&&void 0!==this.buttons[a]&&
(this.buttons[a].element.show(),this.buttons[a].visible=!0,this.element.show())},hide:function(a){var b,d=!1;a||(a=null);if(null!==a&&void 0!==this.buttons[a]){this.buttons[a].element.hide();this.buttons[a].visible=!1;for(b in this.buttons)if(this.buttons.hasOwnProperty(b)&&this.buttons[b].visible){this.element.show();d=!0;break}d||this.element.hide()}}})});define("ui/port-helper-multi-split",["aloha/core","jquery","ui/ui","ui/multiSplit"],function(a,b,d,p){return function(a){var s;s=d.adopt(a.name,
p,{scope:a.scope,getButtons:function(){var d=[];b.each(a.items,function(a,b){d.push({tooltip:b.tooltip,text:b.text,name:b.name,icon:b.iconClass,click:b.click,init:function(){b.cls&&this.element.addClass(b.cls);b.init&&b.init.call(this)},wide:b.wide})});return d}});return{pushItem:function(a){s.addButton(a)},showItem:function(a){s.show(a)},hideItem:function(a){s.hide(a)},setActiveItem:function(a){s.setActiveButton(a)}}}});define("table/nls/i18n",{root:{"floatingmenu.tab.table":"Table","floatingmenu.tab.tablelayout":"Table Layout",
"deleterows.confirm":"Do you really want to delete the selected rows?","deletecolumns.confirm":"Do you really want to delete the selected columns?","deletetable.confirm":"Do you really want to delete the table?",Table:"Table","button.createtable.tooltip":"Insert Table","button.addcolleft.tooltip":"Add Column left","button.addcolright.tooltip":"Add Column right","button.delcols.tooltip":"Delete Columns","button.addrowbefore.tooltip":"Add Row before","button.addrowafter.tooltip":"Add Row after","button.delrows.tooltip":"Delete Rows",
"button.caption.tooltip":"Table caption","empty.caption":"Table caption","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting","button.rowheader.tooltip":"Format row as table header","button.columnheader.tooltip":"Format column as table header","button.mergecells.tooltip":"Merge Cells","button.splitcells.tooltip":"Split Cells","table.label.target":"Summary","table.sidebar.title":"Table","table.mergeCells.notRectangular":"Only a rectangular selection can be merged",
"table.addColumns.nonConsecutive":"Please select a single column or a consecutive range of columns","table.createTable.nestedTablesNoSupported":"Sorry, nested tables are not supported"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("table/table-create-layer",["jquery"],function(a){CreateLayer=function(a){this.TablePlugin=a};CreateLayer.prototype.parameters={elemId:"aloha-table-createLayer",className:"aloha-table-createdialog",numX:10,numY:10,layer:void 0,target:void 0};CreateLayer.prototype.config=
{};CreateLayer.prototype.visible=!1;CreateLayer.prototype.show=function(){var a=this.get("layer");null==a?this.create():(this.setPosition(a),a.find("td").removeClass("hover"),a.show());this.visible=!0};CreateLayer.prototype.create=function(){var b=this,d=a("<div></div>");d.id=this.get("elemId");d.addClass(this.get("className"));var p=a("<table></table>");p.css("width",15*(this.get("numX")+6));for(var r,s,t=0;t<this.get("numY");t++){r=a("<tr></tr>");for(var g=0;g<this.get("numX");g++)s=a("<td>\u00a0</td>"),
0==t&&0==g&&s.addClass("hover"),s.bind("mouseover",{rowId:t,colId:g},function(a){b.handleMouseOver(a,p)}),s.bind("click",{rowId:t,colId:g},function(a){b.TablePlugin.createTable(a.data.colId+1,a.data.rowId+1);b.hide()}),r.append(s);p.append(r)}d.append(p);this.set("layer",d);this.setPosition();d.bind("click",function(a){a.stopPropagation()}).mousedown(function(a){a.stopPropagation()});a("body").append(d).bind("click",function(d){b.visible&&!(d.target===b.get("target")[0]||a.contains(b.get("target")[0],
d.target))&&b.hide()})};CreateLayer.prototype.handleMouseOver=function(b,d){for(var p=b.data.rowId,r=b.data.colId,s=d.find("tr"),t=0;t<=s.length;t++)for(var g=a(s[t]).find("td"),f=0;f<=g.length;f++)t<=p&&f<=r?a(g[f]).addClass("hover"):a(g[f]).removeClass("hover")};CreateLayer.prototype.setPosition=function(){var b=a(this.get("target")),d=b.offset();this.get("layer").css("left",d.left+"px");this.get("layer").css("top",d.top+b.height()+"px")};CreateLayer.prototype.hide=function(){this.get("layer").hide();
this.visible=!1};CreateLayer.prototype.get=function(a){if(this.config[a])return this.config[a];if(this.parameters[a])return this.parameters[a]};CreateLayer.prototype.set=function(a,d){this.config[a]?this.config[a]=d:this.parameters[a]=d};return CreateLayer});define("table/table-plugin-utils",["jquery"],function(a){var b={cellIndexToGridColumn:function(a,p,r){var s=null;b.walkCells(a,function(a,b,d){if(a===p&&b===r)return s=d,!1});return s},walkCells:function(a,p){for(var r=[],s=0;s<a.length;s++){for(var t=
a[s].cells,g=0,f=0;f<t.length;f++){for(var n=t[f],j=b.colspan(n),n=b.rowspan(n);r[f+g];)r[f+g]-=1,g+=1;if(!1===p(s,f,f+g,j,n))return;for(var e=0;e<j;e++){if(r[f+g+e])throw"an impossible case has occurred";r[f+g+e]=n-1}g+=j-1}for(;f+g<r.length;g++)r[f+g]&&(r[f+g]-=1)}},makeGrid:function(a){var p=[];b.walkCells(a,function(b,s,t,g,f){s=a[b].cells[s];for(var n=0;n<f;n++){p[b+n]=p[b+n]||[];for(var j=0;j<g;j++)p[b+n][t+j]={cell:s,colspan:g,rowspan:f,spannedX:j,spannedY:n}}});return p},containsDomCell:function(a){return 0===
a.spannedX&&0===a.spannedY},leftDomCell:function(a,b,r){do{var s=a[b][r];if(0===s.spannedY)return s.cell;r-=s.spannedX+1}while(0<=r);return null},splitCell:function(d,p){var r=a(d),s=b.colspan(d),t=b.rowspan(d);if(!(1===s&&1===t)){for(var g=r.parent(),f=g.parent().children(),g=g.index(),n=r.index(),j=b.makeGrid(f),n=b.cellIndexToGridColumn(f,g,n),e=0;e<t;e++)for(var v=0===e?1:0;v<s;v++){var x=b.leftDomCell(j,g+e,n);null==x?f.eq(g+e).prepend(p()):a(x).after(p())}r.removeAttr("colSpan");r.removeAttr("rowSpan")}},
rowspan:function(b){return parseInt(a(b).attr("rowspan"))||1},colspan:function(b){return parseInt(a(b).attr("colspan"))||1},walkGrid:function(a,b){for(var r=0;r<a.length;r++)for(var s=0;s<a[r].length;s++)if(!1===b(a[r][s],s,r))return},walkGridInsideRect:function(a,p,r){b.walkGrid(a,function(a,b,d){if(d>=p.top&&d<p.bottom&&b>=p.left&&b<p.right)return r(a,b,d)})},leftTrimArray:function(a){for(var b=0;b<a.length;b++)if(null!=a[b])return a.slice(b,a.length);return[]},makeContour:function(a,p){var r=[],
s=[],t=[],g=[];b.walkGrid(a,function(a,b,d){if(p(a,b,d)){if(null==r[d]||b<r[d])r[d]=b;if(null==s[d]||b>s[d])s[d]=b;if(null==t[b]||d<t[b])t[b]=d;if(null==g[b]||d>g[b])g[b]=d}});r=b.leftTrimArray(r);s=b.leftTrimArray(s);t=b.leftTrimArray(t);g=b.leftTrimArray(g);return{left:r,right:s,top:t,bottom:g}},indexOfAnyBut:function(a,b){for(var r=0;r<a.length;r++)if(b!==a[r])return r;return-1},isConsecutive:function(a){for(var b=1;b<a.length;b++)if(1!==Math.abs(a[b]-a[b-1]))return!1;return!0}};return b});define("table/table-cell",
["jquery","table/table-plugin-utils"],function(a,b){var d=function(b,d){null==b&&(b="<td>&nbsp;</td>");b=a(b).get(0);this.obj=a(b);this.tableObj=d;d.cells.push(this)};d.prototype.tableObj=void 0;d.prototype.obj=void 0;d.prototype.wrapper=void 0;d.prototype.hasFocus=!1;d.prototype.activate=function(){var a=this,b=a.obj;b.wrapInner("<div/>");var d=b.children("div").eq(0);d.contentEditable(!0);d.addClass("aloha-table-cell-editable");d.bind("focus",function(b){b.currentTarget&&(b.currentTarget.indexOf=
function(){return-1});a._editableFocus(b)});d.bind("mousedown",function(b){b.currentTarget&&(b.currentTarget.indexOf=function(){return-1});a._editableMouseDown(b);a._startCellSelection()});d.bind("blur",function(b){a._editableBlur(b)});d.bind("keyup",function(b){a._editableKeyUp(b)});d.bind("keydown",function(b){a._editableKeyDown(b)});d.bind("mouseover",function(){a._selectCellRange()});d.contentEditableSelectionChange(function(a){Aloha.Selection.onChange(d,a);return d});b.bind("mousedown",function(b){window.setTimeout(function(){a.wrapper.trigger("focus");
a._selectAll(d)},1);a.tableObj.selection.unselectCells();a._startCellSelection();b.stopPropagation()});b.get(0)&&(b.get(0).onselectstart=function(){return!1});this.wrapper=b.children();this.wrapper.get(0)&&(this.wrapper.get(0).onselectstart=function(){window.event.cancelBubble=!0},this.wrapper.get(0).ondragstart=function(){return!1});return this};d.prototype.deactivate=function(){var b=a(this.obj.children(".aloha-table-cell-editable"));b.length&&(b.parent().append(b.contents()),b.remove(),this.obj.unbind("click"),
this.obj.unbind("mousedown"),""==a.trim(this.obj.attr("class"))&&this.obj.removeAttr("class"))};d.prototype.toString=function(){return"TableCell"};d.prototype._editableFocus=function(){this.hasFocus||(this.tableObj.focus(),this.obj.addClass("aloha-table-cell_active"),this.hasFocus=!0,this.tableObj.selection.selectionType="cell")};d.prototype._editableBlur=function(){this.hasFocus=!1;this.obj.removeClass("aloha-table-cell_active")};d.prototype._virtualX=function(){var a=this.tableObj.obj.children().children("tr"),
d=this.obj.parent().index(),s=this.obj.index();return b.cellIndexToGridColumn(a,d,s)};d.prototype._virtualY=function(){return this.obj.parent("tr").index()};d.prototype._startCellSelection=function(){if(!this.tableObj.selection.cellSelectionMode){this.tableObj.selection.unselectCells();this.tableObj.selection.cellSelectionMode=!0;var b=this;a("body").bind("mouseup.cellselection",function(){b._endCellSelection()});this.tableObj.selection.baseCellPosition=[this._virtualY(),this._virtualX()]}};d.prototype._endCellSelection=
function(){this.tableObj.selection.cellSelectionMode&&(this.tableObj.selection.cellSelectionMode=!1,this.tableObj.selection.baseCellPosition=null,this.tableObj.selection.lastSelectionRange=null,this.tableObj.selection.selectionType="cell",a("body").unbind("mouseup.cellselection"))};d.prototype._getSelectedRect=function(){var a=this._virtualX(),b=this._virtualY(),d=this.tableObj.selection.baseCellPosition,t=d[1];t>a&&(t=a,a=d[1]);var g=d[0];g>b&&(g=b,b=d[0]);return{top:g,right:a,bottom:b,left:t}};
d.prototype._selectCellRange=function(){if(this.tableObj.selection.cellSelectionMode){var d=this._getSelectedRect(),r=this.tableObj,s=r.obj.children().children("tr"),s=b.makeGrid(s);r.selection.selectedCells=[];var t=r.get("classCellSelected");b.walkGrid(s,function(g,f,n){b.containsDomCell(g)&&(n>=d.top&&n<=d.bottom&&f>=d.left&&f<=d.right?(a(g.cell).addClass(t),r.selection.selectedCells.push(g.cell)):a(g.cell).removeClass(t))});r.selection.notifyCellsSelected()}};d.prototype._selectAll=function(b){b=
b.jquery?b.get(0):b;if(a.browser.msie)document.getSelection?(d=document.getSelection(),s=document.createRange(),s.selectNodeContents(b),d.removeAllRanges(),d.addRange(s)):document.selection&&(s=document.body.createTextRange(),s.moveToElementText(b),s.select());else{var d=window.getSelection();if(d.setBaseAndExtent)d.setBaseAndExtent(b,0,b,Math.max(0,b.innerText.length-1));else{window.opera&&"<BR>"==b.innerHTML.substring(b.innerHTML.length-4)&&(b.innerHTML+="&#160;");var s=document.createRange();s.selectNodeContents(b);
d.removeAllRanges();d.addRange(s)}}};d.prototype._editableMouseDown=function(a){this.tableObj.selection.unselectCells();this.tableObj.hasFocus&&a.stopPropagation()};d.prototype._editableKeyUp=function(){};d.prototype._editableKeyDown=function(a){this._checkForEmptyEvent(a);this.obj[0]===this.tableObj.obj.find("tr:last td:last")[0]&&(9==a.keyCode&&!a.altKey&&!a.shiftKey&&!a.ctrlKey)&&(this.tableObj.addRow(this.obj.parent().index()+1),this.tableObj.cells[this.tableObj.cells.length-1]._selectAll(this.wrapper.get(0)),
a.stopPropagation())};d.prototype._checkForEmptyEvent=function(){var b=a(this.wrapper),d=b.text();!(0<b.children().length)&&""===d&&(this.wrapper.text("\u00a0"),this.wrapper.get(0).blur(),this.wrapper.get(0).focus())};d.getContainer=function(b){return a(b.firstChild).hasClass("aloha-table-cell-editable")?b.firstChild:b};return d});define("table/table-selection","aloha jquery table/table-plugin-utils table/table-cell ui/dialog i18n!table/nls/i18n".split(" "),function(a,b,d,p,r,s){function t(a){return{top:a.top[0],
right:a.right[0]+1,bottom:a.bottom[0]+1,left:a.left[0]}}function g(a,b,e){var f=!0;-1!==d.indexOfAnyBut(b.top,b.top[0])||-1!==d.indexOfAnyBut(b.right,b.right[0])||-1!==d.indexOfAnyBut(b.bottom,b.bottom[0])||-1!==d.indexOfAnyBut(b.left,b.left[0])?f=!1:(b=t(b),d.walkGridInsideRect(a,b,function(a){if(!e(a))return f=!1}));return f}var f=function(a){this.table=a};f.prototype.selectionType=void 0;f.prototype.selectedCells=[];f.prototype.selectedColumnIdxs=[];f.prototype.selectedRowIdxs=[];f.prototype.cellSelectionMode=
!1;f.prototype.baseCellPosition=null;f.prototype.lastSelectionRange=null;f.prototype.selectColumns=function(a){this.unselectCells();var f=this.table.getRows();f.shift();for(var f=d.makeGrid(f),e=0;e<a.length;e++)if(-1===b.inArray(a[e],this.selectedColumnIdxs)){this.selectedColumnIdxs.push(a[e]);for(var g=0;g<f.length;g++){var p=f[g][a[e]];d.containsDomCell(p)&&(b(p.cell).addClass(this.table.get("classCellSelected")),this.selectedCells.push(p.cell))}}this.selectionType="column"};f.prototype.selectRows=
function(a){this.unselectCells();var d=this.table.getRows();a.sort(function(a,b){return a-b});for(var e=0;e<a.length;e++)if(d[a[e]]){for(var f=0;f<this.selectedRowIdxs.length;f++)if(a[e]==this.selectedRowIdxs[f])return;this.selectedRowIdxs.push(a[e]);for(f=1;f<d[a[e]].cells.length;f++)this.selectedCells.push(d[a[e]].cells[f]),b(d[a[e]].cells[f]).addClass(this.table.get("classCellSelected"))}this.selectionType="row"};f.prototype.selectAll=function(){var a=b.map(this.table.getRows(),function(a,b){return b});
a.shift();this.selectRows(a)};f.prototype.notifyCellsSelected=function(){a.trigger("aloha-table-selection-changed")};f.prototype._notifyCellsUnselected=function(){a.trigger("aloha-table-selection-changed")};f.prototype.isHeader=function(){if(0==this.selectedCells.length)return!1;for(var a=0;a<this.selectedCells.length;a++)if(!this.selectedCells[a]||"th"!=this.selectedCells[a].nodeName.toLowerCase())return!1;return!0};f.prototype.unselectCells=function(){var a;if(!this.cellSelectionMode&&0<this.selectedCells.length){a=
this.table.getRows();for(var d=0;d<a.length;d++)for(var e=1;e<a[d].cells.length;e++)b(a[d].cells[e]).removeClass(this.table.get("classCellSelected"));this.selectedCells=[];this.selectedColumnIdxs=[];this.selectedRowIdxs=[];this.selectionType="cell";this._notifyCellsUnselected()}};f.prototype.selectionIndex=function(a){for(var b=0;b<this.selectedCells.length;b++)if(this.selectedCells[b]===a)return b;return-1};f.prototype.mergeCells=function(){var f=this.selectedCells;if(0!==f.length){var j=function(a){return-1!=
b.inArray(a.cell,f)},e=d.makeGrid(this.table.getRows()),v=d.makeContour(e,j);if(g(e,v,j)){var x=t(v),j=b(e[x.top][x.left].cell),c=b(p.getContainer(j.get(0)));d.walkGridInsideRect(e,x,function(a,e,d){if(!(e-a.spannedX===x.left&&d-a.spannedY===x.top)){a=a.cell;e=b(p.getContainer(a)).contents();for(d=0;d<e.length;d++)if("string"!==typeof e[d]||""!==b.trim(e[d])){c.append(" ");c.append(e);break}b(a).remove()}});j.attr({rowspan:x.bottom-x.top,colspan:x.right-x.left});this.selectedCells=[j.get(0)];this.cellSelectionMode=
!1;this.lastSelectionRange=this.baseCellPosition=null;this.selectionType="cell";a.trigger("aloha-table-selection-changed")}else r.alert({title:s.t("Table"),text:s.t("table.mergeCells.notRectangular")})}};f.prototype.splitCells=function(){var f=this,g=this.selectedCells;0<g.length&&(b(g).each(function(){d.splitCell(this,function(){return f.table.newActiveCell().obj})}),this.cellSelectionMode=!1,this.lastSelectionRange=this.baseCellPosition=null,this.selectionType="cell",a.trigger("aloha-table-selection-changed"))};
f.prototype.cellsAreMergeable=function(){var a=this.selectedCells;if(2>a.length)return!1;var f=function(e){return-1!=b.inArray(e.cell,a)},e=d.makeGrid(this.table.getRows()),p=d.makeContour(e,f);return g(e,p,f)?!0:!1};f.prototype.cellsAreSplitable=function(){var a=0;return 0<this.selectedCells.length?(b(this.selectedCells).each(function(){var b=d.colspan(this),e=d.rowspan(this);(1<b||1<e)&&a++}),0<a?!0:!1):!1};return f});define("table/table","aloha jquery ui/scopes ui/dialog i18n!table/nls/i18n table/table-cell table/table-selection table/table-plugin-utils".split(" "),
function(a,b,d,p,r,s,t,g){function f(a,b){var d=-1,c=null;"before"===a?c=b.selectedCells[0]:"after"===a&&(c=b.selectedCells[b.selectedCells.length-1]);c&&1==c.nodeType&&(d=c.parentNode.rowIndex);return d}var n=window.GENTICS,j=function(a,d){this.obj=b(a);var f,c,j=this.getRows(),k=j.length,p,r=0,s=[],K;for(f=0;f<k;f++)c=b(j[f]),c=c.children("td, th"),p=c.length,p=g.cellIndexToGridColumn(j,f,p-1)+1,K=parseInt(c.last().attr("colspan"),10),0!=K&&!isNaN(K)&&(1==K&&c.last().removeAttr("colspan"),p+=K-
1),s.push(p),p>r&&(r=p);for(f=0;f<k;f++)c=r-s[f],0<c&&b(j[f]).append(Array(c+1).join("<td></td>"));this.obj.attr("id")||this.obj.attr("id",n.Utils.guid());this.tablePlugin=d;this.selection=new t(this);this.refresh()};b.extend(j.prototype,{obj:void 0,tableWrapper:void 0,cells:void 0,numRows:void 0,numCols:void 0,isActive:!1,hasFocus:!1,parentEditable:void 0,mousedown:!1,clickedColumnId:-1,clickedRowId:-1,columnsToSelect:[],rowsToSelect:[],fmPluginId:void 0});j.prototype.refresh=function(){this.numCols=
this.countVirtualCols();var a=this.getRows();this.numRows=a.length;this.cells=[];for(var d=0;d<a.length;d++)for(var f=b(a[d]).children(),c=0;c<f.length;c++)this.newCell(f[c])};j.prototype.countVirtualCols=function(){var a=this.obj.children().children("tr:first-child").children();return a.length-a.filter("."+this.get("classLeftUpperCorner")).length};j.prototype.get=function(a){return this.tablePlugin.get(a)};j.prototype.set=function(a,b){this.tablePlugin.set(a,b)};j.prototype.activate=function(){if(!this.isActive){var e=
this,d;this.obj.addClass(this.get("className"));this.obj.contentEditable(!1);""==this.obj.attr("id")&&this.obj.attr("id",n.Utils.guid());this.selection.selectionType=void 0;d=this.obj.children("tbody");0===d.length&&(d=this.obj);d.bind("keydown",function(a){!a.ctrlKey&&!a.shiftKey&&0<e.selection.selectedCells.length&&0<e.selection.selectedCells[0].length&&e.selection.selectedCells[0][0].firstChild.focus()});d.bind("mousedown",function(a){e.hasFocus||e.focus();a.stopPropagation();a.preventDefault();
return!1});d=b('<div class="'+this.get("classTableWrapper")+'" data-block-skip-scope="true"></div>');this.obj.wrap(d);d=this.obj.parent();d.alohaBlock&&d.alohaBlock();d=this.obj.parents("."+this.get("classTableWrapper"));d.get(0).onresizestart=function(){return!1};d.get(0).oncontrolselect=function(){return!1};d.get(0).ondragstart=function(){return!1};d.get(0).onmovestart=function(){return!1};this.tableWrapper=this.obj.parents("."+this.get("classTableWrapper")).get(0);b(this.cells).each(function(){this.activate()});
this.attachSelectionColumn();this.attachSelectionRow();this.makeCaptionEditable();this.checkWai();this.isActive=!0;a.trigger("aloha-table-activated")}};j.prototype.makeCaptionEditable=function(){var a=this.obj.find("caption").eq(0);a&&this.tablePlugin.makeCaptionEditable(a)};j.prototype.checkWai=function(){var a=this.wai;a&&(a.removeClass(this.get("waiGreen")),a.removeClass(this.get("waiRed")),""!=b.trim(this.obj[0].summary)?a.addClass(this.get("waiGreen")):a.addClass(this.get("waiRed")))};j.prototype.attachSelectionColumn=
function(){var a=b("<td>"),d,f,c,g;a.html("\u00a0");c=this.obj.context.rows;for(g=0;g<c.length;g++)f=b(c[g]),d=a.clone(),d.addClass(this.get("classSelectionColumn")),d.css("width",this.get("selectionArea")+"px"),f.prepend(d),this.attachRowSelectionEventsToCell(d)};j.prototype.attachRowSelectionEventsToCell=function(a){var b=this;a.unbind("mousedown");a.unbind("mouseover");a.get(0).onselectstart=function(){return!1};a.bind("mousedown",function(a){return b.rowSelectionMouseDown(a)});a.bind("mouseover",
function(a){if(b.mousedown)return b.rowSelectionMouseOver(a)})};j.prototype.rowSelectionMouseDown=function(a){this.focus();0==this.selection.selectedCells.length&&(this.rowsToSelect=[]);this.clickedRowId=a.currentTarget.parentNode.rowIndex;if(a.metaKey){var d=b.inArray(this.clickedRowId,this.rowsToSelect);0<=d?this.rowsToSelect.splice(d,1):this.rowsToSelect.push(this.clickedRowId)}else if(a.shiftKey){this.rowsToSelect.sort(function(a,b){return a-b});var f=this.rowsToSelect[0],d=this.clickedRowId;
f>d&&(f=d,d=this.rowsToSelect[0]);for(this.rowsToSelect=[];f<=d;f++)this.rowsToSelect.push(f)}else this.rowsToSelect=[this.clickedRowId];this.selectRows();a.preventDefault();a.stopPropagation();this.tablePlugin.summary.focus();return!1};j.prototype.rowSelectionMouseOver=function(a){var d=a.currentTarget.parentNode.rowIndex,f;if(this.mousedown&&0<=this.clickedRowId){b.inArray(d,this.rowsToSelect);f=d<this.clickedRowId?d:this.clickedRowId;d=d<this.clickedRowId?this.clickedRowId:d;for(this.rowsToSelect=
[];f<=d;f++)this.rowsToSelect.push(f);this.selectRows();a.preventDefault();a.stopPropagation();return!1}};j.prototype.attachSelectionRow=function(){var a=this,d=b("<td>");d.html("\u00a0");for(var f=0,c=0;c<this.obj.context.rows.length;c++){for(var j=0,k=0;k<this.obj.context.rows[c].cells.length;k++)var n=g.colspan(this.obj.context.rows[c].cells[k]),j=j+n;f<j&&(f=j)}j=b("<tr>");j.addClass(this.get("classSelectionRow"));j.css("height",this.get("selectionArea")+"px");for(c=0;c<f;c++)k=d.clone(),0<c?
this.attachColumnSelectEventsToCell(k):(k=b("<td>").clone(),k.addClass(this.get("classLeftUpperCorner")),this.wai=b("<div/>").width(25).height(12).click(function(b){a.focus();a.selection.selectAll();a.tablePlugin.activeTable.selection.selectionType="cell";a.tablePlugin.updateFloatingMenuScope();a._removeCursorSelection();a.tablePlugin.settings.summaryinsidebar&&(a.tablePlugin.sidebar.open(),a.tablePlugin.sidebarPanel.activate(a.obj),a.tablePlugin.sidebar.correctHeight());try{a.tablePlugin.summary.focus(),
b.stopPropagation(),b.preventDefault()}catch(c){}return!1}),k.append(this.wai)),j.append(k);b(document).bind("mouseup",function(b){a.columnSelectionMouseUp(b)});this.obj.find("tr:first").before(j)};j.prototype.attachColumnSelectEventsToCell=function(a){var b=this;a.unbind("mousedown");a.unbind("mouseover");a.get(0).onselectstart=function(){return!1};a.bind("mousedown",function(a){b.columnSelectionMouseDown(a)});a.bind("mouseover",function(a){b.columnSelectionMouseOver(a)})};j.prototype.columnSelectionMouseDown=
function(a){this.focus();0==this.selection.selectedCells.length&&(this.columnsToSelect=[]);this.clickedColumnId=b(a.currentTarget.parentNode).children().index(a.currentTarget);if(a.metaKey){var d=b.inArray(this.clickedColumnId,this.columnsToSelect);0<=d?this.columnsToSelect.splice(d,1):this.columnsToSelect.push(this.clickedColumnId)}else if(a.shiftKey){this.columnsToSelect.sort(function(a,b){return a-b});var f=this.columnsToSelect[0],d=this.clickedColumnId;f>d&&(f=d,d=this.columnsToSelect[0]);for(this.columnsToSelect=
[];f<=d;f++)this.columnsToSelect.push(f)}else this.columnsToSelect=[this.clickedColumnId];this.selectColumns();a.preventDefault();a.stopPropagation();return!1};j.prototype.columnSelectionMouseOver=function(a){var b=a.currentTarget.cellIndex;a=[];var d;if(this.mouseDownColIdx){d=b<this.mouseDownColIdx?b:this.mouseDownColIdx;for(b=b<this.mouseDownColIdx?this.mouseDownColIdx:b;d<=b;d++)a.push(d);this.selectColumns(a)}};j.prototype.columnSelectionMouseUp=function(){this.mouseDownColIdx=!1};j.prototype.deleteRows=
function(){var a=[],d={},f=this;if(0!==this.selection.selectedCells.length){for(var c=0;c<this.selection.selectedCells.length;c++)d[this.selection.selectedCells[c].parentNode.rowIndex]=!0;for(rowId in d)a.push(rowId);d=!1;a.length==this.numRows&&(d=!0);if(d){var j=this;p.confirm({title:r.t("Table"),text:r.t("deletetable.confirm"),yes:function(){j.deleteTable()}})}else{a.sort(function(a,b){return a-b});var k=a[0];k>this.numRows-a.length&&k--;var n=this.getRows();b.each(a,function(a,b){for(var c=n[b],
e=0;e<c.cells.length;e++)g.splitCell(c.cells[e],function(){return f.newActiveCell().obj})});var s=g.makeGrid(n);b.each(a,function(a,c){for(var e=s[c],d=0;d<e.length;){var f=e[d],k=g.rowspan(f.cell);1<k&&b(f.cell).attr("rowspan",k-1);d+=f.colspan}b(n[c]).remove()});this.numRows-=a.length;window.setTimeout(function(){b(n[1].cells[k+1]).focus()},5);this.selection.unselectCells()}}};j.prototype.deleteColumns=function(){var a=[],d=this.getRows(),f=this,c,j=g.makeGrid(d);if(this.selection.selectedColumnIdxs.length==
j[0].length-1)p.confirm({title:r.t("Table"),text:r.t("deletetable.confirm"),yes:function(){f.deleteTable()}});else{a.sort(function(a,b){return a-b});for(var k=this.selection.selectedColumnIdxs.sort(function(a,b){return b-a}),n=0;n<k.length;n++){for(var s=k[n],t=0;t<d.length;t++)if(c=j[t][s]){if(0===c.spannedX){if(1<c.colspan){var K=this.newActiveCell().obj;b(c.cell).after(K);K.attr("rowspan",c.rowspan);K.attr("colspan",c.colspan-1)}b(c.cell).remove()}else b(c.cell).attr("colspan",c.colspan-1);t+=
c.rowspan-1}j=g.makeGrid(d)}this.numCols-=a.length;window.setTimeout(function(){b(d[1].cells[1]).focus()},5);this.selection.unselectCells()}};j.prototype.deleteTable=function(){for(var b=-1,d=0;d<this.tablePlugin.TableRegistry.length;d++)if(this.tablePlugin.TableRegistry[d].obj.attr("id")==this.obj.attr("id")){b=d;break}0<=b&&(this.deactivate(),this.selection.selectionType=void 0,this.tablePlugin.TableRegistry.splice(d,1),b=a.Selection.rangeObject,b.endContainer=this.obj.get(0).parentNode,b.startContainer=
b.endContainer,b.endOffset=n.Utils.Dom.getIndexInParent(this.obj.get(0)),b.startOffset=b.endOffset,b.clearCaches(),this.obj.remove(),this.parentEditable.obj.focus(),b.correctRange(),b.select())};j.prototype.addRowBeforeSelection=function(){var a=f("before",this.selection);-1!==a&&this.addRow(a)};j.prototype.addRowAfterSelection=function(){var a=f("after",this.selection);-1!==a&&this.addRow(a+1)};j.prototype.addRow=function(a){this.countVirtualCols();for(var d=this.obj.children().children("tr"),f=
0;1>f;f++){var c=b("<tr>"),j=b("<td>");j.addClass(this.get("classSelectionColumn"));this.attachRowSelectionEventsToCell(j);c.append(j);j=g.makeGrid(d);if(a>=j.length)for(var k=1;k<j[0].length;k++)c.append(this.newActiveCell().obj);else for(k=1;k<j[a].length;){var n=j[a][k];if(g.containsDomCell(n))for(var p=n.colspan;p--;)c.append(this.newActiveCell().obj);else b(n.cell).attr("rowspan",n.rowspan+1);k+=n.colspan}a>=d.length?d.eq(d.length-1).after(c):d.eq(a).before(c)}this.numRows+=1};j.prototype.addColumnsRight=
function(){this.addColumns("right")};j.prototype.addColumnsLeft=function(){this.addColumns("left")};j.prototype.addColumns=function(a){var d=b("<td>"),f=this.getRows(),c,j;c=this.selection.selectedColumnIdxs;if(0!==c.length)if(c.sort(function(a,b){return a-b}),g.isConsecutive(c)){if("left"===a){j=c[0];for(var k=0;k<this.selection.selectedColumnIdxs.length;k++)this.selection.selectedColumnIdxs[k]+=1}else j=c[c.length-1];for(var n=g.makeGrid(f),k=0;k<f.length;k++){c=d.clone();c.html("\u00a0");0==k?
this.attachColumnSelectEventsToCell(c):(cellObj=this.newActiveCell(c.get(0)),c=cellObj.obj);var s=g.leftDomCell(n,k,j);null==s?b(f[k]).prepend(c):"left"===a&&g.containsDomCell(n[k][j])?b(s).before(c):b(s).after(c);this.numCols++}}else p.alert({title:r.t("Table"),text:r.t("table.addColumns.nonConsecutive")})};j.prototype.focus=function(){this.hasFocus||(this.parentEditable.isActive||this.parentEditable.obj.focus(),this.tablePlugin.setFocusedTable(this))};j.prototype.focusOut=function(){this.hasFocus&&
(this.tablePlugin.setFocusedTable(void 0),this.selection.selectionType=void 0)};j.prototype._removeCursorSelection=function(){var e=a.getSelection();e&&(e._nativeSelection&&0!=e._nativeSelection._ranges.length)&&(e=e.getRangeAt(0),null!=e.startContainer&&(0===b(e.startContainer).closest("table").length&&0!==this.selection.selectedCells.length)&&(e=s.getContainer(this.selection.selectedCells[0]),b(e).focus()))};j.prototype.selectColumns=function(a){a=a?a:this.columnsToSelect;for(var f=0;f<this.tablePlugin.columnMSItems.length;f++)this.tablePlugin.columnMSButton.showItem(this.tablePlugin.columnMSItems[f].name);
d.setScope(this.tablePlugin.name+".column");this.tablePlugin._columnheaderButton.setState(this.selection.isHeader());f=this.getRows();this.tablePlugin.columnMSButton.setActiveItem();for(var g=0;g<this.tablePlugin.columnConfig.length;g++)b(f[0].cells[0]).hasClass(this.tablePlugin.columnConfig[g].cssClass)&&(this.tablePlugin.columnMSButton.setActiveItem(this.tablePlugin.columnConfig[g].name),g=this.tablePlugin.columnConfig.length);this.obj.find("div.aloha-ui-table-cell-editable").blur();this.selection.selectColumns(a);
this.selection.notifyCellsSelected();this._removeCursorSelection()};j.prototype.selectRows=function(){for(var a=0;a<this.tablePlugin.rowMSItems.length;a++)this.tablePlugin.rowMSButton.showItem(this.tablePlugin.rowMSItems[a].name);for(a=0;a<this.rowsToSelect.length;a++){var f=this.rowsToSelect[a],f=b(this.getRows()[f].cells).toArray();if(0==a)for(var g=0;g<f.length;g++){this.tablePlugin.rowMSButton.setActiveItem();for(var c=0;c<this.tablePlugin.rowConfig.length;c++)b(f[g]).hasClass(this.tablePlugin.rowConfig[c].cssClass)&&
(this.tablePlugin.rowMSButton.setActiveItem(this.tablePlugin.rowConfig[c].name),c=this.tablePlugin.rowConfig.length)}}d.setScope(this.tablePlugin.name+".row");this.selection.selectRows(this.rowsToSelect);this.tablePlugin._rowheaderButton.setState(this.selection.isHeader());this.obj.find("div.aloha-ui-table-cell-editable").blur();this.selection.notifyCellsSelected();this._removeCursorSelection()};j.prototype.deactivate=function(){var a=this.obj.parent();a.mahaloBlock&&a.mahaloBlock();this.obj.removeClass(this.get("className"));
""==b.trim(this.obj.attr("class"))&&this.obj.removeAttr("class");this.obj.removeAttr("contenteditable");this.obj.parents("."+this.get("classTableWrapper")).length&&this.obj.unwrap();this.obj.find("tr."+this.get("classSelectionRow")+":first").remove();var d=this;b.each(this.obj.context.rows,function(){b(this).children("td."+d.get("classSelectionColumn")).remove()});this.obj.find("td, th").removeClass(this.get("classCellSelected"));this.obj.find("td, th").removeClass("aloha-table-cell_active");this.obj.unbind();
this.obj.children("tbody").unbind();for(a=0;a<this.cells.length;a++)this.cells[a].deactivate();this.obj.find("caption div").each(function(){b(this).contents().unwrap()});this.isActive=!1};j.prototype.toString=function(){return"Table"};j.prototype.newCell=function(a){return new s(a,this)};j.prototype.newActiveCell=function(a){a=new s(a,this);a.activate();return a};j.prototype.getRows=function(){var a=this.obj.get(0).rows;return b.makeArray(a)};return j});define("table/table-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/scopes ui/button ui/toggleButton ui/dialog ui/port-helper-attribute-field ui/port-helper-multi-split i18n!table/nls/i18n i18n!aloha/nls/i18n table/table-create-layer table/table table/table-plugin-utils".split(" "),
function(a,b,d,p,r,s,t,g,f,n,j,e,v,x,c){function u(){var a=[],c=D;b.each(arguments,function(){a.push("."+(""==this?c:c+"-"+this))});return b.trim(a.join(" "))}function k(){var a=[],c=D;b.each(arguments,function(){a.push(""==this?c:c+"-"+this)});return b.trim(a.join(" "))}var y=window.GENTICS,z=new d("table");z.createLayer=void 0;z.config=["table"];z.TableRegistry=[];z.activeTable=void 0;z.parameters={className:"aloha-table",classSelectionRow:"aloha-table-selectcolumn",classSelectionColumn:"aloha-table-selectrow",
classLeftUpperCorner:"aloha-table-leftuppercorner",classTableWrapper:"aloha-table-wrapper",classCellSelected:"aloha-cell-selected",waiRed:"aloha-wai-red",waiGreen:"aloha-wai-green",selectionArea:10};z.checkConfig=function(a){if("object"==typeof a&&a.length){for(var b=[],c=0;c<a.length;c++)a[c]&&b.push({name:a[c].name,text:a[c].text?a[c].text:a[c].name,tooltip:a[c].tooltip?a[c].tooltip:a[c].text,iconClass:a[c].iconClass?a[c].iconClass:"aloha-icon-"+a[c].name,cssClass:a[c].cssClass?a[c].cssClass:a[c].name});
a=b}else a=[];return a};z.init=function(){var e=this,d={};this.tableConfig=this.checkConfig(this.tableConfig||this.settings.tableConfig);this.columnConfig=this.checkConfig(this.columnConfig||this.settings.columnConfig);this.rowConfig=this.checkConfig(this.rowConfig||this.settings.rowConfig);this.cellConfig=this.checkConfig(this.cellConfig||this.settings.cellConfig);this.createLayer=new x(this);a.bind("aloha-editable-created",function(a,f){var g=e.getEditableConfig(f.obj);d[f.getId()]=-1!==b.inArray("table",
g);f.obj.bind("mousedown",function(){z.setFocusedTable(void 0)});f.obj.find("table").each(function(){if(e.isEditableTable(this)&&!z.isWithinTable(this)){var a=new c(this,z);a.parentEditable=f;z.TableRegistry.push(a)}z.checkForNestedTables(f.obj)})});this.initTableButtons();a.bind("aloha-table-selection-changed",function(){"undefined"!==typeof z.activeTable&&z.activeTable.selection&&(z.updateFloatingMenuScope(),z.activeTable.selection.cellsAreSplitable()?(e._splitcellsButton.enable(!0),e._splitcellsRowButton.enable(!0),
e._splitcellsColumnButton.enable(!0)):(e._splitcellsButton.enable(!1),e._splitcellsRowButton.enable(!1),e._splitcellsColumnButton.enable(!1)),z.activeTable.selection.cellsAreMergeable()?(e._mergecellsButton.enable(!0),e._mergecellsRowButton.enable(!0),e._mergecellsColumnButton.enable(!0)):(e._mergecellsButton.enable(!1),e._mergecellsRowButton.enable(!1),e._mergecellsColumnButton.enable(!1)))});a.bind("aloha-selection-changed",function(b,c){c.startContainer&&a.activeEditable&&(d[a.activeEditable.getId()]&&
a.Selection.mayInsertTag("table")?e._createTableButton.show():e._createTableButton.hide(),e.activeTable&&(c.findMarkup(function(){return"TABLE"===this.nodeName},a.activeEditable.obj)?(z.updateFloatingMenuScope(),z.setActiveCellStyle()):(e.activeTable.selection.cellSelectionMode=!1,e.activeTable.selection.baseCellPosition=null,e.activeTable.selection.lastSelectionRange=null,e.activeTable.focusOut())))});a.bind("aloha-editable-activated",function(a,d){e._splitcellsButton.enable(!1);e._mergecellsButton.enable(!1);
e._splitcellsRowButton.enable(!1);e._mergecellsRowButton.enable(!1);e._splitcellsColumnButton.enable(!1);e._mergecellsColumnButton.enable(!1);d.editable.obj.find("table").each(function(){for(var a=z.TableRegistry,f=0;f<a.length;f++)if(a[f].obj.attr("id")==b(this).attr("id"))return a[f].activate(),!0;e.isEditableTable(this)&&!z.isWithinTable(this)&&(a=new c(this,z),a.parentEditable=d.editable,a.activate(),z.TableRegistry.push(a));z.checkForNestedTables(d.editable.obj)})});a.bind("aloha-editable-deactivated",
function(){z.activeTable&&z.activeTable.selection.unselectCells();z.setFocusedTable(void 0);for(var a=z.TableRegistry,b=0;b<a.length;b++)a[b].deactivate()});a.bind("aloha-smart-content-changed",function(){a.activeEditable&&a.activeEditable.obj.find("table").each(function(){if(-1==z.indexOfTableInRegistry(this)&&!z.isWithinTable(this)){this.id=y.Utils.guid();var b=new c(this,z);b.parentEditable=a.activeEditable;z.TableRegistry.push(b);b.activate()}z.checkForNestedTables(a.activeEditable.obj)})});this.settings.summaryinsidebar&&
a.ready(function(){e.initSidebar(a.Sidebar.right.show())})};var D="aloha-table";z.initSidebar=function(a){var c=this;c.sidebar=a;c.sidebarPanel=a.addPanel({id:k("sidebar-panel"),title:e.t("table.sidebar.title"),content:"",expanded:!0,activeOn:"table",onInit:function(){var a=this;this.setContent('<label class="'+k("label")+'" for="'+k("textarea")+'" >'+e.t("table.label.target")+'</label><textarea id="'+k("textarea")+'" class="'+k("textarea")+'" />');b(u("textarea")).live("keyup",function(){b(a.effective).attr("summary",
b(u("textarea")).val());var e=b('div[class*="wai"]',"table#"+b(a.effective).attr("id"));e.removeClass(c.get("waiGreen"));e.removeClass(c.get("waiRed"));""!=b(u("textarea")).val().trim()?e.addClass(c.get("waiGreen")):e.addClass(c.get("waiRed"))})},onActivate:function(a){this.effective=a;b(u("textarea")).val(b(this.effective).attr("summary"))}});a.show()};z.isEditableTable=function(a){return y.Utils.Dom.isEditable(a)};z.indexOfTableInRegistry=function(a){for(var b=this.TableRegistry,c=0;c<b.length;c++)if(b[c].obj[0].id==
a.id)return c;return-1};z.getTableFromRegistry=function(a){a=this.indexOfTableInRegistry(a);return-1<a?this.TableRegistry[a]:null};z.isSelectionInTable=function(){var c=a.Selection.getRangeObject(),c=b(c.commonAncestorContainer);return 0==c.length?!1:c.parents(".aloha-editable table").length?!0:!1};z.preventNestedTables=function(){return this.isSelectionInTable()?(f.alert({title:e.t("Table"),text:e.t("table.createTable.nestedTablesNoSupported")}),!0):!1};z.isWithinTable=function(a){return 0<b(a).parents(".aloha-editable table").length};
z.checkForNestedTables=function(a){a.find("table table")};z.initMergeSplitCellsBtns=function(){this._mergecellsButton=r.adopt("mergecells",t,{tooltip:e.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".cell",click:function(){z.activeTable&&z.activeTable.selection.mergeCells()}});this._splitcellsButton=r.adopt("splitcells",t,{tooltip:e.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".cell",click:function(){z.activeTable&&
z.activeTable.selection.splitCells()}});this._mergecellsRowButton=r.adopt("mergecellsRow",t,{tooltip:e.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".row",click:function(){z.activeTable&&z.activeTable.selection.mergeCells()}});this._splitcellsRowButton=r.adopt("splitcellsRow",t,{tooltip:e.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".row",click:function(){z.activeTable&&z.activeTable.selection.splitCells()}});this._mergecellsColumnButton=
r.adopt("mergecellsColumn",t,{tooltip:e.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".column",click:function(){z.activeTable&&z.activeTable.selection.mergeCells()}});this._splitcellsColumnButton=r.adopt("splitcellsColumn",t,{tooltip:e.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".column",click:function(){z.activeTable&&z.activeTable.selection.splitCells()}})};z.initRowsBtns=function(){var c=this;this._addrowbeforeButton=
r.adopt("addrowbefore",t,{tooltip:e.t("button.addrowbefore.tooltip"),icon:"aloha-icon aloha-icon-addrowbefore",scope:this.name+".row",click:function(){c.activeTable&&c.activeTable.addRowBeforeSelection()}});this._addrowafterButton=r.adopt("addrowafter",t,{tooltip:e.t("button.addrowafter.tooltip"),icon:"aloha-icon aloha-icon-addrowafter",scope:this.name+".row",click:function(){c.activeTable&&c.activeTable.addRowAfterSelection()}});this._deleterowsButton=r.adopt("deleterows",t,{tooltip:e.t("button.delrows.tooltip"),
icon:"aloha-icon aloha-icon-deleterows",scope:this.name+".row",click:function(){if(c.activeTable){var a=c.activeTable;f.confirm({title:e.t("Table"),text:e.t("deleterows.confirm"),yes:function(){a.deleteRows()}})}}});this._rowheaderButton=r.adopt("rowheader",g,{tooltip:e.t("button.rowheader.tooltip"),icon:"aloha-icon aloha-icon-rowheader",scope:this.name+".row",click:function(){if(c.activeTable){for(var e=c.activeTable.selection.selectedRowIdxs,d,f=c.activeTable.selection.isHeader(),g=!0,k=0;k<c.activeTable.selection.selectedCells.length;k++)if(d=
c.activeTable.selection.selectedCells[k],!f){g=!1;break}for(k=0;k<c.activeTable.selection.selectedCells.length;k++)d=c.activeTable.selection.selectedCells[k],d=g?a.Markup.transformDomObject(d,"td").removeAttr("scope").get(0):a.Markup.transformDomObject(d,"th").attr("scope","row").get(0),b(c.activeTable.selection.selectedCells[k]).bind("mousedown",function(){var a=b(this).children("div").eq(0);window.setTimeout(function(){a.trigger("focus")},1)});c.activeTable.refresh();c.activeTable.selection.unselectCells();
c.activeTable.selection.selectRows(e)}}});this.rowMSItems=[];b.each(this.rowConfig,function(a,d){c.rowMSItems.push({name:d.name,text:e.t(d.text),tooltip:e.t(d.tooltip),iconClass:"aloha-icon aloha-row-layout "+d.iconClass,click:function(){if(c.activeTable){for(var a=c.activeTable.selection.selectedCells,e=0;e<a.length;e++)if(-1<b(a[e]).attr("class").indexOf(d.cssClass))b(a[e]).removeClass(d.cssClass);else{b(a[e]).addClass(d.cssClass);for(var f=0;f<c.rowConfig.length;f++)c.rowConfig[f].cssClass!=d.cssClass&&
b(a[e]).removeClass(c.rowConfig[f].cssClass)}c.activeTable.selectRows()}}})});0<this.rowMSItems.length&&this.rowMSItems.push({name:"removeFormat",text:e.t("button.removeFormat.text"),tooltip:e.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(c.activeTable){for(var a=c.activeTable.selection.selectedCells,e=0;e<a.length;e++)for(var d=0;d<c.rowConfig.length;d++)b(a[e]).removeClass(c.rowConfig[d].cssClass);c.activeTable.selectRows()}}});this.rowMSButton=
j({items:this.rowMSItems,name:"formatRow",hideIfEmpty:!0,scope:this.name+".row"})};z.initColumnBtns=function(){var c=this;this._addcolumnleftButton=r.adopt("addcolumnleft",t,{tooltip:e.t("button.addcolleft.tooltip"),icon:"aloha-icon aloha-icon-addcolumnleft",scope:this.name+".column",click:function(){c.activeTable&&c.activeTable.addColumnsLeft()}});this._addcolumnrightButton=r.adopt("addcolumnright",t,{tooltip:e.t("button.addcolright.tooltip"),icon:"aloha-icon aloha-icon-addcolumnright",scope:this.name+
".column",click:function(){c.activeTable&&c.activeTable.addColumnsRight()}});this._deletecolumnsButton=r.adopt("deletecolumns",t,{tooltip:e.t("button.delcols.tooltip"),icon:"aloha-icon aloha-icon-deletecolumns",scope:this.name+".column",click:function(){if(c.activeTable){var a=c.activeTable;f.confirm({title:e.t("Table"),text:e.t("deletecolumns.confirm"),yes:function(){a.deleteColumns()}})}}});this._columnheaderButton=r.adopt("columnheader",g,{tooltip:e.t("button.columnheader.tooltip"),icon:"aloha-icon aloha-icon-columnheader",
scope:this.name+".column",click:function(){if(c.activeTable){for(var e=c.activeTable.selection.selectedColumnIdxs,d,f=c.activeTable.selection.isHeader(),g=!0,k=0;k<c.activeTable.selection.selectedCells.length;k++)if(d=c.activeTable.selection.selectedCells[k],!f){g=!1;break}for(k=0;k<c.activeTable.selection.selectedCells.length;k++)d=c.activeTable.selection.selectedCells[k],d=g?a.Markup.transformDomObject(d,"td").removeAttr("scope").get(0):a.Markup.transformDomObject(d,"th").attr("scope","row").get(0),
b(c.activeTable.selection.selectedCells[k]).bind("mousedown",function(){var a=b(this).children("div").eq(0);window.setTimeout(function(){a.trigger("focus")},1)});c.activeTable.refresh();c.activeTable.selection.unselectCells();c.activeTable.selection.selectColumns(e)}}});this.columnMSItems=[];b.each(this.columnConfig,function(a,d){var f={name:d.name,text:e.t(d.text),tooltip:e.t(d.tooltip),iconClass:"aloha-icon aloha-column-layout "+d.iconClass,click:function(){if(c.activeTable){for(var a=c.activeTable.selection.selectedCells,
e=0;e<a.length;e++)if(-1<b(a[e]).attr("class").indexOf(d.cssClass))b(a[e]).removeClass(d.cssClass);else{b(a[e]).addClass(d.cssClass);for(var f=0;f<c.columnConfig.length;f++)c.columnConfig[f].cssClass!=d.cssClass&&b(a[e]).removeClass(c.columnConfig[f].cssClass)}c.activeTable.selectColumns()}}};c.columnMSItems.push(f)});0<this.columnMSItems.length&&this.columnMSItems.push({name:"removeFormat",text:e.t("button.removeFormat.text"),tooltip:e.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",
wide:!0,click:function(){if(c.activeTable){for(var a=c.activeTable.selection.selectedCells,e=0;e<a.length;e++)for(var d=0;d<c.columnConfig.length;d++)b(a[e]).removeClass(c.columnConfig[d].cssClass);c.activeTable.selectColumns()}}});this.columnMSButton=j({items:this.columnMSItems,name:"formatColumn",hideIfEmpty:!0,scope:this.name+".column"})};z.initCellBtns=function(){var a=this;this.cellMSItems=[];b.each(this.cellConfig,function(c,d){var f={name:d.name,text:e.t(d.text),tooltip:e.t(d.tooltip),iconClass:"aloha-icon aloha-column-layout "+
d.iconClass,click:function(){if(a.activeTable){for(var c=a.selectedOrActiveCells(),e=0;e<c.length;e++)if(-1<b(c[e]).attr("class").indexOf(d.cssClass))b(c[e]).removeClass(d.cssClass);else{b(c[e]).addClass(d.cssClass);for(var f=0;f<a.cellConfig.length;f++)a.cellConfig[f].cssClass!=d.cssClass&&b(c[e]).removeClass(a.cellConfig[f].cssClass)}a.setActiveCellStyle()}}};a.cellMSItems.push(f)});0<this.cellMSItems.length&&this.cellMSItems.push({name:"removeFormat",text:e.t("button.removeFormat.text"),tooltip:e.t("button.removeFormat.tooltip"),
cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(a.activeTable){for(var c=a.selectedOrActiveCells(),e=0;e<c.length;e++)for(var d=0;d<a.cellConfig.length;d++)b(c[e]).removeClass(a.cellConfig[d].cssClass);a.setActiveCellStyle()}}});this.cellMSButton=j({items:this.cellMSItems,name:"formatCell",hideIfEmpty:!0,scope:this.name+".cell"})};z.initTableButtons=function(){var c=this;s.createScope(this.name+".row","Aloha.continuoustext");s.createScope(this.name+".column","Aloha.continuoustext");
s.createScope(this.name+".cell","Aloha.continuoustext");this._createTableButton=r.adopt("createTable",t,{tooltip:e.t("button.createtable.tooltip"),icon:"aloha-icon aloha-icon-createTable",scope:"Aloha.continuoustext",click:function(){z.createDialog(this.element)}});this.initColumnBtns();this.initRowsBtns();this.initCellBtns();this.initMergeSplitCellsBtns();this.tableMSItems=[];var d=this.tableConfig;b.each(d,function(a,b){c.tableMSItems.push({name:b.name,text:e.t(b.text),tooltip:e.t(b.tooltip),iconClass:"aloha-icon aloha-table-layout "+
b.iconClass,click:function(){if(c.activeTable){for(var a=0;a<d.length;a++)c.activeTable.obj.removeClass(d[a].cssClass);c.activeTable.obj.addClass(b.cssClass)}}})});0<this.tableMSItems.length&&this.tableMSItems.push({name:"removeFormat",text:e.t("button.removeFormat.text"),tooltip:e.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(c.activeTable)for(var a=0;a<d.length;a++)c.activeTable.obj.removeClass(c.tableConfig[a].cssClass)}});this.tableMSButton=j({items:this.tableMSItems,
name:"formatTable",hideIfEmpty:!0,scope:this.name+".cell"});this._tableCaptionButton=r.adopt("tableCaption",g,{tooltip:e.t("button.caption.tooltip"),icon:"aloha-icon aloha-icon-table-caption",scope:this.name+".cell",click:function(){if(c.activeTable)if(c.activeTable.obj.children("caption").is("caption"))c.activeTable.obj.children("caption").remove();else{var d=e.t("empty.caption"),f=b("<caption></caption>");c.activeTable.obj.prepend(f);c.makeCaptionEditable(f,d);d=f.find("div").eq(0);f=d.contents().eq(0);
if(0<f.length){var g=new y.Utils.RangeObject;g.startContainer=g.endContainer=f.get(0);g.startOffset=0;g.endOffset=f.text().length;c.activeTable.obj.find("div.aloha-table-cell-editable").blur();d.focus();g.select();a.Selection.updateSelection()}}}});this.summary=n({width:275,name:"tableSummary",noTargetHighlight:!0,scope:this.name+".cell"});this.summary.addListener("keyup",function(){c.activeTable&&c.activeTable.checkWai()})};z.makeCaptionEditable=function(a,c){var e=a.children("div");0===e.length?
(e=b("<div></div>"),b(e).addClass("aloha-ui"),b(e).addClass("aloha-editable-caption"),0<a.contents().length?e.append(a.contents()):c&&e.text(c),a.append(e)):1<e.length&&(a.children("div:not(:first-child)").each(function(){$this=b(this);e.eq(0).append($this.contents());$this.remove()}),e=e.eq(0));e.contentEditable(!0)};z.createDialog=function(a){this.createLayer.set("target",a);this.createLayer.show()};z.createTable=function(e,d){if(!this.preventNestedTables())if(a.activeEditable&&"undefined"!==typeof a.activeEditable.obj){for(var f=
document.createElement("table"),g=f.id=y.Utils.guid(),k=document.createElement("tbody"),j=0;j<d;j++){for(var n=document.createElement("tr"),p=0;p<e;p++){var r=document.createTextNode("\u00a0"),s=document.createElement("td");s.appendChild(r);n.appendChild(s)}k.appendChild(n)}f.appendChild(k);k=a.Selection.getRangeObject();j=k.endContainer;n=k.startContainer;p=3==j.nodeType?j.length:j.childNodes.length;3==n.nodeType&&("P"==n.parentNode.tagName&&1==n.parentNode.childNodes.length&&/^(\s|%A0)$/.test(escape(n.data)))&&
(n.data="",k.startOffset=0,j==n&&(k.endOffset=0));if(!y.Utils.Dom.allowsNesting(3==n.nodeType?n.parentNode:n,f))0==k.startOffset&&b(3==n.nodeType?n.parentNode:n).addClass("aloha-table-cleanme"),k.endOffset==p&&b(3==j.nodeType?j.parentNode:j).addClass("aloha-table-cleanme");y.Utils.Dom.insertIntoDOM(b(f),a.Selection.getRangeObject(),a.activeEditable.obj);f=b(".aloha-table-cleanme").removeClass("aloha-table-cleanme");for(k=0;k<f.length;k++)""==b.trim(b(f[k]).html())&&!y.Utils.Dom.isEditingHost(f[k])&&
b(f[k]).remove();g=document.getElementById(g);if(!z.isWithinTable(g)){var u=new c(g,z);u.parentEditable=a.activeEditable;u.activate();b.browser.msie?window.setTimeout(function(){u.cells[0].wrapper.get(0).focus()},20):u.cells[0].wrapper.get(0).focus();z.TableRegistry.push(u)}z.checkForNestedTables(a.activeEditable.obj);u.focus();z.activeTable.selection.selectionType="cell";z.updateFloatingMenuScope()}else this.error("There is no active Editable where the table can be\t\t\t\tinserted!")};z.setFocusedTable=
function(a){null==a&&null!=this.activeTable&&this.activeTable.selection.unselectCells();for(var b=0;b<z.TableRegistry.length;b++)z.TableRegistry[b].hasFocus=!1;"undefined"!=typeof a&&(this.summary.setTargetObject(a.obj,"summary"),a.obj.children("caption").is("caption")&&(this._tableCaptionButton.setState(!0),b=a.obj.children("caption"),this.makeCaptionEditable(b)),a.hasFocus=!0);z.activeTable=a;for(b=0;b<this.tableMSItems.length;b++)this.tableMSButton.showItem(this.tableMSItems[b].name);this.tableMSButton.setActiveItem();
if(this.activeTable)for(b=0;b<this.tableConfig.length;b++)this.activeTable.obj.hasClass(this.tableConfig[b].cssClass)&&this.tableMSButton.setActiveItem(this.tableConfig[b].name)};z.error=function(b){a.Log.error(this,b)};z.debug=function(b){a.Log.debug(this,b)};z.info=function(b){a.Log.info(this,b)};z.log=function(b){a.log("log",this,b)};z.get=function(a){if(this.config[a])return this.config[a];if(this.parameters[a])return this.parameters[a]};z.set=function(a,b){this.config[a]?this.config[a]=b:this.parameters[a]=
b};z.makeClean=function(a){var e=this;a.find("table").each(function(){e.getTableFromRegistry(this)&&((new c(this,e)).deactivate(),b(this).attr("id",null))})};z.toString=function(){return this.prefix};z.updateFloatingMenuScope=function(){null!=z.activeTable&&null!=z.activeTable.selection.selectionType&&s.setScope(z.name+"."+z.activeTable.selection.selectionType)};z.setActiveCellStyle=function(){var a=this;this.cellMSButton.setActiveItem();var c=a.selectedOrActiveCells();b(c).each(function(){for(var c=
0;c<a.cellConfig.length;c++)b(this).hasClass(a.cellConfig[c].cssClass)&&(a.cellMSButton.setActiveItem(a.cellConfig[c].name),c=a.cellConfig.length)})};z.selectedOrActiveCells=function(){var b=this.activeTable.selection.selectedCells;return!b||1>b.length?(b=a.Selection.getRangeObject(),b=a.activeEditable?b.findMarkup(function(){return"td"===this.nodeName.toLowerCase()},a.activeEditable.obj):null,b?[b]:[]):b};p.register(z);return z});define("format/nls/i18n",{root:{"button.strong.tooltip":"Strong","button.em.tooltip":"Emphasize",
"button.b.tooltip":"Bold","button.i.tooltip":"Italic","button.u.tooltip":"Underline","button.cite.tooltip":"Cite","button.q.tooltip":"Tooltip","button.code.tooltip":"Code","button.abbr.tooltip":"Abbreviation","button.del.tooltip":"Strikethrough","button.s.tooltip":"Strikethrough","button.sub.tooltip":"Subscript","button.sup.tooltip":"Superscript","button.p.tooltip":"Paragraph","button.h1.tooltip":"Heading 1","button.h2.tooltip":"Heading 2","button.h3.tooltip":"Heading 3","button.h4.tooltip":"Heading 4",
"button.h5.tooltip":"Heading 5","button.h6.tooltip":"Heading 6","button.pre.tooltip":"Preformatted text","button.title.tooltip":"Title","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting",GENTICS_button_p:"GENTICS_button_p",GENTICS_button_h1:"GENTICS_button_h1",GENTICS_button_h2:"GENTICS_button_h2",GENTICS_button_h3:"GENTICS_button_h3",GENTICS_button_h4:"GENTICS_button_h4",GENTICS_button_h5:"GENTICS_button_h5",GENTICS_button_h6:"GENTICS_button_h6",GENTICS_button_pre:"GENTICS_button_pre",
GENTICS_button_title:"GENTICS_button_title",formatBold:"Ctrl+b",formatItalic:"Ctrl+i",formatUnderline:"Ctrl+u",formatParagraph:"Alt+Ctrl+0",formatH1:"Alt+Ctrl+1",formatH2:"Alt+Ctrl+2",formatH3:"Alt+Ctrl+3",formatH4:"Alt+Ctrl+4",formatH5:"Alt+Ctrl+5",formatH6:"Alt+Ctrl+6",formatPre:"Alt+Ctrl+P",formatDel:"Ctrl+\\",formatSub:"Ctrl+,",formatSup:"Ctrl+.","floatingmenu.tab.format":"Format","format.class.legend":"CSS class","format.class.none":"none"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});
define("format/format-plugin","aloha aloha/plugin jquery ui/ui ui/toggleButton ui/port-helper-multi-split PubSub i18n!format/nls/i18n i18n!aloha/nls/i18n aloha/selection".split(" "),function(a,b,d,p,r,s,t,g){function f(b,e){var f=!1,g,j,n,p,r;d.each(b.buttons,function(b,c){f=!1;for(n=0;n<e.markupEffectiveAtStart.length;n++)g=e.markupEffectiveAtStart[n],a.Selection.standardTextLevelSemanticsComparator(g,c.markup)&&(c.handle.setState(!0),f=!0);f||c.handle.setState(!1)});if(0<b.multiSplitItems.length){j=
!1;for(n=0;n<e.markupEffectiveAtStart.length&&!j;n++){g=e.markupEffectiveAtStart[n];for(p=0;p<b.multiSplitItems.length&&!j;p++)r=b.multiSplitItems[p],r.markup&&a.Selection.standardTextLevelSemanticsComparator(g,r.markup)&&(b.multiSplitButton.setActiveItem(r.name),j=!0)}j||b.multiSplitButton.setActiveItem(null)}}var n=window.GENTICS,j={b:"bold",strong:"bold",i:"italic",em:"italic",del:"strikethrough",sub:"subscript",sup:"superscript",u:"underline",s:"strikethrough"},e={strong:"strong",em:"emphasis",
s:"strikethrough2"},v={u:!0,em:!0,strong:!0,b:!0,i:!0,cite:!0,q:!0,code:!0,abbr:!0,del:!0,s:!0,sub:!0,sup:!0},x={p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,pre:!0};return b.create("format",{config:"b i sub sup p h1 h2 h3 h4 h5 h6 pre removeFormat".split(" "),availableButtons:"u strong del em b i s sub sup p h1 h2 h3 h4 h5 h6 pre removeFormat".split(" "),hotKey:{formatBold:"ctrl+b",formatItalic:"ctrl+i",formatParagraph:"alt+ctrl+0",formatH1:"alt+ctrl+1",formatH2:"alt+ctrl+2",formatH3:"alt+ctrl+3",formatH4:"alt+ctrl+4",
formatH5:"alt+ctrl+5",formatH6:"alt+ctrl+6",formatPre:"ctrl+p",formatDel:"ctrl+d",formatSub:"alt+shift+s",formatSup:"ctrl+shift+s"},init:function(){var b=this;"undefined"!==typeof this.settings.hotKey&&d.extend(!0,this.hotKey,this.settings.hotKey);this.initButtons();a.ready(function(){b.initSidebar(a.Sidebar.right)});a.bind("aloha-editable-activated",function(a,e){b.applyButtonConfig(e.editable.obj);e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatBold,function(){b.addMarkup("b");return!1});
e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatItalic,function(){b.addMarkup("i");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatParagraph,function(){b.changeMarkup("p");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH1,function(){b.changeMarkup("h1");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH2,function(){b.changeMarkup("h2");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH3,function(){b.changeMarkup("h3");
return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH4,function(){b.changeMarkup("h4");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH5,function(){b.changeMarkup("h5");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatH6,function(){b.changeMarkup("h6");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatPre,function(){b.changeMarkup("pre");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatDel,function(){b.addMarkup("del");
return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatSub,function(){b.addMarkup("sub");return!1});e.editable.obj.bind("keydown.aloha.format",b.hotKey.formatSup,function(){b.addMarkup("sup");return!1})});a.bind("aloha-editable-deactivated",function(a,b){b.editable.obj.unbind("keydown.aloha.format")})},applyButtonConfig:function(a){a=this.getEditableConfig(a);var b,e;if("object"===typeof a){var f=[];d.each(a,function(a,b){"number"===typeof a&&"string"===typeof b||f.push(a)});0<f.length&&
(a=f)}this.formatOptions=a;for(b in this.buttons)this.buttons.hasOwnProperty(b)&&(-1!==d.inArray(b,a)?this.buttons[b].handle.show():this.buttons[b].handle.hide());e=this.multiSplitItems.length;for(b=0;b<e;b++)-1!==d.inArray(this.multiSplitItems[b].name,a)?this.multiSplitButton.showItem(this.multiSplitItems[b].name):this.multiSplitButton.hideItem(this.multiSplitItems[b].name)},initButtons:function(){var b=this;this.buttons={};this.multiSplitItems=[];d.each(this.availableButtons,function(f,k){var n=
!1;"number"!==typeof f&&"string"!==typeof k&&(n=k,k=f);if(v[k]){var s=j[k];e.hasOwnProperty(k)&&(s=e[k]);s=p.adopt(s,r,{tooltip:g.t("button."+k+".tooltip"),icon:"aloha-icon aloha-icon-"+s,scope:"Aloha.continuoustext",click:function(){var a=d(".aloha-cell-selected");if(0<a.length){var e=0;a.each(function(){var a=d(this).find("div"),b=a.find(k);0<b.length&&(b.contents().unwrap(),e++);a.contents().wrap("<"+k+"></"+k+">")});e===a.length&&a.find(k).contents().unwrap();return!1}b.addMarkup(k);return!1}});
b.buttons[k]={handle:s,markup:d("<"+k+">",{"class":n||""})}}else x[k]?b.multiSplitItems.push({name:k,tooltip:g.t("button."+k+".tooltip"),iconClass:"aloha-icon "+g.t("aloha-large-icon-"+k),markup:d("<"+k+">"),click:function(){var e=d(".aloha-cell-selected");if(0<e.length){var f=0;e.each(function(){var a=d(this).find("div"),b=a.find(k);0<b.length&&(b.contents().unwrap(),f++);a.contents().wrap("<"+k+"></"+k+">")});f===e.length&&e.find(k).contents().unwrap();return!1}b.changeMarkup(k);a.activeEditable&&
d.browser.mozilla&&a.activeEditable.obj.focus();a.activeEditable&&a.trigger("aloha-format-block")}}):"removeFormat"===k?b.multiSplitItems.push({name:k,text:g.t("button."+k+".text"),tooltip:g.t("button."+k+".tooltip"),wide:!0,cls:"aloha-ui-multisplit-fullwidth",click:function(){b.removeFormat()}}):a.log("warn",this,'Button "'+k+'" is not defined')});this.multiSplitButton=s({name:"formatBlock",items:this.multiSplitItems,hideIfEmpty:!0,scope:"Aloha.continuoustext"});t.sub("aloha.selection.context-change",
function(a){f(b,a.range)})},initSidebar:function(a){var b=this;b.sidebar=a;a.addPanel({id:b.nsClass("sidebar-panel-class"),title:g.t("floatingmenu.tab.format"),content:"",expanded:!0,activeOn:this.formatOptions||!1,onInit:function(){},onActivate:function(a){var c=this;c.effective=a;if(a[0]){c.format=a[0].nodeName.toLowerCase();var e=d("<div>").attr("class",b.nsClass("target-container")),f=d("<fieldset>");f.append(d("<legend>"+c.format+" "+g.t("format.class.legend")).append(d("<select>")));e.append(f);
var j='<div class="'+b.nsClass("target-container")+'"><fieldset><legend>'+g.t("format.class.legend")+'</legend><select name="targetGroup" class="'+b.nsClass("radioTarget")+'"><option value="">'+g.t("format.class.none")+"</option>";b.config[c.format]&&b.config[c.format]["class"]&&d.each(b.config[c.format]["class"],function(a,b){j+='<option value="'+a+'" >'+b+"</option>"});j+="</select></fieldset></div>";c=this;this.setContent(j);d(b.nsSel("framename")).live("keyup",function(){d(c.effective).attr("target",
d(this).val().replace('"',"&quot;").replace("'","&#39;"))});c=this;c.effective=a;d(b.nsSel("linkTitle")).val(d(c.effective).attr("title"))}}});a.show()},nsClass:function(){var a=[];d.each(arguments,function(){a.push(""==this?"aloha-format":"aloha-format-"+this)});return d.trim(a.join(" "))},nsSel:function(){var a=[];d.each(arguments,function(){a.push("."+(""==this?"aloha-format":"aloha-format-"+this))});return d.trim(a.join(" "))},addMarkup:function(b){var e=d("<"+b+">"),g=a.Selection.rangeObject;
if("undefined"===typeof b||""==b)return!1;(b=g.findMarkup(function(){return this.nodeName===e[0].nodeName},a.activeEditable.obj))?g.isCollapsed()?n.Utils.Dom.removeFromDOM(b,g,!0):n.Utils.Dom.removeMarkup(g,e,a.activeEditable.obj):(g.isCollapsed()&&n.Utils.Dom.extendToWord(g),n.Utils.Dom.addMarkup(g,e));g.select();f(this,a.Selection.getRangeObject());return!1},changeMarkup:function(b){a.Selection.changeMarkupOnSelection(d("<"+b+">"))},removeFormat:function(){var b="u strong em b i q del s code sub sup p h1 h2 h3 h4 h5 h6 pre quote blockquote".split(" "),
e=a.Selection.rangeObject,f;this.settings.removeFormats&&(b=this.settings.removeFormats);if(!e.isCollapsed()){for(f=0;f<b.length;f++)n.Utils.Dom.removeMarkup(e,d("<"+b[f]+">"),a.activeEditable.obj);e.select()}},toString:function(){return"format"}})});define("list/nls/i18n",{root:{"button.createulist.tooltip":"Insert Unordered List","button.createolist.tooltip":"Insert Ordered List","button.indentlist.tooltip":"Indent List","button.outdentlist.tooltip":"Outdent List","floatingmenu.tab.list":"Lists"},
ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("list/list-plugin","aloha jquery aloha/plugin ui/ui ui/scopes ui/button ui/toggleButton i18n!list/nls/i18n i18n!aloha/nls/i18n aloha/engine PubSub".split(" "),function(a,b,d,p,r,s,t,g,f,n,j){function e(c,e){b(c).find(c.nodeName).each(function(){var b=a.Selection.getSelectionTree();v(b,this)&&a.Markup.transformDomObject(this,e,a.Selection.rangeObject)});a.Markup.transformDomObject(c,e,a.Selection.rangeObject)}function v(a,c){var e=!1;b.each(a,
function(a,b){if(b.domobj===c&&"none"!==b.selection||v(b.children,c))e=!0});return e}var x=window.GENTICS,c=d.create("list",{config:["ul","ol"],transformableElements:{p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ul:!0,ol:!0},init:function(){var c=this;this._orderedListButton=p.adopt("orderedList",t,{tooltip:g.t("button.createolist.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",scope:"Aloha.continuoustext",click:function(){c.transformList(!0)}});this._unorderedListButton=p.adopt("unorderedList",t,
{tooltip:g.t("button.createulist.tooltip"),icon:"aloha-icon aloha-icon-unorderedlist",scope:"Aloha.continuoustext",click:function(){c.transformList(!1)}});this._indentListButton=p.adopt("indentList",s,{tooltip:g.t("button.indentlist.tooltip"),icon:"aloha-icon aloha-icon-indent",scope:"Aloha.continuoustext",click:function(){c.indentList()}});this._outdentListButton=p.adopt("outdentList",s,{tooltip:g.t("button.outdentlist.tooltip"),icon:"aloha-icon aloha-icon-outdent",scope:"Aloha.continuoustext",click:function(){c.outdentList()}});
r.createScope("Aloha.List","Aloha.continuoustext");j.sub("aloha.selection.context-change",function(e){var d,f=e.range;c._outdentListButton.show(!1);c._indentListButton.show(!1);c._unorderedListButton.setState(!1);c._orderedListButton.setState(!1);for(e=0;e<f.markupEffectiveAtStart.length;e++){d=f.markupEffectiveAtStart[e];if(a.Selection.standardTagNameComparator(d,b("<ul></ul>"))){c._unorderedListButton.setState(!0);c._outdentListButton.show(!0);c._indentListButton.show(!0);break}if(a.Selection.standardTagNameComparator(d,
b("<ol></ol>"))){c._orderedListButton.setState(!0);c._outdentListButton.show(!0);c._indentListButton.show(!0);break}}a.activeEditable&&c.applyButtonConfig(a.activeEditable.obj)});a.Markup.addKeyHandler(9,function(a){return c.processTab(a)})},applyButtonConfig:function(c){c=this.getEditableConfig(c);a.Selection.rangeObject.unmodifiableMarkupAtStart[0]&&(-1!=b.inArray("ul",c)&&-1!=a.Selection.canTag1WrapTag2(a.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ul")?this._unorderedListButton.show(!0):
this._unorderedListButton.show(!1),-1!=b.inArray("ol",c)&&-1!=a.Selection.canTag1WrapTag2(a.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ol")?this._orderedListButton.show(!0):this._orderedListButton.show(!1))},processTab:function(a){return 9===a.keyCode?a.shiftKey?this.outdentList():this.indentList():!0},getStartingDomObjectToTransform:function(){var b=a.Selection.rangeObject,c,e;for(c=0;c<b.markupEffectiveAtStart.length;c++)if(e=b.markupEffectiveAtStart[c],this.transformableElements[e.nodeName.toLowerCase()])return e;
return!1},getNearestSelectedListItem:function(){var b=a.Selection.rangeObject,c,e;for(c=0;c<b.markupEffectiveAtStart.length;c++)if(e=b.markupEffectiveAtStart[c],x.Utils.Dom.isListElement(e))return e;return!1},transformList:function(c){var d=this.getStartingDomObjectToTransform(),f,g,j,p;this._outdentListButton.show(!0);this._indentListButton.show(!0);if(!d&&(a.Selection.changeMarkupOnSelection(b("<p></p>")),d=this.getStartingDomObjectToTransform(),!d)){a.Selection.rangeObject.startContainer.contentEditable?
(c=c?b("<ol></ol>"):b("<ul></ul>"),g=b("<li></li>"),c.append(g),j=g.get(0),d=a.getActiveEditable().obj,j.appendChild(document.createTextNode("")),d.append(c),d.focus(),c=a.createRange(),d=a.getSelection(),c.setStart(j.firstChild,0),c.setEnd(j.firstChild,0),d.removeAllRanges(),d.addRange(c),a.Selection.updateSelection()):a.Log.error(this,"Could not transform selection into a list");return}j=d.nodeName.toLowerCase();if("ul"==j&&!c)c=b(d),j=c.parent(),0<j.length&&x.Utils.Dom.isListElement(j.get(0))?
"li"===j.get(0).nodeName.toLowerCase()?(j.after(c.children()),c.remove()):c.children().unwrap():(c=b(d),b.each(c.children("li"),function(b,c){p=a.Markup.transformDomObject(c,"p",a.Selection.rangeObject);p.after(p.children("ol,ul"));n.ensureContainerEditable(p.get(0))}),c.children().unwrap());else if("ul"==j&&c)e(d,"ol"),this.mergeAdjacentLists(b(d));else if("ol"==j&&!c)e(d,"ul"),this.mergeAdjacentLists(b(d));else if("ol"==j&&c)c=b(d),j=c.parent(),0<j.length&&x.Utils.Dom.isListElement(j.get(0))?"li"===
j.get(0).nodeName.toLowerCase()?(j.after(c.children()),c.remove()):c.children().unwrap():(c=b(d),b.each(c.children("li"),function(b,c){p=a.Markup.transformDomObject(c,"p",a.Selection.rangeObject);p.after(p.children("ol,ul"));n.ensureContainerEditable(p.get(0))}),c.children().unwrap());else{j=a.Selection.rangeObject.getSelectedSiblings(d);c=c?b("<ol></ol>"):b("<ul></ul>");g=b("<li></li>");c.append(g);b(d).contents().appendTo(g);b(d).replaceWith(c);a.Selection.rangeObject.startContainer==d&&(a.Selection.rangeObject.startContainer=
g.get(0));a.Selection.rangeObject.endContainer==d&&(a.Selection.rangeObject.endContainer=g.get(0));if(j){d=!1;for(f=0;f<j.length;++f)x.Utils.Dom.isBlockLevelElement(j[f])?(d&&(d=!1),g=a.Markup.transformDomObject(j[f],"li",a.Selection.rangeObject),c.append(g)):3==j[f].nodeType&&0===b.trim(j[f].data).length||(d||(d=b("<li></li>"),c.append(d),g=d),d.append(j[f]))}this.mergeAdjacentLists(c);j=g.get(0);x.Utils.Dom.isEmpty(j)&&(c=a.createRange(),d=a.getSelection(),j.appendChild(document.createTextNode("")),
c.selectNodeContents(j.lastChild),d.removeAllRanges(),d.addRange(c),a.Selection.updateSelection())}this.refreshSelection()},indentList:function(){var c=this.getNearestSelectedListItem(),e,d,f;if(c){f=b(c).prev("li");if(0===f.length)return!1;b(c).parent();d=a.Selection.rangeObject.getSelectedSiblings(c);e=b(c).parent().clone(!1).empty();e.append(c);f.append(e);if(d)for(c=0;c<d.length;++c)e.append(b(d[c]));this.mergeAdjacentLists(e,!0);this.refreshSelection();return!1}return!0},outdentList:function(){var c=
this.getNearestSelectedListItem(),e,d,f,g,j;if(c){d=b(c);f=d.parent();e=f.parents("ul,ol");g=f.parent("li");if(0<e.length&&x.Utils.Dom.isListElement(e.get(0))){j=(c=a.Selection.rangeObject.getSelectedSiblings(c))&&0<c.length?b(c[c.length-1]):d;0<j.nextAll("li").length&&(e=f.clone(!1).empty(),e.append(j.nextAll()),j.append(e));0<g.length?g.after(d):f.before(d);if(c&&0<c.length)for(e=c.length-1;0<=e;--e)d.after(b(c[e]));0===f.contents("li").length&&f.remove();0<g.length&&0===g.contents().length&&g.remove();
this.refreshSelection()}return!1}return!0},refreshSelection:function(){a.Selection.rangeObject.update();a.Selection.rangeObject.select();a.Selection.updateSelection()},mergeAdjacentLists:function(a,c){for(var e=a.get(0),d;e.previousSibling&&1===e.previousSibling.nodeType&&this.isMergable(e.previousSibling,e,c);)e=e.previousSibling;for(a=b(e);e.nextSibling&&(1===e.nextSibling.nodeType&&this.isMergable(e.nextSibling,e,c)||3===e.nextSibling.nodeType&&0===b.trim(e.nextSibling.data).length);)d=b(e.nextSibling),
1==e.nextSibling.nodeType&&d.contents().appendTo(a),d.remove()},isMergable:function(a,b,c){return c?"ul"==a.nodeName.toLowerCase()||"ol"==a.nodeName.toLowerCase():a.nodeName==b.nodeName}});n.commands.insertorderedlist={action:function(b,e){c.transformList(!0);e&&a.Selection.rangeObject&&(e.startContainer=a.Selection.rangeObject.startContainer,e.startOffset=a.Selection.rangeObject.startOffset,e.endContainer=a.Selection.rangeObject.endContainer,e.endOffset=a.Selection.rangeObject.endOffset)},indeterm:function(){},
state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(a.Selection.standardTagNameComparator(effectiveMarkup,b("<ul></ul>")))break;if(a.Selection.standardTagNameComparator(effectiveMarkup,b("<ol></ol>")))return!0}return!1}};n.commands.insertunorderedlist={action:function(b,e){c.transformList(!1);e&&a.Selection.rangeObject&&(e.startContainer=a.Selection.rangeObject.startContainer,e.startOffset=a.Selection.rangeObject.startOffset,
e.endContainer=a.Selection.rangeObject.endContainer,e.endOffset=a.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(a.Selection.standardTagNameComparator(effectiveMarkup,b("<ul></ul>")))return!0;if(a.Selection.standardTagNameComparator(effectiveMarkup,b("<ol></ol>")))break}return!1}};n.commands.indent={action:function(b,e){c.indentList();e&&a.Selection.rangeObject&&
(e.startContainer=a.Selection.rangeObject.startContainer,e.startOffset=a.Selection.rangeObject.startOffset,e.endContainer=a.Selection.rangeObject.endContainer,e.endOffset=a.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){return!1}};n.commands.outdent={action:function(b,e){c.outdentList();e&&a.Selection.rangeObject&&(e.startContainer=a.Selection.rangeObject.startContainer,e.startOffset=a.Selection.rangeObject.startOffset,e.endContainer=a.Selection.rangeObject.endContainer,
e.endOffset=a.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){return!1}};return c});define("image/nls/i18n",{root:{"size.natural":"Original size","button.addimg.tooltip":"add image ref","floatingmenu.tab.img":"Image","floatingmenu.tab.formatting":"Formatting","floatingmenu.tab.resize":"Resize","floatingmenu.tab.crop":"Crop","button.uploadimg.tooltip":"Upload img","button.uploadimg.label":"Upload","button.img.align.left.tooltip":"Left align","button.img.align.right.tooltip":"Right Align",
"button.img.align.none.tooltip":"No alignment","field.img.title.label":"Title","field.img.title.tooltip":"Title","field.img.label":"URL","field.img.tooltip":"Source","border ":"Add Border to Image","padding.increase ":"Increase Padding","padding.decrease ":"Decrease Padding","size.increase ":"Increase Size","size.decrease ":"Decrease Size",Resize:"Resize",Crop:"Crop",Reset:"Reset",Accept:"Accept",Cancel:"Cancel",height:"Height",width:"Width","button.toggle.tooltip":"Toggle keep aspect ratio","field.img.src.label":"Source",
"field.img.src.tooltip":"Source"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("image/image-floatingMenu","jquery util/class i18n!image/nls/i18n i18n!aloha/nls/i18n ui/ui ui/scopes ui/button ui/toggleButton ui/port-helper-attribute-field".split(" "),function(a,b,d,p,r,s,t,g,f){return b.extend({_constructor:function(){},init:function(a){a.floatingMenuControl=this;this.plugin=a;s.createScope(a.name,"Aloha.empty");this._addUIInsertButton();this._addUIMetaButtons();this._addUIResetButton();
this._addUIAlignButtons();this._addUIMarginButtons();this._addUICropButtons();this._addUIResizeButtons();this._addUIAspectRatioToggleButton()},_addUIAspectRatioToggleButton:function(){var a=this.plugin;this._imageCnrRatioButton=r.adopt("imageCnrRatio",g,{tooltip:d.t("button.toggle.tooltip"),icon:"aloha-icon-cnr-ratio",scope:a.name,click:function(){a.toggleKeepAspectRatio()}});!1!==a.settings.fixedAspectRatio&&(this._imageCnrRatioButton.setState(!0),a.keepAspectRatio=!0)},_addUIResetButton:function(){var a=
this.plugin;this._imageCnrResetButton=r.adopt("imageCnrReset",t,{tooltip:d.t("Reset"),icon:"aloha-icon-cnr-reset",scope:a.name,click:function(){a.reset()}})},_addUIInsertButton:function(){var a=this.plugin;this._insertImageButton=r.adopt("insertImage",t,{tooltip:d.t("button.addimg.tooltip"),icon:"aloha-button aloha-image-insert",scope:"Aloha.continuoustext",click:function(){a.insertImg()}})},_addUIMetaButtons:function(){var a=this.plugin;this.imgSrcField=f({label:d.t("field.img.src.label"),labelClass:"aloha-image-input-label",
tooltip:d.t("field.img.src.tooltip"),name:"imageSource",scope:a.name});this.imgSrcField.setTemplate("<span><b>{name}</b><br/>{url}</span>");this.imgSrcField.setObjectTypeFilter(a.objectTypeFilter);this.imgTitleField=f({label:d.t("field.img.title.label"),labelClass:"aloha-image-input-label",tooltip:d.t("field.img.title.tooltip"),name:"imageTitle",scope:a.name});this.imgTitleField.setObjectTypeFilter()},_addUIAlignButtons:function(){var b=this.plugin;this._imageAlignLeftButton=r.adopt("imageAlignLeft",
t,{tooltip:d.t("button.img.align.left.tooltip"),icon:"aloha-img aloha-image-align-left",scope:b.name,click:function(){var d=a(b.getPluginFocus());d.add(d.parent()).css("float","left")}});this._imageAlignRightButton=r.adopt("imageAlignRight",t,{tooltip:d.t("button.img.align.right.tooltip"),icon:"aloha-img aloha-image-align-right",scope:b.name,click:function(){var d=a(b.getPluginFocus());d.add(d.parent()).css("float","right")}});this._imageAlignNoneButton=r.adopt("imageAlignNone",t,{tooltip:d.t("button.img.align.none.tooltip"),
icon:"aloha-img aloha-image-align-none",scope:b.name,click:function(){var d=a(b.getPluginFocus());d.add(d.parent()).css({"float":"none",display:"inline-block"})}})},_addUIMarginButtons:function(){var b=this.plugin;this._imageIncPaddingButton=r.adopt("imageIncPadding",t,{tooltip:d.t("padding.increase"),icon:"aloha-img aloha-image-padding-increase",scope:b.name,click:function(){a(b.getPluginFocus()).increase("padding")}});this._imageDecPaddingButton=r.adopt("imageDecPadding",t,{tooltip:d.t("padding.decrease"),
icon:"aloha-img aloha-image-padding-decrease",scope:b.name,click:function(){a(b.getPluginFocus()).decrease("padding")}})},_addUICropButtons:function(){var a=this.plugin;s.createScope("Aloha.img",["Aloha.global"]);this._imageCropButton=r.adopt("imageCropButton",g,{tooltip:d.t("Crop"),icon:"aloha-icon-cnr-crop",scope:a.name,click:function(){this.getState()?a.crop():a.endCrop()}})},_addUIResizeButtons:function(){var a=this.plugin;this.imgResizeHeightField=f({label:d.t("height"),labelClass:"aloha-image-input-label",
name:"imageResizeHeight",width:50,scope:a.name});this.imgResizeHeightField.maxValue=a.settings.maxHeight;this.imgResizeHeightField.minValue=a.settings.minHeight;this.imgResizeWidthField=f({label:d.t("width"),labelClass:"aloha-image-input-label",name:"imageResizeWidth",width:50,scope:a.name});this.imgResizeWidthField.maxValue=a.settings.maxWidth;this.imgResizeWidthField.minValue=a.settings.minWidth},setScope:function(){s.setScope(this.plugin.name)},doLayout:function(){}})});define("image/vendor/jcrop/jquery.jcrop.min",
["jquery"],function(a){var b=a;b.Jcrop=function(a,p){function r(a){return""+parseInt(a)+"px"}function s(a){a=b(a).offset();return[a.left,a.top]}function t(a){return[a.pageX-aa[0],a.pageY-aa[1]]}function g(a,b){return function(c){if(D.aspectRatio)switch(a){case "e":c[1]=b.y+1;break;case "w":c[1]=b.y+1;break;case "n":c[0]=b.x+1;break;case "s":c[0]=b.x+1}else switch(a){case "e":c[1]=b.y2;break;case "w":c[1]=b.y2;break;case "n":c[0]=b.x2;break;case "s":c[0]=b.x2}fa.setCurrent(c);ga.update()}}function f(a){var b=
a;m.watchKeys();return function(a){fa.moveOffset([a[0]-b[0],a[1]-b[1]]);b=a;ga.update()}}function n(a){switch(a){case "n":return"sw";case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function j(a){return function(b){if(D.disabled||"move"==a&&!D.allowMove)return!1;A=!0;var c=t(b);aa=s(E);Ca.setCursor("move"==a?a:a+"-resize");if("move"==a)Ca.activateHandlers(f(c),v);else{var c=fa.getFixed(),e=n(a),d=fa.getCorner(n(e));
fa.setPressed(fa.getCorner(e));fa.setCurrent(d);Ca.activateHandlers(g(a,c),v)}b.stopPropagation();b.preventDefault();return!1}}function e(a){return{x:parseInt(a.x*X),y:parseInt(a.y*O),x2:parseInt(a.x2*X),y2:parseInt(a.y2*O),w:parseInt(a.w*X),h:parseInt(a.h*O)}}function v(){var a=fa.getFixed();a.w>D.minSelect[0]&&a.h>D.minSelect[1]?(ga.enableHandles(),ga.done()):ga.release();Ca.setCursor(D.allowSelect?"crosshair":"default")}function x(a){fa.setCurrent(a);ga.update()}function c(){var a=b("<div></div>").addClass(D.baseClass+
"-tracker");b.browser.msie&&a.css({opacity:0,backgroundColor:"white"});return a}function u(a){k([a[0]/X,a[1]/O,a[2]/X,a[3]/O])}function k(a){fa.setPressed([a[0],a[1]]);fa.setCurrent([a[2],a[3]]);ga.update()}function y(a){"object"!=typeof a&&(a={});D=b.extend(D,a);"function"!==typeof D.onChange&&(D.onChange=function(){});"function"!==typeof D.onSelect&&(D.onSelect=function(){})}function z(a){D.allowResize?a?ga.enableOnly():ga.enableHandles():ga.disableHandles();Ca.setCursor(D.allowSelect?"crosshair":
"default");ga.setCursor(D.allowMove?"move":"default");ca.css("backgroundColor",D.bgColor);"setSelect"in D&&(u(p.setSelect),ga.done(),delete D.setSelect);"trueSize"in D&&(X=D.trueSize[0]/G,O=D.trueSize[1]/T);ha=D.maxSize[0]||0;ia=D.maxSize[1]||0;pa=D.minSize[0]||0;ma=D.minSize[1]||0;"outerImage"in D&&(E.attr("src",D.outerImage),delete D.outerImage);ga.refresh()}"object"!==typeof a&&(a=b(a)[0]);"object"!==typeof p&&(p={});"trackDocument"in p||(p.trackDocument=b.browser.msie?!1:!0,b.browser.msie&&"8"==
b.browser.version.split(".")[0]&&(p.trackDocument=!0));"keySupport"in p||(p.keySupport=b.browser.msie?!1:!0);var D={trackDocument:!1,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,borderOpacity:0.4,handleOpacity:0.5,handlePad:5,handleSize:9,handleOffset:5,edgeMargin:14,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,boxWidth:0,boxHeight:0,boundary:8,animationDelay:20,swingSpeed:3,allowSelect:!0,allowMove:!0,allowResize:!0,minSelect:[0,0],maxSize:[0,
0],minSize:[0,0],onChange:function(){},onSelect:function(){}};y(p);var K=b(a),E=K.clone().removeAttr("id").css({position:"absolute"});E.width(K.width());E.height(K.height());K.after(E).hide();var B=E,J=D.boxWidth,N=D.boxHeight,W=B.width(),U=B.height();W>J&&0<J&&(W=J,U=J/B.width()*B.height());U>N&&0<N&&(U=N,W=N/B.height()*B.width());X=B.width()/W;O=B.height()/U;B.width(W).height(U);var G=E.width(),T=E.height(),ca=b("<div />").width(G).height(T).addClass(D.baseClass+"-holder").css({position:"relative",
backgroundColor:D.bgColor}).insertAfter(K).append(E);D.addClass&&ca.addClass(D.addClass);var da=b("<img />").attr("src",E.attr("src")).css("position","absolute").width(G).height(T),ba=b("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}).append(da),V=b("<div />").width("100%").height("100%").css("zIndex",320),H=b("<div />").css({position:"absolute",zIndex:300}).insertBefore(E).append(ba,V),B=D.boundary,ya=c().width(G+2*B).height(T+2*B).css({position:"absolute",
top:r(-B),left:r(-B),zIndex:290}).mousedown(function(a){if(D.disabled||!D.allowSelect)return!1;A=!0;aa=s(E);ga.disableHandles();"crosshair"!=ua&&(Ca.setCursor("crosshair"),ua="crosshair");var b=t(a);fa.setPressed(b);Ca.activateHandlers(x,v);m.watchKeys();ga.update();a.stopPropagation();a.preventDefault();return!1}),ha,ia,pa,ma,X,O,aa=s(E),A,ua,Ia,ja,fa,La=function(){if(!D.aspectRatio){var a=C-L,b=R-P;ha&&Math.abs(a)>ha&&(C=0<a?L+ha:L-ha);ia&&Math.abs(b)>ia&&(R=0<b?P+ia:P-ia);ma&&Math.abs(b)<ma&&(R=
0<b?P+ma:P-ma);pa&&Math.abs(a)<pa&&(C=0<a?L+pa:L-pa);0>L&&(C-=L,L-=L);0>P&&(R-=P,P-=P);0>C&&(L-=C,C-=C);0>R&&(P-=R,R-=R);C>G&&(a=C-G,L-=a,C-=a);R>T&&(a=R-T,P-=a,R-=a);L>G&&(a=L-T,R-=a,P-=a);P>T&&(a=P-T,R-=a,P-=a);return ea(Fa(L,P,C,R))}var a=D.aspectRatio,b=D.minSize[0]/X,c=D.maxSize[0]/X,e=C-L,d=R-P,f=Math.abs(e),g=Math.abs(d);0==c&&(c=10*G);f/g<a?(f=R,w=g*a,g=0>e?L-w:w+L,0>g?(g=0,h=Math.abs((g-L)/a),f=0>d?P-h:h+P):g>G&&(g=G,h=Math.abs((g-L)/a),f=0>d?P-h:h+P)):(g=C,h=f/a,f=0>d?P-h:P+h,0>f?(f=0,w=
Math.abs((f-P)*a),g=0>e?L-w:w+L):f>T&&(f=T,w=Math.abs(f-P)*a,g=0>e?L-w:w+L));g>L?(g-L<b?g=L+b:g-L>c&&(g=L+c),f=f>P?P+(g-L)/a:P-(g-L)/a):g<L&&(L-g<b?g=L-b:L-g>c&&(g=L-c),f=f>P?P+(L-g)/a:P-(L-g)/a);0>g?(L-=g,g=0):g>G&&(L-=g-G,g=G);0>f?(P-=f,f=0):f>T&&(P-=f-T,f=T);return last=ea(Fa(L,P,g,f))},Ga=function(a){0>a[0]&&(a[0]=0);0>a[1]&&(a[1]=0);a[0]>G&&(a[0]=G);a[1]>T&&(a[1]=T);return[a[0],a[1]]},Fa=function(a,b,c,e){var d=a,f=c,g=b,j=e;c<a&&(d=c,f=a);e<b&&(g=e,j=b);return[Math.round(d),Math.round(g),Math.round(f),
Math.round(j)]},ea=function(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}},L=0,P=0,C=0,R=0,Ka,I;fa={flipCoords:Fa,setPressed:function(a){a=Ga(a);C=L=a[0];R=P=a[1]},setCurrent:function(a){a=Ga(a);Ka=a[0]-C;I=a[1]-R;C=a[0];R=a[1]},getOffset:function(){return[Ka,I]},moveOffset:function(a){var b=a[0];a=a[1];0>L+b&&(b-=b+L);0>P+a&&(a-=a+P);T<R+a&&(a+=T-(R+a));G<C+b&&(b+=G-(C+b));L+=b;C+=b;P+=a;R+=a},getCorner:function(a){var b=La();switch(a){case "ne":return[b.x2,b.y];case "nw":return[b.x,
b.y];case "se":return[b.x2,b.y2];case "sw":return[b.x,b.y2]}},getFixed:La};var ga,B=function(a){a=b("<div />").css({position:"absolute",opacity:D.borderOpacity}).addClass(D.baseClass+"-"+a);ba.append(a);return a},Ua=function(a,c){var e=b("<div />").mousedown(j(a)).css({cursor:a+"-resize",position:"absolute",zIndex:c});V.append(e);return e},J=function(a){var b=D.handleSize,c=Ma,e=b;switch(a){case "n":case "s":b="100%";break;case "e":case "w":e="100%"}return Ua(a,Z++).width(b).height(e).css({top:r(-c+
1),left:r(-c+1)})},N=function(a){for(i in a)ra[a[i]]=Ua(a[i],Z++).css({top:r(-Ma+1),left:r(-Ma+1),opacity:D.handleOpacity}).addClass(D.baseClass+"-handle")},xa=function(a){var b=Math.round(a.h/2-Ma),c=Math.round(a.w/2-Ma);west=-Ma+1;var e=a.w-Ma;a=a.h-Ma;"e"in ra&&ra.e.css({top:r(b),left:r(e)})&&ra.w.css({top:r(b)})&&ra.s.css({top:r(a),left:r(c)})&&ra.n.css({left:r(c)});"ne"in ra&&ra.ne.css({left:r(e)})&&ra.se.css({top:r(a),left:r(e)})&&ra.sw.css({top:r(a)});"b"in ra&&ra.b.css({top:r(a)})&&ra.r.css({left:r(e)})},
ka=function(){var a=fa.getFixed();fa.setPressed([a.x,a.y]);fa.setCurrent([a.x2,a.y2]);Pa()},Pa=function(){if(za)return qa()},qa=function(){var a=fa.getFixed(),b=a.h;H.width(a.w).height(b);var b=a.x,c=a.y;da.css({top:r(-c),left:r(-b)});H.css({top:r(c),left:r(b)});D.drawBorders&&$.right.css({left:r(a.w-1)})&&$.bottom.css({top:r(a.h-1)});va&&xa(a);za||(H.show(),E.css("opacity",D.bgOpacity),za=!0);D.onChange(e(a))},la=function(){va=!0;if(D.allowResize)return xa(fa.getFixed()),V.show(),!0},ta=function(){va=
!1;V.hide()},Ha=function(a){(Ia=a)?ta():la()},za,Z=370,$={},ra={},va=!1,Ma=D.handleOffset;D.drawBorders&&($={top:B("hline").css("top",b.browser.msie?r(-1):r(0)),bottom:B("hline"),left:B("vline"),right:B("vline")});D.dragEdges&&(ra.t=J("n"),ra.b=J("s"),ra.r=J("e"),ra.l=J("w"));D.sideHandles&&N(["n","s","e","w"]);D.cornerHandles&&N(["sw","nw","ne","se"]);var Qa=c().mousedown(j("move")).css({cursor:"move",position:"absolute",zIndex:360});ba.append(Qa);ta();ga={updateVisible:Pa,update:qa,release:function(){ta();
H.hide();E.css("opacity",1);za=!1},refresh:ka,setCursor:function(a){Qa.css("cursor",a)},enableHandles:la,enableOnly:function(){va=!0},showHandles:function(){va&&(xa(fa.getFixed()),V.show())},disableHandles:ta,animMode:Ha,done:function(){Ha(!1);ka()}};var Ca,Aa=function(a){Ta(t(a))},na=function(a){a.preventDefault();a.stopPropagation();A&&(A=!1,Oa(t(a)),D.onSelect(e(fa.getFixed())),ya.css({zIndex:290}),l&&b(document).unbind("mousemove",Aa).unbind("mouseup",na),Ta=function(){},Oa=function(){});return!1},
Ta=function(){},Oa=function(){},l=D.trackDocument;l||ya.mousemove(Aa).mouseup(na).mouseout(na);E.before(ya);Ca={activateHandlers:function(a,c){A=!0;Ta=a;Oa=c;ya.css({zIndex:450});l&&b(document).mousemove(Aa).mouseup(na);return!1},setCursor:function(a){ya.css("cursor",a)}};var m,q=function(a,b,c){D.allowMove&&(fa.moveOffset([b,c]),ga.updateVisible());a.preventDefault();a.stopPropagation()},wa=b('<input type="radio" />').css({position:"absolute",left:"-30px"}).keypress(function(a){if(a.ctrlKey)return!0;
var b=(ja=a.shiftKey?!0:!1)?10:1;switch(a.keyCode){case 37:q(a,-b,0);break;case 39:q(a,b,0);break;case 38:q(a,0,-b);break;case 40:q(a,0,b);break;case 27:ga.release();break;case 9:return!0}return nothing(a)}).blur(function(){wa.hide()}),B=b("<div />").css({position:"absolute",overflow:"hidden"}).append(wa);D.keySupport&&B.insertBefore(E);m={watchKeys:function(){D.keySupport&&(wa.show(),wa.focus())}};V.hide();z(!0);B={animateTo:function(a){var b=a[0]/X,c=a[1]/O,e=a[2]/X,d=a[3]/O;if(!Ia){a=fa.flipCoords(b,
c,e,d);var b=fa.getFixed(),f=initcr=[b.x,b.y,b.x2,b.y2],g=D.animationDelay,j=f[0],n=f[1],e=f[2],d=f[3],l=a[0]-initcr[0],m=a[1]-initcr[1],p=a[2]-initcr[2],r=a[3]-initcr[3],s=0,q=D.swingSpeed;ga.animMode(!0);var t=function(){s+=(100-s)/q;f[0]=j+s/100*l;f[1]=n+s/100*m;f[2]=e+s/100*p;f[3]=d+s/100*r;100>s?window.setTimeout(t,g):ga.done();99.8<=s&&(s=100);k(f)};window.setTimeout(t,g)}},setSelect:u,setOptions:function(a){y(a);z()},tellSelect:function(){return e(fa.getFixed())},tellScaled:function(){return fa.getFixed()},
disable:function(){D.disabled=!0;ga.disableHandles();ga.setCursor("default");Ca.setCursor("default")},enable:function(){D.disabled=!1;z()},cancel:function(){ga.done();Ca.activateHandlers(null,null)},focus:m.watchKeys,getBounds:function(){return[G*X,T*O]},getWidgetSize:function(){return[G,T]},release:ga.release,destroy:function(){ca.remove();K.show()}};K.data("Jcrop",B);return B};b.fn.Jcrop=function(a){"object"!==typeof a&&(a={});this.each(function(){if(b(this).data("Jcrop")){if("api"==a)return b(this).data("Jcrop");
b(this).data("Jcrop").setOptions(a)}else{var p=this,r=a.useImg||p.src,s=new Image;s.onload=function(){b.Jcrop(p,a)};s.src=r}});return this}});define("image/vendor/mousewheel/mousewheel",["jquery"],function(a){var b=function(b){var d=b||window.event,p=[].slice.call(arguments,1),g=0,f=0,n=0;b=a.event.fix(d);b.type="mousewheel";d.wheelDelta&&(g=d.wheelDelta/120);d.detail&&(g=-d.detail/3);n=g;void 0!==d.axis&&d.axis===d.HORIZONTAL_AXIS&&(n=0,f=-1*g);void 0!==d.wheelDeltaY&&(n=d.wheelDeltaY/120);void 0!==
d.wheelDeltaX&&(f=-1*d.wheelDeltaX/120);p.unshift(b,g,f,n);return(a.event.dispatch||a.event.handle).apply(this,p)},d=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var p=d.length;p;)a.event.fixHooks[d[--p]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=d.length;a;)this.addEventListener(d[--a],b,!1);else this.onmousewheel=b},teardown:function(){if(this.removeEventListener)for(var a=d.length;a;)this.removeEventListener(d[--a],b,!1);else this.onmousewheel=
null}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});define("image/image-plugin","jquery aloha/plugin image/image-floatingMenu i18n!aloha/nls/i18n i18n!image/nls/i18n jqueryui image/vendor/jcrop/jquery.jcrop.min image/vendor/mousewheel/mousewheel".split(" "),function(a,b,d,p,r){var s=a,t=window.GENTICS,g=window.Aloha;String.prototype.toInteger=String.prototype.toInteger||function(){return parseInt(String(this).replace(/px$/,
"")||0,10)};String.prototype.toFloat=String.prototype.toInteger||function(){return parseFloat(String(this).replace(/px$/,"")||0,10)};Number.prototype.toInteger=Number.prototype.toInteger||String.prototype.toInteger;Number.prototype.toFloat=Number.prototype.toFloat||String.prototype.toFloat;a.extend(!0,a.fn,{increase:a.fn.increase||function(b){var d=a(this),g,e;if(!d.length)return d;g=d.css(b).toFloat();e=Math.round(1.2*(g||1));g===e&&e++;d.css(b,e);return d},decrease:a.fn.decrease||function(b){var d=
a(this),g,e;if(!d.length)return d;g=d.css(b).toFloat();e=Math.round(0.8*(g||0));g===e&&0<e&&e--;d.css(b,e);return d}});return b.create("image",{defaultSettings:{maxWidth:1600,minWidth:3,maxHeight:1200,minHeight:3,autoCorrectManualInput:!0,fixedAspectRatio:!1,autoResize:!1,ui:{meta:!0,crop:!0,resizable:!0},handles:"ne, se, sw, nw",onCropped:function(a,b){g.Log.info("Default onCropped invoked",a,b)},onReset:function(a){g.Log.info("Default onReset invoked",a);return!1},onResize:function(a){g.Log.info("Default onResize invoked",
a)},onResized:function(a){g.Log.info("Default onResized invoked",a)}},_onCropped:function(a,b){s("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());s("body").trigger("aloha-image-cropped",[a,b]);this.onCropped(a,b)},_onReset:function(a){s("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());s("body").trigger("aloha-image-reset",a);return this.onReset(a)},
_onResize:function(a){s("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());s("body").trigger("aloha-image-resize",a);this.onResize(a)},_onResized:function(a){s("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());s("body").trigger("aloha-image-resized",a);this.onResized(a)},imageObj:null,jcAPI:null,keepAspectRatio:!1,startAspectRatio:!1,restoreProps:[],
objectTypeFilter:[],init:function(){g.getPluginUrl("image");"undefined"!=typeof this.settings.objectTypeFilter&&(this.objectTypeFilter=this.settings.objectTypeFilter);this.startAspectRatio=this.settings.fixedAspectRatio;this.config=this.defaultSettings;this.settings=a.extend(!0,this.defaultSettings,this.settings);this.initializeUI();this.bindInteractions();this.subscribeEvents()},initializeUI:function(){this.ui=new d;this.ui.init(this)},bindInteractions:function(){var b=this;if(b.settings.ui.resizable)try{document.execCommand("enableObjectResizing",
!1,!1)}catch(d){g.Log.info(d,"Could not disable enableObjectResizing")}b.settings.ui.meta&&(b.ui.imgSrcField.addListener("keyup",function(){b.srcChange()}),b.ui.imgSrcField.addListener("blur",function(){var d=a(b.ui.imgSrcField.getTargetObject());""===d.attr("src")&&d.remove()}));b.settings.onCropped&&"function"===typeof b.settings.onCropped&&(b.onCropped=b.settings.onCropped);b.settings.onReset&&"function"===typeof b.settings.onReset&&(b.onReset=b.settings.onReset);b.settings.onResized&&"function"===
typeof b.settings.onResized&&(b.onResized=b.settings.onResized);b.settings.onResize&&"function"===typeof b.settings.onResize&&(b.onResize=this.settings.onResize)},subscribeEvents:function(){var b=this,d=this.settings;a("img").filter(d.globalselector).unbind();a("img").filter(d.globalselector).click(function(a){b.clickImage(a)});g.bind("aloha-drop-files-in-editable",function(d,e){for(var n,p=e.filesObjs.length,c;0<=--p;)c=e.filesObjs[p],c.file.type.match(/image\//)&&(b.getEditableConfig(e.editable),
n=a("<img/>"),n.css({"max-width":that.maxWidth,"max-height":that.maxHeight}),n.attr("id",c.id),"undefined"===typeof c.src?n.attr("src",c.data):n.attr("src",c.src),t.Utils.Dom.insertIntoDOM(n,e.range,a(g.activeEditable.obj)))});g.bind("aloha-selection-changed",function(d,e,n){n&&n.target&&(b.settings.ui.resizable&&!a(n.target).hasClass("ui-resizable-handle"))&&(b.endResize(),b.imageObj=null,g.trigger("aloha-image-unselected"));null!==g.activeEditable&&(e=b.findImgMarkup(e),d=b.getEditableConfig(g.activeEditable.obj),
"undefined"!==typeof d?(b.ui._insertImageButton.show(),e?(b.ui._insertImageButton.show(),b.ui.setScope(),b.settings.ui.meta&&(b.ui.imgSrcField.setTargetObject(e,"src"),b.ui.imgTitleField.setTargetObject(e,"title")),b.ui.imgSrcField.foreground(),b.ui.imgSrcField.focus()):b.settings.ui.meta&&b.ui.imgSrcField.setTargetObject(null),b.ui.doLayout()):b.ui._insertImageButton.hide())});g.bind("aloha-editable-created",function(a,e){try{document.execCommand("enableObjectResizing",!1,!1)}catch(d){g.Log.info(d,
"Could not disable enableObjectResizing")}e.obj.delegate("img","mouseup",function(a){b.clickImage(a);a.stopPropagation()})});b._subscribeToResizeFieldEvents()},autoResize:function(){var a=this.imageObj.width(),b=this.imageObj.height(),d=!1;if(a<this.settings.minWidth||a>this.settings.maxWidth||b<this.settings.minHeight||b>this.settings.maxHeight)d=!0;return d&&a>=b?(this._setNormalizedFieldValues("width"),this.setSizeByFieldValue(),!0):d&&a<b?(this._setNormalizedFieldValues("height"),this.setSizeByFieldValue(),
!0):!1},toggleKeepAspectRatio:function(){this.keepAspectRatio=!this.keepAspectRatio;this.endResize();this.startAspectRatio=this.keepAspectRatio?"number"!==typeof this.settings.fixedAspectRatio?this.imageObj.width()/this.imageObj.height():this.settings.fixedAspectRatio:!1;this.startResize()},_subscribeToResizeFieldEvents:function(){function a(b,d,f,g){"undefined"===typeof g&&(g=0);"undefined"===typeof f&&(f=8E3);var j=parseInt(b.val(),10);if(isNaN(j))return b.css("background-color","red"),!1;var n=
j+d;if(0<=d&&n>f){if(e.settings.autoCorrectManualInput)return b.val(f),!0;b.css("background-color","red");return!1}if(0>=d&&n<g){if(e.settings.autoCorrectManualInput)return b.val(g),!0;b.css("background-color","red");return!1}b.css("background-color","");b.val(j+d);return!0}function b(c){var d=c.data.minValue,g=c.data.maxValue,j=c.data.fieldName;if(8===c.keyCode||46===c.keyCode)s(this).val()>=d&&("undefined"!==typeof e.jcAPI&&null!==e.jcAPI?e.setCropAreaByFieldValue():(e._setNormalizedFieldValues(j),
e.setSizeByFieldValue()));else if(57>=c.keyCode&&48<=c.keyCode||105>=c.keyCode&&96<=c.keyCode)s(this).val()>=d&&("undefined"!==typeof e.jcAPI&&null!==e.jcAPI?e.setCropAreaByFieldValue():(e._setNormalizedFieldValues(j),e.setSizeByFieldValue()));else{var n=0;if(38===c.keyCode||107===c.keyCode)n=1;else if(40===c.keyCode||109===c.keyCode)n=-1;if(c.shiftKey||c.metaKey||c.ctrlKey)n*=10;a(s(this),n,g,d)&&("undefined"!==typeof e.jcAPI&&null!==e.jcAPI?e.setCropAreaByFieldValue():(e._setNormalizedFieldValues(j),
e.setSizeByFieldValue()))}c.preventDefault();return!1}function d(b,g){var j=b.data.minValue,n=b.data.maxValue,p=b.data.fieldName;if(b.shiftKey||b.metaKey||b.ctrlKey)g*=10;a(s(this),g,n,j)&&("undefined"!==typeof e.jcAPI&&null!==e.jcAPI?e.setCropAreaByFieldValue():(e._setNormalizedFieldValues(p),e.setSizeByFieldValue()));return!1}var e=this,g=s("#"+e.ui.imgResizeHeightField.getInputId()),p={fieldName:"height",maxValue:e.ui.imgResizeHeightField.maxValue,minValue:e.ui.imgResizeHeightField.minValue};g.live("keyup",
p,b);g.live("mousewheel",p,d);g=s("#"+e.ui.imgResizeWidthField.getInputId());p={fieldName:"width",maxValue:e.ui.imgResizeWidthField.maxValue,minValue:e.ui.imgResizeWidthField.minValue};g.live("keyup",p,b);g.live("mousewheel",p,d)},_setNormalizedFieldValues:function(b){var d=a("#"+this.ui.imgResizeWidthField.getInputId()),g=a("#"+this.ui.imgResizeHeightField.getInputId()),e=d.val(),p=g.val();b=this._normalizeSize(e,p,b);d.val(b.width);g.val(b.height)},setSize:function(a,b){this.imageObj.width(a);this.imageObj.height(b);
var d=this.imageObj.closest(".Aloha_Image_Resize");d.height(b);d.width(a);this._onResize(this.imageObj);this._onResized(this.imageObj)},clickImage:function(b){this.endResize();var d=this.imageObj=a(b.target);if(!d.hasClass("aloha-ui")){this.ui.setScope();d.closest(".aloha-editable");this.restoreProps.push({obj:b.srcElement,src:this.imageObj.attr("src"),width:this.imageObj.width(),height:this.imageObj.height()});s("#"+this.ui.imgResizeHeightField.getInputId()).val(this.imageObj.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(this.imageObj.width());
this.settings.ui.meta&&(this.ui.imgSrcField.setTargetObject(this.imageObj,"src"),this.ui.imgTitleField.setTargetObject(this.imageObj,"title"));g.Selection.preventSelectionChanged();try{this.ui.imgSrcField.focus()}catch(j){}this.settings.ui.resizable&&this.startResize();this.settings.autoResize&&this.autoResize();g.Selection.preventSelectionChangedFlag=!1;g.trigger("aloha-image-selected")}},findImgMarkup:function(b){var d,j;"undefined"===typeof b&&(b=g.Selection.getRangeObject());j=a(b.startContainer);
try{if(g.activeEditable&&("undefined"!==typeof b.startContainer&&"undefined"!==typeof b.startContainer.childNodes&&"undefined"!==typeof b.startOffset&&"undefined"!==typeof b.startContainer.childNodes[b.startOffset]&&"img"===b.startContainer.childNodes[b.startOffset].nodeName.toLowerCase()&&b.startOffset+1===b.endOffset||j.hasClass("Aloha_Image_Resize")))return d=j.find("img")[0],d.css||(d.css=""),d.title||(d.title=""),d.src||(d.src=""),d}catch(e){g.Log.debug(e,"Error finding img markup.")}return null},
getPluginFocus:function(){return this.imageObj},_normalizeSize:function(a,b,d){function e(e){if(b>p.settings.maxHeight){var d={org:b,"new":p.settings.maxHeight};s("body").trigger("aloha-image-resize-outofbounds",["height","max",d]);b=p.settings.maxHeight}else b<p.settings.minHeight&&(d={org:b,"new":p.settings.minHeight},s("body").trigger("aloha-image-resize-outofbounds",["height","min",d]),b=p.settings.minHeight);p.keepAspectRatio&&(a=b*c,e&&g(!1))}function g(d){if(a>p.settings.maxWidth){var j={org:a,
"new":p.settings.maxWidth};s("body").trigger("aloha-image-resize-outofbounds",["width","max",j]);a=p.settings.maxWidth}else a<p.settings.minWidth&&(j={org:a,"new":p.settings.minWidth},s("body").trigger("aloha-image-resize-outofbounds",["width","min",j]),a=p.settings.minWidth);p.keepAspectRatio&&(b=a/c,d&&e(!1))}var p=this;a=parseInt(a);b=parseInt(b);var c=1.33333;p.keepAspectRatio&&(c=a/b);"number"===typeof p.startAspectRatio&&(c=p.startAspectRatio);"width"==d&&g(!0);"height"==d&&e(!0);return{width:Math.floor(a),
height:Math.floor(b)}},setSizeByFieldValue:function(){var a=s("#"+this.ui.imgResizeWidthField.getInputId()).val(),b=s("#"+this.ui.imgResizeHeightField.getInputId()).val();this.setSize(a,b)},setCropAreaByFieldValue:function(){var a=this.jcAPI.tellSelect(),b=s("#"+this.ui.imgResizeWidthField.getInputId()).val(),b=parseInt(b,10),d=s("#"+this.ui.imgResizeHeightField.getInputId()).val(),d=parseInt(d,10);this.jcAPI.setSelect([a.x,a.y,a.x+b,a.y+d])},insertImg:function(){var b=g.Selection.getRangeObject(),
d=this.getEditableConfig(g.activeEditable.obj),j=g.getPluginUrl("image");b.isCollapsed()?(d="max-width: "+d.maxWidth+"; max-height: "+d.maxHeight,j=a('<img style="'+d+'" src="'+j+'/img/blank.jpg" title="" />'),t.Utils.Dom.insertIntoDOM(j,b,a(g.activeEditable.obj))):g.Log.error("img cannot markup a selection")},srcChange:function(){this.imageObj.attr("src",this.ui.imgSrcField.getValue())},positionCropButtons:function(){var b=a(".jcrop-tracker:first"),d=b.offset(),g=d.top,d=d.left,e=b.height(),b=b.width(),
p=a("#aloha-CropNResize-btns");0===g&&0===d&&p.hide();g=parseInt(g+e+3,10);d=parseInt(d+b/2-p.width()/2+10,10);(0!=d||0!=g)&&p.offset({top:g,left:d})},initCropButtons:function(){var b=this,d;a("body").append('<div id="aloha-CropNResize-btns" display="none"><button class="cnr-crop-apply" title="'+r.t("Accept")+'"></button><button class="cnr-crop-cancel" title="'+r.t("Cancel")+'"></button></div>');d=a("#aloha-CropNResize-btns");d.find(".cnr-crop-apply").click(function(){b.acceptCrop()});d.find(".cnr-crop-cancel").click(function(){b.endCrop()});
this.interval=setInterval(function(){b.positionCropButtons()},10)},destroyCropButtons:function(){a("#aloha-CropNResize-btns").remove();clearInterval(this.interval)},_disableSelection:function(a){a.find("*").attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"})},crop:function(){var b=this;b.initCropButtons();b.settings.ui.resizable&&b.endResize();b.jcAPI=a.Jcrop(b.imageObj,{onSelect:function(){b._onCropSelect();window.setTimeout(function(){b.ui.setScope()},
10)}});b._disableSelection(s(".jcrop-holder"));b._disableSelection(s("#imageContainer"));b._disableSelection(s("#aloha-CropNResize-btns"));s("body").trigger("aloha-image-crop-start",[b.imageObj])},_onCropSelect:function(){a("#aloha-CropNResize-btns").fadeIn("slow");a(".jcrop-handle").mousedown(function(){a("#aloha-CropNResize-btns").hide()});a(".jcrop-tracker").mousedown(function(){a("#aloha-CropNResize-btns").hide()});if("undefined"!==typeof this.jcAPI&&null!==this.jcAPI){this.positionCropButtons();
var b=this.jcAPI.tellSelect();a("#"+this.ui.imgResizeWidthField.getInputId()).val(b.w);a("#"+this.ui.imgResizeHeightField.getInputId()).val(b.h)}},endCrop:function(){this.jcAPI&&(this.jcAPI.destroy(),this.jcAPI=null);this.destroyCropButtons();this.ui._imageCropButton.setState(!1);this.settings.ui.resizable&&this.startResize();this.keepAspectRatio&&(this.startAspectRatio=this.imageObj.width()/this.imageObj.height());s("body").trigger("aloha-image-crop-stop",[this.imageObj])},acceptCrop:function(){this._onCropped(this.imageObj,
this.jcAPI.tellSelect());this.endCrop()},startResize:function(){var b=this,d=this.imageObj,d=this.imageObj.css({height:this.imageObj.height(),width:this.imageObj.width(),position:"relative","max-height":"","max-width":""});d.resizable({maxHeight:b.settings.maxHeight,minHeight:b.settings.minHeight,maxWidth:b.settings.maxWidth,minWidth:b.settings.minWidth,aspectRatio:b.startAspectRatio,handles:b.settings.handles,grid:b.settings.grid,resize:function(){b._onResize(b.imageObj)},stop:function(a){b._onResized(b.imageObj);
this.enableCrop&&window.setTimeout(function(){b.ui.setScope();that.done(a)},10)}});d.css("display","inline-block");a(".ui-wrapper").attr("contentEditable",!1).addClass("aloha-image-box-active Aloha_Image_Resize aloha").css({position:"relative",display:"inline-block","float":b.imageObj.css("float")}).bind("resizestart",function(a){a.preventDefault()}).bind("mouseup",function(a){a.originalEvent.stopSelectionUpdate=!0})},endResize:function(){this.imageObj&&this.imageObj.closest(".aloha-editable");this.imageObj&&
this.imageObj.is(":ui-resizable")&&this.imageObj.resizable("destroy").css({top:0,left:0})},resetSize:function(){var b=this,d=new Image;d.onload=function(){var g=b.getPluginFocus();b.settings.ui.resizable&&b.endResize();a(g).add(g.parent()).css({width:d.width+"px",height:d.height+"px","max-width":"","max-height":""});b.settings.ui.resizable&&b.resize()};d.src=b.getPluginFocus().attr("src")},reset:function(){this.settings.ui.crop&&this.endCrop();this.settings.ui.resizable&&this.endResize();if(!this._onReset(this.imageObj))for(var a=
0;a<this.restoreProps.length;a++)if(this.imageObj.get(0)===this.restoreProps[a].obj){this.imageObj.attr("src",this.restoreProps[a].src);this.imageObj.width(this.restoreProps[a].width);this.imageObj.height(this.restoreProps[a].height);break}}})});define("highlighteditables/highlighteditables-plugin",["aloha","jquery","aloha/plugin"],function(a,b,d){var p=window.GENTICS;return d.create("highlighteditables",{config:["highlight"],init:function(){var b=this,d;p.Utils.Position.addMouseMoveCallback(function(){var p,
g;for(p=0;p<a.editables.length;p++)g=a.editables[p],d=b.getEditableConfig(g.obj),!a.activeEditable&&(!g.isDisabled()&&"highlight"==d)&&g.obj.addClass("aloha-editable-highlight")});p.Utils.Position.addMouseStopCallback(function(){b.fade()});a.bind("aloha-editable-activated",function(){b.fade()})},fade:function(){var d,p,t=function(){b(this).css("outline","")};for(d=0;d<a.editables.length;d++)p=a.editables[d].obj,p.hasClass("aloha-editable-highlight")&&p.css("outline",p.css("outlineColor")+" "+p.css("outlineStyle")+
" 5px").removeClass("aloha-editable-highlight").animate({outlineWidth:"0px"},300,"swing",t)}})});define("dom-to-xhtml/dom-to-xhtml","jquery util/dom2 util/misc util/browser aloha/ephemera aloha/console".split(" "),function(a,b,d,p,r,s){function t(a,e){var d=b.attrs(a),f="",g,j;if(p.ie7)for(var n in v)if(v.hasOwnProperty(n)&&a[n]){g=0;for(j=d.length;g<j;g++)if(n===d[g][0].toLowerCase()){d.splice(g,1);break}d.push([n,n])}g=0;for(j=d.length;g<j;g++){var s=d[g];n=s[0].toLowerCase();s=s[1];if(!e||!r.isAttrEphemeral(a,
n,e.attrMap||{},e.attrRxs||{})){var t=v[n];if(t||""!==s)f+=" "+n+'="'+(t?n:s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")+'"'}}return f}function g(a){var b=a.nodeName,e=x[b];if(null!=e)return e;var d="/"+a.nodeName;a=a.nextSibling;for(e=!1;null!=a;){if(d==a.nodeName){e=!0;break}a=a.nextSibling}return x[b]=e}function f(a,b,e,d,f){for(;null!=b;)if(1===b.nodeType&&e&&"/"+a.nodeName==b.nodeName){b=b.nextSibling;break}else 1===b.nodeType&&g(b)?b=n(b,b.nextSibling,!0,d,f):(j(b,d,f),
b=b.nextSibling);return b}function n(a,b,d,g,j){var n=a.nodeName.toLowerCase();a.scopeName&&("HTML"!=a.scopeName&&-1===n.indexOf(":"))&&(n=a.scopeName.toLowerCase()+":"+n);!d&&null==b&&e[n]?j.push("<"+n+t(a,g)+"/>"):(j.push("<"+n+t(a,g)+">"),b=f(a,b,d,g,j),j.push("</"+n+">"));return b}function j(a,b,e){1===a.nodeType?n(a,a.firstChild,g(a),b,e):3===a.nodeType?e.push(a.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;")):8===a.nodeType?e.push("<\!--"+a.nodeValue+"--\>"):s.warn("Unknown node type encountered during serialization, ignoring it: type="+
a.nodeType+" name="+a.nodeName+" value="+a.nodeValue)}var e={area:!0,base:!0,basefont:!0,br:!0,col:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,link:!0,meta:!0,param:!0,embed:!0},v={checked:!0,compact:!0,declare:!0,defer:!0,disabled:!0,ismap:!0,multiple:!0,nohref:!0,noresize:!0,noshade:!0,nowrap:!0,readonly:!0,selected:!0},x={DIV:!1,SPAN:!1,UL:!1,OL:!1,LI:!1,TABLE:!1,TR:!1,TD:!1,TH:!1,I:!1,B:!1,EM:!1,STRONG:!1,A:!1,P:!1};return{contentsToXhtml:function(a,b){var e=[];f(a,a.firstChild,!1,b,e);return e.join("")},
nodeToXhtml:function(a,b){var e=[];j(a,b,e);return e.join("")}}});define("dom-to-xhtml/dom-to-xhtml-plugin",["aloha","jquery","aloha/plugin","aloha/ephemera","dom-to-xhtml/dom-to-xhtml"],function(a,b,d,p,r){return d.create("dom-to-xhtml",{init:function(){var d=this;a.Editable.setContentSerializer(function(a){return!d.settings.editables&&!d.settings.config?r.contentsToXhtml(a):d.settings.editables&&"dom-to-xhtml"==d.settings.editables["#"+b(a).attr("id")]?r.contentsToXhtml(a,p.ephemera()):d.settings.config&&
"dom-to-xhtml"==d.settings.config&&!d.settings.editables["#"+b(a).attr("id")]?r.contentsToXhtml(a,p.ephemera()):b(a).html()})}})});define("contenthandler/wordcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(a,b,d){return d.createHandler({handleContent:function(a){"string"===typeof a?a=b("<div>"+a+"</div>"):a instanceof b&&(a=b("<div>").append(a));this.detectWordContent(a)&&this.transformWordContent(a);return a.html()},detectWordContent:function(a){var d=!1;a.find("*").each(function(){var a=
b(this).attr("style");if(a&&0<=a.toLowerCase().indexOf("mso")||(a=b(this).attr("class"))&&0<=a.toLowerCase().indexOf("mso"))return d=!0,!1});return d},isOrderedList:function(a){return"Wingdings"==a.css("fontFamily")||"Symbol"==a.css("fontFamily")?!1:a.text().match(/^([0-9]{1,3}\.)|([0-9]{1,3}\)|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\)))$/)?!0:!1},transformListsFromWord:function(a){var d=this,s,t;t=a.find("p.MsoListParagraphCxSpFirst,p.MsoListParagraphCxSpMiddle,p.MsoListParagraphCxSpLast,p.MsoListParagraph,p span");
t.each(function(){var a=b(this),d=a.css("font-family")||"",n=a.css("mso-list")||"",j=a.attr("style")||"";a.hasClass("MsoListParagraphCxSpFirst")||a.hasClass("MsoListParagraph")?a.addClass("aloha-list-element"):0<=d.indexOf("Symbol")?a.closest("p").addClass("aloha-list-element"):0<=d.indexOf("Wingdings")?a.closest("p").addClass("aloha-list-element"):""!==n?a.closest("p").addClass("aloha-list-element"):0<=j.indexOf("mso-list")&&a.closest("p").addClass("aloha-list-element")});a.find("p span span span").each(function(){var a=
b(this),d;0===b.trim(a.text()).replace(/&nbsp;/g,"").length&&(d=b.trim(a.parent().parent().text()).replace(/&nbsp;/g,""),d.match(/^([0-9]{1,3}\.)|([0-9]{1,3}\))|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\))|(.)$/)&&(a.closest("p").addClass("aloha-list-element"),a.parent().parent().addClass("aloha-list-bullet")))});t="p.aloha-list-element";s=":not("+t+", font)";t=a.find(t);0<t.length&&t.each(function(){var a=b(this),f,n,j,e,p,t,c,u;a.removeClass("aloha-list-element");a.find("font").each(function(){b(this).contents().unwrap()});
u=[];c=parseFloat(a.css("marginLeft"));isNaN(c)&&(c=0);t=[];p=a.nextUntil(s);e=b(a.find("span.aloha-list-bullet"));0===e.length&&(e=a.find("span").eq(0));j=d.isOrderedList(e);e.remove();n=b(j?"<ol></ol>":"<ul></ul>");t.push(n);f=b("<li></li>");n.append(f);a.contents().appendTo(f);a.replaceWith(n);p.each(function(){var a=b(this),g,p;if(!a.is("font")){a.find("font").each(function(){b(this).contents().unwrap()});g=parseFloat(a.css("marginLeft"));isNaN(g)&&(g=0);e=b(a.find("span.aloha-list-bullet"));
0===e.length&&(e=a.find("span").eq(0));j=d.isOrderedList(e);e.remove();if(g>c)p=b(j?"<ol></ol>":"<ul></ul>"),n.children(":last").append(p),n=p,t.push(n),u.push(g),c=g;else if(g<c&&0<u.length){for(;0<u.length&&u[u.length-1]>g;)u.pop(),t.pop();n=t[t.length-1];c=g}f=b("<li></li>");n.append(f);a.contents().appendTo(f);a.remove()}})})},transformTitles:function(d){d.find("p.MsoTitle").each(function(){a.Markup.transformDomObject(b(this),"h1")});d.find("p.MsoSubtitle").each(function(){a.Markup.transformDomObject(b(this),
"h2")})},cleanHtml:function(a){a.find("*").filter(function(){return""==b.trim(b(this).text())&&!b(this).is("td")}).contents().unwrap();a.find("span").contents().unwrap();a.find("a").each(function(){b(this).attr("href")&&b.trim(b(this).attr("href")).match(/^#(.*)$/)&&b(this).contents().unwrap()});a.find("div").contents().unwrap();a.find("*").filter(function(){return""==b.trim(b(this).text())&&!b(this).is("td")}).remove()},removeParagraphNumbering:function(a){a=a.find("h1,h2,h3,h4,h5,h6");0<a.length&&
a.each(function(){var a=b(this),d=a.find("span"),a=a.find("a");d.each(function(){b.trim(b(this).text()).match(/^([\.\(]?[\d\D][\.\(]?){1,4}$/)&&b(this).remove()});a.each(function(){"undefined"===typeof b(this).attr("href")&&b(this).contents().unwrap()})})},transformToc:function(a){a.find("[class*=MsoToc]").each(function(){var a=b(this),d=a.find("span"),a=a.find("a");d.each(function(){b(this).attr("style")&&-1<b(this).attr("style").search("mso-hide")&&b(this).remove();b(this).contents().unwrap()});
a.each(function(){b(this).contents().unwrap()})})},transformWordContent:function(a){this.transformToc(a);this.removeParagraphNumbering(a);this.transformListsFromWord(a);this.transformTitles(a);this.cleanHtml(a)}})});define("contenthandler/genericcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(a,b,d){return d.createHandler({handleContent:function(d){if(null!=d){"string"===typeof d?d=b("<div>"+d+"</div>"):d instanceof b&&(d=b("<div>").append(d));if(0<d.find(".aloha-block").length)return d.html();
this.cleanLists(d);this.transformTables(d);this.removeComments(d);this.unwrapTags(d);this.removeStyles(d);this.removeNamespacedElements(d);var r=!0;a.settings&&(a.settings.contentHandler&&a.settings.contentHandler.handler&&a.settings.contentHandler.handler.generic&&"undefinded"!==typeof a.settings.contentHandler.handler.generic.transformFormattings&&!a.settings.contentHandler.handler.generic.transformFormattings)&&(r=!1);!0===r&&this.transformFormattings(d);return d.html()}},cleanLists:function(a){a.find("ul,ol").each(function(){b(this).contents(":not(li,ul,ol)").each(function(){b(this).remove()})})},
transformTables:function(a){a.find("table").each(function(){b(this).removeAttr("border").removeAttr("cellspacing").removeAttr("cellpadding")});a.find("td").each(function(){b(this).removeAttr("width").removeAttr("height").removeAttr("valign");"<p><br></p>"===this.innerHTML.replace(/[\s\xA0]+/g,"")&&(this.innerHTML="&nbsp;");1===b(this).find("p").length&&b(this).find("p").contents().unwrap()});a.find("tr").each(function(){b(this).removeAttr("width").removeAttr("height").removeAttr("valign")});a.find("colgroup").remove()},
transformFormattings:function(d){d.find("strong,em,s,u,strike").each(function(){"STRONG"===this.nodeName?a.Markup.transformDomObject(b(this),"b"):"EM"===this.nodeName?a.Markup.transformDomObject(b(this),"i"):"S"===this.nodeName||"STRIKE"==this.nodeName?a.Markup.transformDomObject(b(this),"del"):"U"===this.nodeName&&b(this).contents().unwrap()})},transformLinks:function(a){a.find("a").each(function(){"undefined"===typeof b(this).attr("href")&&b(this).contents().unwrap()})},removeComments:function(a){var d=
this;a.contents().each(function(){8===this.nodeType?b(this).remove():d.removeComments(b(this))})},unwrapTags:function(d){d.find("span,font,div").not(".aloha-wai-lang").each(function(){"DIV"==this.nodeName?"<br>"===this.innerHTML?b(this).contents().unwrap():b(a.Markup.transformDomObject(b(this),"p").append("<br>")).contents().unwrap():b(this).contents().unwrap()})},removeStyles:function(a){var d=this;a.children("style").filter(function(){return"false"!==this.contentEditable}).remove();a.children().filter(function(){return"false"!==
this.contentEditable}).each(function(){b(this).removeAttr("style").removeClass();d.removeStyles(b(this))})},removeNamespacedElements:function(a){a.find("*").each(function(){var a=this.prefix?this.prefix:this.scopeName?this.scopeName:void 0;if(a&&"HTML"!==a||0<=this.nodeName.indexOf(":")){var a=b(this),d=a.contents();d.length?d.unwrap():a.remove()}})}})});define("contenthandler/oembedcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(a,b,d){function p(a){return"undefined"==typeof a||
null==a||b.isArray(a)&&0==a.length?!0:!1}var r=window.escape;b.fn.oembed=function(a,d,n){s=b.extend(!0,b.fn.oembed.defaults,d);t=[];var j;j=[];var e;if(p(s.allowedProviders))t=b.fn.oembed.providers;else{for(d=0;d<b.fn.oembed.providers.length;d++)0<=b.inArray(b.fn.oembed.providers[d].name,s.allowedProviders)&&t.push(b.fn.oembed.providers[d]);s.greedy=!1}if(!p(s.disallowedProviders)){for(d=0;d<t.length;d++)0>b.inArray(t[d].name,s.disallowedProviders)&&j.push(t[d]);t=j;s.greedy=!1}p(s.customProviders)||
b.each(s.customProviders,function(a,d){d instanceof b.fn.oembed.OEmbedProvider?t.push(e):(e=new b.fn.oembed.OEmbedProvider,e.fromJSON(d)&&t.push(e))});d=s.defaultOEmbedProvider;j="http://oohembed.com/oohembed/";"embed.ly"==d&&(j="http://api.embed.ly/v1/api/oembed?");j=new b.fn.oembed.OEmbedProvider(d,null,null,j,"callback");!0==s.greedy&&t.push(j);for(d=0;d<t.length;d++)null==t[d].apiendpoint&&(t[d].apiendpoint=j.apiendpoint);return this.each(function(){var e=b(this),d=null!=a?a:e.attr("href"),c;
s.onEmbed=n?n:function(a){b.fn.oembed.insertCode(this,s.embedMethod,a)};if(null!=d)if(c=b.fn.oembed.getOEmbedProvider(d),null!=c){var f;f=s[c.name];if(null==f)f=null;else{var j,p={};for(j in f)null!=j&&(p[j.toLowerCase()]=f[j]);f=p}c.params=f||{};c.maxWidth=s.maxWidth;c.maxHeight=s.maxHeight;f=c.apiendpoint;j="";var p=c.callbackparameter||"callback",t;f=0>=f.indexOf("?")?f+"?":f+"&";null!=c.maxWidth&&null==c.params.maxwidth&&(c.params.maxwidth=c.maxWidth);null!=c.maxHeight&&null==c.params.maxheight&&
(c.params.maxheight=c.maxHeight);for(t in c.params)t!=c.callbackparameter&&null!=c.params[t]&&(j+="&"+r(t)+"="+c.params[t]);f+="format=json&url="+r(d)+j+"&"+p+"=?";c=b.extend({url:f,type:"get",dataType:"json",success:function(a){a=b.extend({},a);switch(a.type){case "photo":a.code=b.fn.oembed.getPhotoCode(d,a);break;case "video":a.code=b.fn.oembed.getVideoCode(d,a);break;case "rich":a.code=b.fn.oembed.getRichCode(d,a);break;default:a.code=b.fn.oembed.getGenericCode(d,a)}s.beforeEmbed.call(e,a);s.onEmbed.call(e,
a);s.afterEmbed.call(e,a)},error:s.onError.call(e,d,c)},s.ajaxOptions||{});b.ajax(c)}else s.onProviderNotFound.call(e,d);return e})};var s,t=[];b.fn.oembed.defaults={maxWidth:null,maxHeight:null,embedMethod:"replace",defaultOEmbedProvider:"oohembed",allowedProviders:null,disallowedProviders:null,customProviders:null,defaultProvider:null,greedy:!0,onProviderNotFound:function(){},beforeEmbed:function(){},afterEmbed:function(){},onEmbed:function(){},onError:function(){},ajaxOptions:{}};b.fn.oembed.embedCode=
!1;b.fn.oembed.insertCode=function(a,d,n){if(null!=n)switch(b.fn.oembed.embedCode=n.code,d){case "auto":null!=a.attr("href")?b.fn.oembed.insertCode(a,"append",n):b.fn.oembed.insertCode(a,"replace",n);break;case "replace":a.replaceWith(n.code);break;case "fill":a.html(n.code);break;case "append":d=a.next();if(null==d||!d.hasClass("oembed-container"))d=a.after('<div class="oembed-container"></div>').next(".oembed-container"),null!=n&&null!=n.provider_name&&d.toggleClass("oembed-container-"+n.provider_name);
d.html(n.code)}};b.fn.oembed.getInsertCode=function(a,b,d){if(null!=d)return d.code};b.fn.oembed.getPhotoCode=function(a,b){var d;d=b.title?b.title:"";d+=b.author_name?" - "+b.author_name:"";d+=b.provider_name?" - "+b.provider_name:"";d='<div><a href="'+a+"\" target='_blank'><img src=\""+b.url+'" alt="'+d+'"/></a></div>';b.html&&(d+="<div>"+b.html+"</div>");return d};b.fn.oembed.getVideoCode=function(a,b){return b.html};b.fn.oembed.getRichCode=function(a,b){return b.html};b.fn.oembed.getGenericCode=
function(a,b){var d='<a href="'+a+'">'+(null!=b.title?b.title:a)+"</a>";b.html&&(d+="<div>"+b.html+"</div>");return d};b.fn.oembed.isProviderAvailable=function(a){return null!=(void 0)(a)};b.fn.oembed.getOEmbedProvider=function(a){for(var b=0;b<t.length;b++)if(t[b].matches(a))return t[b];return null};b.fn.oembed.OEmbedProvider=function(a,d,n,j,e){this.name=a;this.type=d;this.urlschemes=p(n)?["."]:b.isArray(n)?n:n.split(";");this.apiendpoint=j;this.callbackparameter=e;this.maxWidth=500;this.maxHeight=
400;var s,r,c;this.matches=function(a){for(s=0;s<this.urlschemes.length;s++)if(c=RegExp(this.urlschemes[s],"i"),null!=a.match(c))return!0;return!1};this.fromJSON=function(a){for(r in a)this[r]="urlschemes"!=r?a[r]:p(a[r])?["."]:b.isArray(a[r])?a[r]:a[r].split(";");return!0}};b.fn.oembed.providers=[new b.fn.oembed.OEmbedProvider("youtube","video",["youtube\\.com/watch.+v=[\\w-]+&?"]),new b.fn.oembed.OEmbedProvider("flickr","photo",["flickr\\.com/photos/[-.\\w@]+/\\d+/?"],"http://flickr.com/services/oembed",
"jsoncallback"),new b.fn.oembed.OEmbedProvider("viddler","video",["viddler.com"]),new b.fn.oembed.OEmbedProvider("blip","video",["blip\\.tv/.+"],"http://blip.tv/oembed/"),new b.fn.oembed.OEmbedProvider("hulu","video",["hulu\\.com/watch/.*"],"http://www.hulu.com/api/oembed.json"),new b.fn.oembed.OEmbedProvider("vimeo","video",["http://www.vimeo.com/groups/.*/videos/.*","http://www.vimeo.com/.*","http://vimeo.com/groups/.*/videos/.*","http://vimeo.com/.*"],"http://vimeo.com/api/oembed.json"),new b.fn.oembed.OEmbedProvider("dailymotion",
"video",["dailymotion\\.com/.+"]),new b.fn.oembed.OEmbedProvider("scribd","rich",["scribd\\.com/.+"]),new b.fn.oembed.OEmbedProvider("slideshare","rich",["slideshare.net"],"http://www.slideshare.net/api/oembed/1"),new b.fn.oembed.OEmbedProvider("photobucket","photo",["photobucket\\.com/(albums|groups)/.*"],"http://photobucket.com/oembed/")];return d.createHandler({handleContent:function(a){"string"===typeof a?a=b("<div>"+a+"</div>").get(0):a instanceof b&&(a=b("<div>").append(a).get(0));a=b(a).oembed(b(a).text(),
{embedMethod:"replace"});setTimeout(function(){a=b.fn.oembed.embedCode;return b("<div>").append(a).html()},500)},replaceoEmbedContent:function(){}})});pa.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i;pa.RELATIVE="__relative__";pa.prototype.clean_node=function(a){function b(a,b){var d;for(d=0;d<b.length;d++)if(b[d]==a)return d;return-1}function d(){var a=[],b={},d,f;for(d=0;d<arguments.length;d++)if(arguments[d]&&arguments[d].length)for(f=0;f<arguments[d].length;f++)b[arguments[d][f]]||
(b[arguments[d][f]]=!0,a.push(arguments[d][f]));return a}function p(a){for(var r,g=0;g<this.filters.length;g++)if(!this.filters[g](a)){r=a.cloneNode(!0);this.current_element.appendChild(r);return}switch(a.nodeType){case 1:var f,n,j,e,v,x,c;f=[];g=a;e=!1;for(n=0;n<this.transformers.length;n++)if(j=this.transformers[n]({allowed_elements:this.allowed_elements,config:this.config,node:a,node_name:a.nodeName.toLowerCase(),whitelist_nodes:this.whitelist_nodes,dom:this.dom}),null!=j)if("object"==typeof j){if(j.whitelist_nodes&&
j.whitelist_nodes instanceof Array)for(e=0;e<j.whitelist_nodes.length;e++)-1==b(j.whitelist_nodes[e],this.whitelist_nodes)&&this.whitelist_nodes.push(j.whitelist_nodes[e]);e=j.whitelist?!0:!1;j.attr_whitelist&&(f=d(f,j.attr_whitelist));g=j.node?j.node:g}else throw Error("transformer output must be an object or null");a=this.jQuery;a=a.browser.msie&&"7.0"===a.browser.version;j=g.nodeName.toLowerCase();n=this.current_element;if(this.allowed_elements[j]||e){this.current_element=this.dom.createElement(g.nodeName);
n.appendChild(this.current_element);e=d(this.config.attributes[j],this.config.attributes.__ALL__,f);for(f=0;f<e.length;f++)if(r=e[f],v=g.attributes[r])if(x=!0,this.config.protocols[j]&&this.config.protocols[j][r]&&(x=this.config.protocols[j][r],x=(c=v.nodeValue.toLowerCase().match(pa.REGEX_PROTOCOL))?-1!=b(c[1],x):-1!=b(pa.RELATIVE,x)),x&&(!a||a&&"style"!==r))x=document.createAttribute(r),x.value=v.nodeValue,this.current_element.setAttributeNode(x);if(this.config.add_attributes[j])for(r in this.config.add_attributes[j])if(!a||
a&&"style"!==r)x=document.createAttribute(r),x.value=this.config.add_attributes[j][r],this.current_element.setAttributeNode(x)}else if(-1!=b(g,this.whitelist_nodes)){for(this.current_element=g.cloneNode(!0);0<this.current_element.childNodes.length;)this.current_element.removeChild(this.current_element.firstChild);n.appendChild(this.current_element)}if(!this.config.remove_all_contents&&!this.config.remove_element_contents[j])for(f=0;f<g.childNodes.length;f++)p.call(this,g.childNodes[f]);this.current_element.normalize&&
this.current_element.normalize();this.current_element=n;break;case 3:r=a.cloneNode(!1);this.current_element.appendChild(r);break;case 5:r=a.cloneNode(!1);this.current_element.appendChild(r);break;case 8:this.config.allow_comments&&(r=a.cloneNode(!1),this.current_element.appendChild(r))}}var r=this.dom.createDocumentFragment();this.current_element=r;this.whitelist_nodes=[];for(i=0;i<a.childNodes.length;i++)p.call(this,a.childNodes[i]);r.normalize&&r.normalize();return r};define("vendor/sanitize",function(){});
define("contenthandler/sanitizecontenthandler","aloha/core jquery aloha/contenthandlermanager aloha/plugin aloha/console vendor/sanitize".split(" "),function(a,b,d){var p;a.defaults.sanitize||(a.defaults.sanitize={});a.defaults.sanitize.restricted={elements:"b em i strong u del p span div br".split(" ")};a.defaults.sanitize.basic={elements:"a abbr b blockquote br cite code dd del dl dt em i li ol p pre q small strike strong sub sup u ul".split(" "),attributes:{a:["href"],blockquote:["cite"],q:["cite"],
abbr:["title"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};a.defaults.sanitize.relaxed={elements:"a abbr b blockquote br caption cite code col colgroup dd del dl dt em h1 h2 h3 h4 h5 h6 i img li ol p pre q small strike strong sub sup table tbody td tfoot th thead tr u ul span hr object div".split(" "),attributes:{a:"href title id class target data-gentics-aloha-repository data-gentics-aloha-object-id".split(" "),
div:["id","class","style"],abbr:["title"],blockquote:["cite"],br:["class"],col:["span","width"],colgroup:["span","width"],img:"align alt height src title width class data-caption data-align data-width data-original-image".split(" "),ol:["start","type"],p:["class","style","id"],q:["cite"],table:["summary","width"],td:["abbr","axis","colspan","rowspan","width"],th:"abbr axis colspan rowspan scope width".split(" "),ul:["type"],span:["class","style","lang","xml:lang","role"]},protocols:{a:{href:["ftp",
"http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},img:{src:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};return d.createHandler({handleContent:function(d){var s,t;if(a.activeEditable&&a.settings.contentHandler&&a.settings.contentHandler.handler&&a.settings.contentHandler.handler.sanitize)if(a.settings.contentHandler.handler.sanitize&&(t=a.settings.contentHandler.handler.sanitize),"undefined"!==typeof t["#"+a.activeEditable.getId()])s=
t;else for(var g=a.activeEditable.obj.attr("class").split(" "),f=0;f<g.length;f++)"undefined"!==typeof t["."+g[f]]&&(s=t["."+g[f]]);if("undefined"===typeof p||"undefined"!==typeof s)t=["restricted","basic","relaxed"],g=a.defaults.supports,g=a.settings.contentHandler.sanitize&&-1<b.inArray(a.settings.contentHandler.sanitize,t)?a.defaults.sanitize[a.settings.contentHandler.sanitize]:a.defaults.sanitize.relaxed,a.settings.contentHandler.allows&&(g=a.settings.contentHandler.allows),s&&(g=s),g.filters=
[function(a){return"false"!=a.contentEditable}],p=new pa(g,b);"string"===typeof d?d=b("<div>"+d+"</div>").get(0):d instanceof b&&(d=b("<div>").append(d).get(0));return b("<div>").append(p.clean_node(d)).html()}})});define("contenthandler/blockelementcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(a,b,d){var p={h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,p:!0,pre:!0,blockquote:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,P:!0,PRE:!0,BLOCKQUOTE:!0},r={br:!0,BR:!0},s=function(a,d){var g=
b(d);g.filter("h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty,p:empty,pre:empty,blockquote:empty").remove();b.browser.msie?g.filter("br.aloha-end-br").remove():g.filter("li").each(function(){p[this.nodeName]&&(!this.lastChild||!r[this.lastChild.nodeName])&&b(this).append("<br/>")});g.children(":not(.aloha-block)").each(s)},t=function(a,d){var g=b(d);g.filter("h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty,p:empty,pre:empty,blockquote:empty").append("\u200b");g.children(":not(.aloha-block)").each(t)},
g=function(a,d){var j=b(d);0<j.filter("p,h1,h2,h3,h4,h5,h6,pre,blockquote").length&&p[d.nodeName]&&(!d.lastChild||!r[d.lastChild.nodeName])&&b(d).append("<br/>");j.children(":not(.aloha-block)").each(g)};return d.createHandler({handleContent:function(a,d){"string"===typeof a?a=b("<div>"+a+"</div>"):a instanceof b&&(a=b("<div>").append(a));d=d||{};"initEditable"===d.command?(a.children(":not(.aloha-block)").each(s),b.browser.msie&&7>=b.browser.version&&a.children(":not(.aloha-block)").each(t)):"getContents"===
d.command&&(a.children(":not(.aloha-block)").each(g),a.find("li>br:last").remove());return a.html()}})});define("contenthandler/contenthandler-plugin","aloha aloha/plugin jquery aloha/contenthandlermanager contenthandler/wordcontenthandler contenthandler/genericcontenthandler contenthandler/oembedcontenthandler contenthandler/sanitizecontenthandler contenthandler/blockelementcontenthandler".split(" "),function(a,b,d,p,r,s,t,g,f){return b.create("contenthandler",{settings:{},dependencies:[],init:function(){var a=
{word:r,generic:s,sanitize:g,blockelement:f},b;for(b in a)a.hasOwnProperty(b)&&p.register(b,a[b])}})});define("commands/inserthtml","aloha/core jquery aloha/command aloha/selection util/dom aloha/contenthandlermanager aloha/console".split(" "),function(a,b,d,p,r,s,t){d.register("inserthtml",{action:function(d,f){function n(a){var c=b(a);if(!r.insertIntoDOM(c,f,j,!1)){c=c.contents();(r.isBlockLevelElement(a)||r.isListElement(a))&&n(b("<br/>").get(0));for(p=c.length-1;0<=p;--p)n(c[p])}}var j=b(r.getEditingHostOf(f.startContainer)),
e=f.commonAncestorContainer,p,x=[];d=s.handleContent(d,{contenthandler:a.settings.contentHandler.insertHtml});if("string"===typeof d)d=b("<div>"+d+"</div>");else if(d instanceof b)d=b("<div>").append(d);else throw"INVALID_VALUE_ERR";x=d.contents();r.removeRange(f);for(p=x.length-1;0<=p;--p)n(x[p]);0<x.length?f=r.setCursorAfter(x.get(x.length-1)):f.select();r.doCleanup({merge:!0,removeempty:!0},f,e);try{f.select()}catch(c){t.warn("Error:",c)}}})});define("commands/commands-plugin",["aloha/command",
"./inserthtml"],function(){});define("block/blockmanager","aloha jquery ui/scopes aloha/observable aloha/registry util/class util/strings util/maps".split(" "),function(a,b,d,p,r,s,t,g){var f=window.GENTICS,n=new (s.extend(p,{defaults:{"aloha-block-type":"DefaultBlock"},blockTypes:null,blocks:null,_highlightedBlocks:null,_activeBlock:null,_dragdropEnabled:!0,_constructor:function(){d.createScope("Aloha.Block");this.blockTypes=new r;this.blocks=new r;this._highlightedBlocks={}},registerEventHandlers:function(){var d=
this;this._registerEventHandlersForDeactivatingAlohaBlock();this._registerEventHandlersForDeterminingCurrentlyActiveBlock();this._registerEventHandlersForBlockDeletion();this._registerEventHandlersForCutCopyPaste();a.bind("aloha-selection-changed",function(a,f){f&&0<b(f.getCommonAncestorContainer()).parents(".aloha-block").length||d._deactivateHighlightedBlocks()})},_registerEventHandlersForDeactivatingAlohaBlock:function(){var a=this;b(document).bind("click",function(d){g.isEmpty(a._highlightedBlocks)||
0<b(d.target).closest(".aloha-ui,.aloha-block-do-not-deactivate,.aloha-block").length||a._deactivateHighlightedBlocks()})},_registerEventHandlersForDeterminingCurrentlyActiveBlock:function(){var a=this;this.bind("block-selection-change",function(b){a._activeBlock=0<b.length?b[0]:null})},_registerEventHandlersForBlockDeletion:function(){var d=this;a.bind("aloha-command-will-execute",function(e,f){var g=f.commandId,c=0===a.getSelection().getRangeCount()||1===a.getSelection().getRangeCount()&&a.getSelection().getRangeAt(0).endContainer===
a.getSelection().getRangeAt(0).startContainer&&a.getSelection().getRangeAt(0).endContainer===b("body")[0]||1===a.getSelection().getRangeCount()&&a.getSelection().getRangeAt(0).endContainer===a.getSelection().getRangeAt(0).startContainer&&a.getSelection().getRangeAt(0).startOffset+1===a.getSelection().getRangeAt(0).endOffset;if(d._activeBlock&&("delete"===g||"forwarddelete"===g)&&c)f.preventDefault=!0,d._activeBlock.destroy();else if(!d._activeBlock&&("delete"===g||"forwarddelete"===g)&&1===a.getSelection().getRangeCount()&&
!1===a.getSelection().getRangeAt(0).collapsed){var n;n=function(a){for(var c,d=0,e=a.length;d<e;d++)if(c=a[d],1===c.domobj.nodeType){var f=b(c.domobj);"full"===c.selection&&f.is(".aloha-block")?f.remove():n(c.children)}};n(a.Selection.getSelectionTree())}});b(window.document).keydown(function(a){if("undefined"!==typeof a.srcElement&&"undefined"!==typeof a.srcElement.form)return!0;if(d._activeBlock&&(46===a.which||8===a.which)&&!1===d._activeBlock._isInsideNestedEditable)if(b.browser.msie&&8>=parseInt(b.browser.version,
10)&&d._activeBlock.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")||d._activeBlock.shouldDestroy())return d._activeBlock.destroy(),a.preventDefault(),!1})},_registerEventHandlersForCutCopyPaste:function(){var a=this,d=!1,g=!1,n=null;b(window.document).keydown(function(b){if(a._activeBlock&&(b.ctrlKey||b.metaKey)&&67===b.which)d=!0,a._activeBlock.$element.attr("data-aloha-block-copy-only-block","true"),f.Utils.Dom.selectDomNode(a._activeBlock.$element[0]);if(a._activeBlock&&
(b.ctrlKey||b.metaKey)&&88===b.which)g=!0,a._activeBlock.$element.attr("data-aloha-block-copy-only-block","true"),f.Utils.Dom.selectDomNode(a._activeBlock.$element[0])});b(window.document).keyup(function(b){if(!g&&d&&(67===b.which||18===b.which||91===b.which))d=!1,a._activeBlock.$element.removeAttr("data-aloha-block-copy-only-block"),n&&(n=null);if(g&&(67===b.which||18===b.which||88===b.which))g=!1})},initializeBlockLevelDragDrop:function(){var d=this;b.each(a.editables,function(a,b){b.obj.data("block-dragdrop",
d._dragdropEnabled);d.createBlockLevelSortableForEditableOrBlockCollection(b.obj)});a.bind("aloha-editable-created",function(a,b){b.obj.data("block-dragdrop",d._dragdropEnabled);d.createBlockLevelSortableForEditableOrBlockCollection(b.obj)})},createBlockLevelSortableForEditableOrBlockCollection:function(a){a.hasClass("aloha-block-blocklevel-sortable")||(a.addClass("aloha-block-blocklevel-sortable").sortable({revert:100,handle:".aloha-block-draghandle-blocklevel",connectWith:".aloha-block-blocklevel-sortable.aloha-block-dropzone",
disabled:!this._dragdropEnabled,start:function(a,b){b.item.data("block-sort-allowed",0<b.item.parents(".aloha-block-dropzone").length)},change:function(a,b){b.item.data("block-sort-allowed",0<b.placeholder.parents(".aloha-block-dropzone").length)},stop:function(a,d){d.item.data("block-sort-allowed")||b(this).sortable("cancel");d.item.removeData("block-sort-allowed")}}),a.get(0).ondragstart=function(a,b){if(!b||!b.helper||!b.helper.is(".aloha-block"))return!1})},setDragDropState:function(a){this._dragdropEnabled=
a},getDragDropState:function(){return this._dragdropEnabled},registerBlockType:function(a,b){d.createScope("Aloha.Block."+a,"Aloha.Block");this.blockTypes.register(a,b)},_blockify:function(d,e){var f=b(d),g=a.require("block/block-plugin"),c=f[0].tagName.toLowerCase();-1===b.inArray(c,g.settings.rootTags)?a.Log.error("block/blockmanager","Blocks can only be created from ["+g.settings.rootTags.join(", ")+"] element. You passed "+c+"."):(g=this.getConfig(f,e),this.blockTypes.has(g["aloha-block-type"])?
(f=new (this.blockTypes.get(g["aloha-block-type"]))(f,g),f.$element.addClass("aloha-block-"+g["aloha-block-type"]),this.blocks.register(f.getId(),f)):a.Log.error("block/blockmanager","Block Type "+g["aloha-block-type"]+" not found!"))},_unblockify:function(a){(a=this.getBlock(a))&&a.unblock()},getConfig:function(a,d){var f=a.clone(!0),g=f.data(),c={};f.removeData();for(var n in g)g.hasOwnProperty(n)&&(c[t.camelCaseToDashes(n)]=g[n]);return b.extend({},this.defaults,d,c)},getBlock:function(a){"object"===
typeof a&&(a=b(a),a.hasClass("aloha-block-inner")&&(a=a.parent()),a=a.attr("id"));return this.blocks.get(a)},_unregisterBlock:function(a){a="object"===typeof a?a.getId():a;this.blocks.unregister(a)},_deactivateHighlightedBlocks:function(){b.each(b.extend({},this._highlightedBlocks),function(a){(a=n.getBlock(a))&&a.deactivate()})},_getHighlightedBlocks:function(){var a={};b.each(this.blocks.getEntries(),function(b,d){d.isActive()&&(a[b]=d)});return a},_setHighlighted:function(a){this._highlightedBlocks[a.id]=
!0},_setUnhighlighted:function(a){delete this._highlightedBlocks[a.id]}}));a.Block=a.Block||{};return a.Block.BlockManager=n});define("block/editormanager",["aloha/registry"],function(a){return new (a.extend({createEditor:function(a){if(!this.has(a.type))throw'Editor for type "'+a.type+'" not found.';return new (this.get(a.type))(a)}}))});define("block/sidebarattributeeditor",["jquery","block/blockmanager","aloha/sidebar","block/editormanager","util/class"],function(a,b,d,p,r){return new (r.extend({_sidebar:null,
init:function(){this._sidebar=d.right.show();b.bind("block-selection-change",this._onBlockSelectionChange,this)},_onBlockSelectionChange:function(b){var d=this;this._sidebar&&a.each(b,function(){var b=this.getSchema(),f=this,n=[];b&&d._sidebar.addPanel({title:f.getTitle(),expanded:!0,onInit:function(){var d=a("<form />");d.submit(function(){return!1});a.each(b,function(a,b){var g=p.createEditor(b);g.bind("change",function(b){f.attr(a,b)});f.bind("change",function(){g.setValue(f.attr(a))});d.append(g.render());
g.setValue(f.attr(a));n.push(g)});this.setContent(d)},deactivate:function(){a.each(n,function(a,b){b._deactivate()});this.isActive=!1;this.effectiveElement=null}})})}}))});define("block/block","aloha jquery block/blockmanager aloha/observable ui/scopes util/class PubSub".split(" "),function(a,b,d,p,r,s,t){function g(a){a=a.closest(".aloha-editable");return a.length?!!a.data("block-dragdrop"):!0}var f=window.GENTICS;p=s.extend(p,{title:null,id:null,$element:null,_currentlyRendering:!1,_initialized:!1,
_isInsideNestedEditable:!1,_constructor:function(a,d){var g=this;this.$element=a;a.attr("id")?this.id=a.attr("id"):(this.id=f.Utils.guid(),a.attr("id",this.id));a.contentEditable(!1);a.addClass("aloha-block");this.isDraggable()&&(a.find("img").attr("draggable","false"),a.find("a").attr("draggable","false"));b.each(d,function(a,b){g._setAttribute(a,b)});this._onElementClickHandler=function(a){b(a.target).closest(".aloha-block").get(0)===g.$element.get(0)&&(g._fixScrollPositionBugsInIE(),g.activate(a.target,
a))};this._connectThisBlockToDomElement(a,function(){t.pub("aloha.block.initialized",{block:g})});this._initialized=!0},_onElementClickHandler:null,_preventSelectionChangedEventHandler:function(d){"dblclick"!==d.type&&!b(d.target).is(".aloha-editable")&&a.Selection.preventSelectionChanged()},_connectThisBlockToDomElement:function(a,d){var f=this,c=b(a);this._disconnectFromDomElement();this.$element=c;this.$element.bind("click",this._onElementClickHandler);this.$element.bind("mousedown",this._preventSelectionChangedEventHandler);
this.$element.bind("focus",this._preventSelectionChangedEventHandler);this.$element.bind("dblclick",this._preventSelectionChangedEventHandler);this.init(this.$element,function(){window.setTimeout(function(){f._postProcessElementIfNeeded();d&&d()},5)})},_disconnectFromDomElement:function(){this.$element&&(this.$element.unbind("click",this._onElementClickHandler),this.$element.unbind("mousedown",this._preventSelectionChangedEventHandler),this.$element.unbind("focus",this._preventSelectionChangedEventHandler),
this.$element.unbind("dblclick",this._preventSelectionChangedEventHandler))},_fixScrollPositionBugsInIE:function(){var a=b(window).scrollTop();window.setTimeout(function(){b(window).scrollTop()!==a&&b(window).scrollTop(a)},10)},init:function(a,b){b()},shouldDestroy:function(){var a=this.$element.parent().closest(".aloha-block,.aloha-editable,.aloha-block-collection");return a.hasClass("aloha-block-collection")&&"div"===this.$element[0].tagName.toLowerCase()?!0:a.hasClass("aloha-editable")},destroy:function(a){if(this.shouldDestroy()||
!0===a){var b=this,g=new f.Utils.RangeObject;g.startContainer=g.endContainer=this.$element.parent()[0];g.startOffset=g.endOffset=f.Utils.Dom.getIndexInParent(this.$element[0]);d.trigger("block-delete",this);this.free();var c="span"===this.$element[0].tagName.toLowerCase();this.$element.fadeOut("fast",function(){b.$element.remove();d.trigger("block-selection-change",[]);window.setTimeout(function(){c&&g.select()},5)})}},unblock:function(){this.deactivate();this._disconnectFromDomElement();this.$element.removeClass("aloha-block");
this.$element.children(".aloha-block-handle").remove();this.free()},free:function(){d._unregisterBlock(this);this.unbindAll()},getId:function(){return this.id},getSchema:function(){return null},getTitle:function(){return this.title},isDraggable:function(){return"div"===this.$element[0].tagName.toLowerCase()&&this.$element.parents(".aloha-editable,.aloha-block,.aloha-block-collection").first().hasClass("aloha-block-collection")?!0:this.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")},
activate:function(e,f){var g=[];b.each(d._getHighlightedBlocks(),function(){this.deactivate()});"true"!==this.$element.attr("data-block-skip-scope")&&r.setScope("Aloha.Block."+this.attr("aloha-block-type"));this.$element.addClass("aloha-block-active");this._highlight();g.push(this);this.$element.parents(".aloha-block").each(function(){var a=d.getBlock(this);a&&(a._highlight(),g.push(a))});b(e).closest(".aloha-editable,.aloha-block,.aloha-table-cell-editable,.aloha-table-cell_active").first().hasClass("aloha-block")?
(this._isInsideNestedEditable=!1,a.getSelection().removeAllRanges()):(this._isInsideNestedEditable=!0,f&&a.Selection.updateSelection(f));d.trigger("block-activate",g);d.trigger("block-selection-change",g)},deactivate:function(){var a=this,b=[this];this._unhighlight();this.$element.parents(".aloha-block").each(function(){b.push(this);a._unhighlight()});this.$element.removeClass("aloha-block-active");d.trigger("block-deactivate",b);d.trigger("block-selection-change",[])},isActive:function(){return this.$element.hasClass("aloha-block-active")},
_highlight:function(){this.$element.addClass("aloha-block-highlighted");d._setHighlighted(this)},_unhighlight:function(){this.$element.removeClass("aloha-block-highlighted");d._setUnhighlighted(this)},_update:function(){var a=this;!this._currentlyRendering&&this._initialized&&(this._currentlyRendering=!0,this.update(this.$element,function(){a._postProcessElementIfNeeded()}),this._currentlyRendering=!1)},update:function(a,b){b()},_postProcessElementIfNeeded:function(){this.createEditablesIfNeeded();
this._checkThatNestedBlocksAreStillConsistent();this._makeNestedBlockCollectionsSortable();this.renderBlockHandlesIfNeeded();this.isDraggable()&&"span"===this.$element[0].tagName.toLowerCase()?(this._setupDragDropForInlineElements(),this._disableUglyInternetExplorerDragHandles()):this.isDraggable()&&"div"===this.$element[0].tagName.toLowerCase()&&(this._setupDragDropForBlockElements(),this._disableUglyInternetExplorerDragHandles());this._hideDragHandlesIfDragDropDisabled();this._attachDropzoneHighlightEvents()},
_checkThatNestedBlocksAreStillConsistent:function(){this.$element.find(".aloha-block").each(function(){var a=d.getBlock(this);a&&a.$element[0]!==this&&a._connectThisBlockToDomElement(this)})},_makeNestedBlockCollectionsSortable:function(){var a=this;this.$element.find(".aloha-block-collection").each(function(){var f=b(this);f.closest(".aloha-block").get(0)===a.$element.get(0)&&d.createBlockLevelSortableForEditableOrBlockCollection(f)})},_disableUglyInternetExplorerDragHandles:function(){b.browser.msie&&
(this.$element.get(0).onresizestart=function(){return!1},this.$element.get(0).oncontrolselect=function(){return!1},this.$element.get(0).onmovestart=function(){return!1})},_hideDragHandlesIfDragDropDisabled:function(){this._dd_isDragdropEnabled()||this.$element.find(".aloha-block-draghandle").each(function(){var a=b(this);g(a)||a.removeClass("aloha-block-draghandle")})},_attachDropzoneHighlightEvents:function(){var a=this;this.$element.delegate(".aloha-block-draghandle","mousedown",function(){var d=
a.$element.parents(".aloha-editable").first().data("block-dropzones")||[];b.each(d,function(a,c){var d=b(c);b(d).each(function(){b(this).data("block-dragdrop")&&b(this).addClass("aloha-block-dropzone")})});b(document).one("mouseup.aloha-block-dropzone",function(){var d=a.$element.parents(".aloha-editable").first().data("block-dropzones")||[];b.each(d,function(a,d){b(d).removeClass("aloha-block-dropzone")})})})},_setupDragDropForInlineElements:function(){var a=this,d=null,f=!1,c=null,g=null,j=function(){if(d){var j=
b(d);j.is(".aloha-block-dropInlineElementIntoEmptyBlock")?(j.children().remove(),j.append(c)):j.is(".aloha-block-droppable-right")?(j.html(j.html()+" "),j.after(c)):(0<j.prev("[data-i]").length&&j.prev("[data-i]").html(j.prev("[data-i]").html()+" "),j.html(" "+j.html()),j.before(c));c.removeClass("ui-draggable").css({left:0,top:0});a._fixScrollPositionBugsInIE()}b(".aloha-block-dropInlineElementIntoEmptyBlock").removeClass("aloha-block-dropInlineElementIntoEmptyBlock");g.droppable("destroy");g=null;
f=!0},n=[];this.$element.draggable({handle:".aloha-block-draghandle",scope:"aloha-block-inlinedragdrop",disabled:!this._dd_isDragdropEnabled(),revert:function(){return null===d||!f},revertDuration:250,stop:function(){b.browser.msie&&7===parseInt(b.browser.version,10)&&j();b.each(n,function(){a._dd_traverseDomTreeAndRemoveSpans(this)});c=null;n=[]},start:function(){f=!1;n=[];b(".aloha-editable").children("p:empty").html("&nbsp;");var p={tolerance:"pointer",addClasses:!1,scope:"aloha-block-inlinedragdrop",
over:function(f,g){-1===b.inArray(this,n)&&n.push(this);var j=1===b(this).contents().length&&1===b(this).children("br").length;c=g.draggable;b(this).is(":empty")||j||"&nbsp;"===b(this).html()?(b(this).addClass("aloha-block-dropInlineElementIntoEmptyBlock"),d=this):(a._dd_traverseDomTreeAndWrapCharactersWithSpans(this),b("span[data-i]",this).droppable({tolerance:"pointer",addClasses:!1,scope:"aloha-block-inlinedragdrop",over:function(){d&&b(d).removeClass("aloha-block-droppable");d=this;b(this).addClass("aloha-block-droppable")},
out:function(){b(this).removeClass("aloha-block-droppable");d===this&&(d=null)}}),b.ui.ddmanager.prepareOffsets(g.draggable.data("draggable"),f))},out:function(){b(this).removeClass("aloha-block-dropInlineElementIntoEmptyBlock")},drop:function(){b.browser.msie&&7===parseInt(b.browser.version,10)||j()}};g=b(".aloha-editable.aloha-block-dropzone").children(":not(.aloha-block)");g.droppable(p);b(".aloha-table-cell-editable").droppable(p)}})},_dd_traverseDomTreeAndWrapCharactersWithSpans:function(a){for(var b,
d=0,c=a.childNodes.length;d<c;d++)if(b=a.childNodes[d],1===b.nodeType)if(!~b.className.indexOf("aloha-block")&&void 0===b.attributes["data-i"])this._dd_traverseDomTreeAndWrapCharactersWithSpans(b);else{if(b.attributes["data-i"])break}else 3===b.nodeType&&(b=this._dd_insertSpans(b),d+=b,c+=b)},_dd_splitText:function(a){a=a.split(/(?=\b)/);for(var b=[],d=!1,c=0,f=a.length;c<f;c++)/[^\t\n\r ]/.test(a[c])?d?(b.push(" "+a[c]),d=!1):b.push(a[c]):d=!0;d&&(b[b.length-1]+=" ");return b},_dd_insertSpans:function(a){var d=
a.nodeValue;if(!/[^\t\n\r ]/.test(d))return 0;for(var f=document.createDocumentFragment(),d=this._dd_splitText(d),c=d.length,g,j,n,p=0,r=0;r<c;r++)if(j=d[r],0!==j.length){n=Math.floor(j.length/2);g=parseInt(b.browser.version,10);if(b.browser.msie&&(7===g||8===g))n=0;0<n&&(g=document.createElement("span"),g.appendChild(document.createTextNode(j.substr(0,n))),g.setAttribute("data-i",r),f.appendChild(g),p++);g=document.createElement("span");j=j.substr(n);g.appendChild(document.createTextNode(j));g.setAttribute("data-i",
r);g.setAttribute("class","aloha-block-droppable-right");f.appendChild(g);p++}a.parentNode.replaceChild(f,a);return p-1},_dd_traverseDomTreeAndRemoveSpans:function(a){var b=[],d;d=function(a){for(var c=!1,e,f,g,j=0,n=a.childNodes.length;j<n;j++)g=a.childNodes[j],1===g.nodeType&&(void 0!==g.attributes["data-i"]?(c||(c=!0,e="",f=void 0),c&&(e+=g.firstChild.nodeValue,f&&b.push(f),f=g)):(c&&(c=!1,f.parentNode.replaceChild(document.createTextNode(e),f)),~g.className.indexOf("aloha-block")||d(g)));c&&f.parentNode.replaceChild(document.createTextNode(e),
f)};d(a);a=0;for(var c=b.length;a<c;a++)b[a].parentNode.removeChild(b[a])},_dd_isDragdropEnabled:function(){return g(this.$element.parent())},_setupDragDropForBlockElements:function(){this.$element.find(".aloha-block-draghandle").addClass("aloha-block-draghandle-blocklevel")},createEditablesIfNeeded:function(){this.$element.find(".aloha-editable").aloha()},renderBlockHandlesIfNeeded:function(){this.isDraggable()&&0===this.$element.children(".aloha-block-draghandle").length&&this.$element.prepend('<span class="aloha-block-handle aloha-block-draghandle"></span>')},
attr:function(d,f,g){var c=this,j=!1;if(2<=arguments.length){if("aloha-block-"===d.substr(0,12)){a.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+d+")");return}this._getAttribute(d)!==f&&(j=!0);this._setAttribute(d,f)}else if("object"===typeof d)b.each(d,function(b,d){"aloha-block-"===b.substr(0,12)?a.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+
b+")"):(c._getAttribute(b)!==d&&(j=!0),c._setAttribute(b,d))});else return"string"===typeof d?this._getAttribute(d):this._getAttributes();j&&!g&&(this._update(),this.trigger("change"),a.activeEditable.smartContentChange({type:"block-change"}));return null},_setAttribute:function(a,b){this.$element.attr("data-"+a.toLowerCase(),b)},_getAttribute:function(a){return this.$element.attr("data-"+a.toLowerCase())},_getAttributes:function(){var a={};b.each(this.$element[0].attributes,function(b,d){"data-"===
d.name.substr(0,5)&&(a[d.name.substr(5).toLowerCase()]=d.value)});return a}});s=p.extend({update:function(a,b){b()}});var n=p.extend({title:"Debugging",init:function(a,b){this.update(a,b)},update:function(a,d){a.css({display:"block"});var f='<table class="debug-block">';b.each(this.attr(),function(a,b){f+="<tr><th>"+a+"</th><td>"+b+"</td></tr>"});f+="</table>";a.html(f);d()}}),j=p.extend({title:"EmptyBlock",init:function(){},activate:function(){},deactivate:function(){},renderBlockHandlesIfNeeded:function(){}});
return{AbstractBlock:p,DefaultBlock:s,DebugBlock:n,EmptyBlock:j}});define("block/blockcontenthandler",["jquery","aloha/contenthandlermanager","block/blockmanager"],function(a,b,d){return b.createHandler({handleContent:function(b){"string"===typeof b?b=a("<div>"+b+"</div>"):b instanceof a&&(b=a("<div>").append(b));0<b.find('.aloha-block[data-aloha-block-copy-only-block="true"]').length&&(b.find(".aloha-block:not([id])").remove(),b.find(".aloha-block + span:empty").remove(),b.find("div:empty").remove(),
b.find("br.Apple-interchange-newline").remove(),b.find(".aloha-block").prev("br").remove(),b.find("div > br:only-child").parent().remove());b.find(".aloha-block").each(function(){var b=a(this),p={},t={};a.each(b[0].attributes,function(a,b){"id"!==b.nodeName&&(b.nodeName.match(/^data-/)?t[b.nodeName.substr(5)]=b.nodeValue:p[b.nodeName]=b.nodeValue)});var g=GENTICS.Utils.guid(),f=a("<"+this.tagName+"/>").attr(p).attr("id",g).removeClass("aloha-block-active").removeClass("aloha-block").html(b.html());
b.replaceWith(f);window.setTimeout(function(){d._blockify(a("#"+g),t)},50)});return b.html()}})});define("block/editor",["jquery","aloha/observable","util/class"],function(a,b,d){b=d.extend(b,{schema:null,_constructor:function(a){this.schema=a},render:function(){},getValue:function(){},setValue:function(){},destroy:function(){},_deactivate:function(){this.trigger("change",this.getValue());this.destroy()}});d=b.extend({formInputElementDefinition:null,_$formInputElement:null,render:function(){var b=
a('<div class="aloha-block-editor" />'),d=GENTICS.Utils.guid();b.append(this.renderLabel().attr("id",d));b.append(this.renderFormElement().attr("id",d));return b},renderLabel:function(){var b=a("<label />");b.html(this.schema.label);return b},renderFormElement:function(){var b=this;this._$formInputElement=a(this.formInputElementDefinition);this.afterRenderFormElement(this._$formInputElement);this._$formInputElement.change(function(){b.trigger("change",b.getValue())});return this._$formInputElement},
afterRenderFormElement:function(){},getValue:function(){return this._$formInputElement.val()},setValue:function(a){this._$formInputElement.val(a)},destroy:function(){this._$formInputElement.remove()}});var p=d.extend({formInputElementDefinition:'<input type="text" />'}),r=d.extend({formInputElementDefinition:'<input type="range" />',afterRenderFormElement:function(a){this.schema.range&&(this.schema.range.min&&a.attr("min",this.schema.range.min),this.schema.range.max&&a.attr("max",this.schema.range.max),
this.schema.range.step&&a.attr("step",this.schema.range.step))}}),s=d.extend({formInputElementDefinition:'<input type="url" />'}),t=d.extend({formInputElementDefinition:'<input type="email" />'}),g=d.extend({formInputElementDefinition:"<select />",afterRenderFormElement:function(b){a.each(this.schema.values,function(){b.append(a("<option />").attr("value",this.key).html(this.label))})}}),f=d.extend({formInputElementDefinition:"<button />",afterRenderFormElement:function(a){var b=this;a.html(this.schema.buttonLabel);
a.click(function(){b.schema.callback()})}});return{AbstractEditor:b,AbstractFormElementEditor:d,StringEditor:p,NumberEditor:r,UrlEditor:s,EmailEditor:t,SelectEditor:g,ButtonEditor:f}});define("block/nls/i18n",{root:{"button.toggledragdrop.tooltip":"Toggle Drag & Drop"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("block/block-plugin","aloha aloha/plugin jquery aloha/contenthandlermanager block/blockmanager block/sidebarattributeeditor block/block block/editormanager block/blockcontenthandler block/editor ui/ui ui/toggleButton i18n!block/nls/i18n i18n!aloha/nls/i18n jqueryui".split(" "),
function(a,b,d,p,r,s,t,g,f,n,j,e,v){var x=["div","span"];b=b.create("block",{config:[],settings:{},init:function(){var b=this;this.settings.rootTags||(this.settings.rootTags=x);r.registerBlockType("DebugBlock",t.DebugBlock);r.registerBlockType("DefaultBlock",t.DefaultBlock);r.registerBlockType("EmptyBlock",t.EmptyBlock);g.register("string",n.StringEditor);g.register("number",n.NumberEditor);g.register("url",n.UrlEditor);g.register("email",n.EmailEditor);g.register("select",n.SelectEditor);g.register("button",
n.ButtonEditor);p.register("block",f);r.setDragDropState(b.isDragDropEnabled());r.registerEventHandlers();r.initializeBlockLevelDragDrop();a.bind("aloha-ready",function(){b._createBlocks();!1!==b.settings.sidebarAttributeEditor&&s.init()});this.createButtons();a.bind("aloha-editable-created",function(a,d){b.setDropzones(d.obj)});a.bind("aloha-editable-activated",function(a,d){b.applyButtonConfig(d.editable)})},applyButtonConfig:function(a){this._isDragdropToggleEnabled(a)?(this._toggleDragDropButton.show(),
this._toggleDragDropButton.setState(this._getDragdropState(a))):this._toggleDragDropButton.hide()},_isDragdropToggleEnabled:function(a){a=this.getEditableConfig(a.obj);return(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal||"toggleDragdrop"===a[0]||!0==a.toggleDragdrop||"true"==a.toggleDragdrop||1==a.toggleDragdrop||"1"==a.toggleDragdrop)&&this.isDragDropEnabled()},_getDragdropState:function(a){return this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal?
r.getDragDropState():a.obj.data("block-dragdrop")},_toggleDragdropState:function(b){if(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal){var d=!r.getDragDropState();r.setDragDropState(d);for(var e=0;e<a.editables.length;e++)b=a.editables[e],this._setDragDropStateForEditable(b.obj,d)}else d=!b.obj.data("block-dragdrop"),this._setDragDropStateForEditable(b.obj,d)},createButtons:function(){var b=this;this._toggleDragDropButton=j.adopt("toggleDragDrop",e,{tooltip:v.t("button.toggledragdrop.tooltip"),
icon:"aloha-icon aloha-icon-toggledragdrop",scope:"Aloha.continuoustext",click:function(){b._toggleDragdropState(a.activeEditable)}})},setDropzones:function(a){var b=this.getEditableConfig(a);(b=b&&b.dropzones||this.settings.dropzones)?a.data("block-dropzones",b):a.data("block-dropzones",[".aloha-editable"])},isDragDropEnabled:function(){return this.settings&&"undefined"!==typeof this.settings.dragdrop?!0===this.settings.dragdrop||"true"===this.settings.dragdrop||1===this.settings.dragdrop||"1"===
this.settings.dragdrop:!0},_createBlocks:function(){this.settings.defaults||(this.settings.defaults={});d.each(this.settings.defaults,function(a,b){d(a).alohaBlock(b)})},_setDragDropStateForEditable:function(a,b){a.data("block-dragdrop",b);a.hasClass("ui-sortable")&&a.sortable("option","disabled",!b);a.find(".aloha-block.ui-draggable").each(function(){d(this).draggable("option","disabled",!b)});a.find(".aloha-block-handle").each(function(){b?d(this).addClass("aloha-block-draghandle"):d(this).removeClass("aloha-block-draghandle")})}});
d.fn.alohaBlock=function(a){a=a||{};d(this).each(function(b,d){r._blockify(d,a)});return d(this)};d.fn.mahaloBlock=function(){d(this).each(function(a,b){r._unblockify(b)})};return b});define("align/nls/i18n",{root:{"button.alignright.tooltip":"Align to the right","button.alignleft.tooltip":"Align to the left","button.aligncenter.tooltip":"Center","button.alignjustify.tooltip":"Justify","button.aligntop.tooltip":"Align to the top","button.alignmiddle.tooltip":"Align to the middle","button.alignbottom.tooltip":"Align to the bottom"},
ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("align/align-plugin","aloha aloha/plugin ui/ui ui/toggleButton i18n!align/nls/i18n i18n!aloha/nls/i18n jquery PubSub".split(" "),function(a,b,d,p,r,s,t,g){var f=window.GENTICS;return b.create("align",{_constructor:function(){this._super("align")},config:{alignment:"right left center justify top middle bottom".split(" ")},alignment:"",verticalAlignment:"",lastAlignment:"",lastVerticalAlignment:"",init:function(){this.createButtons();var b=
this;a.bind("aloha-editable-activated",function(a,d){b.applyButtonConfig(d.editable.obj)});g.sub("aloha.selection.context-change",function(d){d=d.range;a.activeEditable&&b.buttonPressed(d)})},buttonPressed:function(a){this.horizontalButtonPressed(a);this.verticalButtonPressed(a)},horizontalButtonPressed:function(b){var d=this;this.lastAlignment=this.alignment;this.alignment="";b.findMarkup(function(){if(""!==this.style.textAlign)return d.alignment=this.style.textAlign,!0;d.alignment=t(this).css("text-align")},
a.activeEditable.obj);if(this.alignment!=this.lastAlignment)switch(this._alignRightButton.setState(!1),this._alignLeftButton.setState(!1),this._alignCenterButton.setState(!1),this._alignJustifyButton.setState(!1),this.alignment){case "right":this._alignRightButton.setState(!0);break;case "center":this._alignCenterButton.setState(!0);break;case "justify":this._alignJustifyButton.setState(!0);break;default:this._alignLeftButton.setState(!0),this.alignment="left"}},verticalButtonPressed:function(b){var d=
this;this.lastVerticalAlignment=this.verticalAlignment;this.verticalAlignment="";b.findMarkup(function(){if(""!==this.style.verticalAlign)return d.verticalAlignment=this.style.verticalAlign,!0;d.verticalAlignment=t(this).css("vertical-align")},a.activeEditable.obj);if(this.verticalAlignment!=this.lastVerticalAlignment)switch(this._alignTopButton.setState(!1),this._alignMiddleButton.setState(!1),this._alignBottomButton.setState(!1),this.verticalAlignment){case "top":this._alignTopButton.setState(!0);
break;case "middle":this._alignMiddleButton.setState(!0);break;case "bottom":this._alignBottomButton.setState(!0);break;default:this._alignTopButton.setState(!0),this.verticalAlignment="top"}},applyButtonConfig:function(a){a=this.getEditableConfig(a);if(!a||!a.alignment||this.settings.alignment)a[0]&&a[0].alignment?a=a[0]:this.settings.alignment&&(a.alignment=this.settings.alignment);"undefined"===typeof a.alignment&&(a=this.config);-1!=t.inArray("right",a.alignment)?this._alignRightButton.show(!0):
this._alignRightButton.show(!1);-1!=t.inArray("left",a.alignment)?this._alignLeftButton.show(!0):this._alignLeftButton.show(!1);-1!=t.inArray("center",a.alignment)?this._alignCenterButton.show(!0):this._alignCenterButton.show(!1);-1!=t.inArray("justify",a.alignment)?this._alignJustifyButton.show(!0):this._alignJustifyButton.show(!1);-1!=t.inArray("top",a.alignment)?this._alignTopButton.show(!0):this._alignTopButton.show(!1);-1!=t.inArray("middle",a.alignment)?this._alignMiddleButton.show(!0):this._alignMiddleButton.show(!1);
-1!=t.inArray("bottom",a.alignment)?this._alignBottomButton.show(!0):this._alignBottomButton.show(!1)},createButtons:function(){var a=this;this._alignLeftButton=d.adopt("alignLeft",p,{tooltip:r.t("button.alignleft.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-left",scope:"Aloha.continuoustext",click:function(){a.align("left")}});this._alignCenterButton=d.adopt("alignCenter",p,{tooltip:r.t("button.aligncenter.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-center",scope:"Aloha.continuoustext",
click:function(){a.align("center")}});this._alignRightButton=d.adopt("alignRight",p,{tooltip:r.t("button.alignright.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-right",scope:"Aloha.continuoustext",click:function(){a.align("right")}});this._alignJustifyButton=d.adopt("alignJustify",p,{tooltip:r.t("button.alignjustify.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-justify",scope:"Aloha.continuoustext",click:function(){a.align("justify")}});this._alignTopButton=d.adopt("alignTop",
p,{tooltip:r.t("button.aligntop.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-top",scope:"table.cell",click:function(){a.verticalAlign("top")}});this._alignMiddleButton=d.adopt("alignMiddle",p,{tooltip:r.t("button.alignmiddle.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-middle",scope:"table.cell",click:function(){a.verticalAlign("middle")}});this._alignBottomButton=d.adopt("alignBottom",p,{tooltip:r.t("button.alignbottom.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-bottom",
scope:"table.cell",click:function(){a.verticalAlign("bottom")}})},verticalAlign:function(b){var d=a.Selection.getRangeObject();this.lastVerticalAlignment=this.verticalAlignment;this.verticalAlignment=b;(b=this.getSelectedCells(d))&&this.toggleAlign(b,"vertical-align");if(this.verticalAlignment!=this.lastVerticalAlignment)switch(this.lastVerticalAlignment){case "top":this._alignTopButton.setState(!1);break;case "middle":this._alignMiddleButton.setState(!1);break;case "bottom":this._alignBottomButton.setState(!1)}d.select()},
align:function(b){var d=a.Selection.getRangeObject();this.lastAlignment=this.alignment;this.alignment=b;b=d.getCommonAncestorContainer();var e=this.getSelectedCells(d);if(e)this.toggleAlign(e);else if(f.Utils.Dom.isEditingHost(b)){var g=[];t.each(a.Selection.getRangeObject().getSelectionTree(),function(){"none"!==this.selection&&3!==this.domobj.nodeType&&g.push(this.domobj)});this.toggleAlign(g)}else this.toggleAlign(b);if(this.alignment!=this.lastAlignment)switch(this.lastAlignment){case "right":this._alignRightButton.setState(!1);
break;case "left":this._alignLeftButton.setState(!1);break;case "center":this._alignCenterButton.setState(!1);break;case "justify":this._alignJustifyButton.setState(!1)}d.select()},getSelectedCells:function(b){var d;b=b.findMarkup(function(){t(this).is("td,th")&&(d=this);return t(this).is("table.aloha-table")},a.activeEditable.obj);b=t(b).find(".aloha-cell-selected");return b.length?b:d},toggleAlign:function(a,b){b=b||"text-align";var d="vertical-align"===b?this.verticalAlignment:this.alignment,f=
!0;t(a).each(function(){if(t(this).css(b)!=d)return f=!1});t(a).each(function(){t(this).css(b)==d&&f?t(this).css(b,""):t(this).css(b,d)})}})});define("paste/paste-plugin",["aloha/core","aloha/plugin","jquery","aloha/command","aloha/console"],function(a,b,d,p,r){function s(){f=a.getSelection().getRangeAt(0);n=a.activeEditable;j.css({top:g.scrollTop(),left:g.scrollLeft()-200});j.contents().remove();n&&n.obj.blur();a.getSelection().removeAllRanges();var b=a.createRange();b.setStart(j.get(0),0);b.setEnd(j.get(0),
0);a.getSelection().addRange(b);j.focus()}function t(){var b;if(f&&n){n.obj.focus();a.getSelection().removeAllRanges();b=a.createRange();b.setStart(f.startContainer,f.startOffset);b.setEnd(f.endContainer,f.endOffset);a.getSelection().addRange(b);b=j.html();d.browser.msie&&/^&nbsp;/.test(b)&&(b=b.substring(6));var g=f.startContainer;3==g.nodeType&&("P"==g.parentNode.nodeName&&1==g.parentNode.childNodes.length&&/^(\s|%A0)$/.test(escape(g.data)))&&(g.data="",f.startOffset=0,f.endContainer==g&&(f.endOffset=
0));a.queryCommandSupported("insertHTML")?a.execCommand("insertHTML",!1,b):r.error("Common.Paste",'Command "insertHTML" not available. Enable the plugin "common/commands".')}n=f=void 0;j.contents().remove()}var g=d(window),f=null,n=null,j=d('<div id="pasteContainer" style="position:absolute; clip:rect(0px, 0px, 0px, 0px); width: 1px; height: 1px;"></div>').contentEditable(!0);return b.create("paste",{settings:{},init:function(){d("body").append(j);a.bind("aloha-editable-created",function(b,f){d.browser.msie?
f.obj.bind("beforepaste",function(a){s();a.stopPropagation()}):f.obj.bind("paste",function(b){s();window.setTimeout(function(){t();a.activeEditable.smartContentChange(b)},10);b.stopPropagation()})});d.browser.msie&&j.bind("paste",function(b){window.setTimeout(function(){t();a.activeEditable.smartContentChange(b)},10);b.stopPropagation()})},register:function(){r.deprecated("Plugins.Paste","register() for pasteHandler is deprecated. Use the ContentHandler Plugin instead.")}})});Aloha._load&&Aloha._load()})();
